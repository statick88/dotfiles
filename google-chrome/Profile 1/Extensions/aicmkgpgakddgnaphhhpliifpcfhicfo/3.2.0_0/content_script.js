(()=>{"use strict";var e,n,t;try{window&&(n="forwardInterceptorRequest",t=function t(s){var a,i;if((null==s?void 0:s.source)===window){var d,r,l=null===(a=s.data)||void 0===a||null===(a=a.postmanMessage)||void 0===a?void 0:a.type,v=null===(i=s.data)||void 0===i||null===(i=i.postmanMessage)||void 0===i?void 0:i.action;try{var u;if("interceptorHttpRequest"===l){if("sendRequest"===v)d=null===(u=s.data)||void 0===u||null===(u=u.postmanMessage)||void 0===u?void 0:u.data,r=null==d?void 0:d.id,chrome.runtime.sendMessage({type:"sendRequest",data:d},(function(n){n=JSON.parse(n),"firefox"===e&&(n=cloneInto(n,window));var t=new CustomEvent("interceptor-event_".concat(r),{detail:n});window.dispatchEvent(t)}));else if("abortRequest"===v){var c;!function(e){chrome.runtime.sendMessage({type:"abortRequest",data:e})}(null===(c=s.data)||void 0===c||null===(c=c.postmanMessage)||void 0===c?void 0:c.data)}}else if("interceptorAgentSYN"===l)chrome.runtime.sendMessage({from:"contentScript-sync"},(function(n){"firefox"===e&&(n=cloneInto(n,window));var t=new CustomEvent("interceptor-agent-ack",{detail:n});window.dispatchEvent(t)}));else if("interceptorSessionSYN"===l)chrome.runtime.sendMessage({from:"contentScript-web-session"});else if(l===n){var m,g,p;"INTERCEPTOR_SESSION_STARTED"===(null===(m=s.data)||void 0===m||null===(m=m.postmanMessage)||void 0===m||null===(m=m.message)||void 0===m?void 0:m.type)?o=!0:"INTERCEPTOR_SESSION_TERMINATED"===(null===(g=s.data)||void 0===g||null===(g=g.postmanMessage)||void 0===g||null===(g=g.message)||void 0===g?void 0:g.type)&&(o=!1),chrome.runtime.sendMessage({type:n,message:null===(p=s.data)||void 0===p||null===(p=p.postmanMessage)||void 0===p?void 0:p.message})}}catch(e){"Extension context invalidated."===e.message?window.removeEventListener("message",t):console.log("Unable to Send message to Interceptor: ",e.message)}}},chrome.runtime.sendMessage({type:"GET_BROWSER"},(function(n){e=n,window.addEventListener("message",t),window.addEventListener("beforeunload",(function(e){o&&(e.preventDefault(),e.returnValue=!0)})),chrome.runtime.onMessage.addListener((function(n){"firefox"===e&&(n.message=cloneInto(n.message,window));var t=new CustomEvent(n.event,{detail:n.message});window.dispatchEvent(t)}))})))}catch(e){}var o=!1})();