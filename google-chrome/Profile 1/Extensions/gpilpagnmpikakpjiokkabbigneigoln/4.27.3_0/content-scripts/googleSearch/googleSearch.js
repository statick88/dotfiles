(()=>{"use strict";const t=JSON.parse('["google.com","google.es","marca.com","twitter.com","as.com","wikipedia.org","elmundo.es","instagram.com","elpais.com","sport.es","20minutes.es","mundodeportivo.com","elespanol.com","youtube.com","facebook.com","twitch.com","twitch.tv","linkedin.com","msn.com","pornhub.com","whatsapp.com","yahoo.com","xvideos.com","onlyfans.com","netflix.com","tiktok.com"]');class e{static get(){return chrome}}var n=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{a(o.next(t))}catch(t){r(t)}}function c(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((o=o.apply(t,e||[])).next())}))};class o{static send(t,o){return n(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{e.get().runtime.sendMessage({id:t,payload:o},(t=>{n(t)}))}))}))}static sendDOMMessage(t,e){return n(this,void 0,void 0,(function*(){return window.parent.postMessage({id:t,payload:e},"*")}))}}class i{static fetch(t,e){return n=this,i=void 0,s=function*(){return o.send("@FETCH_REQUEST_MESSAGE",{url:t,request:e})},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{a(s.next(t))}catch(t){e(t)}}function c(t){try{a(s.throw(t))}catch(t){e(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,c)}a((s=s.apply(n,i||[])).next())}));var n,i,r,s}}var r=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{a(o.next(t))}catch(t){r(t)}}function c(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((o=o.apply(t,e||[])).next())}))};const s="@GEO";class c{static set(t,n){return r(this,void 0,void 0,(function*(){return yield e.get().storage.local.set({[t]:n}),n}))}static get(t){return r(this,void 0,void 0,(function*(){const n=yield e.get().storage.local.get(t);if(n)return n[t]}))}static remove(t){return r(this,void 0,void 0,(function*(){return e.get().storage.local.remove(t)}))}static clear(){return r(this,void 0,void 0,(function*(){return e.get().storage.local.clear()}))}}var a=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{a(o.next(t))}catch(t){r(t)}}function c(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((o=o.apply(t,e||[])).next())}))};class u{constructor(t,e,n){this.timestamp=t,this.exp=e,this.data=n}static get(t){return a(this,void 0,void 0,(function*(){const e=yield c.get(t.join());if(e)return e.exp>Date.now()?e.data:void 0}))}static write(t,e,n=3e4){return a(this,void 0,void 0,(function*(){return c.set(t.join(),{timestamp:Date.now(),exp:Date.now()+n,data:e})}))}static fetch(t,e,n=3e4){return a(this,void 0,void 0,(function*(){if(!t)return;const o=yield u.get(t);if(o)return o;const i=yield e();return(yield u.write(t,i,n)).data}))}}var h=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{a(o.next(t))}catch(t){r(t)}}function c(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((o=o.apply(t,e||[])).next())}))};class d{static get(){return h(this,void 0,void 0,(function*(){return(yield c.get(s))||"es"}))}static set(t="es"){return h(this,void 0,void 0,(function*(){return c.set(s,t)}))}}var l=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{a(o.next(t))}catch(t){r(t)}}function c(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((o=o.apply(t,e||[])).next())}))};class f{constructor(t,e,n,o,i,r,s,c,a,u,h,d,l,f,v,m,g,p,y,w,k,x){this._id=t,this.active=e,this.joined=n,this.hide_extension_popups=o,this.advertiser_id=i,this.advertiser_name=r,this.host=s,this.geos=c,this.allowed_hostnames=a,this.hide_platforms=u,this.network=h,this.tracking_url=d,this.category=l,this.checkout_url_keyword=f,this.success_url_keyword=v,this.peer_keywords=m,this.cashback=g,this.autofill=p,this.coupon_tester=y,this.epic_qoins=w,this.logo=k,this.banner=x}static query(e){return l(this,void 0,void 0,(function*(){const n=yield d.get(),o=["@ADVERTISER_KEY",e.host,e.hostname,n];if(e.hostname&&t.find((t=>{var n;return t.includes(null!==(n=null==e?void 0:e.hostname)&&void 0!==n?n:"")})))throw Error("Advertiser in blacklist.");return u.fetch(o,(()=>l(this,void 0,void 0,(function*(){const t=new URL(`https://qoala-api-7adzuf62ma-nw.a.run.app/networkAdvertisers?geo=${n.toLowerCase()}`);Object.entries(e).forEach((e=>{e[1]&&t.searchParams.append(e[0],String(e[1]))}));const o=yield i.fetch(t.toString(),{method:"GET"});if(!o.success)throw new Error("Error getting advertiser.");if(o.data)return o.data[0]}))),3e5)}))}}var v=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{a(o.next(t))}catch(t){r(t)}}function c(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((o=o.apply(t,e||[])).next())}))};class m{constructor(t,e,n,o,i,r,s){this.uid=t,this.anonymous_id=e,this.email=n,this.name=o,this.createdAt=i,this.photoUrl=r,this.token=s}static get(){return v(this,void 0,void 0,(function*(){return c.get("@AUTH_KEY")}))}static refreshToken(){var t;return v(this,void 0,void 0,(function*(){const e=yield m.get();return(new URLSearchParams).set("data",JSON.stringify({grant_type:"refresh_token",refresh_token:null==e?void 0:e.token})),(yield i.fetch("https://securetoken.googleapis.com/v1/token?key=AIzaSyDgoYNNtBEjkKS3BwzYvYsuD0-CrdyyXJY",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:null!==(t=null==e?void 0:e.token)&&void 0!==t?t:""}).toString()})).id_token}))}}function g(t,n){const o=document.createElement("iframe");o.src=e.get().runtime.getURL(`content-scripts/googleSearch/SearchTag.html?hostname=${t}`),o.className="search-tag";const i=o.style;i.width="250px",i.height="30px",i.border="none",i.borderRadius="99px",i.overflow="none",i.zIndex="2147483647",i.background="none transparent",i.backgroundColor="none transparent",i.transition="all .2s ease-out",i.animation="fade-in 0.5s linear",0===document.getElementsByClassName("search-tag").length&&(null==n||n.prepend(o))}!function(){var t,e,n,o,i;e=this,n=void 0,i=function*(){if((yield m.get())&&location.pathname.includes("search")){const e=document.getElementById("search");if(e){const n=e.getElementsByClassName("g");for(const e of n){const n=e.querySelector("a"),o=null!==(t=null==n?void 0:n.hostname)&&void 0!==t?t:"";if(0===document.getElementsByClassName("search-tag").length){const t=yield f.query({hostname:o,active:!0,joined:!0});!(null==t?void 0:t.hide_platforms.includes("Extension"))&&(null==t?void 0:t.cashback.active)&&g(o,e)}}}}},new((o=void 0)||(o=Promise))((function(t,r){function s(t){try{a(i.next(t))}catch(t){r(t)}}function c(t){try{a(i.throw(t))}catch(t){r(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(s,c)}a((i=i.apply(e,n||[])).next())}))}()})();