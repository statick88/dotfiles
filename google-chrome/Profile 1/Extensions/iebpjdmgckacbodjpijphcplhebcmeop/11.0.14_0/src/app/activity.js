"use strict";(()=>{var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty;var __commonJS=(cb,mod)=>function(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})},__copyProps=(to,from,except,desc)=>{if(from&&typeof from=="object"||typeof from=="function")for(let key of __getOwnPropNames(from))!__hasOwnProp.call(to,key)&&key!==except&&__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:!0}):target,mod));var require_FileSaver_min=__commonJS({"node_modules/file-saver/dist/FileSaver.min.js"(exports,module){(function(a,b){typeof define=="function"&&define.amd?define([],b):typeof exports<"u"?b():(b(),a.FileSaver={})})(exports,function(){"use strict";function b(a2,b2){return typeof b2>"u"?b2={autoBom:!1}:typeof b2!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),b2={autoBom:!b2}),b2.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a2.type)?new Blob(["\uFEFF",a2],{type:a2.type}):a2}function c(a2,b2,c2){var d2=new XMLHttpRequest;d2.open("GET",a2),d2.responseType="blob",d2.onload=function(){g(d2.response,b2,c2)},d2.onerror=function(){console.error("could not download file")},d2.send()}function d(a2){var b2=new XMLHttpRequest;b2.open("HEAD",a2,!1);try{b2.send()}catch{}return 200<=b2.status&&299>=b2.status}function e(a2){try{a2.dispatchEvent(new MouseEvent("click"))}catch{var b2=document.createEvent("MouseEvents");b2.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a2.dispatchEvent(b2)}}var f=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,a=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||(typeof window!="object"||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b2,g2,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g2=g2||b2.name||"download",j.download=g2,j.rel="noopener",typeof b2=="string"?(j.href=b2,j.origin===location.origin?e(j):d(j.href)?c(b2,g2,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b2),setTimeout(function(){i.revokeObjectURL(j.href)},4e4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f2,g2,h){if(g2=g2||f2.name||"download",typeof f2!="string")navigator.msSaveOrOpenBlob(b(f2,h),g2);else if(d(f2))c(f2,g2,h);else{var i=document.createElement("a");i.href=f2,i.target="_blank",setTimeout(function(){e(i)})}}:function(b2,d2,e2,g2){if(g2=g2||open("","_blank"),g2&&(g2.document.title=g2.document.body.innerText="downloading..."),typeof b2=="string")return c(b2,d2,e2);var h=b2.type==="application/octet-stream",i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&typeof FileReader<"u"){var k=new FileReader;k.onloadend=function(){var a2=k.result;a2=j?a2:a2.replace(/^data:[^;]*;/,"data:attachment/file;"),g2?g2.location.href=a2:location=a2,g2=null},k.readAsDataURL(b2)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b2);g2?g2.location=m:location.href=m,g2=null,setTimeout(function(){l.revokeObjectURL(m)},4e4)}});f.saveAs=g.saveAs=g,typeof module<"u"&&(module.exports=g)})}});var require_html2canvas=__commonJS({"node_modules/html2canvas/dist/html2canvas.js"(exports,module){(function(global2,factory){typeof exports=="object"&&typeof module<"u"?module.exports=factory():typeof define=="function"&&define.amd?define(factory):(global2=typeof globalThis<"u"?globalThis:global2||self,global2.html2canvas=factory())})(exports,function(){"use strict";var extendStatics=function(d,b){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d2,b2){d2.__proto__=b2}||function(d2,b2){for(var p in b2)Object.prototype.hasOwnProperty.call(b2,p)&&(d2[p]=b2[p])},extendStatics(d,b)};function __extends(d,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){return __assign=Object.assign||function(t){for(var s,i2=1,n=arguments.length;i2<n;i2++){s=arguments[i2];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t},__assign.apply(this,arguments)};function __awaiter(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e2){reject(e2)}}function rejected(value){try{step(generator.throw(value))}catch(e2){reject(e2)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}function __generator(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f2,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f2)throw new TypeError("Generator is already executing.");for(;_;)try{if(f2=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e2){op=[6,e2],y=0}finally{f2=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}function __spreadArray(to,from,pack2){if(pack2||arguments.length===2)for(var i2=0,l=from.length,ar;i2<l;i2++)(ar||!(i2 in from))&&(ar||(ar=Array.prototype.slice.call(from,0,i2)),ar[i2]=from[i2]);return to.concat(ar||from)}for(var Bounds=function(){function Bounds2(left2,top2,width,height){this.left=left2,this.top=top2,this.width=width,this.height=height}return Bounds2.prototype.add=function(x,y,w,h){return new Bounds2(this.left+x,this.top+y,this.width+w,this.height+h)},Bounds2.fromClientRect=function(context,clientRect){return new Bounds2(clientRect.left+context.windowBounds.left,clientRect.top+context.windowBounds.top,clientRect.width,clientRect.height)},Bounds2.fromDOMRectList=function(context,domRectList){var domRect=Array.from(domRectList).find(function(rect){return rect.width!==0});return domRect?new Bounds2(domRect.left+context.windowBounds.left,domRect.top+context.windowBounds.top,domRect.width,domRect.height):Bounds2.EMPTY},Bounds2.EMPTY=new Bounds2(0,0,0,0),Bounds2}(),parseBounds=function(context,node){return Bounds.fromClientRect(context,node.getBoundingClientRect())},parseDocumentSize=function(document2){var body=document2.body,documentElement=document2.documentElement;if(!body||!documentElement)throw new Error("Unable to get document size");var width=Math.max(Math.max(body.scrollWidth,documentElement.scrollWidth),Math.max(body.offsetWidth,documentElement.offsetWidth),Math.max(body.clientWidth,documentElement.clientWidth)),height=Math.max(Math.max(body.scrollHeight,documentElement.scrollHeight),Math.max(body.offsetHeight,documentElement.offsetHeight),Math.max(body.clientHeight,documentElement.clientHeight));return new Bounds(0,0,width,height)},toCodePoints$1=function(str){for(var codePoints=[],i2=0,length=str.length;i2<length;){var value=str.charCodeAt(i2++);if(value>=55296&&value<=56319&&i2<length){var extra=str.charCodeAt(i2++);(extra&64512)===56320?codePoints.push(((value&1023)<<10)+(extra&1023)+65536):(codePoints.push(value),i2--)}else codePoints.push(value)}return codePoints},fromCodePoint$1=function(){for(var codePoints=[],_i=0;_i<arguments.length;_i++)codePoints[_i]=arguments[_i];if(String.fromCodePoint)return String.fromCodePoint.apply(String,codePoints);var length=codePoints.length;if(!length)return"";for(var codeUnits=[],index=-1,result="";++index<length;){var codePoint=codePoints[index];codePoint<=65535?codeUnits.push(codePoint):(codePoint-=65536,codeUnits.push((codePoint>>10)+55296,codePoint%1024+56320)),(index+1===length||codeUnits.length>16384)&&(result+=String.fromCharCode.apply(String,codeUnits),codeUnits.length=0)}return result},chars$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$2=typeof Uint8Array>"u"?[]:new Uint8Array(256),i$2=0;i$2<chars$2.length;i$2++)lookup$2[chars$2.charCodeAt(i$2)]=i$2;for(var chars$1$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1$1=typeof Uint8Array>"u"?[]:new Uint8Array(256),i$1$1=0;i$1$1<chars$1$1.length;i$1$1++)lookup$1$1[chars$1$1.charCodeAt(i$1$1)]=i$1$1;for(var decode$1=function(base642){var bufferLength=base642.length*.75,len=base642.length,i2,p=0,encoded1,encoded2,encoded3,encoded4;base642[base642.length-1]==="="&&(bufferLength--,base642[base642.length-2]==="="&&bufferLength--);var buffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(bufferLength):new Array(bufferLength),bytes=Array.isArray(buffer)?buffer:new Uint8Array(buffer);for(i2=0;i2<len;i2+=4)encoded1=lookup$1$1[base642.charCodeAt(i2)],encoded2=lookup$1$1[base642.charCodeAt(i2+1)],encoded3=lookup$1$1[base642.charCodeAt(i2+2)],encoded4=lookup$1$1[base642.charCodeAt(i2+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(encoded2&15)<<4|encoded3>>2,bytes[p++]=(encoded3&3)<<6|encoded4&63;return buffer},polyUint16Array$1=function(buffer){for(var length=buffer.length,bytes=[],i2=0;i2<length;i2+=2)bytes.push(buffer[i2+1]<<8|buffer[i2]);return bytes},polyUint32Array$1=function(buffer){for(var length=buffer.length,bytes=[],i2=0;i2<length;i2+=4)bytes.push(buffer[i2+3]<<24|buffer[i2+2]<<16|buffer[i2+1]<<8|buffer[i2]);return bytes},UTRIE2_SHIFT_2$1=5,UTRIE2_SHIFT_1$1=11,UTRIE2_INDEX_SHIFT$1=2,UTRIE2_SHIFT_1_2$1=UTRIE2_SHIFT_1$1-UTRIE2_SHIFT_2$1,UTRIE2_LSCP_INDEX_2_OFFSET$1=65536>>UTRIE2_SHIFT_2$1,UTRIE2_DATA_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_2$1,UTRIE2_DATA_MASK$1=UTRIE2_DATA_BLOCK_LENGTH$1-1,UTRIE2_LSCP_INDEX_2_LENGTH$1=1024>>UTRIE2_SHIFT_2$1,UTRIE2_INDEX_2_BMP_LENGTH$1=UTRIE2_LSCP_INDEX_2_OFFSET$1+UTRIE2_LSCP_INDEX_2_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_OFFSET$1=UTRIE2_INDEX_2_BMP_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_LENGTH$1=32,UTRIE2_INDEX_1_OFFSET$1=UTRIE2_UTF8_2B_INDEX_2_OFFSET$1+UTRIE2_UTF8_2B_INDEX_2_LENGTH$1,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1=65536>>UTRIE2_SHIFT_1$1,UTRIE2_INDEX_2_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_1_2$1,UTRIE2_INDEX_2_MASK$1=UTRIE2_INDEX_2_BLOCK_LENGTH$1-1,slice16$1=function(view,start2,end2){return view.slice?view.slice(start2,end2):new Uint16Array(Array.prototype.slice.call(view,start2,end2))},slice32$1=function(view,start2,end2){return view.slice?view.slice(start2,end2):new Uint32Array(Array.prototype.slice.call(view,start2,end2))},createTrieFromBase64$1=function(base642,_byteLength){var buffer=decode$1(base642),view32=Array.isArray(buffer)?polyUint32Array$1(buffer):new Uint32Array(buffer),view16=Array.isArray(buffer)?polyUint16Array$1(buffer):new Uint16Array(buffer),headerLength=24,index=slice16$1(view16,headerLength/2,view32[4]/2),data=view32[5]===2?slice16$1(view16,(headerLength+view32[4])/2):slice32$1(view32,Math.ceil((headerLength+view32[4])/4));return new Trie$1(view32[0],view32[1],view32[2],view32[3],index,data)},Trie$1=function(){function Trie2(initialValue,errorValue,highStart,highValueIndex,index,data){this.initialValue=initialValue,this.errorValue=errorValue,this.highStart=highStart,this.highValueIndex=highValueIndex,this.index=index,this.data=data}return Trie2.prototype.get=function(codePoint){var ix;if(codePoint>=0){if(codePoint<55296||codePoint>56319&&codePoint<=65535)return ix=this.index[codePoint>>UTRIE2_SHIFT_2$1],ix=(ix<<UTRIE2_INDEX_SHIFT$1)+(codePoint&UTRIE2_DATA_MASK$1),this.data[ix];if(codePoint<=65535)return ix=this.index[UTRIE2_LSCP_INDEX_2_OFFSET$1+(codePoint-55296>>UTRIE2_SHIFT_2$1)],ix=(ix<<UTRIE2_INDEX_SHIFT$1)+(codePoint&UTRIE2_DATA_MASK$1),this.data[ix];if(codePoint<this.highStart)return ix=UTRIE2_INDEX_1_OFFSET$1-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1+(codePoint>>UTRIE2_SHIFT_1$1),ix=this.index[ix],ix+=codePoint>>UTRIE2_SHIFT_2$1&UTRIE2_INDEX_2_MASK$1,ix=this.index[ix],ix=(ix<<UTRIE2_INDEX_SHIFT$1)+(codePoint&UTRIE2_DATA_MASK$1),this.data[ix];if(codePoint<=1114111)return this.data[this.highValueIndex]}return this.errorValue},Trie2}(),chars$3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$3=typeof Uint8Array>"u"?[]:new Uint8Array(256),i$3=0;i$3<chars$3.length;i$3++)lookup$3[chars$3.charCodeAt(i$3)]=i$3;var base64$1="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",LETTER_NUMBER_MODIFIER=50,BK=1,CR$1=2,LF$1=3,CM=4,NL=5,WJ=7,ZW=8,GL=9,SP=10,ZWJ$1=11,B2=12,BA=13,BB=14,HY=15,CB=16,CL=17,CP=18,EX=19,IN=20,NS=21,OP=22,QU=23,IS=24,NU=25,PO=26,PR=27,SY=28,AI=29,AL=30,CJ=31,EB=32,EM=33,H2=34,H3=35,HL=36,ID=37,JL=38,JV=39,JT=40,RI$1=41,SA=42,XX=43,ea_OP=[9001,65288],BREAK_MANDATORY="!",BREAK_NOT_ALLOWED$1="\xD7",BREAK_ALLOWED$1="\xF7",UnicodeTrie$1=createTrieFromBase64$1(base64$1),ALPHABETICS=[AL,HL],HARD_LINE_BREAKS=[BK,CR$1,LF$1,NL],SPACE$1=[SP,ZW],PREFIX_POSTFIX=[PR,PO],LINE_BREAKS=HARD_LINE_BREAKS.concat(SPACE$1),KOREAN_SYLLABLE_BLOCK=[JL,JV,JT,H2,H3],HYPHEN=[HY,BA],codePointsToCharacterClasses=function(codePoints,lineBreak2){lineBreak2===void 0&&(lineBreak2="strict");var types=[],indices=[],categories=[];return codePoints.forEach(function(codePoint,index){var classType=UnicodeTrie$1.get(codePoint);if(classType>LETTER_NUMBER_MODIFIER?(categories.push(!0),classType-=LETTER_NUMBER_MODIFIER):categories.push(!1),["normal","auto","loose"].indexOf(lineBreak2)!==-1&&[8208,8211,12316,12448].indexOf(codePoint)!==-1)return indices.push(index),types.push(CB);if(classType===CM||classType===ZWJ$1){if(index===0)return indices.push(index),types.push(AL);var prev=types[index-1];return LINE_BREAKS.indexOf(prev)===-1?(indices.push(indices[index-1]),types.push(prev)):(indices.push(index),types.push(AL))}if(indices.push(index),classType===CJ)return types.push(lineBreak2==="strict"?NS:ID);if(classType===SA||classType===AI)return types.push(AL);if(classType===XX)return codePoint>=131072&&codePoint<=196605||codePoint>=196608&&codePoint<=262141?types.push(ID):types.push(AL);types.push(classType)}),[indices,types,categories]},isAdjacentWithSpaceIgnored=function(a2,b,currentIndex,classTypes){var current=classTypes[currentIndex];if(Array.isArray(a2)?a2.indexOf(current)!==-1:a2===current)for(var i2=currentIndex;i2<=classTypes.length;){i2++;var next=classTypes[i2];if(next===b)return!0;if(next!==SP)break}if(current===SP)for(var i2=currentIndex;i2>0;){i2--;var prev=classTypes[i2];if(Array.isArray(a2)?a2.indexOf(prev)!==-1:a2===prev)for(var n=currentIndex;n<=classTypes.length;){n++;var next=classTypes[n];if(next===b)return!0;if(next!==SP)break}if(prev!==SP)break}return!1},previousNonSpaceClassType=function(currentIndex,classTypes){for(var i2=currentIndex;i2>=0;){var type=classTypes[i2];if(type===SP)i2--;else return type}return 0},_lineBreakAtIndex=function(codePoints,classTypes,indicies,index,forbiddenBreaks){if(indicies[index]===0)return BREAK_NOT_ALLOWED$1;var currentIndex=index-1;if(Array.isArray(forbiddenBreaks)&&forbiddenBreaks[currentIndex]===!0)return BREAK_NOT_ALLOWED$1;var beforeIndex=currentIndex-1,afterIndex=currentIndex+1,current=classTypes[currentIndex],before=beforeIndex>=0?classTypes[beforeIndex]:0,next=classTypes[afterIndex];if(current===CR$1&&next===LF$1)return BREAK_NOT_ALLOWED$1;if(HARD_LINE_BREAKS.indexOf(current)!==-1)return BREAK_MANDATORY;if(HARD_LINE_BREAKS.indexOf(next)!==-1||SPACE$1.indexOf(next)!==-1)return BREAK_NOT_ALLOWED$1;if(previousNonSpaceClassType(currentIndex,classTypes)===ZW)return BREAK_ALLOWED$1;if(UnicodeTrie$1.get(codePoints[currentIndex])===ZWJ$1||(current===EB||current===EM)&&UnicodeTrie$1.get(codePoints[afterIndex])===ZWJ$1||current===WJ||next===WJ||current===GL||[SP,BA,HY].indexOf(current)===-1&&next===GL||[CL,CP,EX,IS,SY].indexOf(next)!==-1||previousNonSpaceClassType(currentIndex,classTypes)===OP||isAdjacentWithSpaceIgnored(QU,OP,currentIndex,classTypes)||isAdjacentWithSpaceIgnored([CL,CP],NS,currentIndex,classTypes)||isAdjacentWithSpaceIgnored(B2,B2,currentIndex,classTypes))return BREAK_NOT_ALLOWED$1;if(current===SP)return BREAK_ALLOWED$1;if(current===QU||next===QU)return BREAK_NOT_ALLOWED$1;if(next===CB||current===CB)return BREAK_ALLOWED$1;if([BA,HY,NS].indexOf(next)!==-1||current===BB||before===HL&&HYPHEN.indexOf(current)!==-1||current===SY&&next===HL||next===IN||ALPHABETICS.indexOf(next)!==-1&&current===NU||ALPHABETICS.indexOf(current)!==-1&&next===NU||current===PR&&[ID,EB,EM].indexOf(next)!==-1||[ID,EB,EM].indexOf(current)!==-1&&next===PO||ALPHABETICS.indexOf(current)!==-1&&PREFIX_POSTFIX.indexOf(next)!==-1||PREFIX_POSTFIX.indexOf(current)!==-1&&ALPHABETICS.indexOf(next)!==-1||[PR,PO].indexOf(current)!==-1&&(next===NU||[OP,HY].indexOf(next)!==-1&&classTypes[afterIndex+1]===NU)||[OP,HY].indexOf(current)!==-1&&next===NU||current===NU&&[NU,SY,IS].indexOf(next)!==-1)return BREAK_NOT_ALLOWED$1;if([NU,SY,IS,CL,CP].indexOf(next)!==-1)for(var prevIndex=currentIndex;prevIndex>=0;){var type=classTypes[prevIndex];if(type===NU)return BREAK_NOT_ALLOWED$1;if([SY,IS].indexOf(type)!==-1)prevIndex--;else break}if([PR,PO].indexOf(next)!==-1)for(var prevIndex=[CL,CP].indexOf(current)!==-1?beforeIndex:currentIndex;prevIndex>=0;){var type=classTypes[prevIndex];if(type===NU)return BREAK_NOT_ALLOWED$1;if([SY,IS].indexOf(type)!==-1)prevIndex--;else break}if(JL===current&&[JL,JV,H2,H3].indexOf(next)!==-1||[JV,H2].indexOf(current)!==-1&&[JV,JT].indexOf(next)!==-1||[JT,H3].indexOf(current)!==-1&&next===JT||KOREAN_SYLLABLE_BLOCK.indexOf(current)!==-1&&[IN,PO].indexOf(next)!==-1||KOREAN_SYLLABLE_BLOCK.indexOf(next)!==-1&&current===PR||ALPHABETICS.indexOf(current)!==-1&&ALPHABETICS.indexOf(next)!==-1||current===IS&&ALPHABETICS.indexOf(next)!==-1||ALPHABETICS.concat(NU).indexOf(current)!==-1&&next===OP&&ea_OP.indexOf(codePoints[afterIndex])===-1||ALPHABETICS.concat(NU).indexOf(next)!==-1&&current===CP)return BREAK_NOT_ALLOWED$1;if(current===RI$1&&next===RI$1){for(var i2=indicies[currentIndex],count=1;i2>0&&(i2--,classTypes[i2]===RI$1);)count++;if(count%2!==0)return BREAK_NOT_ALLOWED$1}return current===EB&&next===EM?BREAK_NOT_ALLOWED$1:BREAK_ALLOWED$1},cssFormattedClasses=function(codePoints,options){options||(options={lineBreak:"normal",wordBreak:"normal"});var _a=codePointsToCharacterClasses(codePoints,options.lineBreak),indicies=_a[0],classTypes=_a[1],isLetterNumber=_a[2];(options.wordBreak==="break-all"||options.wordBreak==="break-word")&&(classTypes=classTypes.map(function(type){return[NU,AL,SA].indexOf(type)!==-1?ID:type}));var forbiddenBreakpoints=options.wordBreak==="keep-all"?isLetterNumber.map(function(letterNumber,i2){return letterNumber&&codePoints[i2]>=19968&&codePoints[i2]<=40959}):void 0;return[indicies,classTypes,forbiddenBreakpoints]},Break=function(){function Break2(codePoints,lineBreak2,start2,end2){this.codePoints=codePoints,this.required=lineBreak2===BREAK_MANDATORY,this.start=start2,this.end=end2}return Break2.prototype.slice=function(){return fromCodePoint$1.apply(void 0,this.codePoints.slice(this.start,this.end))},Break2}(),LineBreaker=function(str,options){var codePoints=toCodePoints$1(str),_a=cssFormattedClasses(codePoints,options),indicies=_a[0],classTypes=_a[1],forbiddenBreakpoints=_a[2],length=codePoints.length,lastEnd=0,nextIndex=0;return{next:function(){if(nextIndex>=length)return{done:!0,value:null};for(var lineBreak2=BREAK_NOT_ALLOWED$1;nextIndex<length&&(lineBreak2=_lineBreakAtIndex(codePoints,classTypes,indicies,++nextIndex,forbiddenBreakpoints))===BREAK_NOT_ALLOWED$1;);if(lineBreak2!==BREAK_NOT_ALLOWED$1||nextIndex===length){var value=new Break(codePoints,lineBreak2,lastEnd,nextIndex);return lastEnd=nextIndex,{value,done:!1}}return{done:!0,value:null}}}},FLAG_UNRESTRICTED=1,FLAG_ID=2,FLAG_INTEGER=4,FLAG_NUMBER=8,LINE_FEED=10,SOLIDUS=47,REVERSE_SOLIDUS=92,CHARACTER_TABULATION=9,SPACE=32,QUOTATION_MARK=34,EQUALS_SIGN=61,NUMBER_SIGN=35,DOLLAR_SIGN=36,PERCENTAGE_SIGN=37,APOSTROPHE=39,LEFT_PARENTHESIS=40,RIGHT_PARENTHESIS=41,LOW_LINE=95,HYPHEN_MINUS=45,EXCLAMATION_MARK=33,LESS_THAN_SIGN=60,GREATER_THAN_SIGN=62,COMMERCIAL_AT=64,LEFT_SQUARE_BRACKET=91,RIGHT_SQUARE_BRACKET=93,CIRCUMFLEX_ACCENT=61,LEFT_CURLY_BRACKET=123,QUESTION_MARK=63,RIGHT_CURLY_BRACKET=125,VERTICAL_LINE=124,TILDE=126,CONTROL=128,REPLACEMENT_CHARACTER=65533,ASTERISK=42,PLUS_SIGN=43,COMMA=44,COLON=58,SEMICOLON=59,FULL_STOP=46,NULL=0,BACKSPACE=8,LINE_TABULATION=11,SHIFT_OUT=14,INFORMATION_SEPARATOR_ONE=31,DELETE=127,EOF=-1,ZERO=48,a=97,e=101,f=102,u=117,z=122,A=65,E=69,F=70,U=85,Z=90,isDigit=function(codePoint){return codePoint>=ZERO&&codePoint<=57},isSurrogateCodePoint=function(codePoint){return codePoint>=55296&&codePoint<=57343},isHex=function(codePoint){return isDigit(codePoint)||codePoint>=A&&codePoint<=F||codePoint>=a&&codePoint<=f},isLowerCaseLetter=function(codePoint){return codePoint>=a&&codePoint<=z},isUpperCaseLetter=function(codePoint){return codePoint>=A&&codePoint<=Z},isLetter=function(codePoint){return isLowerCaseLetter(codePoint)||isUpperCaseLetter(codePoint)},isNonASCIICodePoint=function(codePoint){return codePoint>=CONTROL},isWhiteSpace=function(codePoint){return codePoint===LINE_FEED||codePoint===CHARACTER_TABULATION||codePoint===SPACE},isNameStartCodePoint=function(codePoint){return isLetter(codePoint)||isNonASCIICodePoint(codePoint)||codePoint===LOW_LINE},isNameCodePoint=function(codePoint){return isNameStartCodePoint(codePoint)||isDigit(codePoint)||codePoint===HYPHEN_MINUS},isNonPrintableCodePoint=function(codePoint){return codePoint>=NULL&&codePoint<=BACKSPACE||codePoint===LINE_TABULATION||codePoint>=SHIFT_OUT&&codePoint<=INFORMATION_SEPARATOR_ONE||codePoint===DELETE},isValidEscape=function(c1,c2){return c1!==REVERSE_SOLIDUS?!1:c2!==LINE_FEED},isIdentifierStart=function(c1,c2,c3){return c1===HYPHEN_MINUS?isNameStartCodePoint(c2)||isValidEscape(c2,c3):isNameStartCodePoint(c1)?!0:!!(c1===REVERSE_SOLIDUS&&isValidEscape(c1,c2))},isNumberStart=function(c1,c2,c3){return c1===PLUS_SIGN||c1===HYPHEN_MINUS?isDigit(c2)?!0:c2===FULL_STOP&&isDigit(c3):isDigit(c1===FULL_STOP?c2:c1)},stringToNumber=function(codePoints){var c=0,sign=1;(codePoints[c]===PLUS_SIGN||codePoints[c]===HYPHEN_MINUS)&&(codePoints[c]===HYPHEN_MINUS&&(sign=-1),c++);for(var integers=[];isDigit(codePoints[c]);)integers.push(codePoints[c++]);var int=integers.length?parseInt(fromCodePoint$1.apply(void 0,integers),10):0;codePoints[c]===FULL_STOP&&c++;for(var fraction=[];isDigit(codePoints[c]);)fraction.push(codePoints[c++]);var fracd=fraction.length,frac=fracd?parseInt(fromCodePoint$1.apply(void 0,fraction),10):0;(codePoints[c]===E||codePoints[c]===e)&&c++;var expsign=1;(codePoints[c]===PLUS_SIGN||codePoints[c]===HYPHEN_MINUS)&&(codePoints[c]===HYPHEN_MINUS&&(expsign=-1),c++);for(var exponent=[];isDigit(codePoints[c]);)exponent.push(codePoints[c++]);var exp=exponent.length?parseInt(fromCodePoint$1.apply(void 0,exponent),10):0;return sign*(int+frac*Math.pow(10,-fracd))*Math.pow(10,expsign*exp)},LEFT_PARENTHESIS_TOKEN={type:2},RIGHT_PARENTHESIS_TOKEN={type:3},COMMA_TOKEN={type:4},SUFFIX_MATCH_TOKEN={type:13},PREFIX_MATCH_TOKEN={type:8},COLUMN_TOKEN={type:21},DASH_MATCH_TOKEN={type:9},INCLUDE_MATCH_TOKEN={type:10},LEFT_CURLY_BRACKET_TOKEN={type:11},RIGHT_CURLY_BRACKET_TOKEN={type:12},SUBSTRING_MATCH_TOKEN={type:14},BAD_URL_TOKEN={type:23},BAD_STRING_TOKEN={type:1},CDO_TOKEN={type:25},CDC_TOKEN={type:24},COLON_TOKEN={type:26},SEMICOLON_TOKEN={type:27},LEFT_SQUARE_BRACKET_TOKEN={type:28},RIGHT_SQUARE_BRACKET_TOKEN={type:29},WHITESPACE_TOKEN={type:31},EOF_TOKEN={type:32},Tokenizer=function(){function Tokenizer2(){this._value=[]}return Tokenizer2.prototype.write=function(chunk){this._value=this._value.concat(toCodePoints$1(chunk))},Tokenizer2.prototype.read=function(){for(var tokens=[],token=this.consumeToken();token!==EOF_TOKEN;)tokens.push(token),token=this.consumeToken();return tokens},Tokenizer2.prototype.consumeToken=function(){var codePoint=this.consumeCodePoint();switch(codePoint){case QUOTATION_MARK:return this.consumeStringToken(QUOTATION_MARK);case NUMBER_SIGN:var c1=this.peekCodePoint(0),c2=this.peekCodePoint(1),c3=this.peekCodePoint(2);if(isNameCodePoint(c1)||isValidEscape(c2,c3)){var flags=isIdentifierStart(c1,c2,c3)?FLAG_ID:FLAG_UNRESTRICTED,value=this.consumeName();return{type:5,value,flags}}break;case DOLLAR_SIGN:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUFFIX_MATCH_TOKEN;break;case APOSTROPHE:return this.consumeStringToken(APOSTROPHE);case LEFT_PARENTHESIS:return LEFT_PARENTHESIS_TOKEN;case RIGHT_PARENTHESIS:return RIGHT_PARENTHESIS_TOKEN;case ASTERISK:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUBSTRING_MATCH_TOKEN;break;case PLUS_SIGN:if(isNumberStart(codePoint,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(codePoint),this.consumeNumericToken();break;case COMMA:return COMMA_TOKEN;case HYPHEN_MINUS:var e1=codePoint,e2=this.peekCodePoint(0),e3=this.peekCodePoint(1);if(isNumberStart(e1,e2,e3))return this.reconsumeCodePoint(codePoint),this.consumeNumericToken();if(isIdentifierStart(e1,e2,e3))return this.reconsumeCodePoint(codePoint),this.consumeIdentLikeToken();if(e2===HYPHEN_MINUS&&e3===GREATER_THAN_SIGN)return this.consumeCodePoint(),this.consumeCodePoint(),CDC_TOKEN;break;case FULL_STOP:if(isNumberStart(codePoint,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(codePoint),this.consumeNumericToken();break;case SOLIDUS:if(this.peekCodePoint(0)===ASTERISK)for(this.consumeCodePoint();;){var c=this.consumeCodePoint();if(c===ASTERISK&&(c=this.consumeCodePoint(),c===SOLIDUS))return this.consumeToken();if(c===EOF)return this.consumeToken()}break;case COLON:return COLON_TOKEN;case SEMICOLON:return SEMICOLON_TOKEN;case LESS_THAN_SIGN:if(this.peekCodePoint(0)===EXCLAMATION_MARK&&this.peekCodePoint(1)===HYPHEN_MINUS&&this.peekCodePoint(2)===HYPHEN_MINUS)return this.consumeCodePoint(),this.consumeCodePoint(),CDO_TOKEN;break;case COMMERCIAL_AT:var a1=this.peekCodePoint(0),a2=this.peekCodePoint(1),a3=this.peekCodePoint(2);if(isIdentifierStart(a1,a2,a3)){var value=this.consumeName();return{type:7,value}}break;case LEFT_SQUARE_BRACKET:return LEFT_SQUARE_BRACKET_TOKEN;case REVERSE_SOLIDUS:if(isValidEscape(codePoint,this.peekCodePoint(0)))return this.reconsumeCodePoint(codePoint),this.consumeIdentLikeToken();break;case RIGHT_SQUARE_BRACKET:return RIGHT_SQUARE_BRACKET_TOKEN;case CIRCUMFLEX_ACCENT:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),PREFIX_MATCH_TOKEN;break;case LEFT_CURLY_BRACKET:return LEFT_CURLY_BRACKET_TOKEN;case RIGHT_CURLY_BRACKET:return RIGHT_CURLY_BRACKET_TOKEN;case u:case U:var u1=this.peekCodePoint(0),u2=this.peekCodePoint(1);return u1===PLUS_SIGN&&(isHex(u2)||u2===QUESTION_MARK)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(codePoint),this.consumeIdentLikeToken();case VERTICAL_LINE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),DASH_MATCH_TOKEN;if(this.peekCodePoint(0)===VERTICAL_LINE)return this.consumeCodePoint(),COLUMN_TOKEN;break;case TILDE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),INCLUDE_MATCH_TOKEN;break;case EOF:return EOF_TOKEN}return isWhiteSpace(codePoint)?(this.consumeWhiteSpace(),WHITESPACE_TOKEN):isDigit(codePoint)?(this.reconsumeCodePoint(codePoint),this.consumeNumericToken()):isNameStartCodePoint(codePoint)?(this.reconsumeCodePoint(codePoint),this.consumeIdentLikeToken()):{type:6,value:fromCodePoint$1(codePoint)}},Tokenizer2.prototype.consumeCodePoint=function(){var value=this._value.shift();return typeof value>"u"?-1:value},Tokenizer2.prototype.reconsumeCodePoint=function(codePoint){this._value.unshift(codePoint)},Tokenizer2.prototype.peekCodePoint=function(delta){return delta>=this._value.length?-1:this._value[delta]},Tokenizer2.prototype.consumeUnicodeRangeToken=function(){for(var digits=[],codePoint=this.consumeCodePoint();isHex(codePoint)&&digits.length<6;)digits.push(codePoint),codePoint=this.consumeCodePoint();for(var questionMarks=!1;codePoint===QUESTION_MARK&&digits.length<6;)digits.push(codePoint),codePoint=this.consumeCodePoint(),questionMarks=!0;if(questionMarks){var start_1=parseInt(fromCodePoint$1.apply(void 0,digits.map(function(digit){return digit===QUESTION_MARK?ZERO:digit})),16),end2=parseInt(fromCodePoint$1.apply(void 0,digits.map(function(digit){return digit===QUESTION_MARK?F:digit})),16);return{type:30,start:start_1,end:end2}}var start2=parseInt(fromCodePoint$1.apply(void 0,digits),16);if(this.peekCodePoint(0)===HYPHEN_MINUS&&isHex(this.peekCodePoint(1))){this.consumeCodePoint(),codePoint=this.consumeCodePoint();for(var endDigits=[];isHex(codePoint)&&endDigits.length<6;)endDigits.push(codePoint),codePoint=this.consumeCodePoint();var end2=parseInt(fromCodePoint$1.apply(void 0,endDigits),16);return{type:30,start:start2,end:end2}}else return{type:30,start:start2,end:start2}},Tokenizer2.prototype.consumeIdentLikeToken=function(){var value=this.consumeName();return value.toLowerCase()==="url"&&this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),{type:19,value}):{type:20,value}},Tokenizer2.prototype.consumeUrlToken=function(){var value=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF)return{type:22,value:""};var next=this.peekCodePoint(0);if(next===APOSTROPHE||next===QUOTATION_MARK){var stringToken=this.consumeStringToken(this.consumeCodePoint());return stringToken.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS)?(this.consumeCodePoint(),{type:22,value:stringToken.value}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN)}for(;;){var codePoint=this.consumeCodePoint();if(codePoint===EOF||codePoint===RIGHT_PARENTHESIS)return{type:22,value:fromCodePoint$1.apply(void 0,value)};if(isWhiteSpace(codePoint))return this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS?(this.consumeCodePoint(),{type:22,value:fromCodePoint$1.apply(void 0,value)}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN);if(codePoint===QUOTATION_MARK||codePoint===APOSTROPHE||codePoint===LEFT_PARENTHESIS||isNonPrintableCodePoint(codePoint))return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;if(codePoint===REVERSE_SOLIDUS)if(isValidEscape(codePoint,this.peekCodePoint(0)))value.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;else value.push(codePoint)}},Tokenizer2.prototype.consumeWhiteSpace=function(){for(;isWhiteSpace(this.peekCodePoint(0));)this.consumeCodePoint()},Tokenizer2.prototype.consumeBadUrlRemnants=function(){for(;;){var codePoint=this.consumeCodePoint();if(codePoint===RIGHT_PARENTHESIS||codePoint===EOF)return;isValidEscape(codePoint,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},Tokenizer2.prototype.consumeStringSlice=function(count){for(var SLICE_STACK_SIZE=5e4,value="";count>0;){var amount=Math.min(SLICE_STACK_SIZE,count);value+=fromCodePoint$1.apply(void 0,this._value.splice(0,amount)),count-=amount}return this._value.shift(),value},Tokenizer2.prototype.consumeStringToken=function(endingCodePoint){var value="",i2=0;do{var codePoint=this._value[i2];if(codePoint===EOF||codePoint===void 0||codePoint===endingCodePoint)return value+=this.consumeStringSlice(i2),{type:0,value};if(codePoint===LINE_FEED)return this._value.splice(0,i2),BAD_STRING_TOKEN;if(codePoint===REVERSE_SOLIDUS){var next=this._value[i2+1];next!==EOF&&next!==void 0&&(next===LINE_FEED?(value+=this.consumeStringSlice(i2),i2=-1,this._value.shift()):isValidEscape(codePoint,next)&&(value+=this.consumeStringSlice(i2),value+=fromCodePoint$1(this.consumeEscapedCodePoint()),i2=-1))}i2++}while(!0)},Tokenizer2.prototype.consumeNumber=function(){var repr=[],type=FLAG_INTEGER,c1=this.peekCodePoint(0);for((c1===PLUS_SIGN||c1===HYPHEN_MINUS)&&repr.push(this.consumeCodePoint());isDigit(this.peekCodePoint(0));)repr.push(this.consumeCodePoint());c1=this.peekCodePoint(0);var c2=this.peekCodePoint(1);if(c1===FULL_STOP&&isDigit(c2))for(repr.push(this.consumeCodePoint(),this.consumeCodePoint()),type=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)repr.push(this.consumeCodePoint());c1=this.peekCodePoint(0),c2=this.peekCodePoint(1);var c3=this.peekCodePoint(2);if((c1===E||c1===e)&&((c2===PLUS_SIGN||c2===HYPHEN_MINUS)&&isDigit(c3)||isDigit(c2)))for(repr.push(this.consumeCodePoint(),this.consumeCodePoint()),type=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)repr.push(this.consumeCodePoint());return[stringToNumber(repr),type]},Tokenizer2.prototype.consumeNumericToken=function(){var _a=this.consumeNumber(),number=_a[0],flags=_a[1],c1=this.peekCodePoint(0),c2=this.peekCodePoint(1),c3=this.peekCodePoint(2);if(isIdentifierStart(c1,c2,c3)){var unit=this.consumeName();return{type:15,number,flags,unit}}return c1===PERCENTAGE_SIGN?(this.consumeCodePoint(),{type:16,number,flags}):{type:17,number,flags}},Tokenizer2.prototype.consumeEscapedCodePoint=function(){var codePoint=this.consumeCodePoint();if(isHex(codePoint)){for(var hex=fromCodePoint$1(codePoint);isHex(this.peekCodePoint(0))&&hex.length<6;)hex+=fromCodePoint$1(this.consumeCodePoint());isWhiteSpace(this.peekCodePoint(0))&&this.consumeCodePoint();var hexCodePoint=parseInt(hex,16);return hexCodePoint===0||isSurrogateCodePoint(hexCodePoint)||hexCodePoint>1114111?REPLACEMENT_CHARACTER:hexCodePoint}return codePoint===EOF?REPLACEMENT_CHARACTER:codePoint},Tokenizer2.prototype.consumeName=function(){for(var result="";;){var codePoint=this.consumeCodePoint();if(isNameCodePoint(codePoint))result+=fromCodePoint$1(codePoint);else if(isValidEscape(codePoint,this.peekCodePoint(0)))result+=fromCodePoint$1(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(codePoint),result}},Tokenizer2}(),Parser=function(){function Parser2(tokens){this._tokens=tokens}return Parser2.create=function(value){var tokenizer=new Tokenizer;return tokenizer.write(value),new Parser2(tokenizer.read())},Parser2.parseValue=function(value){return Parser2.create(value).parseComponentValue()},Parser2.parseValues=function(value){return Parser2.create(value).parseComponentValues()},Parser2.prototype.parseComponentValue=function(){for(var token=this.consumeToken();token.type===31;)token=this.consumeToken();if(token.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(token);var value=this.consumeComponentValue();do token=this.consumeToken();while(token.type===31);if(token.type===32)return value;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},Parser2.prototype.parseComponentValues=function(){for(var values=[];;){var value=this.consumeComponentValue();if(value.type===32)return values;values.push(value),values.push()}},Parser2.prototype.consumeComponentValue=function(){var token=this.consumeToken();switch(token.type){case 11:case 28:case 2:return this.consumeSimpleBlock(token.type);case 19:return this.consumeFunction(token)}return token},Parser2.prototype.consumeSimpleBlock=function(type){for(var block={type,values:[]},token=this.consumeToken();;){if(token.type===32||isEndingTokenFor(token,type))return block;this.reconsumeToken(token),block.values.push(this.consumeComponentValue()),token=this.consumeToken()}},Parser2.prototype.consumeFunction=function(functionToken){for(var cssFunction={name:functionToken.value,values:[],type:18};;){var token=this.consumeToken();if(token.type===32||token.type===3)return cssFunction;this.reconsumeToken(token),cssFunction.values.push(this.consumeComponentValue())}},Parser2.prototype.consumeToken=function(){var token=this._tokens.shift();return typeof token>"u"?EOF_TOKEN:token},Parser2.prototype.reconsumeToken=function(token){this._tokens.unshift(token)},Parser2}(),isDimensionToken=function(token){return token.type===15},isNumberToken=function(token){return token.type===17},isIdentToken=function(token){return token.type===20},isStringToken=function(token){return token.type===0},isIdentWithValue=function(token,value){return isIdentToken(token)&&token.value===value},nonWhiteSpace=function(token){return token.type!==31},nonFunctionArgSeparator=function(token){return token.type!==31&&token.type!==4},parseFunctionArgs=function(tokens){var args=[],arg=[];return tokens.forEach(function(token){if(token.type===4){if(arg.length===0)throw new Error("Error parsing function args, zero tokens for arg");args.push(arg),arg=[];return}token.type!==31&&arg.push(token)}),arg.length&&args.push(arg),args},isEndingTokenFor=function(token,type){return type===11&&token.type===12||type===28&&token.type===29?!0:type===2&&token.type===3},isLength=function(token){return token.type===17||token.type===15},isLengthPercentage=function(token){return token.type===16||isLength(token)},parseLengthPercentageTuple=function(tokens){return tokens.length>1?[tokens[0],tokens[1]]:[tokens[0]]},ZERO_LENGTH={type:17,number:0,flags:FLAG_INTEGER},FIFTY_PERCENT={type:16,number:50,flags:FLAG_INTEGER},HUNDRED_PERCENT={type:16,number:100,flags:FLAG_INTEGER},getAbsoluteValueForTuple=function(tuple,width,height){var x=tuple[0],y=tuple[1];return[getAbsoluteValue(x,width),getAbsoluteValue(typeof y<"u"?y:x,height)]},getAbsoluteValue=function(token,parent){if(token.type===16)return token.number/100*parent;if(isDimensionToken(token))switch(token.unit){case"rem":case"em":return 16*token.number;case"px":default:return token.number}return token.number},DEG="deg",GRAD="grad",RAD="rad",TURN="turn",angle={name:"angle",parse:function(_context,value){if(value.type===15)switch(value.unit){case DEG:return Math.PI*value.number/180;case GRAD:return Math.PI/200*value.number;case RAD:return value.number;case TURN:return Math.PI*2*value.number}throw new Error("Unsupported angle type")}},isAngle=function(value){return value.type===15&&(value.unit===DEG||value.unit===GRAD||value.unit===RAD||value.unit===TURN)},parseNamedSide=function(tokens){var sideOrCorner=tokens.filter(isIdentToken).map(function(ident){return ident.value}).join(" ");switch(sideOrCorner){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ZERO_LENGTH,ZERO_LENGTH];case"to top":case"bottom":return deg(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ZERO_LENGTH,HUNDRED_PERCENT];case"to right":case"left":return deg(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[HUNDRED_PERCENT,HUNDRED_PERCENT];case"to bottom":case"top":return deg(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[HUNDRED_PERCENT,ZERO_LENGTH];case"to left":case"right":return deg(270)}return 0},deg=function(deg2){return Math.PI*deg2/180},color$1={name:"color",parse:function(context,value){if(value.type===18){var colorFunction=SUPPORTED_COLOR_FUNCTIONS[value.name];if(typeof colorFunction>"u")throw new Error('Attempting to parse an unsupported color function "'+value.name+'"');return colorFunction(context,value.values)}if(value.type===5){if(value.value.length===3){var r=value.value.substring(0,1),g=value.value.substring(1,2),b=value.value.substring(2,3);return pack(parseInt(r+r,16),parseInt(g+g,16),parseInt(b+b,16),1)}if(value.value.length===4){var r=value.value.substring(0,1),g=value.value.substring(1,2),b=value.value.substring(2,3),a2=value.value.substring(3,4);return pack(parseInt(r+r,16),parseInt(g+g,16),parseInt(b+b,16),parseInt(a2+a2,16)/255)}if(value.value.length===6){var r=value.value.substring(0,2),g=value.value.substring(2,4),b=value.value.substring(4,6);return pack(parseInt(r,16),parseInt(g,16),parseInt(b,16),1)}if(value.value.length===8){var r=value.value.substring(0,2),g=value.value.substring(2,4),b=value.value.substring(4,6),a2=value.value.substring(6,8);return pack(parseInt(r,16),parseInt(g,16),parseInt(b,16),parseInt(a2,16)/255)}}if(value.type===20){var namedColor=COLORS[value.value.toUpperCase()];if(typeof namedColor<"u")return namedColor}return COLORS.TRANSPARENT}},isTransparent=function(color2){return(255&color2)===0},asString=function(color2){var alpha=255&color2,blue=255&color2>>8,green=255&color2>>16,red=255&color2>>24;return alpha<255?"rgba("+red+","+green+","+blue+","+alpha/255+")":"rgb("+red+","+green+","+blue+")"},pack=function(r,g,b,a2){return(r<<24|g<<16|b<<8|Math.round(a2*255)<<0)>>>0},getTokenColorValue=function(token,i2){if(token.type===17)return token.number;if(token.type===16){var max2=i2===3?1:255;return i2===3?token.number/100*max2:Math.round(token.number/100*max2)}return 0},rgb=function(_context,args){var tokens=args.filter(nonFunctionArgSeparator);if(tokens.length===3){var _a=tokens.map(getTokenColorValue),r=_a[0],g=_a[1],b=_a[2];return pack(r,g,b,1)}if(tokens.length===4){var _b=tokens.map(getTokenColorValue),r=_b[0],g=_b[1],b=_b[2],a2=_b[3];return pack(r,g,b,a2)}return 0};function hue2rgb(t1,t2,hue){return hue<0&&(hue+=1),hue>=1&&(hue-=1),hue<1/6?(t2-t1)*hue*6+t1:hue<1/2?t2:hue<2/3?(t2-t1)*6*(2/3-hue)+t1:t1}var hsl=function(context,args){var tokens=args.filter(nonFunctionArgSeparator),hue=tokens[0],saturation=tokens[1],lightness=tokens[2],alpha=tokens[3],h=(hue.type===17?deg(hue.number):angle.parse(context,hue))/(Math.PI*2),s=isLengthPercentage(saturation)?saturation.number/100:0,l=isLengthPercentage(lightness)?lightness.number/100:0,a2=typeof alpha<"u"&&isLengthPercentage(alpha)?getAbsoluteValue(alpha,1):1;if(s===0)return pack(l*255,l*255,l*255,1);var t2=l<=.5?l*(s+1):l+s-l*s,t1=l*2-t2,r=hue2rgb(t1,t2,h+1/3),g=hue2rgb(t1,t2,h),b=hue2rgb(t1,t2,h-1/3);return pack(r*255,g*255,b*255,a2)},SUPPORTED_COLOR_FUNCTIONS={hsl,hsla:hsl,rgb,rgba:rgb},parseColor=function(context,value){return color$1.parse(context,Parser.create(value).parseComponentValue())},COLORS={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},backgroundClip={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(_context,tokens){return tokens.map(function(token){if(isIdentToken(token))switch(token.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},backgroundColor={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},parseColorStop=function(context,args){var color2=color$1.parse(context,args[0]),stop=args[1];return stop&&isLengthPercentage(stop)?{color:color2,stop}:{color:color2,stop:null}},processColorStops=function(stops,lineLength){var first=stops[0],last=stops[stops.length-1];first.stop===null&&(first.stop=ZERO_LENGTH),last.stop===null&&(last.stop=HUNDRED_PERCENT);for(var processStops=[],previous=0,i2=0;i2<stops.length;i2++){var stop_1=stops[i2].stop;if(stop_1!==null){var absoluteValue=getAbsoluteValue(stop_1,lineLength);absoluteValue>previous?processStops.push(absoluteValue):processStops.push(previous),previous=absoluteValue}else processStops.push(null)}for(var gapBegin=null,i2=0;i2<processStops.length;i2++){var stop_2=processStops[i2];if(stop_2===null)gapBegin===null&&(gapBegin=i2);else if(gapBegin!==null){for(var gapLength=i2-gapBegin,beforeGap=processStops[gapBegin-1],gapValue=(stop_2-beforeGap)/(gapLength+1),g=1;g<=gapLength;g++)processStops[gapBegin+g-1]=gapValue*g;gapBegin=null}}return stops.map(function(_a,i3){var color2=_a.color;return{color:color2,stop:Math.max(Math.min(1,processStops[i3]/lineLength),0)}})},getAngleFromCorner=function(corner,width,height){var centerX=width/2,centerY=height/2,x=getAbsoluteValue(corner[0],width)-centerX,y=centerY-getAbsoluteValue(corner[1],height);return(Math.atan2(y,x)+Math.PI*2)%(Math.PI*2)},calculateGradientDirection=function(angle2,width,height){var radian=typeof angle2=="number"?angle2:getAngleFromCorner(angle2,width,height),lineLength=Math.abs(width*Math.sin(radian))+Math.abs(height*Math.cos(radian)),halfWidth=width/2,halfHeight=height/2,halfLineLength=lineLength/2,yDiff=Math.sin(radian-Math.PI/2)*halfLineLength,xDiff=Math.cos(radian-Math.PI/2)*halfLineLength;return[lineLength,halfWidth-xDiff,halfWidth+xDiff,halfHeight-yDiff,halfHeight+yDiff]},distance=function(a2,b){return Math.sqrt(a2*a2+b*b)},findCorner=function(width,height,x,y,closest){var corners=[[0,0],[0,height],[width,0],[width,height]];return corners.reduce(function(stat,corner){var cx=corner[0],cy=corner[1],d=distance(x-cx,y-cy);return(closest?d<stat.optimumDistance:d>stat.optimumDistance)?{optimumCorner:corner,optimumDistance:d}:stat},{optimumDistance:closest?1/0:-1/0,optimumCorner:null}).optimumCorner},calculateRadius=function(gradient,x,y,width,height){var rx=0,ry=0;switch(gradient.size){case 0:gradient.shape===0?rx=ry=Math.min(Math.abs(x),Math.abs(x-width),Math.abs(y),Math.abs(y-height)):gradient.shape===1&&(rx=Math.min(Math.abs(x),Math.abs(x-width)),ry=Math.min(Math.abs(y),Math.abs(y-height)));break;case 2:if(gradient.shape===0)rx=ry=Math.min(distance(x,y),distance(x,y-height),distance(x-width,y),distance(x-width,y-height));else if(gradient.shape===1){var c=Math.min(Math.abs(y),Math.abs(y-height))/Math.min(Math.abs(x),Math.abs(x-width)),_a=findCorner(width,height,x,y,!0),cx=_a[0],cy=_a[1];rx=distance(cx-x,(cy-y)/c),ry=c*rx}break;case 1:gradient.shape===0?rx=ry=Math.max(Math.abs(x),Math.abs(x-width),Math.abs(y),Math.abs(y-height)):gradient.shape===1&&(rx=Math.max(Math.abs(x),Math.abs(x-width)),ry=Math.max(Math.abs(y),Math.abs(y-height)));break;case 3:if(gradient.shape===0)rx=ry=Math.max(distance(x,y),distance(x,y-height),distance(x-width,y),distance(x-width,y-height));else if(gradient.shape===1){var c=Math.max(Math.abs(y),Math.abs(y-height))/Math.max(Math.abs(x),Math.abs(x-width)),_b=findCorner(width,height,x,y,!1),cx=_b[0],cy=_b[1];rx=distance(cx-x,(cy-y)/c),ry=c*rx}break}return Array.isArray(gradient.size)&&(rx=getAbsoluteValue(gradient.size[0],width),ry=gradient.size.length===2?getAbsoluteValue(gradient.size[1],height):rx),[rx,ry]},linearGradient=function(context,tokens){var angle$1=deg(180),stops=[];return parseFunctionArgs(tokens).forEach(function(arg,i2){if(i2===0){var firstToken=arg[0];if(firstToken.type===20&&firstToken.value==="to"){angle$1=parseNamedSide(arg);return}else if(isAngle(firstToken)){angle$1=angle.parse(context,firstToken);return}}var colorStop=parseColorStop(context,arg);stops.push(colorStop)}),{angle:angle$1,stops,type:1}},prefixLinearGradient=function(context,tokens){var angle$1=deg(180),stops=[];return parseFunctionArgs(tokens).forEach(function(arg,i2){if(i2===0){var firstToken=arg[0];if(firstToken.type===20&&["top","left","right","bottom"].indexOf(firstToken.value)!==-1){angle$1=parseNamedSide(arg);return}else if(isAngle(firstToken)){angle$1=(angle.parse(context,firstToken)+deg(270))%deg(360);return}}var colorStop=parseColorStop(context,arg);stops.push(colorStop)}),{angle:angle$1,stops,type:1}},webkitGradient=function(context,tokens){var angle2=deg(180),stops=[],type=1,shape=0,size=3,position2=[];return parseFunctionArgs(tokens).forEach(function(arg,i2){var firstToken=arg[0];if(i2===0){if(isIdentToken(firstToken)&&firstToken.value==="linear"){type=1;return}else if(isIdentToken(firstToken)&&firstToken.value==="radial"){type=2;return}}if(firstToken.type===18){if(firstToken.name==="from"){var color2=color$1.parse(context,firstToken.values[0]);stops.push({stop:ZERO_LENGTH,color:color2})}else if(firstToken.name==="to"){var color2=color$1.parse(context,firstToken.values[0]);stops.push({stop:HUNDRED_PERCENT,color:color2})}else if(firstToken.name==="color-stop"){var values=firstToken.values.filter(nonFunctionArgSeparator);if(values.length===2){var color2=color$1.parse(context,values[1]),stop_1=values[0];isNumberToken(stop_1)&&stops.push({stop:{type:16,number:stop_1.number*100,flags:stop_1.flags},color:color2})}}}}),type===1?{angle:(angle2+deg(180))%deg(360),stops,type}:{size,shape,stops,position:position2,type}},CLOSEST_SIDE="closest-side",FARTHEST_SIDE="farthest-side",CLOSEST_CORNER="closest-corner",FARTHEST_CORNER="farthest-corner",CIRCLE="circle",ELLIPSE="ellipse",COVER="cover",CONTAIN="contain",radialGradient=function(context,tokens){var shape=0,size=3,stops=[],position2=[];return parseFunctionArgs(tokens).forEach(function(arg,i2){var isColorStop=!0;if(i2===0){var isAtPosition_1=!1;isColorStop=arg.reduce(function(acc,token){if(isAtPosition_1)if(isIdentToken(token))switch(token.value){case"center":return position2.push(FIFTY_PERCENT),acc;case"top":case"left":return position2.push(ZERO_LENGTH),acc;case"right":case"bottom":return position2.push(HUNDRED_PERCENT),acc}else(isLengthPercentage(token)||isLength(token))&&position2.push(token);else if(isIdentToken(token))switch(token.value){case CIRCLE:return shape=0,!1;case ELLIPSE:return shape=1,!1;case"at":return isAtPosition_1=!0,!1;case CLOSEST_SIDE:return size=0,!1;case COVER:case FARTHEST_SIDE:return size=1,!1;case CONTAIN:case CLOSEST_CORNER:return size=2,!1;case FARTHEST_CORNER:return size=3,!1}else if(isLength(token)||isLengthPercentage(token))return Array.isArray(size)||(size=[]),size.push(token),!1;return acc},isColorStop)}if(isColorStop){var colorStop=parseColorStop(context,arg);stops.push(colorStop)}}),{size,shape,stops,position:position2,type:2}},prefixRadialGradient=function(context,tokens){var shape=0,size=3,stops=[],position2=[];return parseFunctionArgs(tokens).forEach(function(arg,i2){var isColorStop=!0;if(i2===0?isColorStop=arg.reduce(function(acc,token){if(isIdentToken(token))switch(token.value){case"center":return position2.push(FIFTY_PERCENT),!1;case"top":case"left":return position2.push(ZERO_LENGTH),!1;case"right":case"bottom":return position2.push(HUNDRED_PERCENT),!1}else if(isLengthPercentage(token)||isLength(token))return position2.push(token),!1;return acc},isColorStop):i2===1&&(isColorStop=arg.reduce(function(acc,token){if(isIdentToken(token))switch(token.value){case CIRCLE:return shape=0,!1;case ELLIPSE:return shape=1,!1;case CONTAIN:case CLOSEST_SIDE:return size=0,!1;case FARTHEST_SIDE:return size=1,!1;case CLOSEST_CORNER:return size=2,!1;case COVER:case FARTHEST_CORNER:return size=3,!1}else if(isLength(token)||isLengthPercentage(token))return Array.isArray(size)||(size=[]),size.push(token),!1;return acc},isColorStop)),isColorStop){var colorStop=parseColorStop(context,arg);stops.push(colorStop)}}),{size,shape,stops,position:position2,type:2}},isLinearGradient=function(background){return background.type===1},isRadialGradient=function(background){return background.type===2},image={name:"image",parse:function(context,value){if(value.type===22){var image_1={url:value.value,type:0};return context.cache.addImage(value.value),image_1}if(value.type===18){var imageFunction=SUPPORTED_IMAGE_FUNCTIONS[value.name];if(typeof imageFunction>"u")throw new Error('Attempting to parse an unsupported image function "'+value.name+'"');return imageFunction(context,value.values)}throw new Error("Unsupported image type "+value.type)}};function isSupportedImage(value){return!(value.type===20&&value.value==="none")&&(value.type!==18||!!SUPPORTED_IMAGE_FUNCTIONS[value.name])}var SUPPORTED_IMAGE_FUNCTIONS={"linear-gradient":linearGradient,"-moz-linear-gradient":prefixLinearGradient,"-ms-linear-gradient":prefixLinearGradient,"-o-linear-gradient":prefixLinearGradient,"-webkit-linear-gradient":prefixLinearGradient,"radial-gradient":radialGradient,"-moz-radial-gradient":prefixRadialGradient,"-ms-radial-gradient":prefixRadialGradient,"-o-radial-gradient":prefixRadialGradient,"-webkit-radial-gradient":prefixRadialGradient,"-webkit-gradient":webkitGradient},backgroundImage={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(context,tokens){if(tokens.length===0)return[];var first=tokens[0];return first.type===20&&first.value==="none"?[]:tokens.filter(function(value){return nonFunctionArgSeparator(value)&&isSupportedImage(value)}).map(function(value){return image.parse(context,value)})}},backgroundOrigin={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(_context,tokens){return tokens.map(function(token){if(isIdentToken(token))switch(token.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},backgroundPosition={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(_context,tokens){return parseFunctionArgs(tokens).map(function(values){return values.filter(isLengthPercentage)}).map(parseLengthPercentageTuple)}},backgroundRepeat={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(_context,tokens){return parseFunctionArgs(tokens).map(function(values){return values.filter(isIdentToken).map(function(token){return token.value}).join(" ")}).map(parseBackgroundRepeat)}},parseBackgroundRepeat=function(value){switch(value){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},BACKGROUND_SIZE;(function(BACKGROUND_SIZE2){BACKGROUND_SIZE2.AUTO="auto",BACKGROUND_SIZE2.CONTAIN="contain",BACKGROUND_SIZE2.COVER="cover"})(BACKGROUND_SIZE||(BACKGROUND_SIZE={}));var backgroundSize={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(_context,tokens){return parseFunctionArgs(tokens).map(function(values){return values.filter(isBackgroundSizeInfoToken)})}},isBackgroundSizeInfoToken=function(value){return isIdentToken(value)||isLengthPercentage(value)},borderColorForSide=function(side){return{name:"border-"+side+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},borderTopColor=borderColorForSide("top"),borderRightColor=borderColorForSide("right"),borderBottomColor=borderColorForSide("bottom"),borderLeftColor=borderColorForSide("left"),borderRadiusForSide=function(side){return{name:"border-radius-"+side,initialValue:"0 0",prefix:!1,type:1,parse:function(_context,tokens){return parseLengthPercentageTuple(tokens.filter(isLengthPercentage))}}},borderTopLeftRadius=borderRadiusForSide("top-left"),borderTopRightRadius=borderRadiusForSide("top-right"),borderBottomRightRadius=borderRadiusForSide("bottom-right"),borderBottomLeftRadius=borderRadiusForSide("bottom-left"),borderStyleForSide=function(side){return{name:"border-"+side+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(_context,style){switch(style){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},borderTopStyle=borderStyleForSide("top"),borderRightStyle=borderStyleForSide("right"),borderBottomStyle=borderStyleForSide("bottom"),borderLeftStyle=borderStyleForSide("left"),borderWidthForSide=function(side){return{name:"border-"+side+"-width",initialValue:"0",type:0,prefix:!1,parse:function(_context,token){return isDimensionToken(token)?token.number:0}}},borderTopWidth=borderWidthForSide("top"),borderRightWidth=borderWidthForSide("right"),borderBottomWidth=borderWidthForSide("bottom"),borderLeftWidth=borderWidthForSide("left"),color={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},direction={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(_context,direction2){switch(direction2){case"rtl":return 1;case"ltr":default:return 0}}},display={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(_context,tokens){return tokens.filter(isIdentToken).reduce(function(bit,token){return bit|parseDisplayValue(token.value)},0)}},parseDisplayValue=function(display2){switch(display2){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},float={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(_context,float2){switch(float2){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},letterSpacing={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(_context,token){return token.type===20&&token.value==="normal"?0:token.type===17||token.type===15?token.number:0}},LINE_BREAK;(function(LINE_BREAK2){LINE_BREAK2.NORMAL="normal",LINE_BREAK2.STRICT="strict"})(LINE_BREAK||(LINE_BREAK={}));var lineBreak={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(_context,lineBreak2){switch(lineBreak2){case"strict":return LINE_BREAK.STRICT;case"normal":default:return LINE_BREAK.NORMAL}}},lineHeight={name:"line-height",initialValue:"normal",prefix:!1,type:4},computeLineHeight=function(token,fontSize2){return isIdentToken(token)&&token.value==="normal"?1.2*fontSize2:token.type===17?fontSize2*token.number:isLengthPercentage(token)?getAbsoluteValue(token,fontSize2):fontSize2},listStyleImage={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(context,token){return token.type===20&&token.value==="none"?null:image.parse(context,token)}},listStylePosition={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(_context,position2){switch(position2){case"inside":return 0;case"outside":default:return 1}}},listStyleType={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(_context,type){switch(type){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},marginForSide=function(side){return{name:"margin-"+side,initialValue:"0",prefix:!1,type:4}},marginTop=marginForSide("top"),marginRight=marginForSide("right"),marginBottom=marginForSide("bottom"),marginLeft=marginForSide("left"),overflow={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(_context,tokens){return tokens.filter(isIdentToken).map(function(overflow2){switch(overflow2.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},overflowWrap={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(_context,overflow2){switch(overflow2){case"break-word":return"break-word";case"normal":default:return"normal"}}},paddingForSide=function(side){return{name:"padding-"+side,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},paddingTop=paddingForSide("top"),paddingRight=paddingForSide("right"),paddingBottom=paddingForSide("bottom"),paddingLeft=paddingForSide("left"),textAlign={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(_context,textAlign2){switch(textAlign2){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},position={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(_context,position2){switch(position2){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},textShadow={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(context,tokens){return tokens.length===1&&isIdentWithValue(tokens[0],"none")?[]:parseFunctionArgs(tokens).map(function(values){for(var shadow={color:COLORS.TRANSPARENT,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH},c=0,i2=0;i2<values.length;i2++){var token=values[i2];isLength(token)?(c===0?shadow.offsetX=token:c===1?shadow.offsetY=token:shadow.blur=token,c++):shadow.color=color$1.parse(context,token)}return shadow})}},textTransform={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(_context,textTransform2){switch(textTransform2){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},transform$1={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(_context,token){if(token.type===20&&token.value==="none")return null;if(token.type===18){var transformFunction=SUPPORTED_TRANSFORM_FUNCTIONS[token.name];if(typeof transformFunction>"u")throw new Error('Attempting to parse an unsupported transform function "'+token.name+'"');return transformFunction(token.values)}return null}},matrix=function(args){var values=args.filter(function(arg){return arg.type===17}).map(function(arg){return arg.number});return values.length===6?values:null},matrix3d=function(args){var values=args.filter(function(arg){return arg.type===17}).map(function(arg){return arg.number}),a1=values[0],b1=values[1];values[2],values[3];var a2=values[4],b2=values[5];values[6],values[7],values[8],values[9],values[10],values[11];var a4=values[12],b4=values[13];return values[14],values[15],values.length===16?[a1,b1,a2,b2,a4,b4]:null},SUPPORTED_TRANSFORM_FUNCTIONS={matrix,matrix3d},DEFAULT_VALUE={type:16,number:50,flags:FLAG_INTEGER},DEFAULT=[DEFAULT_VALUE,DEFAULT_VALUE],transformOrigin={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(_context,tokens){var origins=tokens.filter(isLengthPercentage);return origins.length!==2?DEFAULT:[origins[0],origins[1]]}},visibility={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(_context,visibility2){switch(visibility2){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},WORD_BREAK;(function(WORD_BREAK2){WORD_BREAK2.NORMAL="normal",WORD_BREAK2.BREAK_ALL="break-all",WORD_BREAK2.KEEP_ALL="keep-all"})(WORD_BREAK||(WORD_BREAK={}));for(var wordBreak={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(_context,wordBreak2){switch(wordBreak2){case"break-all":return WORD_BREAK.BREAK_ALL;case"keep-all":return WORD_BREAK.KEEP_ALL;case"normal":default:return WORD_BREAK.NORMAL}}},zIndex={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(_context,token){if(token.type===20)return{auto:!0,order:0};if(isNumberToken(token))return{auto:!1,order:token.number};throw new Error("Invalid z-index number parsed")}},time={name:"time",parse:function(_context,value){if(value.type===15)switch(value.unit.toLowerCase()){case"s":return 1e3*value.number;case"ms":return value.number}throw new Error("Unsupported time type")}},opacity={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(_context,token){return isNumberToken(token)?token.number:1}},textDecorationColor={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},textDecorationLine={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(_context,tokens){return tokens.filter(isIdentToken).map(function(token){switch(token.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(line){return line!==0})}},fontFamily={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(_context,tokens){var accumulator=[],results=[];return tokens.forEach(function(token){switch(token.type){case 20:case 0:accumulator.push(token.value);break;case 17:accumulator.push(token.number.toString());break;case 4:results.push(accumulator.join(" ")),accumulator.length=0;break}}),accumulator.length&&results.push(accumulator.join(" ")),results.map(function(result){return result.indexOf(" ")===-1?result:"'"+result+"'"})}},fontSize={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},fontWeight={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(_context,token){if(isNumberToken(token))return token.number;if(isIdentToken(token))switch(token.value){case"bold":return 700;case"normal":default:return 400}return 400}},fontVariant={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(_context,tokens){return tokens.filter(isIdentToken).map(function(token){return token.value})}},fontStyle={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(_context,overflow2){switch(overflow2){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},contains2=function(bit,value){return(bit&value)!==0},content={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(_context,tokens){if(tokens.length===0)return[];var first=tokens[0];return first.type===20&&first.value==="none"?[]:tokens}},counterIncrement={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(_context,tokens){if(tokens.length===0)return null;var first=tokens[0];if(first.type===20&&first.value==="none")return null;for(var increments=[],filtered=tokens.filter(nonWhiteSpace),i2=0;i2<filtered.length;i2++){var counter=filtered[i2],next=filtered[i2+1];if(counter.type===20){var increment=next&&isNumberToken(next)?next.number:1;increments.push({counter:counter.value,increment})}}return increments}},counterReset={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(_context,tokens){if(tokens.length===0)return[];for(var resets=[],filtered=tokens.filter(nonWhiteSpace),i2=0;i2<filtered.length;i2++){var counter=filtered[i2],next=filtered[i2+1];if(isIdentToken(counter)&&counter.value!=="none"){var reset=next&&isNumberToken(next)?next.number:0;resets.push({counter:counter.value,reset})}}return resets}},duration={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(context,tokens){return tokens.filter(isDimensionToken).map(function(token){return time.parse(context,token)})}},quotes={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(_context,tokens){if(tokens.length===0)return null;var first=tokens[0];if(first.type===20&&first.value==="none")return null;var quotes2=[],filtered=tokens.filter(isStringToken);if(filtered.length%2!==0)return null;for(var i2=0;i2<filtered.length;i2+=2){var open_1=filtered[i2].value,close_1=filtered[i2+1].value;quotes2.push({open:open_1,close:close_1})}return quotes2}},getQuote=function(quotes2,depth,open2){if(!quotes2)return"";var quote=quotes2[Math.min(depth,quotes2.length-1)];return quote?open2?quote.open:quote.close:""},boxShadow={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(context,tokens){return tokens.length===1&&isIdentWithValue(tokens[0],"none")?[]:parseFunctionArgs(tokens).map(function(values){for(var shadow={color:255,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH,spread:ZERO_LENGTH,inset:!1},c=0,i2=0;i2<values.length;i2++){var token=values[i2];isIdentWithValue(token,"inset")?shadow.inset=!0:isLength(token)?(c===0?shadow.offsetX=token:c===1?shadow.offsetY=token:c===2?shadow.blur=token:shadow.spread=token,c++):shadow.color=color$1.parse(context,token)}return shadow})}},paintOrder={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(_context,tokens){var DEFAULT_VALUE2=[0,1,2],layers=[];return tokens.filter(isIdentToken).forEach(function(token){switch(token.value){case"stroke":layers.push(1);break;case"fill":layers.push(0);break;case"markers":layers.push(2);break}}),DEFAULT_VALUE2.forEach(function(value){layers.indexOf(value)===-1&&layers.push(value)}),layers}},webkitTextStrokeColor={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},webkitTextStrokeWidth={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(_context,token){return isDimensionToken(token)?token.number:0}},CSSParsedDeclaration=function(){function CSSParsedDeclaration2(context,declaration){var _a,_b;this.animationDuration=parse(context,duration,declaration.animationDuration),this.backgroundClip=parse(context,backgroundClip,declaration.backgroundClip),this.backgroundColor=parse(context,backgroundColor,declaration.backgroundColor),this.backgroundImage=parse(context,backgroundImage,declaration.backgroundImage),this.backgroundOrigin=parse(context,backgroundOrigin,declaration.backgroundOrigin),this.backgroundPosition=parse(context,backgroundPosition,declaration.backgroundPosition),this.backgroundRepeat=parse(context,backgroundRepeat,declaration.backgroundRepeat),this.backgroundSize=parse(context,backgroundSize,declaration.backgroundSize),this.borderTopColor=parse(context,borderTopColor,declaration.borderTopColor),this.borderRightColor=parse(context,borderRightColor,declaration.borderRightColor),this.borderBottomColor=parse(context,borderBottomColor,declaration.borderBottomColor),this.borderLeftColor=parse(context,borderLeftColor,declaration.borderLeftColor),this.borderTopLeftRadius=parse(context,borderTopLeftRadius,declaration.borderTopLeftRadius),this.borderTopRightRadius=parse(context,borderTopRightRadius,declaration.borderTopRightRadius),this.borderBottomRightRadius=parse(context,borderBottomRightRadius,declaration.borderBottomRightRadius),this.borderBottomLeftRadius=parse(context,borderBottomLeftRadius,declaration.borderBottomLeftRadius),this.borderTopStyle=parse(context,borderTopStyle,declaration.borderTopStyle),this.borderRightStyle=parse(context,borderRightStyle,declaration.borderRightStyle),this.borderBottomStyle=parse(context,borderBottomStyle,declaration.borderBottomStyle),this.borderLeftStyle=parse(context,borderLeftStyle,declaration.borderLeftStyle),this.borderTopWidth=parse(context,borderTopWidth,declaration.borderTopWidth),this.borderRightWidth=parse(context,borderRightWidth,declaration.borderRightWidth),this.borderBottomWidth=parse(context,borderBottomWidth,declaration.borderBottomWidth),this.borderLeftWidth=parse(context,borderLeftWidth,declaration.borderLeftWidth),this.boxShadow=parse(context,boxShadow,declaration.boxShadow),this.color=parse(context,color,declaration.color),this.direction=parse(context,direction,declaration.direction),this.display=parse(context,display,declaration.display),this.float=parse(context,float,declaration.cssFloat),this.fontFamily=parse(context,fontFamily,declaration.fontFamily),this.fontSize=parse(context,fontSize,declaration.fontSize),this.fontStyle=parse(context,fontStyle,declaration.fontStyle),this.fontVariant=parse(context,fontVariant,declaration.fontVariant),this.fontWeight=parse(context,fontWeight,declaration.fontWeight),this.letterSpacing=parse(context,letterSpacing,declaration.letterSpacing),this.lineBreak=parse(context,lineBreak,declaration.lineBreak),this.lineHeight=parse(context,lineHeight,declaration.lineHeight),this.listStyleImage=parse(context,listStyleImage,declaration.listStyleImage),this.listStylePosition=parse(context,listStylePosition,declaration.listStylePosition),this.listStyleType=parse(context,listStyleType,declaration.listStyleType),this.marginTop=parse(context,marginTop,declaration.marginTop),this.marginRight=parse(context,marginRight,declaration.marginRight),this.marginBottom=parse(context,marginBottom,declaration.marginBottom),this.marginLeft=parse(context,marginLeft,declaration.marginLeft),this.opacity=parse(context,opacity,declaration.opacity);var overflowTuple=parse(context,overflow,declaration.overflow);this.overflowX=overflowTuple[0],this.overflowY=overflowTuple[overflowTuple.length>1?1:0],this.overflowWrap=parse(context,overflowWrap,declaration.overflowWrap),this.paddingTop=parse(context,paddingTop,declaration.paddingTop),this.paddingRight=parse(context,paddingRight,declaration.paddingRight),this.paddingBottom=parse(context,paddingBottom,declaration.paddingBottom),this.paddingLeft=parse(context,paddingLeft,declaration.paddingLeft),this.paintOrder=parse(context,paintOrder,declaration.paintOrder),this.position=parse(context,position,declaration.position),this.textAlign=parse(context,textAlign,declaration.textAlign),this.textDecorationColor=parse(context,textDecorationColor,(_a=declaration.textDecorationColor)!==null&&_a!==void 0?_a:declaration.color),this.textDecorationLine=parse(context,textDecorationLine,(_b=declaration.textDecorationLine)!==null&&_b!==void 0?_b:declaration.textDecoration),this.textShadow=parse(context,textShadow,declaration.textShadow),this.textTransform=parse(context,textTransform,declaration.textTransform),this.transform=parse(context,transform$1,declaration.transform),this.transformOrigin=parse(context,transformOrigin,declaration.transformOrigin),this.visibility=parse(context,visibility,declaration.visibility),this.webkitTextStrokeColor=parse(context,webkitTextStrokeColor,declaration.webkitTextStrokeColor),this.webkitTextStrokeWidth=parse(context,webkitTextStrokeWidth,declaration.webkitTextStrokeWidth),this.wordBreak=parse(context,wordBreak,declaration.wordBreak),this.zIndex=parse(context,zIndex,declaration.zIndex)}return CSSParsedDeclaration2.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},CSSParsedDeclaration2.prototype.isTransparent=function(){return isTransparent(this.backgroundColor)},CSSParsedDeclaration2.prototype.isTransformed=function(){return this.transform!==null},CSSParsedDeclaration2.prototype.isPositioned=function(){return this.position!==0},CSSParsedDeclaration2.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},CSSParsedDeclaration2.prototype.isFloating=function(){return this.float!==0},CSSParsedDeclaration2.prototype.isInlineLevel=function(){return contains2(this.display,4)||contains2(this.display,33554432)||contains2(this.display,268435456)||contains2(this.display,536870912)||contains2(this.display,67108864)||contains2(this.display,134217728)},CSSParsedDeclaration2}(),CSSParsedPseudoDeclaration=function(){function CSSParsedPseudoDeclaration2(context,declaration){this.content=parse(context,content,declaration.content),this.quotes=parse(context,quotes,declaration.quotes)}return CSSParsedPseudoDeclaration2}(),CSSParsedCounterDeclaration=function(){function CSSParsedCounterDeclaration2(context,declaration){this.counterIncrement=parse(context,counterIncrement,declaration.counterIncrement),this.counterReset=parse(context,counterReset,declaration.counterReset)}return CSSParsedCounterDeclaration2}(),parse=function(context,descriptor,style){var tokenizer=new Tokenizer,value=style!==null&&typeof style<"u"?style.toString():descriptor.initialValue;tokenizer.write(value);var parser=new Parser(tokenizer.read());switch(descriptor.type){case 2:var token=parser.parseComponentValue();return descriptor.parse(context,isIdentToken(token)?token.value:descriptor.initialValue);case 0:return descriptor.parse(context,parser.parseComponentValue());case 1:return descriptor.parse(context,parser.parseComponentValues());case 4:return parser.parseComponentValue();case 3:switch(descriptor.format){case"angle":return angle.parse(context,parser.parseComponentValue());case"color":return color$1.parse(context,parser.parseComponentValue());case"image":return image.parse(context,parser.parseComponentValue());case"length":var length_1=parser.parseComponentValue();return isLength(length_1)?length_1:ZERO_LENGTH;case"length-percentage":var value_1=parser.parseComponentValue();return isLengthPercentage(value_1)?value_1:ZERO_LENGTH;case"time":return time.parse(context,parser.parseComponentValue())}break}},elementDebuggerAttribute="data-html2canvas-debug",getElementDebugType=function(element){var attribute=element.getAttribute(elementDebuggerAttribute);switch(attribute){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},isDebugging=function(element,type){var elementType=getElementDebugType(element);return elementType===1||type===elementType},ElementContainer=function(){function ElementContainer2(context,element){if(this.context=context,this.textNodes=[],this.elements=[],this.flags=0,isDebugging(element,3))debugger;this.styles=new CSSParsedDeclaration(context,window.getComputedStyle(element,null)),isHTMLElementNode(element)&&(this.styles.animationDuration.some(function(duration2){return duration2>0})&&(element.style.animationDuration="0s"),this.styles.transform!==null&&(element.style.transform="none")),this.bounds=parseBounds(this.context,element),isDebugging(element,4)&&(this.flags|=16)}return ElementContainer2}(),base64="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",chars$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256),i$1=0;i$1<chars$1.length;i$1++)lookup$1[chars$1.charCodeAt(i$1)]=i$1;for(var decode=function(base642){var bufferLength=base642.length*.75,len=base642.length,i2,p=0,encoded1,encoded2,encoded3,encoded4;base642[base642.length-1]==="="&&(bufferLength--,base642[base642.length-2]==="="&&bufferLength--);var buffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(bufferLength):new Array(bufferLength),bytes=Array.isArray(buffer)?buffer:new Uint8Array(buffer);for(i2=0;i2<len;i2+=4)encoded1=lookup$1[base642.charCodeAt(i2)],encoded2=lookup$1[base642.charCodeAt(i2+1)],encoded3=lookup$1[base642.charCodeAt(i2+2)],encoded4=lookup$1[base642.charCodeAt(i2+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(encoded2&15)<<4|encoded3>>2,bytes[p++]=(encoded3&3)<<6|encoded4&63;return buffer},polyUint16Array=function(buffer){for(var length=buffer.length,bytes=[],i2=0;i2<length;i2+=2)bytes.push(buffer[i2+1]<<8|buffer[i2]);return bytes},polyUint32Array=function(buffer){for(var length=buffer.length,bytes=[],i2=0;i2<length;i2+=4)bytes.push(buffer[i2+3]<<24|buffer[i2+2]<<16|buffer[i2+1]<<8|buffer[i2]);return bytes},UTRIE2_SHIFT_2=5,UTRIE2_SHIFT_1=11,UTRIE2_INDEX_SHIFT=2,UTRIE2_SHIFT_1_2=UTRIE2_SHIFT_1-UTRIE2_SHIFT_2,UTRIE2_LSCP_INDEX_2_OFFSET=65536>>UTRIE2_SHIFT_2,UTRIE2_DATA_BLOCK_LENGTH=1<<UTRIE2_SHIFT_2,UTRIE2_DATA_MASK=UTRIE2_DATA_BLOCK_LENGTH-1,UTRIE2_LSCP_INDEX_2_LENGTH=1024>>UTRIE2_SHIFT_2,UTRIE2_INDEX_2_BMP_LENGTH=UTRIE2_LSCP_INDEX_2_OFFSET+UTRIE2_LSCP_INDEX_2_LENGTH,UTRIE2_UTF8_2B_INDEX_2_OFFSET=UTRIE2_INDEX_2_BMP_LENGTH,UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,UTRIE2_INDEX_1_OFFSET=UTRIE2_UTF8_2B_INDEX_2_OFFSET+UTRIE2_UTF8_2B_INDEX_2_LENGTH,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>UTRIE2_SHIFT_1,UTRIE2_INDEX_2_BLOCK_LENGTH=1<<UTRIE2_SHIFT_1_2,UTRIE2_INDEX_2_MASK=UTRIE2_INDEX_2_BLOCK_LENGTH-1,slice16=function(view,start2,end2){return view.slice?view.slice(start2,end2):new Uint16Array(Array.prototype.slice.call(view,start2,end2))},slice32=function(view,start2,end2){return view.slice?view.slice(start2,end2):new Uint32Array(Array.prototype.slice.call(view,start2,end2))},createTrieFromBase64=function(base642,_byteLength){var buffer=decode(base642),view32=Array.isArray(buffer)?polyUint32Array(buffer):new Uint32Array(buffer),view16=Array.isArray(buffer)?polyUint16Array(buffer):new Uint16Array(buffer),headerLength=24,index=slice16(view16,headerLength/2,view32[4]/2),data=view32[5]===2?slice16(view16,(headerLength+view32[4])/2):slice32(view32,Math.ceil((headerLength+view32[4])/4));return new Trie(view32[0],view32[1],view32[2],view32[3],index,data)},Trie=function(){function Trie2(initialValue,errorValue,highStart,highValueIndex,index,data){this.initialValue=initialValue,this.errorValue=errorValue,this.highStart=highStart,this.highValueIndex=highValueIndex,this.index=index,this.data=data}return Trie2.prototype.get=function(codePoint){var ix;if(codePoint>=0){if(codePoint<55296||codePoint>56319&&codePoint<=65535)return ix=this.index[codePoint>>UTRIE2_SHIFT_2],ix=(ix<<UTRIE2_INDEX_SHIFT)+(codePoint&UTRIE2_DATA_MASK),this.data[ix];if(codePoint<=65535)return ix=this.index[UTRIE2_LSCP_INDEX_2_OFFSET+(codePoint-55296>>UTRIE2_SHIFT_2)],ix=(ix<<UTRIE2_INDEX_SHIFT)+(codePoint&UTRIE2_DATA_MASK),this.data[ix];if(codePoint<this.highStart)return ix=UTRIE2_INDEX_1_OFFSET-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH+(codePoint>>UTRIE2_SHIFT_1),ix=this.index[ix],ix+=codePoint>>UTRIE2_SHIFT_2&UTRIE2_INDEX_2_MASK,ix=this.index[ix],ix=(ix<<UTRIE2_INDEX_SHIFT)+(codePoint&UTRIE2_DATA_MASK),this.data[ix];if(codePoint<=1114111)return this.data[this.highValueIndex]}return this.errorValue},Trie2}(),chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=typeof Uint8Array>"u"?[]:new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var Prepend=1,CR=2,LF=3,Control=4,Extend=5,SpacingMark=7,L=8,V=9,T=10,LV=11,LVT=12,ZWJ=13,Extended_Pictographic=14,RI=15,toCodePoints=function(str){for(var codePoints=[],i2=0,length=str.length;i2<length;){var value=str.charCodeAt(i2++);if(value>=55296&&value<=56319&&i2<length){var extra=str.charCodeAt(i2++);(extra&64512)===56320?codePoints.push(((value&1023)<<10)+(extra&1023)+65536):(codePoints.push(value),i2--)}else codePoints.push(value)}return codePoints},fromCodePoint=function(){for(var codePoints=[],_i=0;_i<arguments.length;_i++)codePoints[_i]=arguments[_i];if(String.fromCodePoint)return String.fromCodePoint.apply(String,codePoints);var length=codePoints.length;if(!length)return"";for(var codeUnits=[],index=-1,result="";++index<length;){var codePoint=codePoints[index];codePoint<=65535?codeUnits.push(codePoint):(codePoint-=65536,codeUnits.push((codePoint>>10)+55296,codePoint%1024+56320)),(index+1===length||codeUnits.length>16384)&&(result+=String.fromCharCode.apply(String,codeUnits),codeUnits.length=0)}return result},UnicodeTrie=createTrieFromBase64(base64),BREAK_NOT_ALLOWED="\xD7",BREAK_ALLOWED="\xF7",codePointToClass=function(codePoint){return UnicodeTrie.get(codePoint)},_graphemeBreakAtIndex=function(_codePoints,classTypes,index){var prevIndex=index-2,prev=classTypes[prevIndex],current=classTypes[index-1],next=classTypes[index];if(current===CR&&next===LF)return BREAK_NOT_ALLOWED;if(current===CR||current===LF||current===Control||next===CR||next===LF||next===Control)return BREAK_ALLOWED;if(current===L&&[L,V,LV,LVT].indexOf(next)!==-1||(current===LV||current===V)&&(next===V||next===T)||(current===LVT||current===T)&&next===T||next===ZWJ||next===Extend||next===SpacingMark||current===Prepend)return BREAK_NOT_ALLOWED;if(current===ZWJ&&next===Extended_Pictographic){for(;prev===Extend;)prev=classTypes[--prevIndex];if(prev===Extended_Pictographic)return BREAK_NOT_ALLOWED}if(current===RI&&next===RI){for(var countRI=0;prev===RI;)countRI++,prev=classTypes[--prevIndex];if(countRI%2===0)return BREAK_NOT_ALLOWED}return BREAK_ALLOWED},GraphemeBreaker=function(str){var codePoints=toCodePoints(str),length=codePoints.length,index=0,lastEnd=0,classTypes=codePoints.map(codePointToClass);return{next:function(){if(index>=length)return{done:!0,value:null};for(var graphemeBreak=BREAK_NOT_ALLOWED;index<length&&(graphemeBreak=_graphemeBreakAtIndex(codePoints,classTypes,++index))===BREAK_NOT_ALLOWED;);if(graphemeBreak!==BREAK_NOT_ALLOWED||index===length){var value=fromCodePoint.apply(null,codePoints.slice(lastEnd,index));return lastEnd=index,{value,done:!1}}return{done:!0,value:null}}}},splitGraphemes=function(str){for(var breaker=GraphemeBreaker(str),graphemes=[],bk;!(bk=breaker.next()).done;)bk.value&&graphemes.push(bk.value.slice());return graphemes},testRangeBounds=function(document2){var TEST_HEIGHT=123;if(document2.createRange){var range=document2.createRange();if(range.getBoundingClientRect){var testElement=document2.createElement("boundtest");testElement.style.height=TEST_HEIGHT+"px",testElement.style.display="block",document2.body.appendChild(testElement),range.selectNode(testElement);var rangeBounds=range.getBoundingClientRect(),rangeHeight=Math.round(rangeBounds.height);if(document2.body.removeChild(testElement),rangeHeight===TEST_HEIGHT)return!0}}return!1},testIOSLineBreak=function(document2){var testElement=document2.createElement("boundtest");testElement.style.width="50px",testElement.style.display="block",testElement.style.fontSize="12px",testElement.style.letterSpacing="0px",testElement.style.wordSpacing="0px",document2.body.appendChild(testElement);var range=document2.createRange();testElement.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var node=testElement.firstChild,textList=toCodePoints$1(node.data).map(function(i2){return fromCodePoint$1(i2)}),offset2=0,prev={},supports=textList.every(function(text,i2){range.setStart(node,offset2),range.setEnd(node,offset2+text.length);var rect=range.getBoundingClientRect();offset2+=text.length;var boundAhead=rect.x>prev.x||rect.y>prev.y;return prev=rect,i2===0?!0:boundAhead});return document2.body.removeChild(testElement),supports},testCORS=function(){return typeof new Image().crossOrigin<"u"},testResponseType=function(){return typeof new XMLHttpRequest().responseType=="string"},testSVG=function(document2){var img=new Image,canvas=document2.createElement("canvas"),ctx=canvas.getContext("2d");if(!ctx)return!1;img.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{ctx.drawImage(img,0,0),canvas.toDataURL()}catch{return!1}return!0},isGreenPixel=function(data){return data[0]===0&&data[1]===255&&data[2]===0&&data[3]===255},testForeignObject=function(document2){var canvas=document2.createElement("canvas"),size=100;canvas.width=size,canvas.height=size;var ctx=canvas.getContext("2d");if(!ctx)return Promise.reject(!1);ctx.fillStyle="rgb(0, 255, 0)",ctx.fillRect(0,0,size,size);var img=new Image,greenImageSrc=canvas.toDataURL();img.src=greenImageSrc;var svg=createForeignObjectSVG(size,size,0,0,img);return ctx.fillStyle="red",ctx.fillRect(0,0,size,size),loadSerializedSVG$1(svg).then(function(img2){ctx.drawImage(img2,0,0);var data=ctx.getImageData(0,0,size,size).data;ctx.fillStyle="red",ctx.fillRect(0,0,size,size);var node=document2.createElement("div");return node.style.backgroundImage="url("+greenImageSrc+")",node.style.height=size+"px",isGreenPixel(data)?loadSerializedSVG$1(createForeignObjectSVG(size,size,0,0,node)):Promise.reject(!1)}).then(function(img2){return ctx.drawImage(img2,0,0),isGreenPixel(ctx.getImageData(0,0,size,size).data)}).catch(function(){return!1})},createForeignObjectSVG=function(width,height,x,y,node){var xmlns="http://www.w3.org/2000/svg",svg=document.createElementNS(xmlns,"svg"),foreignObject=document.createElementNS(xmlns,"foreignObject");return svg.setAttributeNS(null,"width",width.toString()),svg.setAttributeNS(null,"height",height.toString()),foreignObject.setAttributeNS(null,"width","100%"),foreignObject.setAttributeNS(null,"height","100%"),foreignObject.setAttributeNS(null,"x",x.toString()),foreignObject.setAttributeNS(null,"y",y.toString()),foreignObject.setAttributeNS(null,"externalResourcesRequired","true"),svg.appendChild(foreignObject),foreignObject.appendChild(node),svg},loadSerializedSVG$1=function(svg){return new Promise(function(resolve,reject){var img=new Image;img.onload=function(){return resolve(img)},img.onerror=reject,img.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(svg))})},FEATURES={get SUPPORT_RANGE_BOUNDS(){var value=testRangeBounds(document);return Object.defineProperty(FEATURES,"SUPPORT_RANGE_BOUNDS",{value}),value},get SUPPORT_WORD_BREAKING(){var value=FEATURES.SUPPORT_RANGE_BOUNDS&&testIOSLineBreak(document);return Object.defineProperty(FEATURES,"SUPPORT_WORD_BREAKING",{value}),value},get SUPPORT_SVG_DRAWING(){var value=testSVG(document);return Object.defineProperty(FEATURES,"SUPPORT_SVG_DRAWING",{value}),value},get SUPPORT_FOREIGNOBJECT_DRAWING(){var value=typeof Array.from=="function"&&typeof window.fetch=="function"?testForeignObject(document):Promise.resolve(!1);return Object.defineProperty(FEATURES,"SUPPORT_FOREIGNOBJECT_DRAWING",{value}),value},get SUPPORT_CORS_IMAGES(){var value=testCORS();return Object.defineProperty(FEATURES,"SUPPORT_CORS_IMAGES",{value}),value},get SUPPORT_RESPONSE_TYPE(){var value=testResponseType();return Object.defineProperty(FEATURES,"SUPPORT_RESPONSE_TYPE",{value}),value},get SUPPORT_CORS_XHR(){var value="withCredentials"in new XMLHttpRequest;return Object.defineProperty(FEATURES,"SUPPORT_CORS_XHR",{value}),value},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var value=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(FEATURES,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value}),value}},TextBounds=function(){function TextBounds2(text,bounds){this.text=text,this.bounds=bounds}return TextBounds2}(),parseTextBounds=function(context,value,styles,node){var textList=breakText(value,styles),textBounds=[],offset2=0;return textList.forEach(function(text){if(styles.textDecorationLine.length||text.trim().length>0)if(FEATURES.SUPPORT_RANGE_BOUNDS){var clientRects=createRange(node,offset2,text.length).getClientRects();if(clientRects.length>1){var subSegments=segmentGraphemes(text),subOffset_1=0;subSegments.forEach(function(subSegment){textBounds.push(new TextBounds(subSegment,Bounds.fromDOMRectList(context,createRange(node,subOffset_1+offset2,subSegment.length).getClientRects()))),subOffset_1+=subSegment.length})}else textBounds.push(new TextBounds(text,Bounds.fromDOMRectList(context,clientRects)))}else{var replacementNode=node.splitText(text.length);textBounds.push(new TextBounds(text,getWrapperBounds(context,node))),node=replacementNode}else FEATURES.SUPPORT_RANGE_BOUNDS||(node=node.splitText(text.length));offset2+=text.length}),textBounds},getWrapperBounds=function(context,node){var ownerDocument=node.ownerDocument;if(ownerDocument){var wrapper=ownerDocument.createElement("html2canvaswrapper");wrapper.appendChild(node.cloneNode(!0));var parentNode=node.parentNode;if(parentNode){parentNode.replaceChild(wrapper,node);var bounds=parseBounds(context,wrapper);return wrapper.firstChild&&parentNode.replaceChild(wrapper.firstChild,wrapper),bounds}}return Bounds.EMPTY},createRange=function(node,offset2,length){var ownerDocument=node.ownerDocument;if(!ownerDocument)throw new Error("Node has no owner document");var range=ownerDocument.createRange();return range.setStart(node,offset2),range.setEnd(node,offset2+length),range},segmentGraphemes=function(value){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var segmenter=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(segmenter.segment(value)).map(function(segment){return segment.segment})}return splitGraphemes(value)},segmentWords=function(value,styles){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var segmenter=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(segmenter.segment(value)).map(function(segment){return segment.segment})}return breakWords(value,styles)},breakText=function(value,styles){return styles.letterSpacing!==0?segmentGraphemes(value):segmentWords(value,styles)},wordSeparators=[32,160,4961,65792,65793,4153,4241],breakWords=function(str,styles){for(var breaker=LineBreaker(str,{lineBreak:styles.lineBreak,wordBreak:styles.overflowWrap==="break-word"?"break-word":styles.wordBreak}),words=[],bk,_loop_1=function(){if(bk.value){var value=bk.value.slice(),codePoints=toCodePoints$1(value),word_1="";codePoints.forEach(function(codePoint){wordSeparators.indexOf(codePoint)===-1?word_1+=fromCodePoint$1(codePoint):(word_1.length&&words.push(word_1),words.push(fromCodePoint$1(codePoint)),word_1="")}),word_1.length&&words.push(word_1)}};!(bk=breaker.next()).done;)_loop_1();return words},TextContainer=function(){function TextContainer2(context,node,styles){this.text=transform(node.data,styles.textTransform),this.textBounds=parseTextBounds(context,this.text,styles,node)}return TextContainer2}(),transform=function(text,transform2){switch(transform2){case 1:return text.toLowerCase();case 3:return text.replace(CAPITALIZE,capitalize);case 2:return text.toUpperCase();default:return text}},CAPITALIZE=/(^|\s|:|-|\(|\))([a-z])/g,capitalize=function(m,p1,p2){return m.length>0?p1+p2.toUpperCase():m},ImageElementContainer=function(_super){__extends(ImageElementContainer2,_super);function ImageElementContainer2(context,img){var _this=_super.call(this,context,img)||this;return _this.src=img.currentSrc||img.src,_this.intrinsicWidth=img.naturalWidth,_this.intrinsicHeight=img.naturalHeight,_this.context.cache.addImage(_this.src),_this}return ImageElementContainer2}(ElementContainer),CanvasElementContainer=function(_super){__extends(CanvasElementContainer2,_super);function CanvasElementContainer2(context,canvas){var _this=_super.call(this,context,canvas)||this;return _this.canvas=canvas,_this.intrinsicWidth=canvas.width,_this.intrinsicHeight=canvas.height,_this}return CanvasElementContainer2}(ElementContainer),SVGElementContainer=function(_super){__extends(SVGElementContainer2,_super);function SVGElementContainer2(context,img){var _this=_super.call(this,context,img)||this,s=new XMLSerializer,bounds=parseBounds(context,img);return img.setAttribute("width",bounds.width+"px"),img.setAttribute("height",bounds.height+"px"),_this.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(img)),_this.intrinsicWidth=img.width.baseVal.value,_this.intrinsicHeight=img.height.baseVal.value,_this.context.cache.addImage(_this.svg),_this}return SVGElementContainer2}(ElementContainer),LIElementContainer=function(_super){__extends(LIElementContainer2,_super);function LIElementContainer2(context,element){var _this=_super.call(this,context,element)||this;return _this.value=element.value,_this}return LIElementContainer2}(ElementContainer),OLElementContainer=function(_super){__extends(OLElementContainer2,_super);function OLElementContainer2(context,element){var _this=_super.call(this,context,element)||this;return _this.start=element.start,_this.reversed=typeof element.reversed=="boolean"&&element.reversed===!0,_this}return OLElementContainer2}(ElementContainer),CHECKBOX_BORDER_RADIUS=[{type:15,flags:0,unit:"px",number:3}],RADIO_BORDER_RADIUS=[{type:16,flags:0,number:50}],reformatInputBounds=function(bounds){return bounds.width>bounds.height?new Bounds(bounds.left+(bounds.width-bounds.height)/2,bounds.top,bounds.height,bounds.height):bounds.width<bounds.height?new Bounds(bounds.left,bounds.top+(bounds.height-bounds.width)/2,bounds.width,bounds.width):bounds},getInputValue=function(node){var value=node.type===PASSWORD?new Array(node.value.length+1).join("\u2022"):node.value;return value.length===0?node.placeholder||"":value},CHECKBOX="checkbox",RADIO="radio",PASSWORD="password",INPUT_COLOR=707406591,InputElementContainer=function(_super){__extends(InputElementContainer2,_super);function InputElementContainer2(context,input){var _this=_super.call(this,context,input)||this;switch(_this.type=input.type.toLowerCase(),_this.checked=input.checked,_this.value=getInputValue(input),(_this.type===CHECKBOX||_this.type===RADIO)&&(_this.styles.backgroundColor=3739148031,_this.styles.borderTopColor=_this.styles.borderRightColor=_this.styles.borderBottomColor=_this.styles.borderLeftColor=2779096575,_this.styles.borderTopWidth=_this.styles.borderRightWidth=_this.styles.borderBottomWidth=_this.styles.borderLeftWidth=1,_this.styles.borderTopStyle=_this.styles.borderRightStyle=_this.styles.borderBottomStyle=_this.styles.borderLeftStyle=1,_this.styles.backgroundClip=[0],_this.styles.backgroundOrigin=[0],_this.bounds=reformatInputBounds(_this.bounds)),_this.type){case CHECKBOX:_this.styles.borderTopRightRadius=_this.styles.borderTopLeftRadius=_this.styles.borderBottomRightRadius=_this.styles.borderBottomLeftRadius=CHECKBOX_BORDER_RADIUS;break;case RADIO:_this.styles.borderTopRightRadius=_this.styles.borderTopLeftRadius=_this.styles.borderBottomRightRadius=_this.styles.borderBottomLeftRadius=RADIO_BORDER_RADIUS;break}return _this}return InputElementContainer2}(ElementContainer),SelectElementContainer=function(_super){__extends(SelectElementContainer2,_super);function SelectElementContainer2(context,element){var _this=_super.call(this,context,element)||this,option=element.options[element.selectedIndex||0];return _this.value=option&&option.text||"",_this}return SelectElementContainer2}(ElementContainer),TextareaElementContainer=function(_super){__extends(TextareaElementContainer2,_super);function TextareaElementContainer2(context,element){var _this=_super.call(this,context,element)||this;return _this.value=element.value,_this}return TextareaElementContainer2}(ElementContainer),IFrameElementContainer=function(_super){__extends(IFrameElementContainer2,_super);function IFrameElementContainer2(context,iframe){var _this=_super.call(this,context,iframe)||this;_this.src=iframe.src,_this.width=parseInt(iframe.width,10)||0,_this.height=parseInt(iframe.height,10)||0,_this.backgroundColor=_this.styles.backgroundColor;try{if(iframe.contentWindow&&iframe.contentWindow.document&&iframe.contentWindow.document.documentElement){_this.tree=parseTree(context,iframe.contentWindow.document.documentElement);var documentBackgroundColor=iframe.contentWindow.document.documentElement?parseColor(context,getComputedStyle(iframe.contentWindow.document.documentElement).backgroundColor):COLORS.TRANSPARENT,bodyBackgroundColor=iframe.contentWindow.document.body?parseColor(context,getComputedStyle(iframe.contentWindow.document.body).backgroundColor):COLORS.TRANSPARENT;_this.backgroundColor=isTransparent(documentBackgroundColor)?isTransparent(bodyBackgroundColor)?_this.styles.backgroundColor:bodyBackgroundColor:documentBackgroundColor}}catch{}return _this}return IFrameElementContainer2}(ElementContainer),LIST_OWNERS=["OL","UL","MENU"],parseNodeTree=function(context,node,parent,root){for(var childNode=node.firstChild,nextNode=void 0;childNode;childNode=nextNode)if(nextNode=childNode.nextSibling,isTextNode(childNode)&&childNode.data.trim().length>0)parent.textNodes.push(new TextContainer(context,childNode,parent.styles));else if(isElementNode(childNode))if(isSlotElement(childNode)&&childNode.assignedNodes)childNode.assignedNodes().forEach(function(childNode2){return parseNodeTree(context,childNode2,parent,root)});else{var container=createContainer(context,childNode);container.styles.isVisible()&&(createsRealStackingContext(childNode,container,root)?container.flags|=4:createsStackingContext(container.styles)&&(container.flags|=2),LIST_OWNERS.indexOf(childNode.tagName)!==-1&&(container.flags|=8),parent.elements.push(container),childNode.slot,childNode.shadowRoot?parseNodeTree(context,childNode.shadowRoot,container,root):!isTextareaElement(childNode)&&!isSVGElement(childNode)&&!isSelectElement(childNode)&&parseNodeTree(context,childNode,container,root))}},createContainer=function(context,element){return isImageElement(element)?new ImageElementContainer(context,element):isCanvasElement(element)?new CanvasElementContainer(context,element):isSVGElement(element)?new SVGElementContainer(context,element):isLIElement(element)?new LIElementContainer(context,element):isOLElement(element)?new OLElementContainer(context,element):isInputElement(element)?new InputElementContainer(context,element):isSelectElement(element)?new SelectElementContainer(context,element):isTextareaElement(element)?new TextareaElementContainer(context,element):isIFrameElement(element)?new IFrameElementContainer(context,element):new ElementContainer(context,element)},parseTree=function(context,element){var container=createContainer(context,element);return container.flags|=4,parseNodeTree(context,element,container,container),container},createsRealStackingContext=function(node,container,root){return container.styles.isPositionedWithZIndex()||container.styles.opacity<1||container.styles.isTransformed()||isBodyElement(node)&&root.styles.isTransparent()},createsStackingContext=function(styles){return styles.isPositioned()||styles.isFloating()},isTextNode=function(node){return node.nodeType===Node.TEXT_NODE},isElementNode=function(node){return node.nodeType===Node.ELEMENT_NODE},isHTMLElementNode=function(node){return isElementNode(node)&&typeof node.style<"u"&&!isSVGElementNode(node)},isSVGElementNode=function(element){return typeof element.className=="object"},isLIElement=function(node){return node.tagName==="LI"},isOLElement=function(node){return node.tagName==="OL"},isInputElement=function(node){return node.tagName==="INPUT"},isHTMLElement2=function(node){return node.tagName==="HTML"},isSVGElement=function(node){return node.tagName==="svg"},isBodyElement=function(node){return node.tagName==="BODY"},isCanvasElement=function(node){return node.tagName==="CANVAS"},isVideoElement=function(node){return node.tagName==="VIDEO"},isImageElement=function(node){return node.tagName==="IMG"},isIFrameElement=function(node){return node.tagName==="IFRAME"},isStyleElement=function(node){return node.tagName==="STYLE"},isScriptElement=function(node){return node.tagName==="SCRIPT"},isTextareaElement=function(node){return node.tagName==="TEXTAREA"},isSelectElement=function(node){return node.tagName==="SELECT"},isSlotElement=function(node){return node.tagName==="SLOT"},isCustomElement=function(node){return node.tagName.indexOf("-")>0},CounterState=function(){function CounterState2(){this.counters={}}return CounterState2.prototype.getCounterValue=function(name){var counter=this.counters[name];return counter&&counter.length?counter[counter.length-1]:1},CounterState2.prototype.getCounterValues=function(name){var counter=this.counters[name];return counter||[]},CounterState2.prototype.pop=function(counters){var _this=this;counters.forEach(function(counter){return _this.counters[counter].pop()})},CounterState2.prototype.parse=function(style){var _this=this,counterIncrement2=style.counterIncrement,counterReset2=style.counterReset,canReset=!0;counterIncrement2!==null&&counterIncrement2.forEach(function(entry){var counter=_this.counters[entry.counter];counter&&entry.increment!==0&&(canReset=!1,counter.length||counter.push(1),counter[Math.max(0,counter.length-1)]+=entry.increment)});var counterNames=[];return canReset&&counterReset2.forEach(function(entry){var counter=_this.counters[entry.counter];counterNames.push(entry.counter),counter||(counter=_this.counters[entry.counter]=[]),counter.push(entry.reset)}),counterNames},CounterState2}(),ROMAN_UPPER={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ARMENIAN={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},HEBREW={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},GEORGIAN={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},createAdditiveCounter=function(value,min2,max2,symbols,fallback,suffix){return value<min2||value>max2?createCounterText(value,fallback,suffix.length>0):symbols.integers.reduce(function(string,integer,index){for(;value>=integer;)value-=integer,string+=symbols.values[index];return string},"")+suffix},createCounterStyleWithSymbolResolver=function(value,codePointRangeLength,isNumeric,resolver){var string="";do isNumeric||value--,string=resolver(value)+string,value/=codePointRangeLength;while(value*codePointRangeLength>=codePointRangeLength);return string},createCounterStyleFromRange=function(value,codePointRangeStart,codePointRangeEnd,isNumeric,suffix){var codePointRangeLength=codePointRangeEnd-codePointRangeStart+1;return(value<0?"-":"")+(createCounterStyleWithSymbolResolver(Math.abs(value),codePointRangeLength,isNumeric,function(codePoint){return fromCodePoint$1(Math.floor(codePoint%codePointRangeLength)+codePointRangeStart)})+suffix)},createCounterStyleFromSymbols=function(value,symbols,suffix){suffix===void 0&&(suffix=". ");var codePointRangeLength=symbols.length;return createCounterStyleWithSymbolResolver(Math.abs(value),codePointRangeLength,!1,function(codePoint){return symbols[Math.floor(codePoint%codePointRangeLength)]})+suffix},CJK_ZEROS=1,CJK_TEN_COEFFICIENTS=2,CJK_TEN_HIGH_COEFFICIENTS=4,CJK_HUNDRED_COEFFICIENTS=8,createCJKCounter=function(value,numbers,multipliers,negativeSign,suffix,flags){if(value<-9999||value>9999)return createCounterText(value,4,suffix.length>0);var tmp=Math.abs(value),string=suffix;if(tmp===0)return numbers[0]+string;for(var digit=0;tmp>0&&digit<=4;digit++){var coefficient=tmp%10;coefficient===0&&contains2(flags,CJK_ZEROS)&&string!==""?string=numbers[coefficient]+string:coefficient>1||coefficient===1&&digit===0||coefficient===1&&digit===1&&contains2(flags,CJK_TEN_COEFFICIENTS)||coefficient===1&&digit===1&&contains2(flags,CJK_TEN_HIGH_COEFFICIENTS)&&value>100||coefficient===1&&digit>1&&contains2(flags,CJK_HUNDRED_COEFFICIENTS)?string=numbers[coefficient]+(digit>0?multipliers[digit-1]:"")+string:coefficient===1&&digit>0&&(string=multipliers[digit-1]+string),tmp=Math.floor(tmp/10)}return(value<0?negativeSign:"")+string},CHINESE_INFORMAL_MULTIPLIERS="\u5341\u767E\u5343\u842C",CHINESE_FORMAL_MULTIPLIERS="\u62FE\u4F70\u4EDF\u842C",JAPANESE_NEGATIVE="\u30DE\u30A4\u30CA\u30B9",KOREAN_NEGATIVE="\uB9C8\uC774\uB108\uC2A4",createCounterText=function(value,type,appendSuffix){var defaultSuffix=appendSuffix?". ":"",cjkSuffix=appendSuffix?"\u3001":"",koreanSuffix=appendSuffix?", ":"",spaceSuffix=appendSuffix?" ":"";switch(type){case 0:return"\u2022"+spaceSuffix;case 1:return"\u25E6"+spaceSuffix;case 2:return"\u25FE"+spaceSuffix;case 5:var string=createCounterStyleFromRange(value,48,57,!0,defaultSuffix);return string.length<4?"0"+string:string;case 4:return createCounterStyleFromSymbols(value,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",cjkSuffix);case 6:return createAdditiveCounter(value,1,3999,ROMAN_UPPER,3,defaultSuffix).toLowerCase();case 7:return createAdditiveCounter(value,1,3999,ROMAN_UPPER,3,defaultSuffix);case 8:return createCounterStyleFromRange(value,945,969,!1,defaultSuffix);case 9:return createCounterStyleFromRange(value,97,122,!1,defaultSuffix);case 10:return createCounterStyleFromRange(value,65,90,!1,defaultSuffix);case 11:return createCounterStyleFromRange(value,1632,1641,!0,defaultSuffix);case 12:case 49:return createAdditiveCounter(value,1,9999,ARMENIAN,3,defaultSuffix);case 35:return createAdditiveCounter(value,1,9999,ARMENIAN,3,defaultSuffix).toLowerCase();case 13:return createCounterStyleFromRange(value,2534,2543,!0,defaultSuffix);case 14:case 30:return createCounterStyleFromRange(value,6112,6121,!0,defaultSuffix);case 15:return createCounterStyleFromSymbols(value,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",cjkSuffix);case 16:return createCounterStyleFromSymbols(value,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",cjkSuffix);case 17:case 48:return createCJKCounter(value,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",CHINESE_INFORMAL_MULTIPLIERS,"\u8CA0",cjkSuffix,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 47:return createCJKCounter(value,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",CHINESE_FORMAL_MULTIPLIERS,"\u8CA0",cjkSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 42:return createCJKCounter(value,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",CHINESE_INFORMAL_MULTIPLIERS,"\u8D1F",cjkSuffix,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 41:return createCJKCounter(value,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",CHINESE_FORMAL_MULTIPLIERS,"\u8D1F",cjkSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 26:return createCJKCounter(value,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",JAPANESE_NEGATIVE,cjkSuffix,0);case 25:return createCJKCounter(value,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",JAPANESE_NEGATIVE,cjkSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 31:return createCJKCounter(value,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",KOREAN_NEGATIVE,koreanSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 33:return createCJKCounter(value,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",KOREAN_NEGATIVE,koreanSuffix,0);case 32:return createCJKCounter(value,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",KOREAN_NEGATIVE,koreanSuffix,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 18:return createCounterStyleFromRange(value,2406,2415,!0,defaultSuffix);case 20:return createAdditiveCounter(value,1,19999,GEORGIAN,3,defaultSuffix);case 21:return createCounterStyleFromRange(value,2790,2799,!0,defaultSuffix);case 22:return createCounterStyleFromRange(value,2662,2671,!0,defaultSuffix);case 22:return createAdditiveCounter(value,1,10999,HEBREW,3,defaultSuffix);case 23:return createCounterStyleFromSymbols(value,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return createCounterStyleFromSymbols(value,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return createCounterStyleFromRange(value,3302,3311,!0,defaultSuffix);case 28:return createCounterStyleFromSymbols(value,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",cjkSuffix);case 29:return createCounterStyleFromSymbols(value,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",cjkSuffix);case 34:return createCounterStyleFromRange(value,3792,3801,!0,defaultSuffix);case 37:return createCounterStyleFromRange(value,6160,6169,!0,defaultSuffix);case 38:return createCounterStyleFromRange(value,4160,4169,!0,defaultSuffix);case 39:return createCounterStyleFromRange(value,2918,2927,!0,defaultSuffix);case 40:return createCounterStyleFromRange(value,1776,1785,!0,defaultSuffix);case 43:return createCounterStyleFromRange(value,3046,3055,!0,defaultSuffix);case 44:return createCounterStyleFromRange(value,3174,3183,!0,defaultSuffix);case 45:return createCounterStyleFromRange(value,3664,3673,!0,defaultSuffix);case 46:return createCounterStyleFromRange(value,3872,3881,!0,defaultSuffix);case 3:default:return createCounterStyleFromRange(value,48,57,!0,defaultSuffix)}},IGNORE_ATTRIBUTE="data-html2canvas-ignore",DocumentCloner=function(){function DocumentCloner2(context,element,options){if(this.context=context,this.options=options,this.scrolledElements=[],this.referenceElement=element,this.counters=new CounterState,this.quoteDepth=0,!element.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(element.ownerDocument.documentElement,!1)}return DocumentCloner2.prototype.toIFrame=function(ownerDocument,windowSize){var _this=this,iframe=createIFrameContainer(ownerDocument,windowSize);if(!iframe.contentWindow)return Promise.reject("Unable to find iframe window");var scrollX=ownerDocument.defaultView.pageXOffset,scrollY=ownerDocument.defaultView.pageYOffset,cloneWindow=iframe.contentWindow,documentClone=cloneWindow.document,iframeLoad=iframeLoader(iframe).then(function(){return __awaiter(_this,void 0,void 0,function(){var onclone,referenceElement;return __generator(this,function(_a){switch(_a.label){case 0:return this.scrolledElements.forEach(restoreNodeScroll),cloneWindow&&(cloneWindow.scrollTo(windowSize.left,windowSize.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(cloneWindow.scrollY!==windowSize.top||cloneWindow.scrollX!==windowSize.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(cloneWindow.scrollX-windowSize.left,cloneWindow.scrollY-windowSize.top,0,0))),onclone=this.options.onclone,referenceElement=this.clonedReferenceElement,typeof referenceElement>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:documentClone.fonts&&documentClone.fonts.ready?[4,documentClone.fonts.ready]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,imagesReady(documentClone)]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return typeof onclone=="function"?[2,Promise.resolve().then(function(){return onclone(documentClone,referenceElement)}).then(function(){return iframe})]:[2,iframe]}})})});return documentClone.open(),documentClone.write(serializeDoctype(document.doctype)+"<html></html>"),restoreOwnerScroll(this.referenceElement.ownerDocument,scrollX,scrollY),documentClone.replaceChild(documentClone.adoptNode(this.documentElement),documentClone.documentElement),documentClone.close(),iframeLoad},DocumentCloner2.prototype.createElementClone=function(node){if(isDebugging(node,2))debugger;if(isCanvasElement(node))return this.createCanvasClone(node);if(isVideoElement(node))return this.createVideoClone(node);if(isStyleElement(node))return this.createStyleClone(node);var clone=node.cloneNode(!1);return isImageElement(clone)&&(isImageElement(node)&&node.currentSrc&&node.currentSrc!==node.src&&(clone.src=node.currentSrc,clone.srcset=""),clone.loading==="lazy"&&(clone.loading="eager")),isCustomElement(clone)?this.createCustomElementClone(clone):clone},DocumentCloner2.prototype.createCustomElementClone=function(node){var clone=document.createElement("html2canvascustomelement");return copyCSSStyles(node.style,clone),clone},DocumentCloner2.prototype.createStyleClone=function(node){try{var sheet=node.sheet;if(sheet&&sheet.cssRules){var css=[].slice.call(sheet.cssRules,0).reduce(function(css2,rule){return rule&&typeof rule.cssText=="string"?css2+rule.cssText:css2},""),style=node.cloneNode(!1);return style.textContent=css,style}}catch(e2){if(this.context.logger.error("Unable to access cssRules property",e2),e2.name!=="SecurityError")throw e2}return node.cloneNode(!1)},DocumentCloner2.prototype.createCanvasClone=function(canvas){var _a;if(this.options.inlineImages&&canvas.ownerDocument){var img=canvas.ownerDocument.createElement("img");try{return img.src=canvas.toDataURL(),img}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",canvas)}}var clonedCanvas=canvas.cloneNode(!1);try{clonedCanvas.width=canvas.width,clonedCanvas.height=canvas.height;var ctx=canvas.getContext("2d"),clonedCtx=clonedCanvas.getContext("2d");if(clonedCtx)if(!this.options.allowTaint&&ctx)clonedCtx.putImageData(ctx.getImageData(0,0,canvas.width,canvas.height),0,0);else{var gl=(_a=canvas.getContext("webgl2"))!==null&&_a!==void 0?_a:canvas.getContext("webgl");if(gl){var attribs=gl.getContextAttributes();attribs?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",canvas)}clonedCtx.drawImage(canvas,0,0)}return clonedCanvas}catch{this.context.logger.info("Unable to clone canvas as it is tainted",canvas)}return clonedCanvas},DocumentCloner2.prototype.createVideoClone=function(video){var canvas=video.ownerDocument.createElement("canvas");canvas.width=video.offsetWidth,canvas.height=video.offsetHeight;var ctx=canvas.getContext("2d");try{return ctx&&(ctx.drawImage(video,0,0,canvas.width,canvas.height),this.options.allowTaint||ctx.getImageData(0,0,canvas.width,canvas.height)),canvas}catch{this.context.logger.info("Unable to clone video as it is tainted",video)}var blankCanvas=video.ownerDocument.createElement("canvas");return blankCanvas.width=video.offsetWidth,blankCanvas.height=video.offsetHeight,blankCanvas},DocumentCloner2.prototype.appendChildNode=function(clone,child,copyStyles){(!isElementNode(child)||!isScriptElement(child)&&!child.hasAttribute(IGNORE_ATTRIBUTE)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(child)))&&(!this.options.copyStyles||!isElementNode(child)||!isStyleElement(child))&&clone.appendChild(this.cloneNode(child,copyStyles))},DocumentCloner2.prototype.cloneChildNodes=function(node,clone,copyStyles){for(var _this=this,child=node.shadowRoot?node.shadowRoot.firstChild:node.firstChild;child;child=child.nextSibling)if(isElementNode(child)&&isSlotElement(child)&&typeof child.assignedNodes=="function"){var assignedNodes=child.assignedNodes();assignedNodes.length&&assignedNodes.forEach(function(assignedNode){return _this.appendChildNode(clone,assignedNode,copyStyles)})}else this.appendChildNode(clone,child,copyStyles)},DocumentCloner2.prototype.cloneNode=function(node,copyStyles){if(isTextNode(node))return document.createTextNode(node.data);if(!node.ownerDocument)return node.cloneNode(!1);var window2=node.ownerDocument.defaultView;if(window2&&isElementNode(node)&&(isHTMLElementNode(node)||isSVGElementNode(node))){var clone=this.createElementClone(node);clone.style.transitionProperty="none";var style=window2.getComputedStyle(node),styleBefore=window2.getComputedStyle(node,":before"),styleAfter=window2.getComputedStyle(node,":after");this.referenceElement===node&&isHTMLElementNode(clone)&&(this.clonedReferenceElement=clone),isBodyElement(clone)&&createPseudoHideStyles(clone);var counters=this.counters.parse(new CSSParsedCounterDeclaration(this.context,style)),before=this.resolvePseudoContent(node,clone,styleBefore,PseudoElementType.BEFORE);isCustomElement(node)&&(copyStyles=!0),isVideoElement(node)||this.cloneChildNodes(node,clone,copyStyles),before&&clone.insertBefore(before,clone.firstChild);var after=this.resolvePseudoContent(node,clone,styleAfter,PseudoElementType.AFTER);return after&&clone.appendChild(after),this.counters.pop(counters),(style&&(this.options.copyStyles||isSVGElementNode(node))&&!isIFrameElement(node)||copyStyles)&&copyCSSStyles(style,clone),(node.scrollTop!==0||node.scrollLeft!==0)&&this.scrolledElements.push([clone,node.scrollLeft,node.scrollTop]),(isTextareaElement(node)||isSelectElement(node))&&(isTextareaElement(clone)||isSelectElement(clone))&&(clone.value=node.value),clone}return node.cloneNode(!1)},DocumentCloner2.prototype.resolvePseudoContent=function(node,clone,style,pseudoElt){var _this=this;if(style){var value=style.content,document2=clone.ownerDocument;if(!(!document2||!value||value==="none"||value==="-moz-alt-content"||style.display==="none")){this.counters.parse(new CSSParsedCounterDeclaration(this.context,style));var declaration=new CSSParsedPseudoDeclaration(this.context,style),anonymousReplacedElement=document2.createElement("html2canvaspseudoelement");copyCSSStyles(style,anonymousReplacedElement),declaration.content.forEach(function(token){if(token.type===0)anonymousReplacedElement.appendChild(document2.createTextNode(token.value));else if(token.type===22){var img=document2.createElement("img");img.src=token.value,img.style.opacity="1",anonymousReplacedElement.appendChild(img)}else if(token.type===18){if(token.name==="attr"){var attr=token.values.filter(isIdentToken);attr.length&&anonymousReplacedElement.appendChild(document2.createTextNode(node.getAttribute(attr[0].value)||""))}else if(token.name==="counter"){var _a=token.values.filter(nonFunctionArgSeparator),counter=_a[0],counterStyle=_a[1];if(counter&&isIdentToken(counter)){var counterState=_this.counters.getCounterValue(counter.value),counterType=counterStyle&&isIdentToken(counterStyle)?listStyleType.parse(_this.context,counterStyle.value):3;anonymousReplacedElement.appendChild(document2.createTextNode(createCounterText(counterState,counterType,!1)))}}else if(token.name==="counters"){var _b=token.values.filter(nonFunctionArgSeparator),counter=_b[0],delim=_b[1],counterStyle=_b[2];if(counter&&isIdentToken(counter)){var counterStates=_this.counters.getCounterValues(counter.value),counterType_1=counterStyle&&isIdentToken(counterStyle)?listStyleType.parse(_this.context,counterStyle.value):3,separator=delim&&delim.type===0?delim.value:"",text=counterStates.map(function(value2){return createCounterText(value2,counterType_1,!1)}).join(separator);anonymousReplacedElement.appendChild(document2.createTextNode(text))}}}else if(token.type===20)switch(token.value){case"open-quote":anonymousReplacedElement.appendChild(document2.createTextNode(getQuote(declaration.quotes,_this.quoteDepth++,!0)));break;case"close-quote":anonymousReplacedElement.appendChild(document2.createTextNode(getQuote(declaration.quotes,--_this.quoteDepth,!1)));break;default:anonymousReplacedElement.appendChild(document2.createTextNode(token.value))}}),anonymousReplacedElement.className=PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;var newClassName=pseudoElt===PseudoElementType.BEFORE?" "+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE:" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;return isSVGElementNode(clone)?clone.className.baseValue+=newClassName:clone.className+=newClassName,anonymousReplacedElement}}},DocumentCloner2.destroy=function(container){return container.parentNode?(container.parentNode.removeChild(container),!0):!1},DocumentCloner2}(),PseudoElementType;(function(PseudoElementType2){PseudoElementType2[PseudoElementType2.BEFORE=0]="BEFORE",PseudoElementType2[PseudoElementType2.AFTER=1]="AFTER"})(PseudoElementType||(PseudoElementType={}));var createIFrameContainer=function(ownerDocument,bounds){var cloneIframeContainer=ownerDocument.createElement("iframe");return cloneIframeContainer.className="html2canvas-container",cloneIframeContainer.style.visibility="hidden",cloneIframeContainer.style.position="fixed",cloneIframeContainer.style.left="-10000px",cloneIframeContainer.style.top="0px",cloneIframeContainer.style.border="0",cloneIframeContainer.width=bounds.width.toString(),cloneIframeContainer.height=bounds.height.toString(),cloneIframeContainer.scrolling="no",cloneIframeContainer.setAttribute(IGNORE_ATTRIBUTE,"true"),ownerDocument.body.appendChild(cloneIframeContainer),cloneIframeContainer},imageReady=function(img){return new Promise(function(resolve){if(img.complete){resolve();return}if(!img.src){resolve();return}img.onload=resolve,img.onerror=resolve})},imagesReady=function(document2){return Promise.all([].slice.call(document2.images,0).map(imageReady))},iframeLoader=function(iframe){return new Promise(function(resolve,reject){var cloneWindow=iframe.contentWindow;if(!cloneWindow)return reject("No window assigned for iframe");var documentClone=cloneWindow.document;cloneWindow.onload=iframe.onload=function(){cloneWindow.onload=iframe.onload=null;var interval=setInterval(function(){documentClone.body.childNodes.length>0&&documentClone.readyState==="complete"&&(clearInterval(interval),resolve(iframe))},50)}})},ignoredStyleProperties=["all","d","content"],copyCSSStyles=function(style,target){for(var i2=style.length-1;i2>=0;i2--){var property=style.item(i2);ignoredStyleProperties.indexOf(property)===-1&&target.style.setProperty(property,style.getPropertyValue(property))}return target},serializeDoctype=function(doctype){var str="";return doctype&&(str+="<!DOCTYPE ",doctype.name&&(str+=doctype.name),doctype.internalSubset&&(str+=doctype.internalSubset),doctype.publicId&&(str+='"'+doctype.publicId+'"'),doctype.systemId&&(str+='"'+doctype.systemId+'"'),str+=">"),str},restoreOwnerScroll=function(ownerDocument,x,y){ownerDocument&&ownerDocument.defaultView&&(x!==ownerDocument.defaultView.pageXOffset||y!==ownerDocument.defaultView.pageYOffset)&&ownerDocument.defaultView.scrollTo(x,y)},restoreNodeScroll=function(_a){var element=_a[0],x=_a[1],y=_a[2];element.scrollLeft=x,element.scrollTop=y},PSEUDO_BEFORE=":before",PSEUDO_AFTER=":after",PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",PSEUDO_HIDE_ELEMENT_STYLE=`{
    content: "" !important;
    display: none !important;
}`,createPseudoHideStyles=function(body){createStyles(body,"."+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+PSEUDO_BEFORE+PSEUDO_HIDE_ELEMENT_STYLE+`
         .`+PSEUDO_HIDE_ELEMENT_CLASS_AFTER+PSEUDO_AFTER+PSEUDO_HIDE_ELEMENT_STYLE)},createStyles=function(body,styles){var document2=body.ownerDocument;if(document2){var style=document2.createElement("style");style.textContent=styles,body.appendChild(style)}},CacheStorage=function(){function CacheStorage2(){}return CacheStorage2.getOrigin=function(url){var link=CacheStorage2._link;return link?(link.href=url,link.href=link.href,link.protocol+link.hostname+link.port):"about:blank"},CacheStorage2.isSameOrigin=function(src){return CacheStorage2.getOrigin(src)===CacheStorage2._origin},CacheStorage2.setContext=function(window2){CacheStorage2._link=window2.document.createElement("a"),CacheStorage2._origin=CacheStorage2.getOrigin(window2.location.href)},CacheStorage2._origin="about:blank",CacheStorage2}(),Cache=function(){function Cache2(context,_options){this.context=context,this._options=_options,this._cache={}}return Cache2.prototype.addImage=function(src){var result=Promise.resolve();return this.has(src)||(isBlobImage(src)||isRenderable(src))&&(this._cache[src]=this.loadImage(src)).catch(function(){}),result},Cache2.prototype.match=function(src){return this._cache[src]},Cache2.prototype.loadImage=function(key){return __awaiter(this,void 0,void 0,function(){var isSameOrigin,useCORS,useProxy,src,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return isSameOrigin=CacheStorage.isSameOrigin(key),useCORS=!isInlineImage(key)&&this._options.useCORS===!0&&FEATURES.SUPPORT_CORS_IMAGES&&!isSameOrigin,useProxy=!isInlineImage(key)&&!isSameOrigin&&!isBlobImage(key)&&typeof this._options.proxy=="string"&&FEATURES.SUPPORT_CORS_XHR&&!useCORS,!isSameOrigin&&this._options.allowTaint===!1&&!isInlineImage(key)&&!isBlobImage(key)&&!useProxy&&!useCORS?[2]:(src=key,useProxy?[4,this.proxy(src)]:[3,2]);case 1:src=_a.sent(),_a.label=2;case 2:return this.context.logger.debug("Added image "+key.substring(0,256)),[4,new Promise(function(resolve,reject){var img=new Image;img.onload=function(){return resolve(img)},img.onerror=reject,(isInlineBase64Image(src)||useCORS)&&(img.crossOrigin="anonymous"),img.src=src,img.complete===!0&&setTimeout(function(){return resolve(img)},500),_this._options.imageTimeout>0&&setTimeout(function(){return reject("Timed out ("+_this._options.imageTimeout+"ms) loading image")},_this._options.imageTimeout)})];case 3:return[2,_a.sent()]}})})},Cache2.prototype.has=function(key){return typeof this._cache[key]<"u"},Cache2.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},Cache2.prototype.proxy=function(src){var _this=this,proxy=this._options.proxy;if(!proxy)throw new Error("No proxy defined");var key=src.substring(0,256);return new Promise(function(resolve,reject){var responseType=FEATURES.SUPPORT_RESPONSE_TYPE?"blob":"text",xhr=new XMLHttpRequest;xhr.onload=function(){if(xhr.status===200)if(responseType==="text")resolve(xhr.response);else{var reader_1=new FileReader;reader_1.addEventListener("load",function(){return resolve(reader_1.result)},!1),reader_1.addEventListener("error",function(e2){return reject(e2)},!1),reader_1.readAsDataURL(xhr.response)}else reject("Failed to proxy resource "+key+" with status code "+xhr.status)},xhr.onerror=reject;var queryString=proxy.indexOf("?")>-1?"&":"?";if(xhr.open("GET",""+proxy+queryString+"url="+encodeURIComponent(src)+"&responseType="+responseType),responseType!=="text"&&xhr instanceof XMLHttpRequest&&(xhr.responseType=responseType),_this._options.imageTimeout){var timeout_1=_this._options.imageTimeout;xhr.timeout=timeout_1,xhr.ontimeout=function(){return reject("Timed out ("+timeout_1+"ms) proxying "+key)}}xhr.send()})},Cache2}(),INLINE_SVG=/^data:image\/svg\+xml/i,INLINE_BASE64=/^data:image\/.*;base64,/i,INLINE_IMG=/^data:image\/.*/i,isRenderable=function(src){return FEATURES.SUPPORT_SVG_DRAWING||!isSVG(src)},isInlineImage=function(src){return INLINE_IMG.test(src)},isInlineBase64Image=function(src){return INLINE_BASE64.test(src)},isBlobImage=function(src){return src.substr(0,4)==="blob"},isSVG=function(src){return src.substr(-3).toLowerCase()==="svg"||INLINE_SVG.test(src)},Vector=function(){function Vector2(x,y){this.type=0,this.x=x,this.y=y}return Vector2.prototype.add=function(deltaX,deltaY){return new Vector2(this.x+deltaX,this.y+deltaY)},Vector2}(),lerp=function(a2,b,t){return new Vector(a2.x+(b.x-a2.x)*t,a2.y+(b.y-a2.y)*t)},BezierCurve=function(){function BezierCurve2(start2,startControl,endControl,end2){this.type=1,this.start=start2,this.startControl=startControl,this.endControl=endControl,this.end=end2}return BezierCurve2.prototype.subdivide=function(t,firstHalf){var ab=lerp(this.start,this.startControl,t),bc=lerp(this.startControl,this.endControl,t),cd=lerp(this.endControl,this.end,t),abbc=lerp(ab,bc,t),bccd=lerp(bc,cd,t),dest=lerp(abbc,bccd,t);return firstHalf?new BezierCurve2(this.start,ab,abbc,dest):new BezierCurve2(dest,bccd,cd,this.end)},BezierCurve2.prototype.add=function(deltaX,deltaY){return new BezierCurve2(this.start.add(deltaX,deltaY),this.startControl.add(deltaX,deltaY),this.endControl.add(deltaX,deltaY),this.end.add(deltaX,deltaY))},BezierCurve2.prototype.reverse=function(){return new BezierCurve2(this.end,this.endControl,this.startControl,this.start)},BezierCurve2}(),isBezierCurve=function(path){return path.type===1},BoundCurves=function(){function BoundCurves2(element){var styles=element.styles,bounds=element.bounds,_a=getAbsoluteValueForTuple(styles.borderTopLeftRadius,bounds.width,bounds.height),tlh=_a[0],tlv=_a[1],_b=getAbsoluteValueForTuple(styles.borderTopRightRadius,bounds.width,bounds.height),trh=_b[0],trv=_b[1],_c=getAbsoluteValueForTuple(styles.borderBottomRightRadius,bounds.width,bounds.height),brh=_c[0],brv=_c[1],_d=getAbsoluteValueForTuple(styles.borderBottomLeftRadius,bounds.width,bounds.height),blh=_d[0],blv=_d[1],factors=[];factors.push((tlh+trh)/bounds.width),factors.push((blh+brh)/bounds.width),factors.push((tlv+blv)/bounds.height),factors.push((trv+brv)/bounds.height);var maxFactor=Math.max.apply(Math,factors);maxFactor>1&&(tlh/=maxFactor,tlv/=maxFactor,trh/=maxFactor,trv/=maxFactor,brh/=maxFactor,brv/=maxFactor,blh/=maxFactor,blv/=maxFactor);var topWidth=bounds.width-trh,rightHeight=bounds.height-brv,bottomWidth=bounds.width-brh,leftHeight=bounds.height-blv,borderTopWidth2=styles.borderTopWidth,borderRightWidth2=styles.borderRightWidth,borderBottomWidth2=styles.borderBottomWidth,borderLeftWidth2=styles.borderLeftWidth,paddingTop2=getAbsoluteValue(styles.paddingTop,element.bounds.width),paddingRight2=getAbsoluteValue(styles.paddingRight,element.bounds.width),paddingBottom2=getAbsoluteValue(styles.paddingBottom,element.bounds.width),paddingLeft2=getAbsoluteValue(styles.paddingLeft,element.bounds.width);this.topLeftBorderDoubleOuterBox=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth2/3,bounds.top+borderTopWidth2/3,tlh-borderLeftWidth2/3,tlv-borderTopWidth2/3,CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth2/3,bounds.top+borderTopWidth2/3),this.topRightBorderDoubleOuterBox=tlh>0||tlv>0?getCurvePoints(bounds.left+topWidth,bounds.top+borderTopWidth2/3,trh-borderRightWidth2/3,trv-borderTopWidth2/3,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2/3,bounds.top+borderTopWidth2/3),this.bottomRightBorderDoubleOuterBox=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh-borderRightWidth2/3,brv-borderBottomWidth2/3,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2/3,bounds.top+bounds.height-borderBottomWidth2/3),this.bottomLeftBorderDoubleOuterBox=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth2/3,bounds.top+leftHeight,blh-borderLeftWidth2/3,blv-borderBottomWidth2/3,CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth2/3,bounds.top+bounds.height-borderBottomWidth2/3),this.topLeftBorderDoubleInnerBox=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth2*2/3,bounds.top+borderTopWidth2*2/3,tlh-borderLeftWidth2*2/3,tlv-borderTopWidth2*2/3,CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth2*2/3,bounds.top+borderTopWidth2*2/3),this.topRightBorderDoubleInnerBox=tlh>0||tlv>0?getCurvePoints(bounds.left+topWidth,bounds.top+borderTopWidth2*2/3,trh-borderRightWidth2*2/3,trv-borderTopWidth2*2/3,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2*2/3,bounds.top+borderTopWidth2*2/3),this.bottomRightBorderDoubleInnerBox=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh-borderRightWidth2*2/3,brv-borderBottomWidth2*2/3,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2*2/3,bounds.top+bounds.height-borderBottomWidth2*2/3),this.bottomLeftBorderDoubleInnerBox=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth2*2/3,bounds.top+leftHeight,blh-borderLeftWidth2*2/3,blv-borderBottomWidth2*2/3,CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth2*2/3,bounds.top+bounds.height-borderBottomWidth2*2/3),this.topLeftBorderStroke=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth2/2,bounds.top+borderTopWidth2/2,tlh-borderLeftWidth2/2,tlv-borderTopWidth2/2,CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth2/2,bounds.top+borderTopWidth2/2),this.topRightBorderStroke=tlh>0||tlv>0?getCurvePoints(bounds.left+topWidth,bounds.top+borderTopWidth2/2,trh-borderRightWidth2/2,trv-borderTopWidth2/2,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2/2,bounds.top+borderTopWidth2/2),this.bottomRightBorderStroke=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh-borderRightWidth2/2,brv-borderBottomWidth2/2,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2/2,bounds.top+bounds.height-borderBottomWidth2/2),this.bottomLeftBorderStroke=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth2/2,bounds.top+leftHeight,blh-borderLeftWidth2/2,blv-borderBottomWidth2/2,CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth2/2,bounds.top+bounds.height-borderBottomWidth2/2),this.topLeftBorderBox=tlh>0||tlv>0?getCurvePoints(bounds.left,bounds.top,tlh,tlv,CORNER.TOP_LEFT):new Vector(bounds.left,bounds.top),this.topRightBorderBox=trh>0||trv>0?getCurvePoints(bounds.left+topWidth,bounds.top,trh,trv,CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width,bounds.top),this.bottomRightBorderBox=brh>0||brv>0?getCurvePoints(bounds.left+bottomWidth,bounds.top+rightHeight,brh,brv,CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width,bounds.top+bounds.height),this.bottomLeftBorderBox=blh>0||blv>0?getCurvePoints(bounds.left,bounds.top+leftHeight,blh,blv,CORNER.BOTTOM_LEFT):new Vector(bounds.left,bounds.top+bounds.height),this.topLeftPaddingBox=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth2,bounds.top+borderTopWidth2,Math.max(0,tlh-borderLeftWidth2),Math.max(0,tlv-borderTopWidth2),CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth2,bounds.top+borderTopWidth2),this.topRightPaddingBox=trh>0||trv>0?getCurvePoints(bounds.left+Math.min(topWidth,bounds.width-borderRightWidth2),bounds.top+borderTopWidth2,topWidth>bounds.width+borderRightWidth2?0:Math.max(0,trh-borderRightWidth2),Math.max(0,trv-borderTopWidth2),CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2,bounds.top+borderTopWidth2),this.bottomRightPaddingBox=brh>0||brv>0?getCurvePoints(bounds.left+Math.min(bottomWidth,bounds.width-borderLeftWidth2),bounds.top+Math.min(rightHeight,bounds.height-borderBottomWidth2),Math.max(0,brh-borderRightWidth2),Math.max(0,brv-borderBottomWidth2),CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-borderRightWidth2,bounds.top+bounds.height-borderBottomWidth2),this.bottomLeftPaddingBox=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth2,bounds.top+Math.min(leftHeight,bounds.height-borderBottomWidth2),Math.max(0,blh-borderLeftWidth2),Math.max(0,blv-borderBottomWidth2),CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth2,bounds.top+bounds.height-borderBottomWidth2),this.topLeftContentBox=tlh>0||tlv>0?getCurvePoints(bounds.left+borderLeftWidth2+paddingLeft2,bounds.top+borderTopWidth2+paddingTop2,Math.max(0,tlh-(borderLeftWidth2+paddingLeft2)),Math.max(0,tlv-(borderTopWidth2+paddingTop2)),CORNER.TOP_LEFT):new Vector(bounds.left+borderLeftWidth2+paddingLeft2,bounds.top+borderTopWidth2+paddingTop2),this.topRightContentBox=trh>0||trv>0?getCurvePoints(bounds.left+Math.min(topWidth,bounds.width+borderLeftWidth2+paddingLeft2),bounds.top+borderTopWidth2+paddingTop2,topWidth>bounds.width+borderLeftWidth2+paddingLeft2?0:trh-borderLeftWidth2+paddingLeft2,trv-(borderTopWidth2+paddingTop2),CORNER.TOP_RIGHT):new Vector(bounds.left+bounds.width-(borderRightWidth2+paddingRight2),bounds.top+borderTopWidth2+paddingTop2),this.bottomRightContentBox=brh>0||brv>0?getCurvePoints(bounds.left+Math.min(bottomWidth,bounds.width-(borderLeftWidth2+paddingLeft2)),bounds.top+Math.min(rightHeight,bounds.height+borderTopWidth2+paddingTop2),Math.max(0,brh-(borderRightWidth2+paddingRight2)),brv-(borderBottomWidth2+paddingBottom2),CORNER.BOTTOM_RIGHT):new Vector(bounds.left+bounds.width-(borderRightWidth2+paddingRight2),bounds.top+bounds.height-(borderBottomWidth2+paddingBottom2)),this.bottomLeftContentBox=blh>0||blv>0?getCurvePoints(bounds.left+borderLeftWidth2+paddingLeft2,bounds.top+leftHeight,Math.max(0,blh-(borderLeftWidth2+paddingLeft2)),blv-(borderBottomWidth2+paddingBottom2),CORNER.BOTTOM_LEFT):new Vector(bounds.left+borderLeftWidth2+paddingLeft2,bounds.top+bounds.height-(borderBottomWidth2+paddingBottom2))}return BoundCurves2}(),CORNER;(function(CORNER2){CORNER2[CORNER2.TOP_LEFT=0]="TOP_LEFT",CORNER2[CORNER2.TOP_RIGHT=1]="TOP_RIGHT",CORNER2[CORNER2.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",CORNER2[CORNER2.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(CORNER||(CORNER={}));var getCurvePoints=function(x,y,r1,r2,position2){var kappa=4*((Math.sqrt(2)-1)/3),ox=r1*kappa,oy=r2*kappa,xm=x+r1,ym=y+r2;switch(position2){case CORNER.TOP_LEFT:return new BezierCurve(new Vector(x,ym),new Vector(x,ym-oy),new Vector(xm-ox,y),new Vector(xm,y));case CORNER.TOP_RIGHT:return new BezierCurve(new Vector(x,y),new Vector(x+ox,y),new Vector(xm,ym-oy),new Vector(xm,ym));case CORNER.BOTTOM_RIGHT:return new BezierCurve(new Vector(xm,y),new Vector(xm,y+oy),new Vector(x+ox,ym),new Vector(x,ym));case CORNER.BOTTOM_LEFT:default:return new BezierCurve(new Vector(xm,ym),new Vector(xm-ox,ym),new Vector(x,y+oy),new Vector(x,y))}},calculateBorderBoxPath=function(curves){return[curves.topLeftBorderBox,curves.topRightBorderBox,curves.bottomRightBorderBox,curves.bottomLeftBorderBox]},calculateContentBoxPath=function(curves){return[curves.topLeftContentBox,curves.topRightContentBox,curves.bottomRightContentBox,curves.bottomLeftContentBox]},calculatePaddingBoxPath=function(curves){return[curves.topLeftPaddingBox,curves.topRightPaddingBox,curves.bottomRightPaddingBox,curves.bottomLeftPaddingBox]},TransformEffect=function(){function TransformEffect2(offsetX,offsetY,matrix2){this.offsetX=offsetX,this.offsetY=offsetY,this.matrix=matrix2,this.type=0,this.target=6}return TransformEffect2}(),ClipEffect=function(){function ClipEffect2(path,target){this.path=path,this.target=target,this.type=1}return ClipEffect2}(),OpacityEffect=function(){function OpacityEffect2(opacity2){this.opacity=opacity2,this.type=2,this.target=6}return OpacityEffect2}(),isTransformEffect=function(effect4){return effect4.type===0},isClipEffect=function(effect4){return effect4.type===1},isOpacityEffect=function(effect4){return effect4.type===2},equalPath=function(a2,b){return a2.length===b.length?a2.some(function(v,i2){return v===b[i2]}):!1},transformPath=function(path,deltaX,deltaY,deltaW,deltaH){return path.map(function(point,index){switch(index){case 0:return point.add(deltaX,deltaY);case 1:return point.add(deltaX+deltaW,deltaY);case 2:return point.add(deltaX+deltaW,deltaY+deltaH);case 3:return point.add(deltaX,deltaY+deltaH)}return point})},StackingContext=function(){function StackingContext2(container){this.element=container,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return StackingContext2}(),ElementPaint=function(){function ElementPaint2(container,parent){if(this.container=container,this.parent=parent,this.effects=[],this.curves=new BoundCurves(this.container),this.container.styles.opacity<1&&this.effects.push(new OpacityEffect(this.container.styles.opacity)),this.container.styles.transform!==null){var offsetX=this.container.bounds.left+this.container.styles.transformOrigin[0].number,offsetY=this.container.bounds.top+this.container.styles.transformOrigin[1].number,matrix2=this.container.styles.transform;this.effects.push(new TransformEffect(offsetX,offsetY,matrix2))}if(this.container.styles.overflowX!==0){var borderBox=calculateBorderBoxPath(this.curves),paddingBox2=calculatePaddingBoxPath(this.curves);equalPath(borderBox,paddingBox2)?this.effects.push(new ClipEffect(borderBox,6)):(this.effects.push(new ClipEffect(borderBox,2)),this.effects.push(new ClipEffect(paddingBox2,4)))}}return ElementPaint2.prototype.getEffects=function(target){for(var inFlow=[2,3].indexOf(this.container.styles.position)===-1,parent=this.parent,effects=this.effects.slice(0);parent;){var croplessEffects=parent.effects.filter(function(effect4){return!isClipEffect(effect4)});if(inFlow||parent.container.styles.position!==0||!parent.parent){if(effects.unshift.apply(effects,croplessEffects),inFlow=[2,3].indexOf(parent.container.styles.position)===-1,parent.container.styles.overflowX!==0){var borderBox=calculateBorderBoxPath(parent.curves),paddingBox2=calculatePaddingBoxPath(parent.curves);equalPath(borderBox,paddingBox2)||effects.unshift(new ClipEffect(paddingBox2,6))}}else effects.unshift.apply(effects,croplessEffects);parent=parent.parent}return effects.filter(function(effect4){return contains2(effect4.target,target)})},ElementPaint2}(),parseStackTree=function(parent,stackingContext,realStackingContext,listItems){parent.container.elements.forEach(function(child){var treatAsRealStackingContext=contains2(child.flags,4),createsStackingContext2=contains2(child.flags,2),paintContainer=new ElementPaint(child,parent);contains2(child.styles.display,2048)&&listItems.push(paintContainer);var listOwnerItems=contains2(child.flags,8)?[]:listItems;if(treatAsRealStackingContext||createsStackingContext2){var parentStack=treatAsRealStackingContext||child.styles.isPositioned()?realStackingContext:stackingContext,stack=new StackingContext(paintContainer);if(child.styles.isPositioned()||child.styles.opacity<1||child.styles.isTransformed()){var order_1=child.styles.zIndex.order;if(order_1<0){var index_1=0;parentStack.negativeZIndex.some(function(current,i2){return order_1>current.element.container.styles.zIndex.order?(index_1=i2,!1):index_1>0}),parentStack.negativeZIndex.splice(index_1,0,stack)}else if(order_1>0){var index_2=0;parentStack.positiveZIndex.some(function(current,i2){return order_1>=current.element.container.styles.zIndex.order?(index_2=i2+1,!1):index_2>0}),parentStack.positiveZIndex.splice(index_2,0,stack)}else parentStack.zeroOrAutoZIndexOrTransformedOrOpacity.push(stack)}else child.styles.isFloating()?parentStack.nonPositionedFloats.push(stack):parentStack.nonPositionedInlineLevel.push(stack);parseStackTree(paintContainer,stack,treatAsRealStackingContext?stack:realStackingContext,listOwnerItems)}else child.styles.isInlineLevel()?stackingContext.inlineLevel.push(paintContainer):stackingContext.nonInlineLevel.push(paintContainer),parseStackTree(paintContainer,stackingContext,realStackingContext,listOwnerItems);contains2(child.flags,8)&&processListItems(child,listOwnerItems)})},processListItems=function(owner,elements){for(var numbering=owner instanceof OLElementContainer?owner.start:1,reversed=owner instanceof OLElementContainer?owner.reversed:!1,i2=0;i2<elements.length;i2++){var item=elements[i2];item.container instanceof LIElementContainer&&typeof item.container.value=="number"&&item.container.value!==0&&(numbering=item.container.value),item.listValue=createCounterText(numbering,item.container.styles.listStyleType,!0),numbering+=reversed?-1:1}},parseStackingContexts=function(container){var paintContainer=new ElementPaint(container,null),root=new StackingContext(paintContainer),listItems=[];return parseStackTree(paintContainer,root,root,listItems),processListItems(paintContainer.container,listItems),root},parsePathForBorder=function(curves,borderSide){switch(borderSide){case 0:return createPathFromCurves(curves.topLeftBorderBox,curves.topLeftPaddingBox,curves.topRightBorderBox,curves.topRightPaddingBox);case 1:return createPathFromCurves(curves.topRightBorderBox,curves.topRightPaddingBox,curves.bottomRightBorderBox,curves.bottomRightPaddingBox);case 2:return createPathFromCurves(curves.bottomRightBorderBox,curves.bottomRightPaddingBox,curves.bottomLeftBorderBox,curves.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(curves.bottomLeftBorderBox,curves.bottomLeftPaddingBox,curves.topLeftBorderBox,curves.topLeftPaddingBox)}},parsePathForBorderDoubleOuter=function(curves,borderSide){switch(borderSide){case 0:return createPathFromCurves(curves.topLeftBorderBox,curves.topLeftBorderDoubleOuterBox,curves.topRightBorderBox,curves.topRightBorderDoubleOuterBox);case 1:return createPathFromCurves(curves.topRightBorderBox,curves.topRightBorderDoubleOuterBox,curves.bottomRightBorderBox,curves.bottomRightBorderDoubleOuterBox);case 2:return createPathFromCurves(curves.bottomRightBorderBox,curves.bottomRightBorderDoubleOuterBox,curves.bottomLeftBorderBox,curves.bottomLeftBorderDoubleOuterBox);case 3:default:return createPathFromCurves(curves.bottomLeftBorderBox,curves.bottomLeftBorderDoubleOuterBox,curves.topLeftBorderBox,curves.topLeftBorderDoubleOuterBox)}},parsePathForBorderDoubleInner=function(curves,borderSide){switch(borderSide){case 0:return createPathFromCurves(curves.topLeftBorderDoubleInnerBox,curves.topLeftPaddingBox,curves.topRightBorderDoubleInnerBox,curves.topRightPaddingBox);case 1:return createPathFromCurves(curves.topRightBorderDoubleInnerBox,curves.topRightPaddingBox,curves.bottomRightBorderDoubleInnerBox,curves.bottomRightPaddingBox);case 2:return createPathFromCurves(curves.bottomRightBorderDoubleInnerBox,curves.bottomRightPaddingBox,curves.bottomLeftBorderDoubleInnerBox,curves.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(curves.bottomLeftBorderDoubleInnerBox,curves.bottomLeftPaddingBox,curves.topLeftBorderDoubleInnerBox,curves.topLeftPaddingBox)}},parsePathForBorderStroke=function(curves,borderSide){switch(borderSide){case 0:return createStrokePathFromCurves(curves.topLeftBorderStroke,curves.topRightBorderStroke);case 1:return createStrokePathFromCurves(curves.topRightBorderStroke,curves.bottomRightBorderStroke);case 2:return createStrokePathFromCurves(curves.bottomRightBorderStroke,curves.bottomLeftBorderStroke);case 3:default:return createStrokePathFromCurves(curves.bottomLeftBorderStroke,curves.topLeftBorderStroke)}},createStrokePathFromCurves=function(outer1,outer2){var path=[];return isBezierCurve(outer1)?path.push(outer1.subdivide(.5,!1)):path.push(outer1),isBezierCurve(outer2)?path.push(outer2.subdivide(.5,!0)):path.push(outer2),path},createPathFromCurves=function(outer1,inner1,outer2,inner2){var path=[];return isBezierCurve(outer1)?path.push(outer1.subdivide(.5,!1)):path.push(outer1),isBezierCurve(outer2)?path.push(outer2.subdivide(.5,!0)):path.push(outer2),isBezierCurve(inner2)?path.push(inner2.subdivide(.5,!0).reverse()):path.push(inner2),isBezierCurve(inner1)?path.push(inner1.subdivide(.5,!1).reverse()):path.push(inner1),path},paddingBox=function(element){var bounds=element.bounds,styles=element.styles;return bounds.add(styles.borderLeftWidth,styles.borderTopWidth,-(styles.borderRightWidth+styles.borderLeftWidth),-(styles.borderTopWidth+styles.borderBottomWidth))},contentBox=function(element){var styles=element.styles,bounds=element.bounds,paddingLeft2=getAbsoluteValue(styles.paddingLeft,bounds.width),paddingRight2=getAbsoluteValue(styles.paddingRight,bounds.width),paddingTop2=getAbsoluteValue(styles.paddingTop,bounds.width),paddingBottom2=getAbsoluteValue(styles.paddingBottom,bounds.width);return bounds.add(paddingLeft2+styles.borderLeftWidth,paddingTop2+styles.borderTopWidth,-(styles.borderRightWidth+styles.borderLeftWidth+paddingLeft2+paddingRight2),-(styles.borderTopWidth+styles.borderBottomWidth+paddingTop2+paddingBottom2))},calculateBackgroundPositioningArea=function(backgroundOrigin2,element){return backgroundOrigin2===0?element.bounds:backgroundOrigin2===2?contentBox(element):paddingBox(element)},calculateBackgroundPaintingArea=function(backgroundClip2,element){return backgroundClip2===0?element.bounds:backgroundClip2===2?contentBox(element):paddingBox(element)},calculateBackgroundRendering=function(container,index,intrinsicSize){var backgroundPositioningArea=calculateBackgroundPositioningArea(getBackgroundValueForIndex(container.styles.backgroundOrigin,index),container),backgroundPaintingArea=calculateBackgroundPaintingArea(getBackgroundValueForIndex(container.styles.backgroundClip,index),container),backgroundImageSize=calculateBackgroundSize(getBackgroundValueForIndex(container.styles.backgroundSize,index),intrinsicSize,backgroundPositioningArea),sizeWidth=backgroundImageSize[0],sizeHeight=backgroundImageSize[1],position2=getAbsoluteValueForTuple(getBackgroundValueForIndex(container.styles.backgroundPosition,index),backgroundPositioningArea.width-sizeWidth,backgroundPositioningArea.height-sizeHeight),path=calculateBackgroundRepeatPath(getBackgroundValueForIndex(container.styles.backgroundRepeat,index),position2,backgroundImageSize,backgroundPositioningArea,backgroundPaintingArea),offsetX=Math.round(backgroundPositioningArea.left+position2[0]),offsetY=Math.round(backgroundPositioningArea.top+position2[1]);return[path,offsetX,offsetY,sizeWidth,sizeHeight]},isAuto=function(token){return isIdentToken(token)&&token.value===BACKGROUND_SIZE.AUTO},hasIntrinsicValue=function(value){return typeof value=="number"},calculateBackgroundSize=function(size,_a,bounds){var intrinsicWidth=_a[0],intrinsicHeight=_a[1],intrinsicProportion=_a[2],first=size[0],second=size[1];if(!first)return[0,0];if(isLengthPercentage(first)&&second&&isLengthPercentage(second))return[getAbsoluteValue(first,bounds.width),getAbsoluteValue(second,bounds.height)];var hasIntrinsicProportion=hasIntrinsicValue(intrinsicProportion);if(isIdentToken(first)&&(first.value===BACKGROUND_SIZE.CONTAIN||first.value===BACKGROUND_SIZE.COVER)){if(hasIntrinsicValue(intrinsicProportion)){var targetRatio=bounds.width/bounds.height;return targetRatio<intrinsicProportion!=(first.value===BACKGROUND_SIZE.COVER)?[bounds.width,bounds.width/intrinsicProportion]:[bounds.height*intrinsicProportion,bounds.height]}return[bounds.width,bounds.height]}var hasIntrinsicWidth=hasIntrinsicValue(intrinsicWidth),hasIntrinsicHeight=hasIntrinsicValue(intrinsicHeight),hasIntrinsicDimensions=hasIntrinsicWidth||hasIntrinsicHeight;if(isAuto(first)&&(!second||isAuto(second))){if(hasIntrinsicWidth&&hasIntrinsicHeight)return[intrinsicWidth,intrinsicHeight];if(!hasIntrinsicProportion&&!hasIntrinsicDimensions)return[bounds.width,bounds.height];if(hasIntrinsicDimensions&&hasIntrinsicProportion){var width_1=hasIntrinsicWidth?intrinsicWidth:intrinsicHeight*intrinsicProportion,height_1=hasIntrinsicHeight?intrinsicHeight:intrinsicWidth/intrinsicProportion;return[width_1,height_1]}var width_2=hasIntrinsicWidth?intrinsicWidth:bounds.width,height_2=hasIntrinsicHeight?intrinsicHeight:bounds.height;return[width_2,height_2]}if(hasIntrinsicProportion){var width_3=0,height_3=0;return isLengthPercentage(first)?width_3=getAbsoluteValue(first,bounds.width):isLengthPercentage(second)&&(height_3=getAbsoluteValue(second,bounds.height)),isAuto(first)?width_3=height_3*intrinsicProportion:(!second||isAuto(second))&&(height_3=width_3/intrinsicProportion),[width_3,height_3]}var width=null,height=null;if(isLengthPercentage(first)?width=getAbsoluteValue(first,bounds.width):second&&isLengthPercentage(second)&&(height=getAbsoluteValue(second,bounds.height)),width!==null&&(!second||isAuto(second))&&(height=hasIntrinsicWidth&&hasIntrinsicHeight?width/intrinsicWidth*intrinsicHeight:bounds.height),height!==null&&isAuto(first)&&(width=hasIntrinsicWidth&&hasIntrinsicHeight?height/intrinsicHeight*intrinsicWidth:bounds.width),width!==null&&height!==null)return[width,height];throw new Error("Unable to calculate background-size for element")},getBackgroundValueForIndex=function(values,index){var value=values[index];return typeof value>"u"?values[0]:value},calculateBackgroundRepeatPath=function(repeat,_a,_b,backgroundPositioningArea,backgroundPaintingArea){var x=_a[0],y=_a[1],width=_b[0],height=_b[1];switch(repeat){case 2:return[new Vector(Math.round(backgroundPositioningArea.left),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+backgroundPositioningArea.width),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+backgroundPositioningArea.width),Math.round(height+backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left),Math.round(height+backgroundPositioningArea.top+y))];case 3:return[new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.top)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.top)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.height+backgroundPositioningArea.top)),new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.height+backgroundPositioningArea.top))];case 1:return[new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.top+y)),new Vector(Math.round(backgroundPositioningArea.left+x+width),Math.round(backgroundPositioningArea.top+y+height)),new Vector(Math.round(backgroundPositioningArea.left+x),Math.round(backgroundPositioningArea.top+y+height))];default:return[new Vector(Math.round(backgroundPaintingArea.left),Math.round(backgroundPaintingArea.top)),new Vector(Math.round(backgroundPaintingArea.left+backgroundPaintingArea.width),Math.round(backgroundPaintingArea.top)),new Vector(Math.round(backgroundPaintingArea.left+backgroundPaintingArea.width),Math.round(backgroundPaintingArea.height+backgroundPaintingArea.top)),new Vector(Math.round(backgroundPaintingArea.left),Math.round(backgroundPaintingArea.height+backgroundPaintingArea.top))]}},SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",SAMPLE_TEXT="Hidden Text",FontMetrics=function(){function FontMetrics2(document2){this._data={},this._document=document2}return FontMetrics2.prototype.parseMetrics=function(fontFamily2,fontSize2){var container=this._document.createElement("div"),img=this._document.createElement("img"),span=this._document.createElement("span"),body=this._document.body;container.style.visibility="hidden",container.style.fontFamily=fontFamily2,container.style.fontSize=fontSize2,container.style.margin="0",container.style.padding="0",container.style.whiteSpace="nowrap",body.appendChild(container),img.src=SMALL_IMAGE,img.width=1,img.height=1,img.style.margin="0",img.style.padding="0",img.style.verticalAlign="baseline",span.style.fontFamily=fontFamily2,span.style.fontSize=fontSize2,span.style.margin="0",span.style.padding="0",span.appendChild(this._document.createTextNode(SAMPLE_TEXT)),container.appendChild(span),container.appendChild(img);var baseline=img.offsetTop-span.offsetTop+2;container.removeChild(span),container.appendChild(this._document.createTextNode(SAMPLE_TEXT)),container.style.lineHeight="normal",img.style.verticalAlign="super";var middle=img.offsetTop-container.offsetTop+2;return body.removeChild(container),{baseline,middle}},FontMetrics2.prototype.getMetrics=function(fontFamily2,fontSize2){var key=fontFamily2+" "+fontSize2;return typeof this._data[key]>"u"&&(this._data[key]=this.parseMetrics(fontFamily2,fontSize2)),this._data[key]},FontMetrics2}(),Renderer=function(){function Renderer2(context,options){this.context=context,this.options=options}return Renderer2}(),MASK_OFFSET=1e4,CanvasRenderer=function(_super){__extends(CanvasRenderer2,_super);function CanvasRenderer2(context,options){var _this=_super.call(this,context,options)||this;return _this._activeEffects=[],_this.canvas=options.canvas?options.canvas:document.createElement("canvas"),_this.ctx=_this.canvas.getContext("2d"),options.canvas||(_this.canvas.width=Math.floor(options.width*options.scale),_this.canvas.height=Math.floor(options.height*options.scale),_this.canvas.style.width=options.width+"px",_this.canvas.style.height=options.height+"px"),_this.fontMetrics=new FontMetrics(document),_this.ctx.scale(_this.options.scale,_this.options.scale),_this.ctx.translate(-options.x,-options.y),_this.ctx.textBaseline="bottom",_this._activeEffects=[],_this.context.logger.debug("Canvas renderer initialized ("+options.width+"x"+options.height+") with scale "+options.scale),_this}return CanvasRenderer2.prototype.applyEffects=function(effects){for(var _this=this;this._activeEffects.length;)this.popEffect();effects.forEach(function(effect4){return _this.applyEffect(effect4)})},CanvasRenderer2.prototype.applyEffect=function(effect4){this.ctx.save(),isOpacityEffect(effect4)&&(this.ctx.globalAlpha=effect4.opacity),isTransformEffect(effect4)&&(this.ctx.translate(effect4.offsetX,effect4.offsetY),this.ctx.transform(effect4.matrix[0],effect4.matrix[1],effect4.matrix[2],effect4.matrix[3],effect4.matrix[4],effect4.matrix[5]),this.ctx.translate(-effect4.offsetX,-effect4.offsetY)),isClipEffect(effect4)&&(this.path(effect4.path),this.ctx.clip()),this._activeEffects.push(effect4)},CanvasRenderer2.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},CanvasRenderer2.prototype.renderStack=function(stack){return __awaiter(this,void 0,void 0,function(){var styles;return __generator(this,function(_a){switch(_a.label){case 0:return styles=stack.element.container.styles,styles.isVisible()?[4,this.renderStackContent(stack)]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2]}})})},CanvasRenderer2.prototype.renderNode=function(paint){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:if(contains2(paint.container.flags,16))debugger;return paint.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(paint)]:[3,3];case 1:return _a.sent(),[4,this.renderNodeContent(paint)];case 2:_a.sent(),_a.label=3;case 3:return[2]}})})},CanvasRenderer2.prototype.renderTextWithLetterSpacing=function(text,letterSpacing2,baseline){var _this=this;if(letterSpacing2===0)this.ctx.fillText(text.text,text.bounds.left,text.bounds.top+baseline);else{var letters=segmentGraphemes(text.text);letters.reduce(function(left2,letter){return _this.ctx.fillText(letter,left2,text.bounds.top+baseline),left2+_this.ctx.measureText(letter).width},text.bounds.left)}},CanvasRenderer2.prototype.createFontStyle=function(styles){var fontVariant2=styles.fontVariant.filter(function(variant){return variant==="normal"||variant==="small-caps"}).join(""),fontFamily2=fixIOSSystemFonts(styles.fontFamily).join(", "),fontSize2=isDimensionToken(styles.fontSize)?""+styles.fontSize.number+styles.fontSize.unit:styles.fontSize.number+"px";return[[styles.fontStyle,fontVariant2,styles.fontWeight,fontSize2,fontFamily2].join(" "),fontFamily2,fontSize2]},CanvasRenderer2.prototype.renderTextNode=function(text,styles){return __awaiter(this,void 0,void 0,function(){var _a,font,fontFamily2,fontSize2,_b,baseline,middle,paintOrder2,_this=this;return __generator(this,function(_c){return _a=this.createFontStyle(styles),font=_a[0],fontFamily2=_a[1],fontSize2=_a[2],this.ctx.font=font,this.ctx.direction=styles.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",_b=this.fontMetrics.getMetrics(fontFamily2,fontSize2),baseline=_b.baseline,middle=_b.middle,paintOrder2=styles.paintOrder,text.textBounds.forEach(function(text2){paintOrder2.forEach(function(paintOrderLayer){switch(paintOrderLayer){case 0:_this.ctx.fillStyle=asString(styles.color),_this.renderTextWithLetterSpacing(text2,styles.letterSpacing,baseline);var textShadows=styles.textShadow;textShadows.length&&text2.text.trim().length&&(textShadows.slice(0).reverse().forEach(function(textShadow2){_this.ctx.shadowColor=asString(textShadow2.color),_this.ctx.shadowOffsetX=textShadow2.offsetX.number*_this.options.scale,_this.ctx.shadowOffsetY=textShadow2.offsetY.number*_this.options.scale,_this.ctx.shadowBlur=textShadow2.blur.number,_this.renderTextWithLetterSpacing(text2,styles.letterSpacing,baseline)}),_this.ctx.shadowColor="",_this.ctx.shadowOffsetX=0,_this.ctx.shadowOffsetY=0,_this.ctx.shadowBlur=0),styles.textDecorationLine.length&&(_this.ctx.fillStyle=asString(styles.textDecorationColor||styles.color),styles.textDecorationLine.forEach(function(textDecorationLine2){switch(textDecorationLine2){case 1:_this.ctx.fillRect(text2.bounds.left,Math.round(text2.bounds.top+baseline),text2.bounds.width,1);break;case 2:_this.ctx.fillRect(text2.bounds.left,Math.round(text2.bounds.top),text2.bounds.width,1);break;case 3:_this.ctx.fillRect(text2.bounds.left,Math.ceil(text2.bounds.top+middle),text2.bounds.width,1);break}}));break;case 1:styles.webkitTextStrokeWidth&&text2.text.trim().length&&(_this.ctx.strokeStyle=asString(styles.webkitTextStrokeColor),_this.ctx.lineWidth=styles.webkitTextStrokeWidth,_this.ctx.lineJoin=window.chrome?"miter":"round",_this.ctx.strokeText(text2.text,text2.bounds.left,text2.bounds.top+baseline)),_this.ctx.strokeStyle="",_this.ctx.lineWidth=0,_this.ctx.lineJoin="miter";break}})}),[2]})})},CanvasRenderer2.prototype.renderReplacedElement=function(container,curves,image2){if(image2&&container.intrinsicWidth>0&&container.intrinsicHeight>0){var box=contentBox(container),path=calculatePaddingBoxPath(curves);this.path(path),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(image2,0,0,container.intrinsicWidth,container.intrinsicHeight,box.left,box.top,box.width,box.height),this.ctx.restore()}},CanvasRenderer2.prototype.renderNodeContent=function(paint){return __awaiter(this,void 0,void 0,function(){var container,curves,styles,_i,_a,child,image2,image2,iframeRenderer,canvas,size,_b,fontFamily2,fontSize2,baseline,bounds,x,textBounds,img,image2,url,fontFamily2,bounds;return __generator(this,function(_c){switch(_c.label){case 0:this.applyEffects(paint.getEffects(4)),container=paint.container,curves=paint.curves,styles=container.styles,_i=0,_a=container.textNodes,_c.label=1;case 1:return _i<_a.length?(child=_a[_i],[4,this.renderTextNode(child,styles)]):[3,4];case 2:_c.sent(),_c.label=3;case 3:return _i++,[3,1];case 4:if(!(container instanceof ImageElementContainer))return[3,8];_c.label=5;case 5:return _c.trys.push([5,7,,8]),[4,this.context.cache.match(container.src)];case 6:return image2=_c.sent(),this.renderReplacedElement(container,curves,image2),[3,8];case 7:return _c.sent(),this.context.logger.error("Error loading image "+container.src),[3,8];case 8:if(container instanceof CanvasElementContainer&&this.renderReplacedElement(container,curves,container.canvas),!(container instanceof SVGElementContainer))return[3,12];_c.label=9;case 9:return _c.trys.push([9,11,,12]),[4,this.context.cache.match(container.svg)];case 10:return image2=_c.sent(),this.renderReplacedElement(container,curves,image2),[3,12];case 11:return _c.sent(),this.context.logger.error("Error loading svg "+container.svg.substring(0,255)),[3,12];case 12:return container instanceof IFrameElementContainer&&container.tree?(iframeRenderer=new CanvasRenderer2(this.context,{scale:this.options.scale,backgroundColor:container.backgroundColor,x:0,y:0,width:container.width,height:container.height}),[4,iframeRenderer.render(container.tree)]):[3,14];case 13:canvas=_c.sent(),container.width&&container.height&&this.ctx.drawImage(canvas,0,0,container.width,container.height,container.bounds.left,container.bounds.top,container.bounds.width,container.bounds.height),_c.label=14;case 14:if(container instanceof InputElementContainer&&(size=Math.min(container.bounds.width,container.bounds.height),container.type===CHECKBOX?container.checked&&(this.ctx.save(),this.path([new Vector(container.bounds.left+size*.39363,container.bounds.top+size*.79),new Vector(container.bounds.left+size*.16,container.bounds.top+size*.5549),new Vector(container.bounds.left+size*.27347,container.bounds.top+size*.44071),new Vector(container.bounds.left+size*.39694,container.bounds.top+size*.5649),new Vector(container.bounds.left+size*.72983,container.bounds.top+size*.23),new Vector(container.bounds.left+size*.84,container.bounds.top+size*.34085),new Vector(container.bounds.left+size*.39363,container.bounds.top+size*.79)]),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore()):container.type===RADIO&&container.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(container.bounds.left+size/2,container.bounds.top+size/2,size/4,0,Math.PI*2,!0),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore())),isTextInputElement(container)&&container.value.length){switch(_b=this.createFontStyle(styles),fontFamily2=_b[0],fontSize2=_b[1],baseline=this.fontMetrics.getMetrics(fontFamily2,fontSize2).baseline,this.ctx.font=fontFamily2,this.ctx.fillStyle=asString(styles.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=canvasTextAlign(container.styles.textAlign),bounds=contentBox(container),x=0,container.styles.textAlign){case 1:x+=bounds.width/2;break;case 2:x+=bounds.width;break}textBounds=bounds.add(x,0,0,-bounds.height/2+1),this.ctx.save(),this.path([new Vector(bounds.left,bounds.top),new Vector(bounds.left+bounds.width,bounds.top),new Vector(bounds.left+bounds.width,bounds.top+bounds.height),new Vector(bounds.left,bounds.top+bounds.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new TextBounds(container.value,textBounds),styles.letterSpacing,baseline),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!contains2(container.styles.display,2048))return[3,20];if(container.styles.listStyleImage===null)return[3,19];if(img=container.styles.listStyleImage,img.type!==0)return[3,18];image2=void 0,url=img.url,_c.label=15;case 15:return _c.trys.push([15,17,,18]),[4,this.context.cache.match(url)];case 16:return image2=_c.sent(),this.ctx.drawImage(image2,container.bounds.left-(image2.width+10),container.bounds.top),[3,18];case 17:return _c.sent(),this.context.logger.error("Error loading list-style-image "+url),[3,18];case 18:return[3,20];case 19:paint.listValue&&container.styles.listStyleType!==-1&&(fontFamily2=this.createFontStyle(styles)[0],this.ctx.font=fontFamily2,this.ctx.fillStyle=asString(styles.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",bounds=new Bounds(container.bounds.left,container.bounds.top+getAbsoluteValue(container.styles.paddingTop,container.bounds.width),container.bounds.width,computeLineHeight(styles.lineHeight,styles.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new TextBounds(paint.listValue,bounds),styles.letterSpacing,computeLineHeight(styles.lineHeight,styles.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),_c.label=20;case 20:return[2]}})})},CanvasRenderer2.prototype.renderStackContent=function(stack){return __awaiter(this,void 0,void 0,function(){var _i,_a,child,_b,_c,child,_d,_e,child,_f,_g,child,_h,_j,child,_k,_l,child,_m,_o,child;return __generator(this,function(_p){switch(_p.label){case 0:if(contains2(stack.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(stack.element)];case 1:_p.sent(),_i=0,_a=stack.negativeZIndex,_p.label=2;case 2:return _i<_a.length?(child=_a[_i],[4,this.renderStack(child)]):[3,5];case 3:_p.sent(),_p.label=4;case 4:return _i++,[3,2];case 5:return[4,this.renderNodeContent(stack.element)];case 6:_p.sent(),_b=0,_c=stack.nonInlineLevel,_p.label=7;case 7:return _b<_c.length?(child=_c[_b],[4,this.renderNode(child)]):[3,10];case 8:_p.sent(),_p.label=9;case 9:return _b++,[3,7];case 10:_d=0,_e=stack.nonPositionedFloats,_p.label=11;case 11:return _d<_e.length?(child=_e[_d],[4,this.renderStack(child)]):[3,14];case 12:_p.sent(),_p.label=13;case 13:return _d++,[3,11];case 14:_f=0,_g=stack.nonPositionedInlineLevel,_p.label=15;case 15:return _f<_g.length?(child=_g[_f],[4,this.renderStack(child)]):[3,18];case 16:_p.sent(),_p.label=17;case 17:return _f++,[3,15];case 18:_h=0,_j=stack.inlineLevel,_p.label=19;case 19:return _h<_j.length?(child=_j[_h],[4,this.renderNode(child)]):[3,22];case 20:_p.sent(),_p.label=21;case 21:return _h++,[3,19];case 22:_k=0,_l=stack.zeroOrAutoZIndexOrTransformedOrOpacity,_p.label=23;case 23:return _k<_l.length?(child=_l[_k],[4,this.renderStack(child)]):[3,26];case 24:_p.sent(),_p.label=25;case 25:return _k++,[3,23];case 26:_m=0,_o=stack.positiveZIndex,_p.label=27;case 27:return _m<_o.length?(child=_o[_m],[4,this.renderStack(child)]):[3,30];case 28:_p.sent(),_p.label=29;case 29:return _m++,[3,27];case 30:return[2]}})})},CanvasRenderer2.prototype.mask=function(paths){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(paths.slice(0).reverse()),this.ctx.closePath()},CanvasRenderer2.prototype.path=function(paths){this.ctx.beginPath(),this.formatPath(paths),this.ctx.closePath()},CanvasRenderer2.prototype.formatPath=function(paths){var _this=this;paths.forEach(function(point,index){var start2=isBezierCurve(point)?point.start:point;index===0?_this.ctx.moveTo(start2.x,start2.y):_this.ctx.lineTo(start2.x,start2.y),isBezierCurve(point)&&_this.ctx.bezierCurveTo(point.startControl.x,point.startControl.y,point.endControl.x,point.endControl.y,point.end.x,point.end.y)})},CanvasRenderer2.prototype.renderRepeat=function(path,pattern,offsetX,offsetY){this.path(path),this.ctx.fillStyle=pattern,this.ctx.translate(offsetX,offsetY),this.ctx.fill(),this.ctx.translate(-offsetX,-offsetY)},CanvasRenderer2.prototype.resizeImage=function(image2,width,height){var _a;if(image2.width===width&&image2.height===height)return image2;var ownerDocument=(_a=this.canvas.ownerDocument)!==null&&_a!==void 0?_a:document,canvas=ownerDocument.createElement("canvas");canvas.width=Math.max(1,width),canvas.height=Math.max(1,height);var ctx=canvas.getContext("2d");return ctx.drawImage(image2,0,0,image2.width,image2.height,0,0,width,height),canvas},CanvasRenderer2.prototype.renderBackgroundImage=function(container){return __awaiter(this,void 0,void 0,function(){var index,_loop_1,this_1,_i,_a,backgroundImage2;return __generator(this,function(_b){switch(_b.label){case 0:index=container.styles.backgroundImage.length-1,_loop_1=function(backgroundImage3){var image2,url,_c,path,x,y,width,height,pattern,_d,path,x,y,width,height,_e,lineLength,x0,x1,y0,y1,canvas,ctx,gradient_1,pattern,_f,path,left2,top_1,width,height,position2,x,y,_g,rx,ry,radialGradient_1,midX,midY,f2,invF;return __generator(this,function(_h){switch(_h.label){case 0:if(backgroundImage3.type!==0)return[3,5];image2=void 0,url=backgroundImage3.url,_h.label=1;case 1:return _h.trys.push([1,3,,4]),[4,this_1.context.cache.match(url)];case 2:return image2=_h.sent(),[3,4];case 3:return _h.sent(),this_1.context.logger.error("Error loading background-image "+url),[3,4];case 4:return image2&&(_c=calculateBackgroundRendering(container,index,[image2.width,image2.height,image2.width/image2.height]),path=_c[0],x=_c[1],y=_c[2],width=_c[3],height=_c[4],pattern=this_1.ctx.createPattern(this_1.resizeImage(image2,width,height),"repeat"),this_1.renderRepeat(path,pattern,x,y)),[3,6];case 5:isLinearGradient(backgroundImage3)?(_d=calculateBackgroundRendering(container,index,[null,null,null]),path=_d[0],x=_d[1],y=_d[2],width=_d[3],height=_d[4],_e=calculateGradientDirection(backgroundImage3.angle,width,height),lineLength=_e[0],x0=_e[1],x1=_e[2],y0=_e[3],y1=_e[4],canvas=document.createElement("canvas"),canvas.width=width,canvas.height=height,ctx=canvas.getContext("2d"),gradient_1=ctx.createLinearGradient(x0,y0,x1,y1),processColorStops(backgroundImage3.stops,lineLength).forEach(function(colorStop){return gradient_1.addColorStop(colorStop.stop,asString(colorStop.color))}),ctx.fillStyle=gradient_1,ctx.fillRect(0,0,width,height),width>0&&height>0&&(pattern=this_1.ctx.createPattern(canvas,"repeat"),this_1.renderRepeat(path,pattern,x,y))):isRadialGradient(backgroundImage3)&&(_f=calculateBackgroundRendering(container,index,[null,null,null]),path=_f[0],left2=_f[1],top_1=_f[2],width=_f[3],height=_f[4],position2=backgroundImage3.position.length===0?[FIFTY_PERCENT]:backgroundImage3.position,x=getAbsoluteValue(position2[0],width),y=getAbsoluteValue(position2[position2.length-1],height),_g=calculateRadius(backgroundImage3,x,y,width,height),rx=_g[0],ry=_g[1],rx>0&&ry>0&&(radialGradient_1=this_1.ctx.createRadialGradient(left2+x,top_1+y,0,left2+x,top_1+y,rx),processColorStops(backgroundImage3.stops,rx*2).forEach(function(colorStop){return radialGradient_1.addColorStop(colorStop.stop,asString(colorStop.color))}),this_1.path(path),this_1.ctx.fillStyle=radialGradient_1,rx!==ry?(midX=container.bounds.left+.5*container.bounds.width,midY=container.bounds.top+.5*container.bounds.height,f2=ry/rx,invF=1/f2,this_1.ctx.save(),this_1.ctx.translate(midX,midY),this_1.ctx.transform(1,0,0,f2,0,0),this_1.ctx.translate(-midX,-midY),this_1.ctx.fillRect(left2,invF*(top_1-midY)+midY,width,height*invF),this_1.ctx.restore()):this_1.ctx.fill())),_h.label=6;case 6:return index--,[2]}})},this_1=this,_i=0,_a=container.styles.backgroundImage.slice(0).reverse(),_b.label=1;case 1:return _i<_a.length?(backgroundImage2=_a[_i],[5,_loop_1(backgroundImage2)]):[3,4];case 2:_b.sent(),_b.label=3;case 3:return _i++,[3,1];case 4:return[2]}})})},CanvasRenderer2.prototype.renderSolidBorder=function(color2,side,curvePoints){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return this.path(parsePathForBorder(curvePoints,side)),this.ctx.fillStyle=asString(color2),this.ctx.fill(),[2]})})},CanvasRenderer2.prototype.renderDoubleBorder=function(color2,width,side,curvePoints){return __awaiter(this,void 0,void 0,function(){var outerPaths,innerPaths;return __generator(this,function(_a){switch(_a.label){case 0:return width<3?[4,this.renderSolidBorder(color2,side,curvePoints)]:[3,2];case 1:return _a.sent(),[2];case 2:return outerPaths=parsePathForBorderDoubleOuter(curvePoints,side),this.path(outerPaths),this.ctx.fillStyle=asString(color2),this.ctx.fill(),innerPaths=parsePathForBorderDoubleInner(curvePoints,side),this.path(innerPaths),this.ctx.fill(),[2]}})})},CanvasRenderer2.prototype.renderNodeBackgroundAndBorders=function(paint){return __awaiter(this,void 0,void 0,function(){var styles,hasBackground,borders,backgroundPaintingArea,side,_i,borders_1,border,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return this.applyEffects(paint.getEffects(2)),styles=paint.container.styles,hasBackground=!isTransparent(styles.backgroundColor)||styles.backgroundImage.length,borders=[{style:styles.borderTopStyle,color:styles.borderTopColor,width:styles.borderTopWidth},{style:styles.borderRightStyle,color:styles.borderRightColor,width:styles.borderRightWidth},{style:styles.borderBottomStyle,color:styles.borderBottomColor,width:styles.borderBottomWidth},{style:styles.borderLeftStyle,color:styles.borderLeftColor,width:styles.borderLeftWidth}],backgroundPaintingArea=calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(styles.backgroundClip,0),paint.curves),hasBackground||styles.boxShadow.length?(this.ctx.save(),this.path(backgroundPaintingArea),this.ctx.clip(),isTransparent(styles.backgroundColor)||(this.ctx.fillStyle=asString(styles.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(paint.container)]):[3,2];case 1:_a.sent(),this.ctx.restore(),styles.boxShadow.slice(0).reverse().forEach(function(shadow){_this.ctx.save();var borderBoxArea=calculateBorderBoxPath(paint.curves),maskOffset=shadow.inset?0:MASK_OFFSET,shadowPaintingArea=transformPath(borderBoxArea,-maskOffset+(shadow.inset?1:-1)*shadow.spread.number,(shadow.inset?1:-1)*shadow.spread.number,shadow.spread.number*(shadow.inset?-2:2),shadow.spread.number*(shadow.inset?-2:2));shadow.inset?(_this.path(borderBoxArea),_this.ctx.clip(),_this.mask(shadowPaintingArea)):(_this.mask(borderBoxArea),_this.ctx.clip(),_this.path(shadowPaintingArea)),_this.ctx.shadowOffsetX=shadow.offsetX.number+maskOffset,_this.ctx.shadowOffsetY=shadow.offsetY.number,_this.ctx.shadowColor=asString(shadow.color),_this.ctx.shadowBlur=shadow.blur.number,_this.ctx.fillStyle=shadow.inset?asString(shadow.color):"rgba(0,0,0,1)",_this.ctx.fill(),_this.ctx.restore()}),_a.label=2;case 2:side=0,_i=0,borders_1=borders,_a.label=3;case 3:return _i<borders_1.length?(border=borders_1[_i],border.style!==0&&!isTransparent(border.color)&&border.width>0?border.style!==2?[3,5]:[4,this.renderDashedDottedBorder(border.color,border.width,side,paint.curves,2)]:[3,11]):[3,13];case 4:return _a.sent(),[3,11];case 5:return border.style!==3?[3,7]:[4,this.renderDashedDottedBorder(border.color,border.width,side,paint.curves,3)];case 6:return _a.sent(),[3,11];case 7:return border.style!==4?[3,9]:[4,this.renderDoubleBorder(border.color,border.width,side,paint.curves)];case 8:return _a.sent(),[3,11];case 9:return[4,this.renderSolidBorder(border.color,side,paint.curves)];case 10:_a.sent(),_a.label=11;case 11:side++,_a.label=12;case 12:return _i++,[3,3];case 13:return[2]}})})},CanvasRenderer2.prototype.renderDashedDottedBorder=function(color2,width,side,curvePoints,style){return __awaiter(this,void 0,void 0,function(){var strokePaths,boxPaths,startX,startY,endX,endY,length,dashLength,spaceLength,useLineDash,multiplier,numberOfDashes,minSpace,maxSpace,path1,path2,path1,path2;return __generator(this,function(_a){return this.ctx.save(),strokePaths=parsePathForBorderStroke(curvePoints,side),boxPaths=parsePathForBorder(curvePoints,side),style===2&&(this.path(boxPaths),this.ctx.clip()),isBezierCurve(boxPaths[0])?(startX=boxPaths[0].start.x,startY=boxPaths[0].start.y):(startX=boxPaths[0].x,startY=boxPaths[0].y),isBezierCurve(boxPaths[1])?(endX=boxPaths[1].end.x,endY=boxPaths[1].end.y):(endX=boxPaths[1].x,endY=boxPaths[1].y),side===0||side===2?length=Math.abs(startX-endX):length=Math.abs(startY-endY),this.ctx.beginPath(),style===3?this.formatPath(strokePaths):this.formatPath(boxPaths.slice(0,2)),dashLength=width<3?width*3:width*2,spaceLength=width<3?width*2:width,style===3&&(dashLength=width,spaceLength=width),useLineDash=!0,length<=dashLength*2?useLineDash=!1:length<=dashLength*2+spaceLength?(multiplier=length/(2*dashLength+spaceLength),dashLength*=multiplier,spaceLength*=multiplier):(numberOfDashes=Math.floor((length+spaceLength)/(dashLength+spaceLength)),minSpace=(length-numberOfDashes*dashLength)/(numberOfDashes-1),maxSpace=(length-(numberOfDashes+1)*dashLength)/numberOfDashes,spaceLength=maxSpace<=0||Math.abs(spaceLength-minSpace)<Math.abs(spaceLength-maxSpace)?minSpace:maxSpace),useLineDash&&(style===3?this.ctx.setLineDash([0,dashLength+spaceLength]):this.ctx.setLineDash([dashLength,spaceLength])),style===3?(this.ctx.lineCap="round",this.ctx.lineWidth=width):this.ctx.lineWidth=width*2+1.1,this.ctx.strokeStyle=asString(color2),this.ctx.stroke(),this.ctx.setLineDash([]),style===2&&(isBezierCurve(boxPaths[0])&&(path1=boxPaths[3],path2=boxPaths[0],this.ctx.beginPath(),this.formatPath([new Vector(path1.end.x,path1.end.y),new Vector(path2.start.x,path2.start.y)]),this.ctx.stroke()),isBezierCurve(boxPaths[1])&&(path1=boxPaths[1],path2=boxPaths[2],this.ctx.beginPath(),this.formatPath([new Vector(path1.end.x,path1.end.y),new Vector(path2.start.x,path2.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},CanvasRenderer2.prototype.render=function(element){return __awaiter(this,void 0,void 0,function(){var stack;return __generator(this,function(_a){switch(_a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),stack=parseStackingContexts(element),[4,this.renderStack(stack)];case 1:return _a.sent(),this.applyEffects([]),[2,this.canvas]}})})},CanvasRenderer2}(Renderer),isTextInputElement=function(container){return container instanceof TextareaElementContainer||container instanceof SelectElementContainer?!0:container instanceof InputElementContainer&&container.type!==RADIO&&container.type!==CHECKBOX},calculateBackgroundCurvedPaintingArea=function(clip,curves){switch(clip){case 0:return calculateBorderBoxPath(curves);case 2:return calculateContentBoxPath(curves);case 1:default:return calculatePaddingBoxPath(curves)}},canvasTextAlign=function(textAlign2){switch(textAlign2){case 1:return"center";case 2:return"right";case 0:default:return"left"}},iOSBrokenFonts=["-apple-system","system-ui"],fixIOSSystemFonts=function(fontFamilies){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?fontFamilies.filter(function(fontFamily2){return iOSBrokenFonts.indexOf(fontFamily2)===-1}):fontFamilies},ForeignObjectRenderer=function(_super){__extends(ForeignObjectRenderer2,_super);function ForeignObjectRenderer2(context,options){var _this=_super.call(this,context,options)||this;return _this.canvas=options.canvas?options.canvas:document.createElement("canvas"),_this.ctx=_this.canvas.getContext("2d"),_this.options=options,_this.canvas.width=Math.floor(options.width*options.scale),_this.canvas.height=Math.floor(options.height*options.scale),_this.canvas.style.width=options.width+"px",_this.canvas.style.height=options.height+"px",_this.ctx.scale(_this.options.scale,_this.options.scale),_this.ctx.translate(-options.x,-options.y),_this.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+options.width+"x"+options.height+" at "+options.x+","+options.y+") with scale "+options.scale),_this}return ForeignObjectRenderer2.prototype.render=function(element){return __awaiter(this,void 0,void 0,function(){var svg,img;return __generator(this,function(_a){switch(_a.label){case 0:return svg=createForeignObjectSVG(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,element),[4,loadSerializedSVG(svg)];case 1:return img=_a.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(img,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},ForeignObjectRenderer2}(Renderer),loadSerializedSVG=function(svg){return new Promise(function(resolve,reject){var img=new Image;img.onload=function(){resolve(img)},img.onerror=reject,img.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(svg))})},Logger=function(){function Logger2(_a){var id=_a.id,enabled=_a.enabled;this.id=id,this.enabled=enabled,this.start=Date.now()}return Logger2.prototype.debug=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args)):this.info.apply(this,args))},Logger2.prototype.getTime=function(){return Date.now()-this.start},Logger2.prototype.info=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args))},Logger2.prototype.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args)):this.info.apply(this,args))},Logger2.prototype.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,__spreadArray([this.id,this.getTime()+"ms"],args)):this.info.apply(this,args))},Logger2.instances={},Logger2}(),Context=function(){function Context2(options,windowBounds){var _a;this.windowBounds=windowBounds,this.instanceName="#"+Context2.instanceCount++,this.logger=new Logger({id:this.instanceName,enabled:options.logging}),this.cache=(_a=options.cache)!==null&&_a!==void 0?_a:new Cache(this,options)}return Context2.instanceCount=1,Context2}(),html2canvas2=function(element,options){return options===void 0&&(options={}),renderElement(element,options)};typeof window<"u"&&CacheStorage.setContext(window);var renderElement=function(element,opts){return __awaiter(void 0,void 0,void 0,function(){var ownerDocument,defaultView,resourceOptions,contextOptions,windowOptions,windowBounds,context,foreignObjectRendering,cloneOptions,documentCloner,clonedElement,container,_a,width,height,left2,top2,backgroundColor2,renderOptions,canvas,renderer,root,renderer,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t;return __generator(this,function(_u){switch(_u.label){case 0:if(!element||typeof element!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(ownerDocument=element.ownerDocument,!ownerDocument)throw new Error("Element is not attached to a Document");if(defaultView=ownerDocument.defaultView,!defaultView)throw new Error("Document is not attached to a Window");return resourceOptions={allowTaint:(_b=opts.allowTaint)!==null&&_b!==void 0?_b:!1,imageTimeout:(_c=opts.imageTimeout)!==null&&_c!==void 0?_c:15e3,proxy:opts.proxy,useCORS:(_d=opts.useCORS)!==null&&_d!==void 0?_d:!1},contextOptions=__assign({logging:(_e=opts.logging)!==null&&_e!==void 0?_e:!0,cache:opts.cache},resourceOptions),windowOptions={windowWidth:(_f=opts.windowWidth)!==null&&_f!==void 0?_f:defaultView.innerWidth,windowHeight:(_g=opts.windowHeight)!==null&&_g!==void 0?_g:defaultView.innerHeight,scrollX:(_h=opts.scrollX)!==null&&_h!==void 0?_h:defaultView.pageXOffset,scrollY:(_j=opts.scrollY)!==null&&_j!==void 0?_j:defaultView.pageYOffset},windowBounds=new Bounds(windowOptions.scrollX,windowOptions.scrollY,windowOptions.windowWidth,windowOptions.windowHeight),context=new Context(contextOptions,windowBounds),foreignObjectRendering=(_k=opts.foreignObjectRendering)!==null&&_k!==void 0?_k:!1,cloneOptions={allowTaint:(_l=opts.allowTaint)!==null&&_l!==void 0?_l:!1,onclone:opts.onclone,ignoreElements:opts.ignoreElements,inlineImages:foreignObjectRendering,copyStyles:foreignObjectRendering},context.logger.debug("Starting document clone with size "+windowBounds.width+"x"+windowBounds.height+" scrolled to "+-windowBounds.left+","+-windowBounds.top),documentCloner=new DocumentCloner(context,element,cloneOptions),clonedElement=documentCloner.clonedReferenceElement,clonedElement?[4,documentCloner.toIFrame(ownerDocument,windowBounds)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return container=_u.sent(),_a=isBodyElement(clonedElement)||isHTMLElement2(clonedElement)?parseDocumentSize(clonedElement.ownerDocument):parseBounds(context,clonedElement),width=_a.width,height=_a.height,left2=_a.left,top2=_a.top,backgroundColor2=parseBackgroundColor(context,clonedElement,opts.backgroundColor),renderOptions={canvas:opts.canvas,backgroundColor:backgroundColor2,scale:(_o=(_m=opts.scale)!==null&&_m!==void 0?_m:defaultView.devicePixelRatio)!==null&&_o!==void 0?_o:1,x:((_p=opts.x)!==null&&_p!==void 0?_p:0)+left2,y:((_q=opts.y)!==null&&_q!==void 0?_q:0)+top2,width:(_r=opts.width)!==null&&_r!==void 0?_r:Math.ceil(width),height:(_s=opts.height)!==null&&_s!==void 0?_s:Math.ceil(height)},foreignObjectRendering?(context.logger.debug("Document cloned, using foreign object rendering"),renderer=new ForeignObjectRenderer(context,renderOptions),[4,renderer.render(clonedElement)]):[3,3];case 2:return canvas=_u.sent(),[3,5];case 3:return context.logger.debug("Document cloned, element located at "+left2+","+top2+" with size "+width+"x"+height+" using computed rendering"),context.logger.debug("Starting DOM parsing"),root=parseTree(context,clonedElement),backgroundColor2===root.styles.backgroundColor&&(root.styles.backgroundColor=COLORS.TRANSPARENT),context.logger.debug("Starting renderer for element at "+renderOptions.x+","+renderOptions.y+" with size "+renderOptions.width+"x"+renderOptions.height),renderer=new CanvasRenderer(context,renderOptions),[4,renderer.render(root)];case 4:canvas=_u.sent(),_u.label=5;case 5:return(!((_t=opts.removeContainer)!==null&&_t!==void 0)||_t)&&(DocumentCloner.destroy(container)||context.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),context.logger.debug("Finished rendering"),[2,canvas]}})})},parseBackgroundColor=function(context,element,backgroundColorOverride){var ownerDocument=element.ownerDocument,documentBackgroundColor=ownerDocument.documentElement?parseColor(context,getComputedStyle(ownerDocument.documentElement).backgroundColor):COLORS.TRANSPARENT,bodyBackgroundColor=ownerDocument.body?parseColor(context,getComputedStyle(ownerDocument.body).backgroundColor):COLORS.TRANSPARENT,defaultBackgroundColor=typeof backgroundColorOverride=="string"?parseColor(context,backgroundColorOverride):backgroundColorOverride===null?COLORS.TRANSPARENT:4294967295;return element===ownerDocument.documentElement?isTransparent(documentBackgroundColor)?isTransparent(bodyBackgroundColor)?defaultBackgroundColor:bodyBackgroundColor:documentBackgroundColor:defaultBackgroundColor};return html2canvas2})}});function localizePage(){let msgPrefix="__MSG_";function getMessageFromTemplate(template,defaultVal=""){return template.replace(/__MSG_(\w+)__/g,(_match,v1)=>v1?chrome.i18n.getMessage(v1):defaultVal)}function updatePageTitle(){document.title.startsWith(msgPrefix)&&(document.title=getMessageFromTemplate(document.title,"Table Capture!"))}updatePageTitle(),Array.from(document.querySelectorAll(".tc18nValue")).forEach(el=>{let message=getMessageFromTemplate(el.value);el.value=message}),Array.from(document.querySelectorAll("._tc18n")).forEach(el=>{let message=getMessageFromTemplate(el.innerText);el.innerText=message}),Array.from(document.querySelectorAll("._tc18nHTML")).forEach(el=>{let message=getMessageFromTemplate(el.innerText);el.innerHTML=message})}document.addEventListener("DOMContentLoaded",localizePage);var BASE_API_URL="https://georgemike.com/api",MajorVersion=11,MinorVersion=14,EXT_PLATFORM="C",CurrentVersion=`${MajorVersion}.0.${MinorVersion}${EXT_PLATFORM}`,ReleaseName="Quin Snyder",SUPPORTS_CLOUD=!0,DEV_PRETEND_PRO=!1,DEV_PRETEND_CLOUD=!1;var DEV_DEBUG=!1;var CloudConfigKeys=["gptApiKey","gptTokensConsumed"],ExtractConfigKeys=["addNewLinesForParagraphs","csvDelimiter","deleteEmptyRows","extractImageSrc","getLinkUrls","inlineImagesGSheets","ignoreHiddenPageElements","ignoreHiddenTables","ignoreImages","moneyAsNumber","numberAsNumber","numDecimalChar","numThousandChar","redGreenExtract","removeStrikethroughs"],DurationConfigKeys=["autoScrollInterval","sheetSyncWriteInterval","autoPageWait"],AllConfigKeys=[...ExtractConfigKeys,...CloudConfigKeys,...DurationConfigKeys,"alwaysAllowColumnify","copyImagesToClipboard","enableGDriveWrite","enablePastePrompt","enableRequestSearch","enableUrlAutoPage","filenameTemplate","renderRowPreview","showDeveloperOptions","singleSheetExcelExport","useUnifiedPaging","onboarded","installDate","licenseCode","paidPro","paidCloud","cloudLicenseCode","requiresPaid","googleAuthToken","googleAuthRefreshToken","user","recipes"],DurationDefaultValues={autoScrollInterval:.75*1e3,sheetSyncWriteInterval:10*1e3,autoPageWait:3*1e3},CloudConfigDefaults={gptTokensConsumed:0,gptApiKey:null},UserConfigDefaults={...CloudConfigDefaults,...DurationDefaultValues,addNewLinesForParagraphs:!1,alwaysAllowColumnify:!1,copyImagesToClipboard:!1,csvDelimiter:",",deleteEmptyRows:!0,enableGDriveWrite:!1,enablePastePrompt:!0,enableRequestSearch:!1,enableUrlAutoPage:!1,extractImageSrc:!1,filenameTemplate:"",getLinkUrls:!1,ignoreHiddenPageElements:!0,ignoreHiddenTables:!0,ignoreImages:!1,inlineImagesGSheets:!1,moneyAsNumber:!1,numberAsNumber:!1,numDecimalChar:".",numThousandChar:",",redGreenExtract:!1,removeStrikethroughs:!1,renderRowPreview:!0,showDeveloperOptions:!1,singleSheetExcelExport:!1,useUnifiedPaging:!1,onboarded:!1,installDate:null,licenseCode:null,paidPro:!1,paidCloud:!1,paidProOrMore:!1,cloudLicenseCode:null,requiresPaid:!1,user:null,googleAuthToken:null,googleAuthRefreshToken:null,recipes:[]};var dotRe=/\./,lastDotRe=/\.[^.]*$/,space=" ",lineFeed=`
`,dash="-",dot=".",colon=":",lowercaseC="c",lowercaseL="l",lowercaseR="r",verticalBar="|",minCellSize=3;function markdownTable(table,options={}){var settings=options||{},delimiter=settings.delimiter,start2=settings.start,end2=settings.end,alignment=settings.align,calculateStringLength=settings.stringLength||lengthNoop,cellCount=0,rowIndex=-1,rowLength=table.length,sizes=[],align,rule,rows,row,cells,index,position,size,value,spacing,before,after;try{table&&table.length&&table.forEach((row2,i)=>{row2.forEach((cell,j)=>{cell.includes("|")&&(table[i][j]=cell.replace(/\|/g,"\\|"))})})}catch{}for(alignment=alignment?alignment.concat():[],delimiter==null&&(delimiter=space+verticalBar+space),start2==null&&(start2=verticalBar+space),end2==null&&(end2=space+verticalBar);++rowIndex<rowLength;)for(row=table[rowIndex],index=-1,row.length>cellCount&&(cellCount=row.length);++index<cellCount;)position=row[index]?dotindex(row[index]):null,sizes[index]||(sizes[index]=minCellSize),position>sizes[index]&&(sizes[index]=position);for(typeof alignment=="string"&&(alignment=pad(cellCount,alignment).split("")),index=-1;++index<cellCount;)align=alignment[index],typeof align=="string"&&(align=align.charAt(0).toLowerCase()),align!==lowercaseL&&align!==lowercaseR&&align!==lowercaseC&&align!==dot&&(align=""),alignment[index]=align;for(rowIndex=-1,rows=[];++rowIndex<rowLength;){for(row=table[rowIndex],index=-1,cells=[];++index<cellCount;)value=row[index],value=stringify(value),alignment[index]===dot?(position=dotindex(value),size=sizes[index]+(dotRe.test(value)?0:1)-(calculateStringLength(value)-position),cells[index]=value+pad(size-1)):cells[index]=value;rows[rowIndex]=cells}for(sizes=[],rowIndex=-1;++rowIndex<rowLength;)for(cells=rows[rowIndex],index=-1;++index<cellCount;)value=cells[index],sizes[index]||(sizes[index]=minCellSize),size=calculateStringLength(value),size>sizes[index]&&(sizes[index]=size);for(rowIndex=-1;++rowIndex<rowLength;){if(cells=rows[rowIndex],index=-1,settings.pad!==!1)for(;++index<cellCount;)value=cells[index],position=sizes[index]-(calculateStringLength(value)||0),spacing=pad(position),alignment[index]===lowercaseR||alignment[index]===dot?value=spacing+value:alignment[index]===lowercaseC?(position/=2,position%1===0?(before=position,after=position):(before=position+.5,after=position-.5),value=pad(before)+value+pad(after)):value+=spacing,cells[index]=value;rows[rowIndex]=cells.join(delimiter)}if(settings.rule!==!1){for(index=-1,rule=[];++index<cellCount;)settings.pad===!1?(value=table[0][index],spacing=calculateStringLength(stringify(value)),spacing=spacing>minCellSize?spacing:minCellSize):spacing=sizes[index],align=alignment[index],value=align===lowercaseR||align===""?dash:colon,value+=pad(spacing-2,dash),value+=align!==lowercaseL&&align!==""?colon:dash,rule[index]=value;rows.splice(1,0,rule.join(delimiter))}return start2+rows.join(end2+lineFeed+start2)+end2}function stringify(value){return value==null?"":String(value)}function lengthNoop(value){return String(value).length}function pad(length,character=" "){return new Array(length+1).join(character||space)}function dotindex(value){var match=lastDotRe.exec(value);return match?match.index+1:value.length}var TABULAR_COPY_CONST={rowSeparator:`\r
`,colSeparator:"	"};function arrayOfArraysToString(arrayOfArrays,rowSeparator,colSeparator){return arrayOfArrays.map(row=>row.join(colSeparator)).join(rowSeparator)}function postProcessFinalString(str,outputFormat,rowSeparator,colSeparator,extractConfig){if(!str||!str.trim())return str;if(outputFormat=="MARKDOWN"){let asArray=stringToArrayOfArrays(str,rowSeparator,colSeparator);return markdownTable(asArray)}if((outputFormat=="GOOG"||outputFormat=="OFFICE365")&&str.includes('"')){let beginsWithCleaner=new RegExp(/$"/,"g"),rowBeginsWithCleaner=new RegExp(rowSeparator+'"',"g"),colBeginsWithCleaner=new RegExp(colSeparator+'"',"g");str=str.replace(beginsWithCleaner,'""""'),str=str.replace(rowBeginsWithCleaner,`${rowSeparator}""""`),str=str.replace(colBeginsWithCleaner,`${colSeparator}""""`)}if(outputFormat=="GOOG"&&!!extractConfig.inlineImagesGSheets){let imageCellRegex=new RegExp(`(^|${colSeparator})(http.*?)(.png|.jpg|.jpeg|.gif)`,"g");str=str.replace(imageCellRegex,'$1=IMAGE("$2$3", 1)')}return str}function stringToArrayOfArrays(str,rowSeparator,colSeparator){return str?str.split(rowSeparator).map(s=>s.split(colSeparator)):[]}var ExtensionId="iebpjdmgckacbodjpijphcplhebcmeop",ExtBase=`chrome-extension://${ExtensionId}`,ChromeExtBase="chrome-extension://",DiscordInvite="https://discord.gg/JWzDVSNBgC",ReviewLink="https://chromewebstore.google.com/detail/table-capture/iebpjdmgckacbodjpijphcplhebcmeop",SupportMailTo="mailto:support@georgemike.com?subject=Table%20Capture",NewsletterUrl="http://eepurl.com/dmo_QT";var RoadmapUrl="https://docs.google.com/document/d/10wM8tSyatRIlKGM7bYYBHLbfCZANuO5ewoX2SnC8HMs/edit",RecipesDocUrl="https://docs.google.com/document/d/1bxJNXozYSA_zld8QVA92QhSP5wUA5BMOC5A5h8HZm5o/edit";var _tcBasePath=null,_tcCurrentPath=null;function getBasePath(){return(!_tcBasePath||!_tcCurrentPath)&&(_tcCurrentPath=window.location.href.split("/").slice(0,-1).join("/")+"/",_tcBasePath=window.location.origin),{basePath:_tcBasePath,currentPath:_tcCurrentPath}}function applyBasePath(href){if(!href||!href.trim()||href.startsWith("javascript:")||href.startsWith("blob:")||href.startsWith("data:"))return null;if(href.startsWith("mailto:"))return href.split("&")[0].split("?")[0].split(":")[1].trim();let{basePath,currentPath}=getBasePath();return href.indexOf("/")===0?basePath+href:href.startsWith("http")||href.includes("://")?href:currentPath+href}function _tcInPlaceNumberization(data,numDecimalChar,numThousandChar){data.forEach((row,i)=>{row.forEach((cell,j)=>{_tcIsStringNumeric(cell,[numDecimalChar,numThousandChar])&&(data[i][j]=_tcStringToNumber(cell,numDecimalChar,numThousandChar))})})}function _tcIsStringNumeric(str,extraChars=[]){return str==null||typeof str!="string"?!1:(extraChars.forEach(c=>{str=str.replace(new RegExp("\\"+c,"g"),"")}),!isNaN(Number(str))&&!isNaN(parseFloat(str)))}function _tcStringToNumber(str,numDecimalChar,numThousandChar){let originalStr=str;try{return str=str.replace(new RegExp("\\"+numThousandChar,"g"),""),str=str.replace(new RegExp("\\"+numDecimalChar,"g"),"."),parseFloat(str)}catch{}return originalStr}function getIntAttribute(element,attributeName,defaultValue){let value=element.getAttribute(attributeName);if(value===null)return defaultValue;try{return parseInt(value,10)}catch{return defaultValue}}function _tcGetPathTo(element){if(!element)return null;if(element===document.body)return"/html[1]/body[1]";if(element.id)return`//*[@id="${element.id}"]`;if(tagNameCompare(element,"html"))return"/html[1]";if(!element.parentNode)return"//*";let ix=0,siblings=element.parentNode.childNodes;for(let i=0;i<siblings.length;i++){let sibling=siblings[i];if(sibling===element){let lcTagName=element.tagName.toLowerCase();return _tcGetPathTo(element.parentNode)+`/${lcTagName}[${ix+1}]`}sibling.nodeType===1&&tagNameCompare(sibling,element)&&ix++}return null}function _tcGetElementByXpath(path,doc=null){if(!path)return null;if(doc=doc||document,typeof path=="string")return doc.evaluate(path,doc,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;for(;path.length;){let exhaustivePath=path.shift(),el=doc.evaluate(exhaustivePath,doc,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(el)return el}return null}function getUCNodeName(node){return node&&node.nodeName?node.nodeName.toUpperCase():""}function _tcSpecificGetSelectorForEl(el){if(!el)return null;let selector="",lcTagName=el.tagName.toLowerCase(),classes=Array.from(el.classList).filter(className=>!className.startsWith("_tc_"));classes.length===1?selector=`${lcTagName}.${classes[0]}`:el.id?selector=`#${el.id}`:selector=`${lcTagName}.${classes.join(".")}`;let{element:matchingElement}=_tcGetSingleElementBySelector(selector);return matchingElement?selector:null}function _tcGetSingleElementBySelector(selectorOrXpath,orMatchingInnerText=null){if(!selectorOrXpath||typeof selectorOrXpath!="string")return{element:null,count:0};try{if(selectorOrXpath=selectorOrXpath.trim(),selectorOrXpath.startsWith("/"))return{element:_tcGetElementByXpath(selectorOrXpath),count:0};let matchingElements=Array.from(document.querySelectorAll(selectorOrXpath));if(matchingElements.length===1)return{element:matchingElements[0],count:1};if(orMatchingInnerText){let matchingInnerTextElements=matchingElements.filter(e=>e.textContent===orMatchingInnerText);if(matchingInnerTextElements.length===1)return{element:matchingInnerTextElements[0],count:1}}return{element:null,count:matchingElements.length}}catch{}return{element:null,count:0}}function tagNameCompare(a,b){try{if(a===b)return!0;if(a===void 0||b===void 0||a===null||b===null)return!1;let tagName=null;if(typeof a=="object"&&"tagName"in a&&a.tagName?tagName=a.tagName.toUpperCase():typeof a=="string"&&(tagName=a.toUpperCase()),typeof b=="string")return tagName===b.toUpperCase();if(typeof b=="object"){if("tagName"in b&&b.tagName)return tagName===b.tagName.toUpperCase();if("length"in b&&b.length&&b.length>0)return b.some(tagNameB=>tagNameCompare(tagName,tagNameB))}}catch{}return!1}function tableNodeToString(table,rowSeparator,colSeparator,userConfig,isRootTable=void 0){if(!table)return"";let array=nodeToArrays(table,rowSeparator,colSeparator,userConfig,isRootTable);return arrayOfArraysToString(array,rowSeparator,colSeparator)}function nodeToArrays(node,rowSeparator,colSeparator,userConfig,isRootTable=void 0){let rows=_tcNodeToStringRoot(node,rowSeparator,colSeparator,userConfig,isRootTable,{trimTrailingColSep:!0}).split(rowSeparator),finalArray=[];for(var i=0;i<rows.length;i++){let cols=rows[i].split(colSeparator);if(i==rows.length-1&&cols.length==1&&!cols[0])break;finalArray.push(cols)}if(tagNameCompare(node,"TABLE")){let tableNode=node,rowSpanEls=Array.from(tableNode.querySelectorAll('*[rowspan]:not([rowspan=""])'));rowSpanEls&&rowSpanEls.length&&_tcPopulateRowspanVals(finalArray,tableNode,rowSpanEls,userConfig.deleteEmptyRows)}return finalArray}function _tcNodeToStringRoot(node,rowSeparator,colSeparator,userConfig,isRootTable=void 0,postOpts){let str=_tcNodeToString(node,rowSeparator,colSeparator,userConfig,isRootTable);if(postOpts.trimTrailingColSep&&str){let cleaner=new RegExp(colSeparator+rowSeparator,"g");str=str.replace(cleaner,rowSeparator)}if(postOpts.trimLastRowColSep&&str&&str.endsWith(colSeparator)){let cleaner=new RegExp(colSeparator+"$","g");str=str.replace(cleaner,"")}return str}function _tcNodeToString(node,rowSeparator,colSeparator,userConfig,isRootTable=void 0){let str="";if(!node)return"";let newLinesAsSpaces=!0,{addNewLinesForParagraphs,deleteEmptyRows,extractImageSrc,getLinkUrls,ignoreImages,inlineImagesGSheets,moneyAsNumber,redGreenExtract}=userConfig,ucNodeName=getUCNodeName(node);if(ucNodeName==="TC-WORKSHOP"||ucNodeName==="SCRIPT"||ucNodeName==="NOSCRIPT"||ucNodeName==="STYLE")return"";if(addNewLinesForParagraphs&&ucNodeName==="BR")return"|";if(_tcIsElementHidden(node,userConfig))return"";if(ucNodeName==="SELECT")return _tcSelectToString(node);if(ucNodeName==="TEXTAREA")return _tcTextareaToString(node);if(addNewLinesForParagraphs&&(ucNodeName==="PRE"||ucNodeName==="CODE")){let preVal=node.innerText.trim();return preVal=preVal.replace(new RegExp("\\n","g"),"\u2602"),preVal}if(ucNodeName==="TABLE"&&isRootTable===!1){let subTableString=_tcNodeToString(node,rowSeparator,colSeparator,userConfig,!0);return _tcTableStringToCellString(subTableString,rowSeparator,colSeparator)}if(!ignoreImages&&extractImageSrc&&ucNodeName==="I"&&node.childNodes.length===0&&!node.innerHTML)return window.getComputedStyle(node,":before").getPropertyValue("content")&&node.classList.length?Array.from(node.classList).join("_"):"";if(!ignoreImages&&ucNodeName==="SPAN"&&node.getAttribute("role")==="img"&&node.getAttribute("aria-label"))return node.getAttribute("aria-label")??"";let tfoot=null;if(node.childNodes.length){let child=node.firstChild;for(;child;){if(_tcIsElementHidden(child,userConfig)){child=child.nextSibling;continue}let ucTag=child.nodeName.toUpperCase(),nodeStringValue=_tcNodeToString(child,rowSeparator,colSeparator,userConfig,!1);if(ucTag=="TR")deleteEmptyRows&&isNodeValueEmptyRow(nodeStringValue,colSeparator)||(str+=nodeStringValue+rowSeparator);else if(ucTag=="TD"||ucTag=="TH")nodeStringValue=nodeStringValue.trim(),moneyAsNumber&&(nodeStringValue=maybeCleanMoneyValue(nodeStringValue)),_tcIsCellNumberWeird(nodeStringValue)&&(nodeStringValue="'"+nodeStringValue),str+=nodeStringValue+getTDSeparation(child,colSeparator);else if(ucTag==="CAPTION"&&ucNodeName==="TABLE")deleteEmptyRows&&(!nodeStringValue||!nodeStringValue.trim())||(str+=nodeStringValue+rowSeparator);else if(ucTag==="TFOOT")tfoot=nodeStringValue;else if(_tcIsSpaceNeeded(str,rowSeparator,colSeparator)&&(str+=" "),str+=nodeStringValue,getLinkUrls&&ucTag=="A"){_tcIsSpaceNeeded(str,rowSeparator,colSeparator)&&(str+=" ");let href=child.getAttribute("href");if(href){let url=applyBasePath(href);url&&(str+=`(${url})`)}}else ucTag==="INPUT"?str+=_tcInputToString(child):(ucTag==="IMG"||ucTag==="SVG"&&ignoreImages)&&(str+=_tcImageToString(extractImageSrc,ignoreImages,inlineImagesGSheets,child));child=child.nextSibling}}else ucNodeName=="#TEXT"&&node.nodeValue&&(str+=_tcTextNodeVal(node,newLinesAsSpaces,redGreenExtract).trim());return addNewLinesForParagraphs&&ucNodeName==="P"&&node.nextElementSibling&&(str+="|"),tfoot&&(str+=tfoot,tfoot=null),str}function _tcIsInRedSpace(r,g,b){return r>g&&r>b&&r-g>50&&r-b>50}function _tcIsInGreenSpace(r,g,b){return g>r&&g>b&&g-r>50&&g-b>50}function _tcIsRGBColorInColorSpace(color){let rgb=color.match(/\d+/g),inRedSpace=!1,inGreenSpace=!1;if(rgb){let r=parseInt(rgb[0],10),g=parseInt(rgb[1],10),b=parseInt(rgb[2],10);inRedSpace=_tcIsInRedSpace(r,g,b),inGreenSpace=_tcIsInGreenSpace(r,g,b)}return{inRedSpace,inGreenSpace}}function _tcTextNodeVal(textNode,newLinesAsSpaces=!1,redGreenExtract=!1){let re_n=new RegExp("\\n","g"),re_t=new RegExp("\\t","g"),tempStr=textNode.nodeValue??"";if(tempStr=tempStr.replace(re_t,""),newLinesAsSpaces?(tempStr=tempStr.replace(re_n," "),tempStr=tempStr.trim()):tempStr=tempStr.replace(re_n,""),redGreenExtract&&tempStr&&textNode.parentElement)try{let node=textNode.parentElement,computedStyle=window.getComputedStyle(node),{color,backgroundColor}=computedStyle,{inRedSpace:colorInRedSpace,inGreenSpace:colorInGreenSpace}=_tcIsRGBColorInColorSpace(color),{inRedSpace:bgInRedSpace,inGreenSpace:bgInGreenSpace}=_tcIsRGBColorInColorSpace(backgroundColor);colorInRedSpace?tempStr+=" (red)":colorInGreenSpace?tempStr+=" (green)":bgInRedSpace?tempStr+=" (bg-red)":bgInGreenSpace&&(tempStr+=" (bg-green)")}catch{}return tempStr}function _tcTextareaToString(el){return el.value}function _tcSelectToString(el){if(!el.options||el.options.length===0||el.selectedIndex<0)return"";let index=el.selectedIndex||0;return el.options[index].text.trim()}function _tcTableStringToCellString(str,rowSeparator,colSeparator){if(!str)return"";let noNeed=new RegExp(`(${rowSeparator}(\\s+)?)+$`,"g"),colToSpace=new RegExp(colSeparator,"g"),rowToNewLine=new RegExp(rowSeparator,"g");return str=str.replace(noNeed,""),str=str.replace(colToSpace," "),str=str.replace(rowToNewLine," <> "),str.trim()}function _tcInputToString(child){let validTypes=["text","checkbox","number","email","search","tel","url","range","color","date","datetime","datetime-local","time","month","week"],type=child.type&&child.type.toLowerCase();return validTypes.includes(type)?type==="checkbox"?!!child.checked+"":child.hasAttribute("value")?child.value:"":""}function _tcImageToString(extractImageSrc,ignoreImages,inlineImagesGSheets,child){if(ignoreImages)return"";if((extractImageSrc||inlineImagesGSheets)&&child.src){let imageSrc=child.src;return imageSrc.includes(ExtBase)&&(imageSrc=imageSrc.replace(ExtBase,"")),imageSrc.includes(ChromeExtBase)&&(imageSrc=imageSrc.replace(ChromeExtBase,"")),inlineImagesGSheets&&imageSrc?imageSrc:child.alt?`${child.alt} (${imageSrc})`:imageSrc}return child.alt?child.alt:""}function _tcComputeEffectiveColIndex(tr,td){let cells=Array.from(tr.children),index=cells.indexOf(td);if(index===-1)return index;let precedingColSpans=cells.slice(0,index).map(cell=>getIntAttribute(cell,"colspan",1)).filter(spanval=>spanval>1).map(spanvalOver1=>spanvalOver1-1),bumpCount=0;return precedingColSpans.forEach(val=>bumpCount+=val),index+bumpCount}function _tcGetNonNestedTableRows(tr,deleteEmptyRows){let table=tr;for(;table&&table.tagName.toUpperCase()!=="TABLE";)table=table.parentElement;if(!table)return[];let rows=[],head=table.querySelector("thead");head&&(rows=rows.concat(Array.from(head.children)));let body=table.querySelector("tbody");return body&&(rows=rows.concat(Array.from(body.children))),deleteEmptyRows&&(rows=rows.filter(r=>!!r.childElementCount)),rows}function _tcPopulateRowspanVals(array,table,rowspans,deleteEmptyRows){if(!rowspans||rowspans.length===0||!table||!array||array.length===0)return;let absRows={};Array.from(rowspans).forEach(rowspan=>{let colShift=1,spanCount=0;try{spanCount=getIntAttribute(rowspan,"rowspan",0),colShift=getIntAttribute(rowspan,"colspan",1)}catch{}if(spanCount<=1)return;let rowspanParent=rowspan.parentElement;if(!tagNameCompare(rowspanParent,"TR"))return;let tr=rowspanParent,rows=_tcGetNonNestedTableRows(tr,deleteEmptyRows),rowIndex=Array.from(rows).indexOf(tr);if(rowIndex===-1||rowIndex>=array.length)return;let colIndex=_tcComputeEffectiveColIndex(tr,rowspan);if(colIndex===-1||colIndex>=array[rowIndex].length)return;let val=array[rowIndex][colIndex];for(var i=rowIndex+1;i<rowIndex+spanCount;i++){for(absRows[i]||(absRows[i]={});absRows[i].hasOwnProperty(colIndex);)colIndex++;absRows[i][colIndex]=val;for(let j=1;j<colShift;j++)absRows[i][colIndex+j]=""}}),Object.keys(absRows).forEach(rowIndex=>{let rowIndexN=Number(rowIndex);Object.keys(absRows[rowIndexN]).forEach(colIndex=>{let colIndexN=Number(colIndex);array[rowIndexN]&&array[rowIndexN].splice(colIndexN,0,absRows[rowIndexN][colIndexN])})})}function _tcIsPageExtensionPage(){if(window&&window.location){let url=window.location.href;return url.startsWith("chrome")||url.startsWith("edge")||url.startsWith("moz-extension")}return!1}function _tcIsElementHidden(el,{ignoreHiddenPageElements,removeStrikethroughs,paidProOrMore}){if(!el)return!0;let style=null;if(ignoreHiddenPageElements){if(el.classList&&el.classList.contains("sr-only"))return!0;if(_tcIsPageExtensionPage())return!1;if(el.offsetParent===null&&(style=window.getComputedStyle(el),style.display==="none"))return!0}return!!(paidProOrMore&&removeStrikethroughs&&el.nodeName!=="#text"&&(style||(style=window.getComputedStyle(el)),style.textDecoration.includes("line-through")))}function isNodeValueEmptyRow(str,colSeparator){return!str||!str.trim()?!0:str===colSeparator}function _tcIsCellNumberWeird(str){return!str||!str.trim()?!1:str[0]!=="+"?_tcIsCellNumberEuroZeroLeading(str):isNaN(Number(str))}function _tcIsCellNumberEuroZeroLeading(str){return str?(str=str.trim(),str.includes(",")&&str.startsWith("0")&&!str.includes(" ")):!1}function _tcIsSpaceNeeded(str,rowSeparator,colSeparator){if(!str)return!1;let lastCharacter=str[str.length-1],penultimateCharacter=str.length>1?str[str.length-2]:null;return lastCharacter===rowSeparator||lastCharacter===colSeparator||penultimateCharacter+lastCharacter===rowSeparator?!1:lastCharacter!==" "}function extractNumber(value,locale=navigator.language){let example=Intl.NumberFormat(locale).format(1.1),cleanPattern=new RegExp(`[^-+0-9${example.charAt(1)}]`,"g"),normalized=value.replace(cleanPattern,"").replace(example.charAt(1),".");return parseFloat(normalized)}function getTDSeparation(node,colSeparator){if(node&&colSeparator)try{let colspanstr=node.getAttribute("colspan"),spanCount=colspanstr?parseInt(colspanstr,10):1;return spanCount<1?colSeparator:colSeparator.repeat(spanCount)}catch{}return colSeparator}function maybeCleanMoneyValue(stringVal){if(!stringVal||stringVal.length<2)return stringVal;let CCY_SYMBOLS="\u060B\u058F\u0192$\u20BC\u09F3\u0E3F\xA5\u20A1\u20B1\u039E\u20AC\u20BE\xA3\u20B5\u20AA\u20B9\uFDFC\u17DB\u20AD\u20A8\u0141\u20AE\u20A6\uFFE5\u20BD\u20A4\u20BA\u20B4\u20AB\u0243\u20A3",hasMoneySym=!1;for(var i=0;i<CCY_SYMBOLS.length;i++){let symbol=CCY_SYMBOLS[i];stringVal.includes(symbol)&&(hasMoneySym=!0)}if(hasMoneySym){let regex=new RegExp(`[${CCY_SYMBOLS}]+`,"g"),cleanVal=stringVal.replace(regex,"").trim(),matches=cleanVal.match(/[0-9.,+\-]+/);if(matches&&matches.length&&matches[0]===cleanVal)try{return extractNumber(cleanVal)+""}catch{}}return stringVal}function swallowError(err,context){try{DEV_DEBUG&&console.log(`${context} Error Caught: `,err)}catch{}}var StorageWrapper=class{set(key){throw new Error("StorageWrapper -> set not supported")}get(key){throw new Error("StorageWrapper -> get not supported")}remove(key){throw new Error("StorageWrapper -> remove not supported")}getMaxItems(){return chrome.storage.sync.MAX_ITEMS}getItemByteQuota(){return chrome.storage.sync.QUOTA_BYTES_PER_ITEM}};var ChromeStorageWrapper=class extends StorageWrapper{api_;constructor(api){super(),this.api_=api}removeP(key){return new Promise(resolve=>{this.api_.remove(key,resolve)})}setP(values){return new Promise((resolve,reject)=>{this.api_.set(values,response=>{hasRuntimeError()?reject(getRuntimeError()):resolve(response)})})}getP(keyOrObj){return new Promise(resolve=>{this.api_.get(keyOrObj,resolve)})}},ChromeSyncStorageWrapper=class extends ChromeStorageWrapper{constructor(){super(chrome.storage.sync)}},ChromeLocalStorageWrapper=class extends ChromeStorageWrapper{constructor(){super(chrome.storage.local)}};function hasRuntimeError(){return!!chrome.runtime.lastError}function isPageOnboardingPage(url){return!!url&&url.startsWith("chrome-extension://")&&url.includes("onboard/onboard.html")}function getRuntimeError(){return chrome.runtime.lastError}function getSyncStorageApi(){return new ChromeSyncStorageWrapper}function getLocalStorageApi(){return new ChromeLocalStorageWrapper}var TableActionLogger=class{userConfig_;extractConfig_;localStorageApi_;constructor(userConfig){this.userConfig_=userConfig,this.extractConfig_={...userConfig},this.localStorageApi_=getLocalStorageApi()}initLogDataForUrl_(logData,url,title){logData.version||(logData.version="5.2"),logData[url]||(logData[url]={url,title,actionCount:0,elements:{}})}logGptTokensUsed(tokenCounts){return this.localStorageApi_.getP("gptTokensConsumed").then(values=>{let sum=values.gptTokensConsumed||0;return tokenCounts.forEach(count=>sum+=count),this.localStorageApi_.setP({gptTokensConsumed:sum})})}logPublishableTableAction(publishableTable,tcAction){if(publishableTable.paged)return this.logPagedTableAction_(publishableTable,tcAction);if(publishableTable.dynamic)return this.logDynamicTableAction_(publishableTable,tcAction);let{sourceUrl:url,pageTitle,tableDef,treatAsTable}=publishableTable;return url?this.getLogDataForPage_(url,pageTitle).then(logData=>{let{pathTo}=tableDef,key=`dom://${pathTo}`,name=this.getTableName_(pageTitle,tableDef);return logData[url].elements[key]||(logData[url].elements[key]={key,name,paged:!1,dynamic:!1,actionCount:0,repros:[]}),logData[url].actionCount++,logData[url].elements[key].actionCount++,logData[url].elements[key].repros.push({...tcAction,url,pathTo,treatAsTable,extractConfig:this.extractConfig_,timestamp:Date.now()}),this.localStorageApi_.setP({[LogKey]:logData})}).catch(err=>this.handleError_(err)):Promise.reject("No URL present.")}logPagedTableAction_(publishableTable,tcAction){let{sourceUrl:url,pageTitle}=publishableTable;return url?this.getLogDataForPage_(url,pageTitle).then(logData=>{let pagingDef=publishableTable.pagingDef,key=`dom://${pagingDef.pathToElement}`;return logData[url].elements[key]||(logData[url].elements[key]={key,name:`Multi-page Table (Pages: ${publishableTable.pages})`,paged:!0,dynamic:!1,actionCount:0,repros:[]}),logData[url].actionCount++,logData[url].elements[key].actionCount++,logData[url].elements[key].repros.push({...tcAction,url,pagingDef,paged:!0,pages:publishableTable.pages,extractConfig:this.extractConfig_,timestamp:Date.now()}),this.localStorageApi_.setP({[LogKey]:logData})}).catch(err=>this.handleError_(err)):Promise.reject("No URL present.")}logDynamicTableAction_(publishableTable,tcAction){let{sourceUrl:url,pageTitle}=publishableTable;return url?this.getLogDataForPage_(url,pageTitle).then(logData=>this.localStorageApi_.setP({[LogKey]:logData})).catch(err=>this.handleError_(err)):Promise.reject("No URL present.")}logWrapperAction(tableWrapper,tcAction){let{url,pageTitle,def}=tableWrapper.getDirect();return this.logActionForTableWrapperDefs_(tcAction,url,pageTitle,[def],tableWrapper.getReproOptions())}logWrapperDefAction(tableWrapperDefs,tcAction,url,pageTitle){return this.logActionForTableWrapperDefs_(tcAction,url,pageTitle,tableWrapperDefs,null)}logActionForTableWrapperDefs_(tcAction,url,title,defs,reproOptions){if(!url)return Promise.reject("No URL present.");let tcTableDefs=defs.map(def=>{let{index,table,pathTo}=def;if(table){let{id,adjusted:name}=table;return{id,index,pathTo,name}}else if(pathTo){let{id,name}=def;return{id,index,pathTo,name}}throw new Error("TableActionLogger::error - fallthrough")});return this.logActionForTCTableDefs_(tcAction,url,title,tcTableDefs,reproOptions)}logActionForTCTableDefs_(tcAction,url,title,tcTableDefs,reproOptions){return this.getLogDataForPage_(url,title).then(logData=>(tcTableDefs.forEach(tcTableDef=>{let{id,name,index,pathTo}=tcTableDef,key=`dom://${pathTo}`;(!logData[url].elements[key]||name&&logData[url].elements[key].name!=name||logData[url].elements[key].id!=id)&&(logData[url].elements[key]={key,actionCount:0,repros:[],id,pathTo,index,name,paged:!1,dynamic:!1}),logData[url].actionCount++,logData[url].elements[key].actionCount++,logData[url].elements[key].repros.push({...tcAction,...reproOptions,url,pathTo,index,extractConfig:this.extractConfig_,timestamp:Date.now()})}),this.localStorageApi_.setP({[LogKey]:logData}))).catch(err=>this.handleError_(err))}getTableName_(pageTitle,tableDef){if(tableDef){if(tableDef.adjusted)return tableDef.adjusted;if(tableDef.id)return`Table (#${tableDef.id})`;if(tableDef.rows)return`Table (rows: ${tableDef.rows})`}return pageTitle?`Table (${pageTitle})`:"Table (N/A)"}getLogDataForUrlAndDef(url,tableDef){return!tableDef||!url?Promise.resolve(null):this.getLogDataForUrl(url).then(logData=>{let{pathTo}=tableDef,key=`dom://${pathTo}`;if(logData.elements)return logData.elements[key]})}getLogDataForUrl(url){return this.localStorageApi_.getP(LogKey).then(values=>(values[LogKey]||{})[url])}getLogDataForPage_(url,title){return this.localStorageApi_.getP(LogKey).then(values=>{let logData=values[LogKey]||{};return this.initLogDataForUrl_(logData,url,title),logData})}handleError_(err){console.error(err)}};var LogKey="tcapLog";function _tcLogTableWrapperMessageAction(tableWrapper,messageAction,outputFormat=null,userConfig){new TableActionLogger(userConfig).logWrapperAction(tableWrapper,{messageAction,outputFormat:outputFormat??void 0})}function s2ab(s){if(typeof ArrayBuffer<"u"){let buf=new ArrayBuffer(s.length);for(var view=new Uint8Array(buf),i=0;i!=s.length;++i)view[i]=s.charCodeAt(i)&255;return buf}else{let buf=new Array(s.length);for(var i=0;i!=s.length;++i)buf[i]=s.charCodeAt(i)&255;return buf}}function removeBase64Prefix(base64String){if(!base64String||base64String==="data:")return"";let prefix="base64,",index=base64String.indexOf(prefix);return index===-1?base64String:base64String.substring(index+prefix.length)}function base64ToUint8Array(base64){if(base64=removeBase64Prefix(base64),!base64)return null;let raw=atob(base64),uint8Array=new Uint8Array(new ArrayBuffer(raw.length));for(let i=0;i<raw.length;i++)uint8Array[i]=raw.charCodeAt(i);return uint8Array}async function canUseClipboard(){try{let permissionStatus=await navigator.permissions.query({name:"clipboard-write"});return permissionStatus.state==="granted"||permissionStatus.state==="prompt"}catch{return!1}}function copyImageToClipboard(data){let blob=new Blob([base64ToUint8Array(data)],{type:"image/png"}),item=new ClipboardItem({"image/png":blob});navigator.clipboard.write([item])}function copyToClipboardNew(data){if(!navigator.clipboard)throw new Error("Clipboard API not available");return navigator.clipboard.writeText(data)}function copyToClipboard(data){if(data===null)throw new Error("No data present");function createTextArea(value){let txt=document.createElement("textarea");return txt.className="offscreeneded",txt.value=value,document.body.appendChild(txt),txt}try{let txt=createTextArea(data);txt.select();let success=document.execCommand("copy");if(document.body.removeChild(txt),!success)throw new Error("Copy failed")}catch(err){throw err}}function isBehindOtherElement(element,falseIfNotCenterable){if(!element)return!1;let boundingRect=element.getBoundingClientRect();if(falseIfNotCenterable&&boundingRect.height>window.innerHeight)return!1;let left2=boundingRect.left+1,right2=boundingRect.right-1,top2=boundingRect.top+1,bottom2=boundingRect.bottom-1;return document.elementFromPoint(left2,top2)!==element||document.elementFromPoint(right2,top2)!==element||document.elementFromPoint(left2,bottom2)!==element||document.elementFromPoint(right2,bottom2)!==element}var import_file_saver=__toESM(require_FileSaver_min(),1);var XLSX={};XLSX.version="0.20.2";var current_codepage=1200,current_ansi=1252,$cptable,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(cp){VALID_ANSI.indexOf(cp)!=-1&&(current_ansi=CS2CP[0]=cp)};function reset_ansi(){set_ansi(1252)}var set_cp=function(cp){current_codepage=cp,set_ansi(cp)};function reset_cp(){set_cp(1200),reset_ansi()}function utf16beread(data){for(var o=[],i=0;i<data.length>>1;++i)o[i]=String.fromCharCode(data.charCodeAt(2*i+1)+(data.charCodeAt(2*i)<<8));return o.join("")}var _getchar=function(x){return String.fromCharCode(x)},_getansi=function(x){return String.fromCharCode(x)};var DENSE=null,DIF_XL=!0,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(input){for(var o="",c1=0,c2=0,c3=0,e1=0,e2=0,e3=0,e4=0,i=0;i<input.length;)c1=input.charCodeAt(i++),e1=c1>>2,c2=input.charCodeAt(i++),e2=(c1&3)<<4|c2>>4,c3=input.charCodeAt(i++),e3=(c2&15)<<2|c3>>6,e4=c3&63,isNaN(c2)?e3=e4=64:isNaN(c3)&&(e4=64),o+=Base64_map.charAt(e1)+Base64_map.charAt(e2)+Base64_map.charAt(e3)+Base64_map.charAt(e4);return o}function Base64_encode_pass(input){for(var o="",c1=0,c2=0,c3=0,e1=0,e2=0,e3=0,e4=0,i=0;i<input.length;)c1=input.charCodeAt(i++),c1>255&&(c1=95),e1=c1>>2,c2=input.charCodeAt(i++),c2>255&&(c2=95),e2=(c1&3)<<4|c2>>4,c3=input.charCodeAt(i++),c3>255&&(c3=95),e3=(c2&15)<<2|c3>>6,e4=c3&63,isNaN(c2)?e3=e4=64:isNaN(c3)&&(e4=64),o+=Base64_map.charAt(e1)+Base64_map.charAt(e2)+Base64_map.charAt(e3)+Base64_map.charAt(e4);return o}function Base64_encode_arr(input){for(var o="",c1=0,c2=0,c3=0,e1=0,e2=0,e3=0,e4=0,i=0;i<input.length;)c1=input[i++],e1=c1>>2,c2=input[i++],e2=(c1&3)<<4|c2>>4,c3=input[i++],e3=(c2&15)<<2|c3>>6,e4=c3&63,isNaN(c2)?e3=e4=64:isNaN(c3)&&(e4=64),o+=Base64_map.charAt(e1)+Base64_map.charAt(e2)+Base64_map.charAt(e3)+Base64_map.charAt(e4);return o}function Base64_decode(input){var o="",c1=0,c2=0,c3=0,e1=0,e2=0,e3=0,e4=0;if(input.slice(0,5)=="data:"){var i=input.slice(0,1024).indexOf(";base64,");i>-1&&(input=input.slice(i+8))}input=input.replace(/[^\w\+\/\=]/g,"");for(var i=0;i<input.length;)e1=Base64_map.indexOf(input.charAt(i++)),e2=Base64_map.indexOf(input.charAt(i++)),c1=e1<<2|e2>>4,o+=String.fromCharCode(c1),e3=Base64_map.indexOf(input.charAt(i++)),c2=(e2&15)<<4|e3>>2,e3!==64&&(o+=String.fromCharCode(c2)),e4=Base64_map.indexOf(input.charAt(i++)),c3=(e3&3)<<6|e4,e4!==64&&(o+=String.fromCharCode(c3));return o}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var nbfs=!Buffer.from;if(!nbfs)try{Buffer.from("foo","utf8")}catch{nbfs=!0}return nbfs?function(buf,enc){return enc?new Buffer(buf,enc):new Buffer(buf)}:Buffer.from.bind(Buffer)}return function(){}}(),buf_utf16le=function(){if(typeof Buffer>"u")return!1;var x=Buffer_from([65,0]);if(!x)return!1;var o=x.toString("utf16le");return o.length==1}();function new_raw_buf(len){return has_buf?Buffer.alloc?Buffer.alloc(len):new Buffer(len):typeof Uint8Array<"u"?new Uint8Array(len):new Array(len)}function new_unsafe_buf(len){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(len):new Buffer(len):typeof Uint8Array<"u"?new Uint8Array(len):new Array(len)}var s2a=function(s){return has_buf?Buffer_from(s,"binary"):s.split("").map(function(x){return x.charCodeAt(0)&255})};function s2ab2(s){if(typeof ArrayBuffer>"u")return s2a(s);for(var buf=new ArrayBuffer(s.length),view=new Uint8Array(buf),i=0;i!=s.length;++i)view[i]=s.charCodeAt(i)&255;return buf}function a2s(data){if(Array.isArray(data))return data.map(function(c){return String.fromCharCode(c)}).join("");for(var o=[],i=0;i<data.length;++i)o[i]=String.fromCharCode(data[i]);return o.join("")}function a2u(data){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(data)}var bconcat=has_buf?function(bufs){return Buffer.concat(bufs.map(function(buf){return Buffer.isBuffer(buf)?buf:Buffer_from(buf)}))}:function(bufs){if(typeof Uint8Array<"u"){var i=0,maxlen=0;for(i=0;i<bufs.length;++i)maxlen+=bufs[i].length;var o=new Uint8Array(maxlen),len=0;for(i=0,maxlen=0;i<bufs.length;maxlen+=len,++i)len=bufs[i].length,bufs[i]instanceof Uint8Array?o.set(bufs[i],maxlen):typeof bufs[i]=="string"?o.set(new Uint8Array(s2a(bufs[i])),maxlen):o.set(new Uint8Array(bufs[i]),maxlen);return o}return[].concat.apply([],bufs.map(function(buf){return Array.isArray(buf)?buf:[].slice.call(buf)}))};function utf8decode(content){for(var out=[],widx=0,L=content.length+250,o=new_raw_buf(content.length+255),ridx=0;ridx<content.length;++ridx){var c=content.charCodeAt(ridx);if(c<128)o[widx++]=c;else if(c<2048)o[widx++]=192|c>>6&31,o[widx++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var d=content.charCodeAt(++ridx)&1023;o[widx++]=240|c>>8&7,o[widx++]=128|c>>2&63,o[widx++]=128|d>>6&15|(c&3)<<4,o[widx++]=128|d&63}else o[widx++]=224|c>>12&15,o[widx++]=128|c>>6&63,o[widx++]=128|c&63;widx>L&&(out.push(o.slice(0,widx)),widx=0,o=new_raw_buf(65535),L=65530)}return out.push(o.slice(0,widx)),bconcat(out)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(x){for(var o="",i=x.length-1;i>=0;)o+=x.charAt(i--);return o}function pad0(v,d){var t=""+v;return t.length>=d?t:fill("0",d-t.length)+t}function pad_(v,d){var t=""+v;return t.length>=d?t:fill(" ",d-t.length)+t}function rpad_(v,d){var t=""+v;return t.length>=d?t:t+fill(" ",d-t.length)}function pad0r1(v,d){var t=""+Math.round(v);return t.length>=d?t:fill("0",d-t.length)+t}function pad0r2(v,d){var t=""+v;return t.length>=d?t:fill("0",d-t.length)+t}var p2_32=Math.pow(2,32);function pad0r(v,d){if(v>p2_32||v<-p2_32)return pad0r1(v,d);var i=Math.round(v);return pad0r2(i,d)}function SSF_isgeneral(s,i){return i=i||0,s.length>=7+i&&(s.charCodeAt(i)|32)===103&&(s.charCodeAt(i+1)|32)===101&&(s.charCodeAt(i+2)|32)===110&&(s.charCodeAt(i+3)|32)===101&&(s.charCodeAt(i+4)|32)===114&&(s.charCodeAt(i+5)|32)===97&&(s.charCodeAt(i+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(x,D,mixed){for(var sgn=x<0?-1:1,B=x*sgn,P_2=0,P_1=1,P=0,Q_2=1,Q_1=0,Q=0,A=Math.floor(B);Q_1<D&&(A=Math.floor(B),P=A*P_1+P_2,Q=A*Q_1+Q_2,!(B-A<5e-8));)B=1/(B-A),P_2=P_1,P_1=P,Q_2=Q_1,Q_1=Q;if(Q>D&&(Q_1>D?(Q=Q_2,P=P_2):(Q=Q_1,P=P_1)),!mixed)return[0,sgn*P,Q];var q=Math.floor(sgn*P/Q);return[q,sgn*P-q*Q,Q]}function SSF_normalize_xl_unsafe(v){var s=v.toPrecision(16);if(s.indexOf("e")>-1){var m=s.slice(0,s.indexOf("e"));return m=m.indexOf(".")>-1?m.slice(0,m.slice(0,2)=="0."?17:16):m.slice(0,15)+fill("0",m.length-15),m+s.slice(s.indexOf("e"))}var n=s.indexOf(".")>-1?s.slice(0,s.slice(0,2)=="0."?17:16):s.slice(0,15)+fill("0",s.length-15);return Number(n)}function SSF_parse_date_code(v,opts,b2){if(v>2958465||v<0)return null;v=SSF_normalize_xl_unsafe(v);var date=v|0,time=Math.floor(86400*(v-date)),dow=0,dout=[],out={D:date,T:time,u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(out.u)<1e-6&&(out.u=0),opts&&opts.date1904&&(date+=1462),out.u>.9999&&(out.u=0,++time==86400&&(out.T=time=0,++date,++out.D)),date===60)dout=b2?[1317,10,29]:[1900,2,29],dow=3;else if(date===0)dout=b2?[1317,8,29]:[1900,1,0],dow=6;else{date>60&&--date;var d=new Date(1900,0,1);d.setDate(d.getDate()+date-1),dout=[d.getFullYear(),d.getMonth()+1,d.getDate()],dow=d.getDay(),date<60&&(dow=(dow+6)%7),b2&&(dow=SSF_fix_hijri(d,dout))}return out.y=dout[0],out.m=dout[1],out.d=dout[2],out.S=time%60,time=Math.floor(time/60),out.M=time%60,time=Math.floor(time/60),out.H=time,out.q=dow,out}function SSF_strip_decimal(o){return o.indexOf(".")==-1?o:o.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(o){return o.indexOf("E")==-1?o:o.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(v){var w=v<0?12:11,o=SSF_strip_decimal(v.toFixed(12));return o.length<=w||(o=v.toPrecision(10),o.length<=w)?o:v.toExponential(5)}function SSF_large_exp(v){var o=SSF_strip_decimal(v.toFixed(11));return o.length>(v<0?12:11)||o==="0"||o==="-0"?v.toPrecision(6):o}function SSF_general_num(v){var V=Math.floor(Math.log(Math.abs(v))*Math.LOG10E),o;return V>=-4&&V<=-1?o=v.toPrecision(10+V):Math.abs(V)<=9?o=SSF_small_exp(v):V===10?o=v.toFixed(10).substr(0,12):o=SSF_large_exp(v),SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()))}function SSF_general(v,opts){switch(typeof v){case"string":return v;case"boolean":return v?"TRUE":"FALSE";case"number":return(v|0)===v?v.toString(10):SSF_general_num(v);case"undefined":return"";case"object":if(v==null)return"";if(v instanceof Date)return SSF_format(14,datenum(v,opts&&opts.date1904),opts)}throw new Error("unsupported value in General format: "+v)}function SSF_fix_hijri(date,o){o[0]-=581;var dow=date.getDay();return date<60&&(dow=(dow+6)%7),dow}function SSF_write_date(type,fmt,val,ss0){var o="",ss=0,tt=0,y=val.y,out,outl=0;switch(type){case 98:y=val.y+543;case 121:switch(fmt.length){case 1:case 2:out=y%100,outl=2;break;default:out=y%1e4,outl=4;break}break;case 109:switch(fmt.length){case 1:case 2:out=val.m,outl=fmt.length;break;case 3:return months[val.m-1][1];case 5:return months[val.m-1][0];default:return months[val.m-1][2]}break;case 100:switch(fmt.length){case 1:case 2:out=val.d,outl=fmt.length;break;case 3:return days[val.q][0];default:return days[val.q][1]}break;case 104:switch(fmt.length){case 1:case 2:out=1+(val.H+11)%12,outl=fmt.length;break;default:throw"bad hour format: "+fmt}break;case 72:switch(fmt.length){case 1:case 2:out=val.H,outl=fmt.length;break;default:throw"bad hour format: "+fmt}break;case 77:switch(fmt.length){case 1:case 2:out=val.M,outl=fmt.length;break;default:throw"bad minute format: "+fmt}break;case 115:if(fmt!="s"&&fmt!="ss"&&fmt!=".0"&&fmt!=".00"&&fmt!=".000")throw"bad second format: "+fmt;return val.u===0&&(fmt=="s"||fmt=="ss")?pad0(val.S,fmt.length):(ss0>=2?tt=ss0===3?1e3:100:tt=ss0===1?10:1,ss=Math.round(tt*(val.S+val.u)),ss>=60*tt&&(ss=0),fmt==="s"?ss===0?"0":""+ss/tt:(o=pad0(ss,2+ss0),fmt==="ss"?o.substr(0,2):"."+o.substr(2,fmt.length-1)));case 90:switch(fmt){case"[h]":case"[hh]":out=val.D*24+val.H;break;case"[m]":case"[mm]":out=(val.D*24+val.H)*60+val.M;break;case"[s]":case"[ss]":out=((val.D*24+val.H)*60+val.M)*60+(ss0==0?Math.round(val.S+val.u):val.S);break;default:throw"bad abstime format: "+fmt}outl=fmt.length===3?1:2;break;case 101:out=y,outl=1;break}var outstr=outl>0?pad0(out,outl):"";return outstr}function commaify(s){var w=3;if(s.length<=w)return s;for(var j=s.length%w,o=s.substr(0,j);j!=s.length;j+=w)o+=(o.length>0?",":"")+s.substr(j,w);return o}var pct1=/%/g;function write_num_pct(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul)}function write_num_cm(type,fmt,val){for(var idx=fmt.length-1;fmt.charCodeAt(idx-1)===44;)--idx;return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)))}function write_num_exp(fmt,val){var o,idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return"0.0E+0";if(val<0)return"-"+write_num_exp(fmt,-val);var period=fmt.indexOf(".");period===-1&&(period=fmt.indexOf("E"));var ee=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee<0&&(ee+=period),o=(val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period),o.indexOf("e")===-1){var fakee=Math.floor(Math.log(val)*Math.LOG10E);for(o.indexOf(".")===-1?o=o.charAt(0)+"."+o.substr(1)+"E+"+(fakee-o.length+ee):o+="E+"+(fakee-ee);o.substr(0,2)==="0.";)o=o.charAt(0)+o.substr(2,period)+"."+o.substr(2+period),o=o.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");o=o.replace(/\+-/,"-")}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee)%period)+"."+$3.substr(ee)+"E"})}else o=val.toExponential(idx);return fmt.match(/E\+00$/)&&o.match(/e[+-]\d$/)&&(o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1)),fmt.match(/E\-/)&&o.match(/e\+/)&&(o=o.replace(/e\+/,"e")),o.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(r,aval,sign){var den=parseInt(r[4],10),rr=Math.round(aval*den),base=Math.floor(rr/den),myn=rr-base*den,myd=den;return sign+(base===0?"":""+base)+" "+(myn===0?fill(" ",r[1].length+1+r[4].length):pad_(myn,r[1].length)+r[2]+"/"+r[3]+pad0(myd,r[4].length))}function write_num_f2(r,aval,sign){return sign+(aval===0?"":""+aval)+fill(" ",r[1].length+2+r[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\)[^)]*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(str){for(var o="",cc,i=0;i!=str.length;++i)switch(cc=str.charCodeAt(i)){case 35:break;case 63:o+=" ";break;case 48:o+="0";break;default:o+=String.fromCharCode(cc)}return o}function rnd(val,d){var dd=Math.pow(10,d);return""+Math.round(val*dd)/dd}function dec(val,d){var _frac=val-Math.floor(val),dd=Math.pow(10,d);return d<(""+Math.round(_frac*dd)).length?0:Math.round(_frac*dd)}function carry(val,d){return d<(""+Math.round((val-Math.floor(val))*Math.pow(10,d))).length?1:0}function flr(val){return val<2147483647&&val>-2147483648?""+(val>=0?val|0:val-1|0):""+Math.floor(val)}function write_num_flt(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return val>=0?write_num_flt("n",ffmt,val):"("+write_num_flt("n",ffmt,-val)+")"}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp(fmt,val);if(fmt.charCodeAt(0)===36)return"$"+write_num_flt(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o,r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0r(aval,fmt.length);if(fmt.match(/^[#?]+$/))return o=pad0r(val,0),o==="0"&&(o=""),o.length>fmt.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o;if(r=fmt.match(frac1))return write_num_f1(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0r(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1))return o=rnd(val,r[1].length).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1])).replace(/\.(\d*)$/,function($$,$1){return"."+$1+fill("0",hashq(r[1]).length-$1.length)}),fmt.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(fmt=fmt.replace(/^#+([0.])/,"$1"),r=fmt.match(/^(0*)\.(#*)$/))return sign+rnd(aval,r[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(pad0r(aval,0));if(r=fmt.match(/^#,##0\.([#0]*0)$/))return val<0?"-"+write_num_flt(type,fmt,-val):commaify(""+(Math.floor(val)+carry(val,r[1].length)))+"."+pad0(dec(val,r[1].length),r[1].length);if(r=fmt.match(/^#,#*,#0/))return write_num_flt(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_flt(type,fmt.replace(/[\\-]/g,""),val)),ri=0,_strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x2){return ri<o.length?o.charAt(ri++):x2==="0"?"0":""}));if(fmt.match(phone))return o=write_num_flt(type,"##########",val),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(r[4].length,7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!1),o=""+sign,oa=write_num("n",r[1],ff[1]),oa.charAt(oa.length-1)==" "&&(oa=oa.substr(0,oa.length-1)+"0"),o+=oa+r[2]+"/"+r[3],oa=rpad_(ff[2],ri),oa.length<r[4].length&&(oa=hashq(r[4].substr(r[4].length-oa.length))+oa),o+=oa,o;if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(Math.max(r[1].length,r[4].length),7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!0),sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length));if(r=fmt.match(/^[#0?]+$/))return o=pad0r(val,0),fmt.length<=o.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o;if(r=fmt.match(/^([#0?]+)\.([#0]+)$/)){o=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1"),ri=o.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o.length-lres;return hashq(fmt.substr(0,lres)+o+fmt.substr(fmt.length-rres))}if(r=fmt.match(/^00,000\.([#0]*0)$/))return ri=dec(val,r[1].length),val<0?"-"+write_num_flt(type,fmt,-val):commaify(flr(val)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return"00,"+($$.length<3?pad0(0,3-$$.length):"")+$$})+"."+pad0(ri,r[1].length);switch(fmt){case"###,##0.00":return write_num_flt(type,"#,##0.00",val);case"###,###":case"##,###":case"#,###":var x=commaify(pad0r(aval,0));return x!=="0"?sign+x:"";case"###,###.00":return write_num_flt(type,"###,##0.00",val).replace(/^0\./,".");case"#,###.00":return write_num_flt(type,"#,##0.00",val).replace(/^0\./,".");default:}throw new Error("unsupported format |"+fmt+"|")}function write_num_cm2(type,fmt,val){for(var idx=fmt.length-1;fmt.charCodeAt(idx-1)===44;)--idx;return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)))}function write_num_pct2(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul)}function write_num_exp2(fmt,val){var o,idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return"0.0E+0";if(val<0)return"-"+write_num_exp2(fmt,-val);var period=fmt.indexOf(".");period===-1&&(period=fmt.indexOf("E"));var ee=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee<0&&(ee+=period),o=(val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period),!o.match(/[Ee]/)){var fakee=Math.floor(Math.log(val)*Math.LOG10E);o.indexOf(".")===-1?o=o.charAt(0)+"."+o.substr(1)+"E+"+(fakee-o.length+ee):o+="E+"+(fakee-ee),o=o.replace(/\+-/,"-")}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee)%period)+"."+$3.substr(ee)+"E"})}else o=val.toExponential(idx);return fmt.match(/E\+00$/)&&o.match(/e[+-]\d$/)&&(o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1)),fmt.match(/E\-/)&&o.match(/e\+/)&&(o=o.replace(/e\+/,"e")),o.replace("e","E")}function write_num_int(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return val>=0?write_num_int("n",ffmt,val):"("+write_num_int("n",ffmt,-val)+")"}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm2(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct2(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp2(fmt,val);if(fmt.charCodeAt(0)===36)return"$"+write_num_int(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o,r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0(aval,fmt.length);if(fmt.match(/^[#?]+$/))return o=""+val,val===0&&(o=""),o.length>fmt.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o;if(r=fmt.match(frac1))return write_num_f2(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1))return o=(""+val).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1])),o=o.replace(/\.(\d*)$/,function($$,$1){return"."+$1+fill("0",hashq(r[1]).length-$1.length)}),fmt.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(fmt=fmt.replace(/^#+([0.])/,"$1"),r=fmt.match(/^(0*)\.(#*)$/))return sign+(""+aval).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(""+aval);if(r=fmt.match(/^#,##0\.([#0]*0)$/))return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val)+"."+fill("0",r[1].length);if(r=fmt.match(/^#,#*,#0/))return write_num_int(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_int(type,fmt.replace(/[\\-]/g,""),val)),ri=0,_strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x2){return ri<o.length?o.charAt(ri++):x2==="0"?"0":""}));if(fmt.match(phone))return o=write_num_int(type,"##########",val),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(r[4].length,7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!1),o=""+sign,oa=write_num("n",r[1],ff[1]),oa.charAt(oa.length-1)==" "&&(oa=oa.substr(0,oa.length-1)+"0"),o+=oa+r[2]+"/"+r[3],oa=rpad_(ff[2],ri),oa.length<r[4].length&&(oa=hashq(r[4].substr(r[4].length-oa.length))+oa),o+=oa,o;if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(Math.max(r[1].length,r[4].length),7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!0),sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length));if(r=fmt.match(/^[#0?]+$/))return o=""+val,fmt.length<=o.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o;if(r=fmt.match(/^([#0]+)\.([#0]+)$/)){o=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1"),ri=o.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o.length-lres;return hashq(fmt.substr(0,lres)+o+fmt.substr(fmt.length-rres))}if(r=fmt.match(/^00,000\.([#0]*0)$/))return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return"00,"+($$.length<3?pad0(0,3-$$.length):"")+$$})+"."+pad0(0,r[1].length);switch(fmt){case"###,###":case"##,###":case"#,###":var x=commaify(""+aval);return x!=="0"?sign+x:"";default:if(fmt.match(/\.[0#?]*$/))return write_num_int(type,fmt.slice(0,fmt.lastIndexOf(".")),val)+hashq(fmt.slice(fmt.lastIndexOf(".")))}throw new Error("unsupported format |"+fmt+"|")}function write_num(type,fmt,val){return(val|0)===val?write_num_int(type,fmt,val):write_num_flt(type,fmt,val)}function SSF_split_fmt(fmt){for(var out=[],in_str=!1,i=0,j=0;i<fmt.length;++i)switch(fmt.charCodeAt(i)){case 34:in_str=!in_str;break;case 95:case 42:case 92:++i;break;case 59:out[out.length]=fmt.substr(j,i-j),j=i+1}if(out[out.length]=fmt.substr(j),in_str===!0)throw new Error("Format |"+fmt+"| unterminated string ");return out}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(fmt){for(var i=0,c="",o="";i<fmt.length;)switch(c=fmt.charAt(i)){case"G":SSF_isgeneral(fmt,i)&&(i+=6),i++;break;case'"':for(;fmt.charCodeAt(++i)!==34&&i<fmt.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(fmt.charAt(i+1)==="1"||fmt.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(fmt.substr(i,3).toUpperCase()==="A/P"||fmt.substr(i,5).toUpperCase()==="AM/PM"||fmt.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++i;break;case"[":for(o=c;fmt.charAt(i++)!=="]"&&i<fmt.length;)o+=fmt.charAt(i);if(o.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;i<fmt.length&&("0#?.,E+-%".indexOf(c=fmt.charAt(++i))>-1||c=="\\"&&fmt.charAt(i+1)=="-"&&"0#".indexOf(fmt.charAt(i+2))>-1););break;case"?":for(;fmt.charAt(++i)===c;);break;case"*":++i,(fmt.charAt(i)==" "||fmt.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<fmt.length&&"0123456789".indexOf(fmt.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}function eval_fmt(fmt,v,opts,flen){for(var out=[],o="",i=0,c="",lst="t",dt,j,cc,hr="H";i<fmt.length;)switch(c=fmt.charAt(i)){case"G":if(!SSF_isgeneral(fmt,i))throw new Error("unrecognized character "+c+" in "+fmt);out[out.length]={t:"G",v:"General"},i+=7;break;case'"':for(o="";(cc=fmt.charCodeAt(++i))!==34&&i<fmt.length;)o+=String.fromCharCode(cc);out[out.length]={t:"t",v:o},++i;break;case"\\":var w=fmt.charAt(++i),t=w==="("||w===")"?w:"t";out[out.length]={t,v:w},++i;break;case"_":out[out.length]={t:"t",v:" "},i+=2;break;case"@":out[out.length]={t:"T",v},++i;break;case"B":case"b":if(fmt.charAt(i+1)==="1"||fmt.charAt(i+1)==="2"){if(dt==null&&(dt=SSF_parse_date_code(v,opts,fmt.charAt(i+1)==="2"),dt==null))return"";out[out.length]={t:"X",v:fmt.substr(i,2)},lst=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(v<0||dt==null&&(dt=SSF_parse_date_code(v,opts),dt==null))return"";for(o=c;++i<fmt.length&&fmt.charAt(i).toLowerCase()===c;)o+=c;c==="m"&&lst.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=hr),out[out.length]={t:c,v:o},lst=c;break;case"A":case"a":case"\u4E0A":var q={t:c,v:c};if(dt==null&&(dt=SSF_parse_date_code(v,opts)),fmt.substr(i,3).toUpperCase()==="A/P"?(dt!=null&&(q.v=dt.H>=12?fmt.charAt(i+2):c),q.t="T",hr="h",i+=3):fmt.substr(i,5).toUpperCase()==="AM/PM"?(dt!=null&&(q.v=dt.H>=12?"PM":"AM"),q.t="T",i+=5,hr="h"):fmt.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(dt!=null&&(q.v=dt.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),q.t="T",i+=5,hr="h"):(q.t="t",++i),dt==null&&q.t==="T")return"";out[out.length]=q,lst=c;break;case"[":for(o=c;fmt.charAt(i++)!=="]"&&i<fmt.length;)o+=fmt.charAt(i);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(SSF_abstime)){if(dt==null&&(dt=SSF_parse_date_code(v,opts),dt==null))return"";out[out.length]={t:"Z",v:o.toLowerCase()},lst=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(fmt)||(out[out.length]={t:"t",v:o}));break;case".":if(dt!=null){for(o=c;++i<fmt.length&&(c=fmt.charAt(i))==="0";)o+=c;out[out.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++i<fmt.length&&"0#?.,E+-%".indexOf(c=fmt.charAt(i))>-1;)o+=c;out[out.length]={t:"n",v:o};break;case"?":for(o=c;fmt.charAt(++i)===c;)o+=c;out[out.length]={t:c,v:o},lst=c;break;case"*":++i,(fmt.charAt(i)==" "||fmt.charAt(i)=="*")&&++i;break;case"(":case")":out[out.length]={t:flen===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;i<fmt.length&&"0123456789".indexOf(fmt.charAt(++i))>-1;)o+=fmt.charAt(i);out[out.length]={t:"D",v:o};break;case" ":out[out.length]={t:c,v:c},++i;break;case"$":out[out.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+fmt);out[out.length]={t:"t",v:c},++i;break}var bt=0,ss0=0,ssm;for(i=out.length-1,lst="t";i>=0;--i)switch(out[i].t){case"h":case"H":out[i].t=hr,lst="h",bt<1&&(bt=1);break;case"s":(ssm=out[i].v.match(/\.0+$/))&&(ss0=Math.max(ss0,ssm[0].length-1),bt=4),bt<3&&(bt=3);case"d":case"y":case"e":lst=out[i].t;break;case"M":lst=out[i].t,bt<2&&(bt=2);break;case"m":lst==="s"&&(out[i].t="M",bt<2&&(bt=2));break;case"X":break;case"Z":bt<1&&out[i].v.match(/[Hh]/)&&(bt=1),bt<2&&out[i].v.match(/[Mm]/)&&(bt=2),bt<3&&out[i].v.match(/[Ss]/)&&(bt=3)}var _dt;switch(bt){case 0:break;case 1:case 2:case 3:dt.u>=.5&&(dt.u=0,++dt.S),dt.S>=60&&(dt.S=0,++dt.M),dt.M>=60&&(dt.M=0,++dt.H),dt.H>=24&&(dt.H=0,++dt.D,_dt=SSF_parse_date_code(dt.D),_dt.u=dt.u,_dt.S=dt.S,_dt.M=dt.M,_dt.H=dt.H,dt=_dt);break;case 4:switch(ss0){case 1:dt.u=Math.round(dt.u*10)/10;break;case 2:dt.u=Math.round(dt.u*100)/100;break;case 3:dt.u=Math.round(dt.u*1e3)/1e3;break}dt.u>=1&&(dt.u=0,++dt.S),dt.S>=60&&(dt.S=0,++dt.M),dt.M>=60&&(dt.M=0,++dt.H),dt.H>=24&&(dt.H=0,++dt.D,_dt=SSF_parse_date_code(dt.D),_dt.u=dt.u,_dt.S=dt.S,_dt.M=dt.M,_dt.H=dt.H,dt=_dt);break}var nstr="",jj;for(i=0;i<out.length;++i)switch(out[i].t){case"t":case"T":case" ":case"D":break;case"X":out[i].v="",out[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":out[i].v=SSF_write_date(out[i].t.charCodeAt(0),out[i].v,dt,ss0),out[i].t="t";break;case"n":case"?":for(jj=i+1;out[jj]!=null&&((c=out[jj].t)==="?"||c==="D"||(c===" "||c==="t")&&out[jj+1]!=null&&(out[jj+1].t==="?"||out[jj+1].t==="t"&&out[jj+1].v==="/")||out[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(out[jj].v==="/"||out[jj].v===" "&&out[jj+1]!=null&&out[jj+1].t=="?"));)out[i].v+=out[jj].v,out[jj]={v:"",t:";"},++jj;nstr+=out[i].v,i=jj-1;break;case"G":out[i].t="t",out[i].v=SSF_general(v,opts);break}var vv="",myv,ostr;if(nstr.length>0){nstr.charCodeAt(0)==40?(myv=v<0&&nstr.charCodeAt(0)===45?-v:v,ostr=write_num("n",nstr,myv)):(myv=v<0&&flen>1?-v:v,ostr=write_num("n",nstr,myv),myv<0&&out[0]&&out[0].t=="t"&&(ostr=ostr.substr(1),out[0].v="-"+out[0].v)),jj=ostr.length-1;var decpt=out.length;for(i=0;i<out.length;++i)if(out[i]!=null&&out[i].t!="t"&&out[i].v.indexOf(".")>-1){decpt=i;break}var lasti=out.length;if(decpt===out.length&&ostr.indexOf("E")===-1){for(i=out.length-1;i>=0;--i)out[i]==null||"n?".indexOf(out[i].t)===-1||(jj>=out[i].v.length-1?(jj-=out[i].v.length,out[i].v=ostr.substr(jj+1,out[i].v.length)):jj<0?out[i].v="":(out[i].v=ostr.substr(0,jj+1),jj=-1),out[i].t="t",lasti=i);jj>=0&&lasti<out.length&&(out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v)}else if(decpt!==out.length&&ostr.indexOf("E")===-1){for(jj=ostr.indexOf(".")-1,i=decpt;i>=0;--i)if(!(out[i]==null||"n?".indexOf(out[i].t)===-1)){for(j=out[i].v.indexOf(".")>-1&&i===decpt?out[i].v.indexOf(".")-1:out[i].v.length-1,vv=out[i].v.substr(j+1);j>=0;--j)jj>=0&&(out[i].v.charAt(j)==="0"||out[i].v.charAt(j)==="#")&&(vv=ostr.charAt(jj--)+vv);out[i].v=vv,out[i].t="t",lasti=i}for(jj>=0&&lasti<out.length&&(out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v),jj=ostr.indexOf(".")+1,i=decpt;i<out.length;++i)if(!(out[i]==null||"n?(".indexOf(out[i].t)===-1&&i!==decpt)){for(j=out[i].v.indexOf(".")>-1&&i===decpt?out[i].v.indexOf(".")+1:0,vv=out[i].v.substr(0,j);j<out[i].v.length;++j)jj<ostr.length&&(vv+=ostr.charAt(jj++));out[i].v=vv,out[i].t="t",lasti=i}}}for(i=0;i<out.length;++i)out[i]!=null&&"n?".indexOf(out[i].t)>-1&&(myv=flen>1&&v<0&&i>0&&out[i-1].v==="-"?-v:v,out[i].v=write_num(out[i].t,out[i].v,myv),out[i].t="t");var retval="";for(i=0;i!==out.length;++i)out[i]!=null&&(retval+=out[i].v);return retval}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(v,rr){if(rr==null)return!1;var thresh=parseFloat(rr[2]);switch(rr[1]){case"=":if(v==thresh)return!0;break;case">":if(v>thresh)return!0;break;case"<":if(v<thresh)return!0;break;case"<>":if(v!=thresh)return!0;break;case">=":if(v>=thresh)return!0;break;case"<=":if(v<=thresh)return!0;break}return!1}function choose_fmt(f,v){var fmt=SSF_split_fmt(f),l=fmt.length,lat=fmt[l-1].indexOf("@");if(l<4&&lat>-1&&--l,fmt.length>4)throw new Error("cannot find right format for |"+fmt.join("|")+"|");if(typeof v!="number")return[4,fmt.length===4||lat>-1?fmt[fmt.length-1]:"@"];switch(fmt.length){case 1:fmt=lat>-1?["General","General","General",fmt[0]]:[fmt[0],fmt[0],fmt[0],"@"];break;case 2:fmt=lat>-1?[fmt[0],fmt[0],fmt[0],fmt[1]]:[fmt[0],fmt[1],fmt[0],"@"];break;case 3:fmt=lat>-1?[fmt[0],fmt[1],fmt[0],fmt[2]]:[fmt[0],fmt[1],fmt[2],"@"];break;case 4:break}var ff=v>0?fmt[0]:v<0?fmt[1]:fmt[2];if(fmt[0].indexOf("[")===-1&&fmt[1].indexOf("[")===-1)return[l,ff];if(fmt[0].match(/\[[=<>]/)!=null||fmt[1].match(/\[[=<>]/)!=null){var m1=fmt[0].match(cfregex2),m2=fmt[1].match(cfregex2);return chkcond(v,m1)?[l,fmt[0]]:chkcond(v,m2)?[l,fmt[1]]:[l,fmt[m1!=null&&m2!=null?2:1]]}return[l,ff]}function SSF_format(fmt,v,o){o==null&&(o={});var sfmt="";switch(typeof fmt){case"string":fmt=="m/d/yy"&&o.dateNF?sfmt=o.dateNF:sfmt=fmt;break;case"number":fmt==14&&o.dateNF?sfmt=o.dateNF:sfmt=(o.table!=null?o.table:table_fmt)[fmt],sfmt==null&&(sfmt=o.table&&o.table[SSF_default_map[fmt]]||table_fmt[SSF_default_map[fmt]]),sfmt==null&&(sfmt=SSF_default_str[fmt]||"General");break}if(SSF_isgeneral(sfmt,0))return SSF_general(v,o);v instanceof Date&&(v=datenum(v,o.date1904));var f=choose_fmt(sfmt,v);if(SSF_isgeneral(f[1]))return SSF_general(v,o);if(v===!0)v="TRUE";else if(v===!1)v="FALSE";else if(v===""||v==null)return"";return eval_fmt(f[1],v,o,f[0])}function SSF_load(fmt,idx){if(typeof idx!="number"){idx=+idx||-1;for(var i=0;i<392;++i){if(table_fmt[i]==null){idx<0&&(idx=i);continue}if(table_fmt[i]==fmt){idx=i;break}}idx<0&&(idx=391)}return table_fmt[idx]=fmt,idx}function SSF_load_table(tbl){for(var i=0;i!=392;++i)tbl[i]!==void 0&&SSF_load(tbl[i],i)}function make_ssf(){table_fmt=SSF_init_table()}var dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(dateNF){var fmt=typeof dateNF=="number"?table_fmt[dateNF]:dateNF;return fmt=fmt.replace(dateNFregex,"(\\d+)"),dateNFregex.lastIndex=0,new RegExp("^"+fmt+"$")}function dateNF_fix(str,dateNF,match){var Y=-1,m=-1,d=-1,H=-1,M=-1,S=-1;(dateNF.match(dateNFregex)||[]).forEach(function(n,i){var v=parseInt(match[i+1],10);switch(n.toLowerCase().charAt(0)){case"y":Y=v;break;case"d":d=v;break;case"h":H=v;break;case"s":S=v;break;case"m":H>=0?M=v:m=v;break}}),dateNFregex.lastIndex=0,S>=0&&M==-1&&m>=0&&(M=m,m=-1);var datestr=(""+(Y>=0?Y:new Date().getFullYear())).slice(-4)+"-"+("00"+(m>=1?m:1)).slice(-2)+"-"+("00"+(d>=1?d:1)).slice(-2);datestr.length==7&&(datestr="0"+datestr),datestr.length==8&&(datestr="20"+datestr);var timestr=("00"+(H>=0?H:0)).slice(-2)+":"+("00"+(M>=0?M:0)).slice(-2)+":"+("00"+(S>=0?S:0)).slice(-2);return H==-1&&M==-1&&S==-1?datestr:Y==-1&&m==-1&&d==-1?timestr:datestr+"T"+timestr}var bad_formats={"d.m":"d\\.m"};function SSF__load(fmt,idx){return SSF_load(bad_formats[fmt]||fmt,idx)}var CRC32=function(){var CRC322={};CRC322.version="1.2.0";function signed_crc_table(){for(var c=0,table=new Array(256),n=0;n!=256;++n)c=n,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,table[n]=c;return typeof Int32Array<"u"?new Int32Array(table):table}var T0=signed_crc_table();function slice_by_16_tables(T){var c=0,v=0,n=0,table=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(n=0;n!=256;++n)table[n]=T[n];for(n=0;n!=256;++n)for(v=T[n],c=256+n;c<4096;c+=256)v=table[c]=v>>>8^T[v&255];var out=[];for(n=1;n!=16;++n)out[n-1]=typeof Int32Array<"u"&&typeof table.subarray=="function"?table.subarray(n*256,n*256+256):table.slice(n*256,n*256+256);return out}var TT=slice_by_16_tables(T0),T1=TT[0],T2=TT[1],T3=TT[2],T4=TT[3],T5=TT[4],T6=TT[5],T7=TT[6],T8=TT[7],T9=TT[8],Ta=TT[9],Tb=TT[10],Tc=TT[11],Td=TT[12],Te=TT[13],Tf=TT[14];function crc32_bstr(bstr,seed){for(var C=seed^-1,i=0,L=bstr.length;i<L;)C=C>>>8^T0[(C^bstr.charCodeAt(i++))&255];return~C}function crc32_buf(B,seed){for(var C=seed^-1,L=B.length-15,i=0;i<L;)C=Tf[B[i++]^C&255]^Te[B[i++]^C>>8&255]^Td[B[i++]^C>>16&255]^Tc[B[i++]^C>>>24]^Tb[B[i++]]^Ta[B[i++]]^T9[B[i++]]^T8[B[i++]]^T7[B[i++]]^T6[B[i++]]^T5[B[i++]]^T4[B[i++]]^T3[B[i++]]^T2[B[i++]]^T1[B[i++]]^T0[B[i++]];for(L+=15;i<L;)C=C>>>8^T0[(C^B[i++])&255];return~C}function crc32_str(str,seed){for(var C=seed^-1,i=0,L=str.length,c=0,d=0;i<L;)c=str.charCodeAt(i++),c<128?C=C>>>8^T0[(C^c)&255]:c<2048?(C=C>>>8^T0[(C^(192|c>>6&31))&255],C=C>>>8^T0[(C^(128|c&63))&255]):c>=55296&&c<57344?(c=(c&1023)+64,d=str.charCodeAt(i++)&1023,C=C>>>8^T0[(C^(240|c>>8&7))&255],C=C>>>8^T0[(C^(128|c>>2&63))&255],C=C>>>8^T0[(C^(128|d>>6&15|(c&3)<<4))&255],C=C>>>8^T0[(C^(128|d&63))&255]):(C=C>>>8^T0[(C^(224|c>>12&15))&255],C=C>>>8^T0[(C^(128|c>>6&63))&255],C=C>>>8^T0[(C^(128|c&63))&255]);return~C}return CRC322.table=T0,CRC322.bstr=crc32_bstr,CRC322.buf=crc32_buf,CRC322.str=crc32_str,CRC322}(),CFB=function(){var exports={};exports.version="1.2.2";function namecmp(l,r){for(var L=l.split("/"),R=r.split("/"),i2=0,c=0,Z=Math.min(L.length,R.length);i2<Z;++i2){if(c=L[i2].length-R[i2].length)return c;if(L[i2]!=R[i2])return L[i2]<R[i2]?-1:1}return L.length-R.length}function dirname(p){if(p.charAt(p.length-1)=="/")return p.slice(0,-1).indexOf("/")===-1?p:dirname(p.slice(0,-1));var c=p.lastIndexOf("/");return c===-1?p:p.slice(0,c+1)}function filename(p){if(p.charAt(p.length-1)=="/")return filename(p.slice(0,-1));var c=p.lastIndexOf("/");return c===-1?p:p.slice(c+1)}function write_dos_date(buf,date){typeof date=="string"&&(date=new Date(date));var hms=date.getHours();hms=hms<<6|date.getMinutes(),hms=hms<<5|date.getSeconds()>>>1,buf.write_shift(2,hms);var ymd=date.getFullYear()-1980;ymd=ymd<<4|date.getMonth()+1,ymd=ymd<<5|date.getDate(),buf.write_shift(2,ymd)}function parse_dos_date(buf){var hms=buf.read_shift(2)&65535,ymd=buf.read_shift(2)&65535,val=new Date,d=ymd&31;ymd>>>=5;var m=ymd&15;ymd>>>=4,val.setMilliseconds(0),val.setFullYear(ymd+1980),val.setMonth(m-1),val.setDate(d);var S=hms&31;hms>>>=5;var M=hms&63;return hms>>>=6,val.setHours(hms),val.setMinutes(M),val.setSeconds(S<<1),val}function parse_extra_field(blob){prep_blob(blob,0);for(var o={},flags=0;blob.l<=blob.length-4;){var type=blob.read_shift(2),sz=blob.read_shift(2),tgt=blob.l+sz,p={};switch(type){case 21589:flags=blob.read_shift(1),flags&1&&(p.mtime=blob.read_shift(4)),sz>5&&(flags&2&&(p.atime=blob.read_shift(4)),flags&4&&(p.ctime=blob.read_shift(4))),p.mtime&&(p.mt=new Date(p.mtime*1e3));break;case 1:{var sz1=blob.read_shift(4),sz2=blob.read_shift(4);p.usz=sz2*Math.pow(2,32)+sz1,sz1=blob.read_shift(4),sz2=blob.read_shift(4),p.csz=sz2*Math.pow(2,32)+sz1}break}blob.l=tgt,o[type]=p}return o}var fs;function get_fs(){return fs||(fs=_fs)}function parse(file,options){if(file[0]==80&&file[1]==75)return parse_zip(file,options);if((file[0]|32)==109&&(file[1]|32)==105)return parse_mad(file,options);if(file.length<512)throw new Error("CFB file size "+file.length+" < 512");var mver=3,ssz=512,nmfs=0,difat_sec_cnt=0,dir_start=0,minifat_start=0,difat_start=0,fat_addrs=[],blob=file.slice(0,512);prep_blob(blob,0);var mv=check_get_mver(blob);switch(mver=mv[0],mver){case 3:ssz=512;break;case 4:ssz=4096;break;case 0:if(mv[1]==0)return parse_zip(file,options);default:throw new Error("Major Version: Expected 3 or 4 saw "+mver)}ssz!==512&&(blob=file.slice(0,ssz),prep_blob(blob,28));var header=file.slice(0,ssz);check_shifts(blob,mver);var dir_cnt=blob.read_shift(4,"i");if(mver===3&&dir_cnt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+dir_cnt);blob.l+=4,dir_start=blob.read_shift(4,"i"),blob.l+=4,blob.chk("00100000","Mini Stream Cutoff Size: "),minifat_start=blob.read_shift(4,"i"),nmfs=blob.read_shift(4,"i"),difat_start=blob.read_shift(4,"i"),difat_sec_cnt=blob.read_shift(4,"i");for(var q2=-1,j=0;j<109&&(q2=blob.read_shift(4,"i"),!(q2<0));++j)fat_addrs[j]=q2;var sectors=sectorify(file,ssz);sleuth_fat(difat_start,difat_sec_cnt,sectors,ssz,fat_addrs);var sector_list=make_sector_list(sectors,dir_start,fat_addrs,ssz);dir_start<sector_list.length&&(sector_list[dir_start].name="!Directory"),nmfs>0&&minifat_start!==ENDOFCHAIN&&(sector_list[minifat_start].name="!MiniFAT"),sector_list[fat_addrs[0]].name="!FAT",sector_list.fat_addrs=fat_addrs,sector_list.ssz=ssz;var files={},Paths=[],FileIndex=[],FullPaths=[];read_directory(dir_start,sector_list,sectors,Paths,nmfs,files,FileIndex,minifat_start),build_full_paths(FileIndex,FullPaths,Paths),Paths.shift();var o={FileIndex,FullPaths};return options&&options.raw&&(o.raw={header,sectors}),o}function check_get_mver(blob){if(blob[blob.l]==80&&blob[blob.l+1]==75)return[0,0];blob.chk(HEADER_SIGNATURE,"Header Signature: "),blob.l+=16;var mver=blob.read_shift(2,"u");return[blob.read_shift(2,"u"),mver]}function check_shifts(blob,mver){var shift=9;switch(blob.l+=2,shift=blob.read_shift(2)){case 9:if(mver!=3)throw new Error("Sector Shift: Expected 9 saw "+shift);break;case 12:if(mver!=4)throw new Error("Sector Shift: Expected 12 saw "+shift);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+shift)}blob.chk("0600","Mini Sector Shift: "),blob.chk("000000000000","Reserved: ")}function sectorify(file,ssz){for(var nsectors=Math.ceil(file.length/ssz)-1,sectors=[],i2=1;i2<nsectors;++i2)sectors[i2-1]=file.slice(i2*ssz,(i2+1)*ssz);return sectors[nsectors-1]=file.slice(nsectors*ssz),sectors}function build_full_paths(FI,FP,Paths){for(var i2=0,L=0,R=0,C=0,j=0,pl=Paths.length,dad=[],q2=[];i2<pl;++i2)dad[i2]=q2[i2]=i2,FP[i2]=Paths[i2];for(;j<q2.length;++j)i2=q2[j],L=FI[i2].L,R=FI[i2].R,C=FI[i2].C,dad[i2]===i2&&(L!==-1&&dad[L]!==L&&(dad[i2]=dad[L]),R!==-1&&dad[R]!==R&&(dad[i2]=dad[R])),C!==-1&&(dad[C]=i2),L!==-1&&i2!=dad[i2]&&(dad[L]=dad[i2],q2.lastIndexOf(L)<j&&q2.push(L)),R!==-1&&i2!=dad[i2]&&(dad[R]=dad[i2],q2.lastIndexOf(R)<j&&q2.push(R));for(i2=1;i2<pl;++i2)dad[i2]===i2&&(R!==-1&&dad[R]!==R?dad[i2]=dad[R]:L!==-1&&dad[L]!==L&&(dad[i2]=dad[L]));for(i2=1;i2<pl;++i2)if(FI[i2].type!==0){if(j=i2,j!=dad[j])do j=dad[j],FP[i2]=FP[j]+"/"+FP[i2];while(j!==0&&dad[j]!==-1&&j!=dad[j]);dad[i2]=-1}for(FP[0]+="/",i2=1;i2<pl;++i2)FI[i2].type!==2&&(FP[i2]+="/")}function get_mfat_entry(entry,payload,mini){for(var start2=entry.start,size=entry.size,o=[],idx=start2;mini&&size>0&&idx>=0;)o.push(payload.slice(idx*MSSZ,idx*MSSZ+MSSZ)),size-=MSSZ,idx=__readInt32LE(mini,idx*4);return o.length===0?new_buf(0):bconcat(o).slice(0,entry.size)}function sleuth_fat(idx,cnt,sectors,ssz,fat_addrs){var q2=ENDOFCHAIN;if(idx===ENDOFCHAIN){if(cnt!==0)throw new Error("DIFAT chain shorter than expected")}else if(idx!==-1){var sector=sectors[idx],m=(ssz>>>2)-1;if(!sector)return;for(var i2=0;i2<m&&(q2=__readInt32LE(sector,i2*4))!==ENDOFCHAIN;++i2)fat_addrs.push(q2);cnt>=1&&sleuth_fat(__readInt32LE(sector,ssz-4),cnt-1,sectors,ssz,fat_addrs)}}function get_sector_list(sectors,start2,fat_addrs,ssz,chkd){var buf=[],buf_chain=[];chkd||(chkd=[]);var modulus=ssz-1,j=0,jj=0;for(j=start2;j>=0;){chkd[j]=!0,buf[buf.length]=j,buf_chain.push(sectors[j]);var addr=fat_addrs[Math.floor(j*4/ssz)];if(jj=j*4&modulus,ssz<4+jj)throw new Error("FAT boundary crossed: "+j+" 4 "+ssz);if(!sectors[addr])break;j=__readInt32LE(sectors[addr],jj)}return{nodes:buf,data:__toBuffer([buf_chain])}}function make_sector_list(sectors,dir_start,fat_addrs,ssz){var sl=sectors.length,sector_list=[],chkd=[],buf=[],buf_chain=[],modulus=ssz-1,i2=0,j=0,k=0,jj=0;for(i2=0;i2<sl;++i2)if(buf=[],k=i2+dir_start,k>=sl&&(k-=sl),!chkd[k]){buf_chain=[];var seen=[];for(j=k;j>=0;){seen[j]=!0,chkd[j]=!0,buf[buf.length]=j,buf_chain.push(sectors[j]);var addr=fat_addrs[Math.floor(j*4/ssz)];if(jj=j*4&modulus,ssz<4+jj)throw new Error("FAT boundary crossed: "+j+" 4 "+ssz);if(!sectors[addr]||(j=__readInt32LE(sectors[addr],jj),seen[j]))break}sector_list[k]={nodes:buf,data:__toBuffer([buf_chain])}}return sector_list}function read_directory(dir_start,sector_list,sectors,Paths,nmfs,files,FileIndex,mini){for(var minifat_store=0,pl=Paths.length?2:0,sector=sector_list[dir_start].data,i2=0,namelen=0,name;i2<sector.length;i2+=128){var blob=sector.slice(i2,i2+128);prep_blob(blob,64),namelen=blob.read_shift(2),name=__utf16le(blob,0,namelen-pl),Paths.push(name);var o={name,type:blob.read_shift(1),color:blob.read_shift(1),L:blob.read_shift(4,"i"),R:blob.read_shift(4,"i"),C:blob.read_shift(4,"i"),clsid:blob.read_shift(16),state:blob.read_shift(4,"i"),start:0,size:0},ctime=blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2);ctime!==0&&(o.ct=read_date(blob,blob.l-8));var mtime=blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2);mtime!==0&&(o.mt=read_date(blob,blob.l-8)),o.start=blob.read_shift(4,"i"),o.size=blob.read_shift(4,"i"),o.size<0&&o.start<0&&(o.size=o.type=0,o.start=ENDOFCHAIN,o.name=""),o.type===5?(minifat_store=o.start,nmfs>0&&minifat_store!==ENDOFCHAIN&&(sector_list[minifat_store].name="!StreamData")):o.size>=4096?(o.storage="fat",sector_list[o.start]===void 0&&(sector_list[o.start]=get_sector_list(sectors,o.start,sector_list.fat_addrs,sector_list.ssz)),sector_list[o.start].name=o.name,o.content=sector_list[o.start].data.slice(0,o.size)):(o.storage="minifat",o.size<0?o.size=0:minifat_store!==ENDOFCHAIN&&o.start!==ENDOFCHAIN&&sector_list[minifat_store]&&(o.content=get_mfat_entry(o,sector_list[minifat_store].data,(sector_list[mini]||{}).data))),o.content&&prep_blob(o.content,0),files[name]=o,FileIndex.push(o)}}function read_date(blob,offset2){return new Date((__readUInt32LE(blob,offset2+4)/1e7*Math.pow(2,32)+__readUInt32LE(blob,offset2)/1e7-11644473600)*1e3)}function read_file(filename2,options){return get_fs(),parse(fs.readFileSync(filename2),options)}function read2(blob,options){var type=options&&options.type;switch(type||has_buf&&Buffer.isBuffer(blob)&&(type="buffer"),type||"base64"){case"file":return read_file(blob,options);case"base64":return parse(s2a(Base64_decode(blob)),options);case"binary":return parse(s2a(blob),options)}return parse(blob,options)}function init_cfb(cfb,opts){var o=opts||{},root=o.root||"Root Entry";if(cfb.FullPaths||(cfb.FullPaths=[]),cfb.FileIndex||(cfb.FileIndex=[]),cfb.FullPaths.length!==cfb.FileIndex.length)throw new Error("inconsistent CFB structure");cfb.FullPaths.length===0&&(cfb.FullPaths[0]=root+"/",cfb.FileIndex[0]={name:root,type:5}),o.CLSID&&(cfb.FileIndex[0].clsid=o.CLSID),seed_cfb(cfb)}function seed_cfb(cfb){var nm="Sh33tJ5";if(!CFB.find(cfb,"/"+nm)){var p=new_buf(4);p[0]=55,p[1]=p[3]=50,p[2]=54,cfb.FileIndex.push({name:nm,type:2,content:p,size:4,L:69,R:69,C:69}),cfb.FullPaths.push(cfb.FullPaths[0]+nm),rebuild_cfb(cfb)}}function rebuild_cfb(cfb,f){init_cfb(cfb);for(var gc=!1,s=!1,i2=cfb.FullPaths.length-1;i2>=0;--i2){var _file=cfb.FileIndex[i2];switch(_file.type){case 0:s?gc=!0:(cfb.FileIndex.pop(),cfb.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(_file.R*_file.L*_file.C)&&(gc=!0),_file.R>-1&&_file.L>-1&&_file.R==_file.L&&(gc=!0);break;default:gc=!0;break}}if(!(!gc&&!f)){var now=new Date(1987,1,19),j=0,fullPaths=Object.create?Object.create(null):{},data=[];for(i2=0;i2<cfb.FullPaths.length;++i2)fullPaths[cfb.FullPaths[i2]]=!0,cfb.FileIndex[i2].type!==0&&data.push([cfb.FullPaths[i2],cfb.FileIndex[i2]]);for(i2=0;i2<data.length;++i2){var dad=dirname(data[i2][0]);for(s=fullPaths[dad];!s;){for(;dirname(dad)&&!fullPaths[dirname(dad)];)dad=dirname(dad);data.push([dad,{name:filename(dad).replace("/",""),type:1,clsid:HEADER_CLSID,ct:now,mt:now,content:null}]),fullPaths[dad]=!0,dad=dirname(data[i2][0]),s=fullPaths[dad]}}for(data.sort(function(x,y){return namecmp(x[0],y[0])}),cfb.FullPaths=[],cfb.FileIndex=[],i2=0;i2<data.length;++i2)cfb.FullPaths[i2]=data[i2][0],cfb.FileIndex[i2]=data[i2][1];for(i2=0;i2<data.length;++i2){var elt=cfb.FileIndex[i2],nm=cfb.FullPaths[i2];if(elt.name=filename(nm).replace("/",""),elt.L=elt.R=elt.C=-(elt.color=1),elt.size=elt.content?elt.content.length:0,elt.start=0,elt.clsid=elt.clsid||HEADER_CLSID,i2===0)elt.C=data.length>1?1:-1,elt.size=0,elt.type=5;else if(nm.slice(-1)=="/"){for(j=i2+1;j<data.length&&dirname(cfb.FullPaths[j])!=nm;++j);for(elt.C=j>=data.length?-1:j,j=i2+1;j<data.length&&dirname(cfb.FullPaths[j])!=dirname(nm);++j);elt.R=j>=data.length?-1:j,elt.type=1}else dirname(cfb.FullPaths[i2+1]||"")==dirname(nm)&&(elt.R=i2+1),elt.type=2}}}function _write(cfb,options){var _opts=options||{};if(_opts.fileType=="mad")return write_mad(cfb,_opts);switch(rebuild_cfb(cfb),_opts.fileType){case"zip":return write_zip2(cfb,_opts)}var L=function(cfb2){for(var mini_size=0,fat_size=0,i3=0;i3<cfb2.FileIndex.length;++i3){var file2=cfb2.FileIndex[i3];if(file2.content){var flen2=file2.content.length;flen2>0&&(flen2<4096?mini_size+=flen2+63>>6:fat_size+=flen2+511>>9)}}for(var dir_cnt=cfb2.FullPaths.length+3>>2,mini_cnt=mini_size+7>>3,mfat_cnt=mini_size+127>>7,fat_base=mini_cnt+fat_size+dir_cnt+mfat_cnt,fat_cnt=fat_base+127>>7,difat_cnt=fat_cnt<=109?0:Math.ceil((fat_cnt-109)/127);fat_base+fat_cnt+difat_cnt+127>>7>fat_cnt;)difat_cnt=++fat_cnt<=109?0:Math.ceil((fat_cnt-109)/127);var L2=[1,difat_cnt,fat_cnt,mfat_cnt,dir_cnt,fat_size,mini_size,0];return cfb2.FileIndex[0].size=mini_size<<6,L2[7]=(cfb2.FileIndex[0].start=L2[0]+L2[1]+L2[2]+L2[3]+L2[4]+L2[5])+(L2[6]+7>>3),L2}(cfb),o=new_buf(L[7]<<9),i2=0,T=0;{for(i2=0;i2<8;++i2)o.write_shift(1,HEADER_SIG[i2]);for(i2=0;i2<8;++i2)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),i2=0;i2<3;++i2)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,L[2]),o.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:ENDOFCHAIN),o.write_shift(4,L[3]),o.write_shift(-4,L[1]?L[0]-1:ENDOFCHAIN),o.write_shift(4,L[1]),i2=0;i2<109;++i2)o.write_shift(-4,i2<L[2]?L[1]+i2:-1)}if(L[1])for(T=0;T<L[1];++T){for(;i2<236+T*127;++i2)o.write_shift(-4,i2<L[2]?L[1]+i2:-1);o.write_shift(-4,T===L[1]-1?ENDOFCHAIN:T+1)}var chainit=function(w){for(T+=w;i2<T-1;++i2)o.write_shift(-4,i2+1);w&&(++i2,o.write_shift(-4,ENDOFCHAIN))};for(T=i2=0,T+=L[1];i2<T;++i2)o.write_shift(-4,consts.DIFSECT);for(T+=L[2];i2<T;++i2)o.write_shift(-4,consts.FATSECT);chainit(L[3]),chainit(L[4]);for(var j=0,flen=0,file=cfb.FileIndex[0];j<cfb.FileIndex.length;++j)file=cfb.FileIndex[j],file.content&&(flen=file.content.length,!(flen<4096)&&(file.start=T,chainit(flen+511>>9)));for(chainit(L[6]+7>>3);o.l&511;)o.write_shift(-4,consts.ENDOFCHAIN);for(T=i2=0,j=0;j<cfb.FileIndex.length;++j)file=cfb.FileIndex[j],file.content&&(flen=file.content.length,!(!flen||flen>=4096)&&(file.start=T,chainit(flen+63>>6)));for(;o.l&511;)o.write_shift(-4,consts.ENDOFCHAIN);for(i2=0;i2<L[4]<<2;++i2){var nm=cfb.FullPaths[i2];if(!nm||nm.length===0){for(j=0;j<17;++j)o.write_shift(4,0);for(j=0;j<3;++j)o.write_shift(4,-1);for(j=0;j<12;++j)o.write_shift(4,0);continue}file=cfb.FileIndex[i2],i2===0&&(file.start=file.size?file.start-1:ENDOFCHAIN);var _nm=i2===0&&_opts.root||file.name;if(_nm.length>31&&(console.error("Name "+_nm+" will be truncated to "+_nm.slice(0,31)),_nm=_nm.slice(0,31)),flen=2*(_nm.length+1),o.write_shift(64,_nm,"utf16le"),o.write_shift(2,flen),o.write_shift(1,file.type),o.write_shift(1,file.color),o.write_shift(-4,file.L),o.write_shift(-4,file.R),o.write_shift(-4,file.C),file.clsid)o.write_shift(16,file.clsid,"hex");else for(j=0;j<4;++j)o.write_shift(4,0);o.write_shift(4,file.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,file.start),o.write_shift(4,file.size),o.write_shift(4,0)}for(i2=1;i2<cfb.FileIndex.length;++i2)if(file=cfb.FileIndex[i2],file.size>=4096)if(o.l=file.start+1<<9,has_buf&&Buffer.isBuffer(file.content))file.content.copy(o,o.l,0,file.size),o.l+=file.size+511&-512;else{for(j=0;j<file.size;++j)o.write_shift(1,file.content[j]);for(;j&511;++j)o.write_shift(1,0)}for(i2=1;i2<cfb.FileIndex.length;++i2)if(file=cfb.FileIndex[i2],file.size>0&&file.size<4096)if(has_buf&&Buffer.isBuffer(file.content))file.content.copy(o,o.l,0,file.size),o.l+=file.size+63&-64;else{for(j=0;j<file.size;++j)o.write_shift(1,file.content[j]);for(;j&63;++j)o.write_shift(1,0)}if(has_buf)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}function find(cfb,path){var UCFullPaths=cfb.FullPaths.map(function(x){return x.toUpperCase()}),UCPaths=UCFullPaths.map(function(x){var y=x.split("/");return y[y.length-(x.slice(-1)=="/"?2:1)]}),k=!1;path.charCodeAt(0)===47?(k=!0,path=UCFullPaths[0].slice(0,-1)+path):k=path.indexOf("/")!==-1;var UCPath=path.toUpperCase(),w=k===!0?UCFullPaths.indexOf(UCPath):UCPaths.indexOf(UCPath);if(w!==-1)return cfb.FileIndex[w];var m=!UCPath.match(chr1);for(UCPath=UCPath.replace(chr0,""),m&&(UCPath=UCPath.replace(chr1,"!")),w=0;w<UCFullPaths.length;++w)if((m?UCFullPaths[w].replace(chr1,"!"):UCFullPaths[w]).replace(chr0,"")==UCPath||(m?UCPaths[w].replace(chr1,"!"):UCPaths[w]).replace(chr0,"")==UCPath)return cfb.FileIndex[w];return null}var MSSZ=64,ENDOFCHAIN=-2,HEADER_SIGNATURE="d0cf11e0a1b11ae1",HEADER_SIG=[208,207,17,224,161,177,26,225],HEADER_CLSID="00000000000000000000000000000000",consts={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN,FREESECT:-1,HEADER_SIGNATURE,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function write_file(cfb,filename2,options){get_fs();var o=_write(cfb,options);fs.writeFileSync(filename2,o)}function a2s2(o){for(var out=new Array(o.length),i2=0;i2<o.length;++i2)out[i2]=String.fromCharCode(o[i2]);return out.join("")}function write2(cfb,options){var o=_write(cfb,options);switch(options&&options.type||"buffer"){case"file":return get_fs(),fs.writeFileSync(options.filename,o),o;case"binary":return typeof o=="string"?o:a2s2(o);case"base64":return Base64_encode(typeof o=="string"?o:a2s2(o));case"buffer":if(has_buf)return Buffer.isBuffer(o)?o:Buffer_from(o);case"array":return typeof o=="string"?s2a(o):o}return o}var _zlib;function use_zlib(zlib){try{var InflateRaw=zlib.InflateRaw,InflRaw=new InflateRaw;if(InflRaw._processChunk(new Uint8Array([3,0]),InflRaw._finishFlushFlag),InflRaw.bytesRead)_zlib=zlib;else throw new Error("zlib does not expose bytesRead")}catch(e){console.error("cannot use native zlib: "+(e.message||e))}}function _inflateRawSync(payload,usz){if(!_zlib)return _inflate(payload,usz);var InflateRaw=_zlib.InflateRaw,InflRaw=new InflateRaw,out=InflRaw._processChunk(payload.slice(payload.l),InflRaw._finishFlushFlag);return payload.l+=InflRaw.bytesRead,out}function _deflateRawSync(payload){return _zlib?_zlib.deflateRawSync(payload):_deflate(payload)}var CLEN_ORDER=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],LEN_LN=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],DST_LN=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function bit_swap_8(n){var t=(n<<1|n<<11)&139536|(n<<5|n<<15)&558144;return(t>>16|t>>8|t)&255}for(var use_typed_arrays=typeof Uint8Array<"u",bitswap8=use_typed_arrays?new Uint8Array(256):[],q=0;q<256;++q)bitswap8[q]=bit_swap_8(q);function bit_swap_n(n,b){var rev=bitswap8[n&255];return b<=8?rev>>>8-b:(rev=rev<<8|bitswap8[n>>8&255],b<=16?rev>>>16-b:(rev=rev<<8|bitswap8[n>>16&255],rev>>>24-b))}function read_bits_2(buf,bl){var w=bl&7,h=bl>>>3;return(buf[h]|(w<=6?0:buf[h+1]<<8))>>>w&3}function read_bits_3(buf,bl){var w=bl&7,h=bl>>>3;return(buf[h]|(w<=5?0:buf[h+1]<<8))>>>w&7}function read_bits_4(buf,bl){var w=bl&7,h=bl>>>3;return(buf[h]|(w<=4?0:buf[h+1]<<8))>>>w&15}function read_bits_5(buf,bl){var w=bl&7,h=bl>>>3;return(buf[h]|(w<=3?0:buf[h+1]<<8))>>>w&31}function read_bits_7(buf,bl){var w=bl&7,h=bl>>>3;return(buf[h]|(w<=1?0:buf[h+1]<<8))>>>w&127}function read_bits_n(buf,bl,n){var w=bl&7,h=bl>>>3,f=(1<<n)-1,v=buf[h]>>>w;return n<8-w||(v|=buf[h+1]<<8-w,n<16-w)||(v|=buf[h+2]<<16-w,n<24-w)||(v|=buf[h+3]<<24-w),v&f}function write_bits_3(buf,bl,v){var w=bl&7,h=bl>>>3;return w<=5?buf[h]|=(v&7)<<w:(buf[h]|=v<<w&255,buf[h+1]=(v&7)>>8-w),bl+3}function write_bits_1(buf,bl,v){var w=bl&7,h=bl>>>3;return v=(v&1)<<w,buf[h]|=v,bl+1}function write_bits_8(buf,bl,v){var w=bl&7,h=bl>>>3;return v<<=w,buf[h]|=v&255,v>>>=8,buf[h+1]=v,bl+8}function write_bits_16(buf,bl,v){var w=bl&7,h=bl>>>3;return v<<=w,buf[h]|=v&255,v>>>=8,buf[h+1]=v&255,buf[h+2]=v>>>8,bl+16}function realloc(b,sz){var L=b.length,M=2*L>sz?2*L:sz+5,i2=0;if(L>=sz)return b;if(has_buf){var o=new_unsafe_buf(M);if(b.copy)b.copy(o);else for(;i2<b.length;++i2)o[i2]=b[i2];return o}else if(use_typed_arrays){var a=new Uint8Array(M);if(a.set)a.set(b);else for(;i2<L;++i2)a[i2]=b[i2];return a}return b.length=M,b}function zero_fill_array(n){for(var o=new Array(n),i2=0;i2<n;++i2)o[i2]=0;return o}function build_tree(clens,cmap,MAX){var maxlen=1,w=0,i2=0,j=0,ccode=0,L=clens.length,bl_count=use_typed_arrays?new Uint16Array(32):zero_fill_array(32);for(i2=0;i2<32;++i2)bl_count[i2]=0;for(i2=L;i2<MAX;++i2)clens[i2]=0;L=clens.length;var ctree=use_typed_arrays?new Uint16Array(L):zero_fill_array(L);for(i2=0;i2<L;++i2)bl_count[w=clens[i2]]++,maxlen<w&&(maxlen=w),ctree[i2]=0;for(bl_count[0]=0,i2=1;i2<=maxlen;++i2)bl_count[i2+16]=ccode=ccode+bl_count[i2-1]<<1;for(i2=0;i2<L;++i2)ccode=clens[i2],ccode!=0&&(ctree[i2]=bl_count[ccode+16]++);var cleni=0;for(i2=0;i2<L;++i2)if(cleni=clens[i2],cleni!=0)for(ccode=bit_swap_n(ctree[i2],maxlen)>>maxlen-cleni,j=(1<<maxlen+4-cleni)-1;j>=0;--j)cmap[ccode|j<<cleni]=cleni&15|i2<<4;return maxlen}var fix_lmap=use_typed_arrays?new Uint16Array(512):zero_fill_array(512),fix_dmap=use_typed_arrays?new Uint16Array(32):zero_fill_array(32);if(!use_typed_arrays){for(var i=0;i<512;++i)fix_lmap[i]=0;for(i=0;i<32;++i)fix_dmap[i]=0}(function(){for(var dlens=[],i2=0;i2<32;i2++)dlens.push(5);build_tree(dlens,fix_dmap,32);var clens=[];for(i2=0;i2<=143;i2++)clens.push(8);for(;i2<=255;i2++)clens.push(9);for(;i2<=279;i2++)clens.push(7);for(;i2<=287;i2++)clens.push(8);build_tree(clens,fix_lmap,288)})();var _deflateRaw=function(){for(var DST_LN_RE=use_typed_arrays?new Uint8Array(32768):[],j=0,k=0;j<DST_LN.length-1;++j)for(;k<DST_LN[j+1];++k)DST_LN_RE[k]=j;for(;k<32768;++k)DST_LN_RE[k]=29;var LEN_LN_RE=use_typed_arrays?new Uint8Array(259):[];for(j=0,k=0;j<LEN_LN.length-1;++j)for(;k<LEN_LN[j+1];++k)LEN_LN_RE[k]=j;function write_stored(data,out){for(var boff=0;boff<data.length;){var L=Math.min(65535,data.length-boff),h=boff+L==data.length;for(out.write_shift(1,+h),out.write_shift(2,L),out.write_shift(2,~L&65535);L-- >0;)out[out.l++]=data[boff++]}return out.l}function write_huff_fixed(data,out){for(var bl=0,boff=0,addrs=use_typed_arrays?new Uint16Array(32768):[];boff<data.length;){var L=Math.min(65535,data.length-boff);if(L<10){for(bl=write_bits_3(out,bl,+(boff+L==data.length)),bl&7&&(bl+=8-(bl&7)),out.l=bl/8|0,out.write_shift(2,L),out.write_shift(2,~L&65535);L-- >0;)out[out.l++]=data[boff++];bl=out.l*8;continue}bl=write_bits_3(out,bl,+(boff+L==data.length)+2);for(var hash3=0;L-- >0;){var d=data[boff];hash3=(hash3<<5^d)&32767;var match=-1,mlen=0;if((match=addrs[hash3])&&(match|=boff&-32768,match>boff&&(match-=32768),match<boff))for(;data[match+mlen]==data[boff+mlen]&&mlen<250;)++mlen;if(mlen>2){d=LEN_LN_RE[mlen],d<=22?bl=write_bits_8(out,bl,bitswap8[d+1]>>1)-1:(write_bits_8(out,bl,3),bl+=5,write_bits_8(out,bl,bitswap8[d-23]>>5),bl+=3);var len_eb=d<8?0:d-4>>2;len_eb>0&&(write_bits_16(out,bl,mlen-LEN_LN[d]),bl+=len_eb),d=DST_LN_RE[boff-match],bl=write_bits_8(out,bl,bitswap8[d]>>3),bl-=3;var dst_eb=d<4?0:d-2>>1;dst_eb>0&&(write_bits_16(out,bl,boff-match-DST_LN[d]),bl+=dst_eb);for(var q2=0;q2<mlen;++q2)addrs[hash3]=boff&32767,hash3=(hash3<<5^data[boff])&32767,++boff;L-=mlen-1}else d<=143?d=d+48:bl=write_bits_1(out,bl,1),bl=write_bits_8(out,bl,bitswap8[d]),addrs[hash3]=boff&32767,++boff}bl=write_bits_8(out,bl,0)-1}return out.l=(bl+7)/8|0,out.l}return function(data,out){return data.length<8?write_stored(data,out):write_huff_fixed(data,out)}}();function _deflate(data){var buf=new_buf(50+Math.floor(data.length*1.1)),off=_deflateRaw(data,buf);return buf.slice(0,off)}var dyn_lmap=use_typed_arrays?new Uint16Array(32768):zero_fill_array(32768),dyn_dmap=use_typed_arrays?new Uint16Array(32768):zero_fill_array(32768),dyn_cmap=use_typed_arrays?new Uint16Array(128):zero_fill_array(128),dyn_len_1=1,dyn_len_2=1;function dyn(data,boff){var _HLIT=read_bits_5(data,boff)+257;boff+=5;var _HDIST=read_bits_5(data,boff)+1;boff+=5;var _HCLEN=read_bits_4(data,boff)+4;boff+=4;for(var w=0,clens=use_typed_arrays?new Uint8Array(19):zero_fill_array(19),ctree=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],maxlen=1,bl_count=use_typed_arrays?new Uint8Array(8):zero_fill_array(8),next_code=use_typed_arrays?new Uint8Array(8):zero_fill_array(8),L=clens.length,i2=0;i2<_HCLEN;++i2)clens[CLEN_ORDER[i2]]=w=read_bits_3(data,boff),maxlen<w&&(maxlen=w),bl_count[w]++,boff+=3;var ccode=0;for(bl_count[0]=0,i2=1;i2<=maxlen;++i2)next_code[i2]=ccode=ccode+bl_count[i2-1]<<1;for(i2=0;i2<L;++i2)(ccode=clens[i2])!=0&&(ctree[i2]=next_code[ccode]++);var cleni=0;for(i2=0;i2<L;++i2)if(cleni=clens[i2],cleni!=0){ccode=bitswap8[ctree[i2]]>>8-cleni;for(var j=(1<<7-cleni)-1;j>=0;--j)dyn_cmap[ccode|j<<cleni]=cleni&7|i2<<3}var hcodes=[];for(maxlen=1;hcodes.length<_HLIT+_HDIST;)switch(ccode=dyn_cmap[read_bits_7(data,boff)],boff+=ccode&7,ccode>>>=3){case 16:for(w=3+read_bits_2(data,boff),boff+=2,ccode=hcodes[hcodes.length-1];w-- >0;)hcodes.push(ccode);break;case 17:for(w=3+read_bits_3(data,boff),boff+=3;w-- >0;)hcodes.push(0);break;case 18:for(w=11+read_bits_7(data,boff),boff+=7;w-- >0;)hcodes.push(0);break;default:hcodes.push(ccode),maxlen<ccode&&(maxlen=ccode);break}var h1=hcodes.slice(0,_HLIT),h2=hcodes.slice(_HLIT);for(i2=_HLIT;i2<286;++i2)h1[i2]=0;for(i2=_HDIST;i2<30;++i2)h2[i2]=0;return dyn_len_1=build_tree(h1,dyn_lmap,286),dyn_len_2=build_tree(h2,dyn_dmap,30),boff}function inflate(data,usz){if(data[0]==3&&!(data[1]&3))return[new_raw_buf(usz),2];for(var boff=0,header=0,outbuf=new_unsafe_buf(usz||1<<18),woff=0,OL=outbuf.length>>>0,max_len_1=0,max_len_2=0;!(header&1);){if(header=read_bits_3(data,boff),boff+=3,header>>>1)header>>1==1?(max_len_1=9,max_len_2=5):(boff=dyn(data,boff),max_len_1=dyn_len_1,max_len_2=dyn_len_2);else{boff&7&&(boff+=8-(boff&7));var sz=data[boff>>>3]|data[(boff>>>3)+1]<<8;if(boff+=32,sz>0)for(!usz&&OL<woff+sz&&(outbuf=realloc(outbuf,woff+sz),OL=outbuf.length);sz-- >0;)outbuf[woff++]=data[boff>>>3],boff+=8;continue}for(;;){!usz&&OL<woff+32767&&(outbuf=realloc(outbuf,woff+32767),OL=outbuf.length);var bits=read_bits_n(data,boff,max_len_1),code=header>>>1==1?fix_lmap[bits]:dyn_lmap[bits];if(boff+=code&15,code>>>=4,!(code>>>8&255))outbuf[woff++]=code;else{if(code==256)break;code-=257;var len_eb=code<8?0:code-4>>2;len_eb>5&&(len_eb=0);var tgt=woff+LEN_LN[code];len_eb>0&&(tgt+=read_bits_n(data,boff,len_eb),boff+=len_eb),bits=read_bits_n(data,boff,max_len_2),code=header>>>1==1?fix_dmap[bits]:dyn_dmap[bits],boff+=code&15,code>>>=4;var dst_eb=code<4?0:code-2>>1,dst=DST_LN[code];for(dst_eb>0&&(dst+=read_bits_n(data,boff,dst_eb),boff+=dst_eb),!usz&&OL<tgt&&(outbuf=realloc(outbuf,tgt+100),OL=outbuf.length);woff<tgt;)outbuf[woff]=outbuf[woff-dst],++woff}}}return usz?[outbuf,boff+7>>>3]:[outbuf.slice(0,woff),boff+7>>>3]}function _inflate(payload,usz){var data=payload.slice(payload.l||0),out=inflate(data,usz);return payload.l+=out[1],out[0]}function warn_or_throw(wrn,msg){if(wrn)typeof console<"u"&&console.error(msg);else throw new Error(msg)}function parse_zip(file,options){var blob=file;prep_blob(blob,0);var FileIndex=[],FullPaths=[],o={FileIndex,FullPaths};init_cfb(o,{root:options.root});for(var i2=blob.length-4;(blob[i2]!=80||blob[i2+1]!=75||blob[i2+2]!=5||blob[i2+3]!=6)&&i2>=0;)--i2;blob.l=i2+4,blob.l+=4;var fcnt=blob.read_shift(2);blob.l+=6;var start_cd=blob.read_shift(4);for(blob.l=start_cd,i2=0;i2<fcnt;++i2){blob.l+=20;var csz=blob.read_shift(4),usz=blob.read_shift(4),namelen=blob.read_shift(2),efsz=blob.read_shift(2),fcsz=blob.read_shift(2);blob.l+=8;var offset2=blob.read_shift(4),EF=parse_extra_field(blob.slice(blob.l+namelen,blob.l+namelen+efsz));blob.l+=namelen+efsz+fcsz;var L=blob.l;blob.l=offset2+4,EF&&EF[1]&&((EF[1]||{}).usz&&(usz=EF[1].usz),(EF[1]||{}).csz&&(csz=EF[1].csz)),parse_local_file(blob,csz,usz,o,EF),blob.l=L}return o}function parse_local_file(blob,csz,usz,o,EF){blob.l+=2;var flags=blob.read_shift(2),meth=blob.read_shift(2),date=parse_dos_date(blob);if(flags&8257)throw new Error("Unsupported ZIP encryption");for(var crc32=blob.read_shift(4),_csz=blob.read_shift(4),_usz=blob.read_shift(4),namelen=blob.read_shift(2),efsz=blob.read_shift(2),name="",i2=0;i2<namelen;++i2)name+=String.fromCharCode(blob[blob.l++]);if(efsz){var ef=parse_extra_field(blob.slice(blob.l,blob.l+efsz));(ef[21589]||{}).mt&&(date=ef[21589].mt),(ef[1]||{}).usz&&(_usz=ef[1].usz),(ef[1]||{}).csz&&(_csz=ef[1].csz),EF&&((EF[21589]||{}).mt&&(date=EF[21589].mt),(EF[1]||{}).usz&&(_usz=ef[1].usz),(EF[1]||{}).csz&&(_csz=ef[1].csz))}blob.l+=efsz;var data=blob.slice(blob.l,blob.l+_csz);switch(meth){case 8:data=_inflateRawSync(blob,_usz);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+meth)}var wrn=!1;flags&8&&(crc32=blob.read_shift(4),crc32==134695760&&(crc32=blob.read_shift(4),wrn=!0),_csz=blob.read_shift(4),_usz=blob.read_shift(4)),_csz!=csz&&warn_or_throw(wrn,"Bad compressed size: "+csz+" != "+_csz),_usz!=usz&&warn_or_throw(wrn,"Bad uncompressed size: "+usz+" != "+_usz),cfb_add(o,name,data,{unsafe:!0,mt:date})}function write_zip2(cfb,options){var _opts=options||{},out=[],cdirs=[],o=new_buf(1),method=_opts.compression?8:0,flags=0,desc=!1;desc&&(flags|=8);var i2=0,j=0,start_cd=0,fcnt=0,root=cfb.FullPaths[0],fp=root,fi=cfb.FileIndex[0],crcs=[],sz_cd=0;for(i2=1;i2<cfb.FullPaths.length;++i2)if(fp=cfb.FullPaths[i2].slice(root.length),fi=cfb.FileIndex[i2],!(!fi.size||!fi.content||fp=="Sh33tJ5")){var start2=start_cd,namebuf=new_buf(fp.length);for(j=0;j<fp.length;++j)namebuf.write_shift(1,fp.charCodeAt(j)&127);namebuf=namebuf.slice(0,namebuf.l),crcs[fcnt]=typeof fi.content=="string"?CRC32.bstr(fi.content,0):CRC32.buf(fi.content,0);var outbuf=typeof fi.content=="string"?s2a(fi.content):fi.content;method==8&&(outbuf=_deflateRawSync(outbuf)),o=new_buf(30),o.write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,flags),o.write_shift(2,method),fi.mt?write_dos_date(o,fi.mt):o.write_shift(4,0),o.write_shift(-4,flags&8?0:crcs[fcnt]),o.write_shift(4,flags&8?0:outbuf.length),o.write_shift(4,flags&8?0:fi.content.length),o.write_shift(2,namebuf.length),o.write_shift(2,0),start_cd+=o.length,out.push(o),start_cd+=namebuf.length,out.push(namebuf),start_cd+=outbuf.length,out.push(outbuf),flags&8&&(o=new_buf(12),o.write_shift(-4,crcs[fcnt]),o.write_shift(4,outbuf.length),o.write_shift(4,fi.content.length),start_cd+=o.l,out.push(o)),o=new_buf(46),o.write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,flags),o.write_shift(2,method),o.write_shift(4,0),o.write_shift(-4,crcs[fcnt]),o.write_shift(4,outbuf.length),o.write_shift(4,fi.content.length),o.write_shift(2,namebuf.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,start2),sz_cd+=o.l,cdirs.push(o),sz_cd+=namebuf.length,cdirs.push(namebuf),++fcnt}return o=new_buf(22),o.write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,fcnt),o.write_shift(2,fcnt),o.write_shift(4,sz_cd),o.write_shift(4,start_cd),o.write_shift(2,0),bconcat([bconcat(out),bconcat(cdirs),o])}var ContentTypeMap={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function get_content_type(fi,fp){if(fi.ctype)return fi.ctype;var ext=fi.name||"",m=ext.match(/\.([^\.]+)$/);return m&&ContentTypeMap[m[1]]||fp&&(m=(ext=fp).match(/[\.\\]([^\.\\])+$/),m&&ContentTypeMap[m[1]])?ContentTypeMap[m[1]]:"application/octet-stream"}function write_base64_76(bstr){for(var data=Base64_encode(bstr),o=[],i2=0;i2<data.length;i2+=76)o.push(data.slice(i2,i2+76));return o.join(`\r
`)+`\r
`}function write_quoted_printable(text){var encoded=text.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(c){var w=c.charCodeAt(0).toString(16).toUpperCase();return"="+(w.length==1?"0"+w:w)});encoded=encoded.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),encoded.charAt(0)==`
`&&(encoded="=0D"+encoded.slice(1)),encoded=encoded.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var o=[],split=encoded.split(`\r
`),si=0;si<split.length;++si){var str=split[si];if(str.length==0){o.push("");continue}for(var i2=0;i2<str.length;){var end2=76,tmp=str.slice(i2,i2+end2);tmp.charAt(end2-1)=="="?end2--:tmp.charAt(end2-2)=="="?end2-=2:tmp.charAt(end2-3)=="="&&(end2-=3),tmp=str.slice(i2,i2+end2),i2+=end2,i2<str.length&&(tmp+="="),o.push(tmp)}}return o.join(`\r
`)}function parse_quoted_printable(data){for(var o=[],di=0;di<data.length;++di){for(var line=data[di];di<=data.length&&line.charAt(line.length-1)=="=";)line=line.slice(0,line.length-1)+data[++di];o.push(line)}for(var oi=0;oi<o.length;++oi)o[oi]=o[oi].replace(/[=][0-9A-Fa-f]{2}/g,function($$){return String.fromCharCode(parseInt($$.slice(1),16))});return s2a(o.join(`\r
`))}function parse_mime(cfb,data,root){for(var fname="",cte="",ctype="",fdata,di=0;di<10;++di){var line=data[di];if(!line||line.match(/^\s*$/))break;var m=line.match(/^([^:]*?):\s*([^\s].*)$/);if(m)switch(m[1].toLowerCase()){case"content-location":fname=m[2].trim();break;case"content-type":ctype=m[2].trim();break;case"content-transfer-encoding":cte=m[2].trim();break}}switch(++di,cte.toLowerCase()){case"base64":fdata=s2a(Base64_decode(data.slice(di).join("")));break;case"quoted-printable":fdata=parse_quoted_printable(data.slice(di));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+cte)}var file=cfb_add(cfb,fname.slice(root.length),fdata,{unsafe:!0});ctype&&(file.ctype=ctype)}function parse_mad(file,options){if(a2s2(file.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var root=options&&options.root||"",data=(has_buf&&Buffer.isBuffer(file)?file.toString("binary"):a2s2(file)).split(`\r
`),di=0,row="";for(di=0;di<data.length;++di)if(row=data[di],!!/^Content-Location:/i.test(row)&&(row=row.slice(row.indexOf("file")),root||(root=row.slice(0,row.lastIndexOf("/")+1)),row.slice(0,root.length)!=root))for(;root.length>0&&(root=root.slice(0,root.length-1),root=root.slice(0,root.lastIndexOf("/")+1),row.slice(0,root.length)!=root););var mboundary=(data[1]||"").match(/boundary="(.*?)"/);if(!mboundary)throw new Error("MAD cannot find boundary");var boundary="--"+(mboundary[1]||""),FileIndex=[],FullPaths=[],o={FileIndex,FullPaths};init_cfb(o);var start_di,fcnt=0;for(di=0;di<data.length;++di){var line=data[di];line!==boundary&&line!==boundary+"--"||(fcnt++&&parse_mime(o,data.slice(start_di,di),root),start_di=di)}return o}function write_mad(cfb,options){var opts=options||{},boundary=opts.boundary||"SheetJS";boundary="------="+boundary;for(var out=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+boundary.slice(2)+'"',"","",""],root=cfb.FullPaths[0],fp=root,fi=cfb.FileIndex[0],i2=1;i2<cfb.FullPaths.length;++i2)if(fp=cfb.FullPaths[i2].slice(root.length),fi=cfb.FileIndex[i2],!(!fi.size||!fi.content||fp=="Sh33tJ5")){fp=fp.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(c){return"_x"+c.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(u){return"_u"+u.charCodeAt(0).toString(16)+"_"});for(var ca=fi.content,cstr=has_buf&&Buffer.isBuffer(ca)?ca.toString("binary"):a2s2(ca),dispcnt=0,L=Math.min(1024,cstr.length),cc=0,csl=0;csl<=L;++csl)(cc=cstr.charCodeAt(csl))>=32&&cc<128&&++dispcnt;var qp=dispcnt>=L*4/5;out.push(boundary),out.push("Content-Location: "+(opts.root||"file:///C:/SheetJS/")+fp),out.push("Content-Transfer-Encoding: "+(qp?"quoted-printable":"base64")),out.push("Content-Type: "+get_content_type(fi,fp)),out.push(""),out.push(qp?write_quoted_printable(cstr):write_base64_76(cstr))}return out.push(boundary+`--\r
`),out.join(`\r
`)}function cfb_new(opts){var o={};return init_cfb(o,opts),o}function cfb_add(cfb,name,content,opts){var unsafe=opts&&opts.unsafe;unsafe||init_cfb(cfb);var file=!unsafe&&CFB.find(cfb,name);if(!file){var fpath=cfb.FullPaths[0];name.slice(0,fpath.length)==fpath?fpath=name:(fpath.slice(-1)!="/"&&(fpath+="/"),fpath=(fpath+name).replace("//","/")),file={name:filename(name),type:2},cfb.FileIndex.push(file),cfb.FullPaths.push(fpath),unsafe||CFB.utils.cfb_gc(cfb)}return file.content=content,file.size=content?content.length:0,opts&&(opts.CLSID&&(file.clsid=opts.CLSID),opts.mt&&(file.mt=opts.mt),opts.ct&&(file.ct=opts.ct)),file}function cfb_del(cfb,name){init_cfb(cfb);var file=CFB.find(cfb,name);if(file){for(var j=0;j<cfb.FileIndex.length;++j)if(cfb.FileIndex[j]==file)return cfb.FileIndex.splice(j,1),cfb.FullPaths.splice(j,1),!0}return!1}function cfb_mov(cfb,old_name,new_name){init_cfb(cfb);var file=CFB.find(cfb,old_name);if(file){for(var j=0;j<cfb.FileIndex.length;++j)if(cfb.FileIndex[j]==file)return cfb.FileIndex[j].name=filename(new_name),cfb.FullPaths[j]=new_name,!0}return!1}function cfb_gc(cfb){rebuild_cfb(cfb,!0)}return exports.find=find,exports.read=read2,exports.parse=parse,exports.write=write2,exports.writeFile=write_file,exports.utils={cfb_new,cfb_add,cfb_del,cfb_mov,cfb_gc,ReadShift,CheckField,prep_blob,bconcat,use_zlib,_deflateRaw:_deflate,_inflateRaw:_inflate,consts},exports}(),_fs;function blobify(data){return typeof data=="string"?s2ab2(data):Array.isArray(data)?a2u(data):data}function write_dl(fname,payload,enc){if(typeof _fs<"u"&&_fs.writeFileSync)return enc?_fs.writeFileSync(fname,payload,enc):_fs.writeFileSync(fname,payload);if(typeof Deno<"u"){if(enc&&typeof payload=="string")switch(enc){case"utf8":payload=new TextEncoder(enc).encode(payload);break;case"binary":payload=s2ab2(payload);break;default:throw new Error("Unsupported encoding "+enc)}return Deno.writeFileSync(fname,payload)}var data=enc=="utf8"?utf8write(payload):payload;if(typeof IE_SaveFile<"u")return IE_SaveFile(data,fname);if(typeof Blob<"u"){var blob=new Blob([blobify(data)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(blob,fname);if(typeof saveAs<"u")return saveAs(blob,fname);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var url=URL.createObjectURL(blob);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(url)},6e4),chrome.downloads.download({url,filename:fname,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=fname,a.href=url,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(url)},6e4),url}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var b64="data:application/octet-stream;base64,"+Base64_encode_arr(new Uint8Array(blobify(data)));return chrome.downloads.download({url:b64,filename:fname,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var out=File(fname);return out.open("w"),out.encoding="binary",Array.isArray(payload)&&(payload=a2s(payload)),out.write(payload),out.close(),payload}catch(e){if(!e.message||e.message.indexOf("onstruct")==-1)throw e}throw new Error("cannot save file "+fname)}function keys(o){for(var ks=Object.keys(o),o2=[],i=0;i<ks.length;++i)Object.prototype.hasOwnProperty.call(o,ks[i])&&o2.push(ks[i]);return o2}function evert_key(obj,key){for(var o=[],K=keys(obj),i=0;i!==K.length;++i)o[obj[K[i]][key]]==null&&(o[obj[K[i]][key]]=K[i]);return o}function evert(obj){for(var o=[],K=keys(obj),i=0;i!==K.length;++i)o[obj[K[i]]]=K[i];return o}function evert_num(obj){for(var o=[],K=keys(obj),i=0;i!==K.length;++i)o[obj[K[i]]]=parseInt(K[i],10);return o}function evert_arr(obj){for(var o=[],K=keys(obj),i=0;i!==K.length;++i)o[obj[K[i]]]==null&&(o[obj[K[i]]]=[]),o[obj[K[i]]].push(K[i]);return o}var dnthresh=Date.UTC(1899,11,30,0,0,0),dnthresh1=Date.UTC(1899,11,31,0,0,0),dnthresh2=Date.UTC(1904,0,1,0,0,0);function datenum(v,date1904){var epoch=v.getTime(),res=(epoch-dnthresh)/(24*60*60*1e3);return date1904?(res-=1462,res<-1402?res-1:res):res<60?res-1:res}function numdate(v){if(v>=60&&v<61)return v;var out=new Date;return out.setTime((v>60?v:v+1)*24*60*60*1e3+dnthresh),out}var pdre1=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,pdre2=/^(\d+)-(\d+)-(\d+)$/,pdre3=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function parseDate(str,date1904){if(str instanceof Date)return str;var m=str.match(pdre1);if(m)return new Date((date1904?dnthresh2:dnthresh1)+((parseInt(m[1],10)*60+parseInt(m[2],10))*60+(m[3]?parseInt(m[3].slice(1),10):0))*1e3+(m[4]?parseInt((m[4]+"000").slice(1,4),10):0));if(m=str.match(pdre2),m)return new Date(Date.UTC(+m[1],+m[2]-1,+m[3],0,0,0,0));if(m=str.match(pdre3),m)return new Date(Date.UTC(+m[1],+m[2]-1,+m[3],+m[4],+m[5],m[6]&&parseInt(m[6].slice(1),10)||0,m[7]&&parseInt((m[7]+"0000").slice(1,4),10)||0));var d=new Date(str);return d}function cc2str(arr,debomit){if(has_buf&&Buffer.isBuffer(arr)){if(debomit&&buf_utf16le){if(arr[0]==255&&arr[1]==254)return utf8write(arr.slice(2).toString("utf16le"));if(arr[1]==254&&arr[2]==255)return utf8write(utf16beread(arr.slice(2).toString("binary")))}return arr.toString("binary")}if(typeof TextDecoder<"u")try{if(debomit){if(arr[0]==255&&arr[1]==254)return utf8write(new TextDecoder("utf-16le").decode(arr.slice(2)));if(arr[0]==254&&arr[1]==255)return utf8write(new TextDecoder("utf-16be").decode(arr.slice(2)))}var rev={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(arr)&&(arr=new Uint8Array(arr)),new TextDecoder("latin1").decode(arr).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(c){return rev[c]||c})}catch{}var o=[],i=0;try{for(i=0;i<arr.length-65536;i+=65536)o.push(String.fromCharCode.apply(0,arr.slice(i,i+65536)));o.push(String.fromCharCode.apply(0,arr.slice(i)))}catch{try{for(;i<arr.length-16384;i+=16384)o.push(String.fromCharCode.apply(0,arr.slice(i,i+16384)));o.push(String.fromCharCode.apply(0,arr.slice(i)))}catch{for(;i!=arr.length;++i)o.push(String.fromCharCode(arr[i]))}}return o.join("")}function dup(o){if(typeof JSON<"u"&&!Array.isArray(o))return JSON.parse(JSON.stringify(o));if(typeof o!="object"||o==null)return o;if(o instanceof Date)return new Date(o.getTime());var out={};for(var k in o)Object.prototype.hasOwnProperty.call(o,k)&&(out[k]=dup(o[k]));return out}function fill(c,l){for(var o="";o.length<l;)o+=c;return o}function fuzzynum(s){var v=Number(s);if(!isNaN(v))return isFinite(v)?v:NaN;if(!/\d/.test(s))return v;var wt=1,ss=s.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return wt*=100,""});return!isNaN(v=Number(ss))||(ss=ss.replace(/[(]([^()]*)[)]/,function($$,$1){return wt=-wt,$1}),!isNaN(v=Number(ss)))?v/wt:v}var FDRE1=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,FDRE2=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,FDISO=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,utc_append_works=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function fuzzytime1(M){return M[2]?M[3]?M[4]?new Date(Date.UTC(1899,11,31,+M[1]%12+(M[7]=="p"?12:0),+M[2],+M[4],parseFloat(M[3])*1e3)):new Date(Date.UTC(1899,11,31,M[7]=="p"?12:0,+M[1],+M[2],parseFloat(M[3])*1e3)):M[5]?new Date(Date.UTC(1899,11,31,+M[1]%12+(M[7]=="p"?12:0),+M[2],+M[5],M[6]?parseFloat(M[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+M[1]%12+(M[7]=="p"?12:0),+M[2],0,0)):new Date(Date.UTC(1899,11,31,+M[1]%12+(M[7]=="p"?12:0),0,0,0))}function fuzzytime2(M){return M[2]?M[3]?M[4]?new Date(Date.UTC(1899,11,31,+M[1],+M[2],+M[4],parseFloat(M[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+M[1],+M[2],parseFloat(M[3])*1e3)):M[5]?new Date(Date.UTC(1899,11,31,+M[1],+M[2],+M[5],M[6]?parseFloat(M[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+M[1],+M[2],0,0)):new Date(Date.UTC(1899,11,31,+M[1],0,0,0))}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(s){if(FDISO.test(s))return s.indexOf("Z")==-1?local_to_utc(new Date(s)):new Date(s);var lower=s.toLowerCase(),lnos=lower.replace(/\s+/g," ").trim(),M=lnos.match(FDRE1);if(M)return fuzzytime1(M);if(M=lnos.match(FDRE2),M)return fuzzytime2(M);if(M=lnos.match(pdre3),M)return new Date(Date.UTC(+M[1],+M[2]-1,+M[3],+M[4],+M[5],M[6]&&parseInt(M[6].slice(1),10)||0,M[7]&&parseInt((M[7]+"0000").slice(1,4),10)||0));var o=new Date(utc_append_works&&s.indexOf("UTC")==-1?s+" UTC":s),n=new Date(NaN),y=o.getYear(),m=o.getMonth(),d=o.getDate();if(isNaN(d))return n;if(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(lower=lower.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),lower.length>3&&lower_months.indexOf(lower)==-1)return n}else if(lower.replace(/[ap]m?/,"").match(/[a-z]/))return n;return y<0||y>8099||s.match(/[^-0-9:,\/\\\ ]/)?n:o}function utc_to_local(utc){return new Date(utc.getUTCFullYear(),utc.getUTCMonth(),utc.getUTCDate(),utc.getUTCHours(),utc.getUTCMinutes(),utc.getUTCSeconds(),utc.getUTCMilliseconds())}function local_to_utc(local){return new Date(Date.UTC(local.getFullYear(),local.getMonth(),local.getDate(),local.getHours(),local.getMinutes(),local.getSeconds(),local.getMilliseconds()))}function zip_add_file(zip,path,content){if(zip.FullPaths){if(typeof content=="string"){var res;return has_buf?res=Buffer_from(content):res=utf8decode(content),CFB.utils.cfb_add(zip,path,res)}CFB.utils.cfb_add(zip,path,content)}else zip.file(path,content)}function zip_new(){return CFB.utils.cfb_new()}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings);var decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function escapexml(text){var s=text+"";return s.replace(decregex,function(y){return rencoding[y]}).replace(charegex,function(s2){return"_x"+("000"+s2.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(text){return escapexml(text).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(text){var s=text+"";return s.replace(decregex,function(y){return rencoding[y]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(s2){return"&#x"+("000"+s2.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(text){var s=text+"";return s.replace(decregex,function(y){return rencoding[y]}).replace(htmlcharegex,function(s2){return"&#x"+s2.charCodeAt(0).toString(16).toUpperCase()+";"})}function xlml_unfixstr(str){return str.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(value){switch(value){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function utf8reada(orig){for(var out="",i=0,c=0,d=0,e=0,f=0,w=0;i<orig.length;){if(c=orig.charCodeAt(i++),c<128){out+=String.fromCharCode(c);continue}if(d=orig.charCodeAt(i++),c>191&&c<224){f=(c&31)<<6,f|=d&63,out+=String.fromCharCode(f);continue}if(e=orig.charCodeAt(i++),c<240){out+=String.fromCharCode((c&15)<<12|(d&63)<<6|e&63);continue}f=orig.charCodeAt(i++),w=((c&7)<<18|(d&63)<<12|(e&63)<<6|f&63)-65536,out+=String.fromCharCode(55296+(w>>>10&1023)),out+=String.fromCharCode(56320+(w&1023))}return out}function utf8readb(data){var out=new_raw_buf(2*data.length),w,i,j=1,k=0,ww=0,c;for(i=0;i<data.length;i+=j)j=1,(c=data.charCodeAt(i))<128?w=c:c<224?(w=(c&31)*64+(data.charCodeAt(i+1)&63),j=2):c<240?(w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63),j=3):(j=4,w=(c&7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63),w-=65536,ww=55296+(w>>>10&1023),w=56320+(w&1023)),ww!==0&&(out[k++]=ww&255,out[k++]=ww>>>8,ww=0),out[k++]=w%256,out[k++]=w>>>8;return out.slice(0,k).toString("ucs2")}function utf8readc(data){return Buffer_from(data,"binary").toString("utf8")}var utf8corpus="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(data){return Buffer_from(data,"utf8").toString("binary")}:function(orig){for(var out=[],i=0,c=0,d=0;i<orig.length;)switch(c=orig.charCodeAt(i++),!0){case c<128:out.push(String.fromCharCode(c));break;case c<2048:out.push(String.fromCharCode(192+(c>>6))),out.push(String.fromCharCode(128+(c&63)));break;case(c>=55296&&c<57344):c-=55296,d=orig.charCodeAt(i++)-56320+(c<<10),out.push(String.fromCharCode(240+(d>>18&7))),out.push(String.fromCharCode(144+(d>>12&63))),out.push(String.fromCharCode(128+(d>>6&63))),out.push(String.fromCharCode(128+(d&63)));break;default:out.push(String.fromCharCode(224+(c>>12))),out.push(String.fromCharCode(128+(c>>6&63))),out.push(String.fromCharCode(128+(c&63)))}return out.join("")},htmldecode=function(){var entities=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(x){return[new RegExp("&"+x[0]+";","ig"),x[1]]});return function(str){for(var o=str.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<entities.length;++i)o=o.replace(entities[i][0],entities[i][1]);return o}}();var wtregex=/(^\s|\s$|\n)/;function writetag(f,g){return"<"+f+(g.match(wtregex)?' xml:space="preserve"':"")+">"+g+"</"+f+">"}function wxt_helper(h){return keys(h).map(function(k){return" "+k+'="'+h[k]+'"'}).join("")}function writextag(f,g,h){return"<"+f+(h!=null?wxt_helper(h):"")+(g!=null?(g.match(wtregex)?' xml:space="preserve"':"")+">"+g+"</"+f:"/")+">"}function write_w3cdtf(d,t){try{return d.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function write_vt(s,xlsx){switch(typeof s){case"string":var o=writextag("vt:lpwstr",escapexml(s));return xlsx&&(o=o.replace(/&quot;/g,"_x0022_")),o;case"number":return writextag((s|0)==s?"vt:i4":"vt:r8",escapexml(String(s)));case"boolean":return writextag("vt:bool",s?"true":"false")}if(s instanceof Date)return writextag("vt:filetime",write_w3cdtf(s));throw new Error("Unable to serialize "+s)}var XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(b,idx){for(var s=1-2*(b[idx+7]>>>7),e=((b[idx+7]&127)<<4)+(b[idx+6]>>>4&15),m=b[idx+6]&15,i=5;i>=0;--i)m=m*256+b[idx+i];return e==2047?m==0?s*(1/0):NaN:(e==0?e=-1022:(e-=1023,m+=Math.pow(2,52)),s*Math.pow(2,e-52)*m)}function write_double_le(b,v,idx){var bs=(v<0||1/v==-1/0?1:0)<<7,e=0,m=0,av=bs?-v:v;isFinite(av)?av==0?e=m=0:(e=Math.floor(Math.log(av)/Math.LN2),m=av*Math.pow(2,52-e),e<=-1023&&(!isFinite(m)||m<Math.pow(2,52))?e=-1022:(m-=Math.pow(2,52),e+=1023)):(e=2047,m=isNaN(v)?26985:0);for(var i=0;i<=5;++i,m/=256)b[idx+i]=m&255;b[idx+6]=(e&15)<<4|m&15,b[idx+7]=e>>4|bs}var ___toBuffer=function(bufs){for(var x=[],w=10240,i=0;i<bufs[0].length;++i)if(bufs[0][i])for(var j=0,L=bufs[0][i].length;j<L;j+=w)x.push.apply(x,bufs[0][i].slice(j,j+w));return x},__toBuffer=has_buf?function(bufs){return bufs[0].length>0&&Buffer.isBuffer(bufs[0][0])?Buffer.concat(bufs[0].map(function(x){return Buffer.isBuffer(x)?x:Buffer_from(x)})):___toBuffer(bufs)}:___toBuffer,___utf16le=function(b,s,e){for(var ss=[],i=s;i<e;i+=2)ss.push(String.fromCharCode(__readUInt16LE(b,i)));return ss.join("").replace(chr0,"")},__utf16le=has_buf?function(b,s,e){return!Buffer.isBuffer(b)||!buf_utf16le?___utf16le(b,s,e):b.toString("utf16le",s,e).replace(chr0,"")}:___utf16le,___hexlify=function(b,s,l){for(var ss=[],i=s;i<s+l;++i)ss.push(("0"+b[i].toString(16)).slice(-2));return ss.join("")},__hexlify=has_buf?function(b,s,l){return Buffer.isBuffer(b)?b.toString("hex",s,s+l):___hexlify(b,s,l)}:___hexlify,___utf8=function(b,s,e){for(var ss=[],i=s;i<e;i++)ss.push(String.fromCharCode(__readUInt8(b,i)));return ss.join("")},__utf8=has_buf?function(b,s,e){return Buffer.isBuffer(b)?b.toString("utf8",s,e):___utf8(b,s,e)}:___utf8,___lpstr=function(b,i){var len=__readUInt32LE(b,i);return len>0?__utf8(b,i+4,i+4+len-1):""},__lpstr=___lpstr,___cpstr=function(b,i){var len=__readUInt32LE(b,i);return len>0?__utf8(b,i+4,i+4+len-1):""},__cpstr=___cpstr,___lpwstr=function(b,i){var len=2*__readUInt32LE(b,i);return len>0?__utf8(b,i+4,i+4+len-1):""},__lpwstr=___lpwstr,___lpp4=function(b,i){var len=__readUInt32LE(b,i);return len>0?__utf16le(b,i+4,i+4+len):""},__lpp4=___lpp4,___8lpp4=function(b,i){var len=__readUInt32LE(b,i);return len>0?__utf8(b,i+4,i+4+len):""},__8lpp4=___8lpp4,___double=function(b,idx){return read_double_le(b,idx)},__double=___double,is_buf=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};has_buf&&(__lpstr=function(b,i){if(!Buffer.isBuffer(b))return ___lpstr(b,i);var len=b.readUInt32LE(i);return len>0?b.toString("utf8",i+4,i+4+len-1):""},__cpstr=function(b,i){if(!Buffer.isBuffer(b))return ___cpstr(b,i);var len=b.readUInt32LE(i);return len>0?b.toString("utf8",i+4,i+4+len-1):""},__lpwstr=function(b,i){if(!Buffer.isBuffer(b)||!buf_utf16le)return ___lpwstr(b,i);var len=2*b.readUInt32LE(i);return b.toString("utf16le",i+4,i+4+len-1)},__lpp4=function(b,i){if(!Buffer.isBuffer(b)||!buf_utf16le)return ___lpp4(b,i);var len=b.readUInt32LE(i);return b.toString("utf16le",i+4,i+4+len)},__8lpp4=function(b,i){if(!Buffer.isBuffer(b))return ___8lpp4(b,i);var len=b.readUInt32LE(i);return b.toString("utf8",i+4,i+4+len)},__double=function(b,i){return Buffer.isBuffer(b)?b.readDoubleLE(i):___double(b,i)},is_buf=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array});function cpdoit(){__utf16le=function(b,s,e){return $cptable.utils.decode(1200,b.slice(s,e)).replace(chr0,"")},__utf8=function(b,s,e){return $cptable.utils.decode(65001,b.slice(s,e))},__lpstr=function(b,i){var len=__readUInt32LE(b,i);return len>0?$cptable.utils.decode(current_ansi,b.slice(i+4,i+4+len-1)):""},__cpstr=function(b,i){var len=__readUInt32LE(b,i);return len>0?$cptable.utils.decode(current_codepage,b.slice(i+4,i+4+len-1)):""},__lpwstr=function(b,i){var len=2*__readUInt32LE(b,i);return len>0?$cptable.utils.decode(1200,b.slice(i+4,i+4+len-1)):""},__lpp4=function(b,i){var len=__readUInt32LE(b,i);return len>0?$cptable.utils.decode(1200,b.slice(i+4,i+4+len)):""},__8lpp4=function(b,i){var len=__readUInt32LE(b,i);return len>0?$cptable.utils.decode(65001,b.slice(i+4,i+4+len)):""}}typeof $cptable<"u"&&cpdoit();var __readUInt8=function(b,idx){return b[idx]},__readUInt16LE=function(b,idx){return b[idx+1]*256+b[idx]},__readInt16LE=function(b,idx){var u=b[idx+1]*256+b[idx];return u<32768?u:(65535-u+1)*-1},__readUInt32LE=function(b,idx){return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]},__readInt32LE=function(b,idx){return b[idx+3]<<24|b[idx+2]<<16|b[idx+1]<<8|b[idx]},__readInt32BE=function(b,idx){return b[idx]<<24|b[idx+1]<<16|b[idx+2]<<8|b[idx+3]};function ReadShift(size,t){var o="",oI,oR,oo=[],w,vv,i,loc;switch(t){case"dbcs":if(loc=this.l,has_buf&&Buffer.isBuffer(this)&&buf_utf16le)o=this.slice(this.l,this.l+2*size).toString("utf16le");else for(i=0;i<size;++i)o+=String.fromCharCode(__readUInt16LE(this,loc)),loc+=2;size*=2;break;case"utf8":o=__utf8(this,this.l,this.l+size);break;case"utf16le":size*=2,o=__utf16le(this,this.l,this.l+size);break;case"wstr":if(typeof $cptable<"u")o=$cptable.utils.decode(current_codepage,this.slice(this.l,this.l+2*size));else return ReadShift.call(this,size,"dbcs");size=2*size;break;case"lpstr-ansi":o=__lpstr(this,this.l),size=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":o=__cpstr(this,this.l),size=4+__readUInt32LE(this,this.l);break;case"lpwstr":o=__lpwstr(this,this.l),size=4+2*__readUInt32LE(this,this.l);break;case"lpp4":size=4+__readUInt32LE(this,this.l),o=__lpp4(this,this.l),size&2&&(size+=2);break;case"8lpp4":size=4+__readUInt32LE(this,this.l),o=__8lpp4(this,this.l),size&3&&(size+=4-(size&3));break;case"cstr":for(size=0,o="";(w=__readUInt8(this,this.l+size++))!==0;)oo.push(_getchar(w));o=oo.join("");break;case"_wstr":for(size=0,o="";(w=__readUInt16LE(this,this.l+size))!==0;)oo.push(_getchar(w)),size+=2;size+=2,o=oo.join("");break;case"dbcs-cont":for(o="",loc=this.l,i=0;i<size;++i){if(this.lens&&this.lens.indexOf(loc)!==-1)return w=__readUInt8(this,loc),this.l=loc+1,vv=ReadShift.call(this,size-i,w?"dbcs-cont":"sbcs-cont"),oo.join("")+vv;oo.push(_getchar(__readUInt16LE(this,loc))),loc+=2}o=oo.join(""),size*=2;break;case"cpstr":if(typeof $cptable<"u"){o=$cptable.utils.decode(current_codepage,this.slice(this.l,this.l+size));break}case"sbcs-cont":for(o="",loc=this.l,i=0;i!=size;++i){if(this.lens&&this.lens.indexOf(loc)!==-1)return w=__readUInt8(this,loc),this.l=loc+1,vv=ReadShift.call(this,size-i,w?"dbcs-cont":"sbcs-cont"),oo.join("")+vv;oo.push(_getchar(__readUInt8(this,loc))),loc+=1}o=oo.join("");break;default:switch(size){case 1:return oI=__readUInt8(this,this.l),this.l++,oI;case 2:return oI=(t==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,oI;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(oI=(size>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,oI):(oR=__readUInt32LE(this,this.l),this.l+=4,oR);case 8:case-8:if(t==="f")return size==8?oR=__double(this,this.l):oR=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,oR;size=8;case 16:o=__hexlify(this,this.l,size);break}}return this.l+=size,o}var __writeUInt32LE=function(b,val,idx){b[idx]=val&255,b[idx+1]=val>>>8&255,b[idx+2]=val>>>16&255,b[idx+3]=val>>>24&255},__writeInt32LE=function(b,val,idx){b[idx]=val&255,b[idx+1]=val>>8&255,b[idx+2]=val>>16&255,b[idx+3]=val>>24&255},__writeUInt16LE=function(b,val,idx){b[idx]=val&255,b[idx+1]=val>>>8&255};function WriteShift(t,val,f){var size=0,i=0;if(f==="dbcs"){for(i=0;i!=val.length;++i)__writeUInt16LE(this,val.charCodeAt(i),this.l+2*i);size=2*val.length}else if(f==="sbcs"||f=="cpstr")if(typeof $cptable<"u"&&current_ansi==874){for(i=0;i!=val.length;++i){var cpp=$cptable.utils.encode(current_ansi,val.charAt(i));this[this.l+i]=cpp[0]}size=val.length}else if(typeof $cptable<"u"&&f=="cpstr"){if(cpp=$cptable.utils.encode(current_codepage,val),cpp.length==val.length)for(i=0;i<val.length;++i)cpp[i]==0&&val.charCodeAt(i)!=0&&(cpp[i]=95);if(cpp.length==2*val.length)for(i=0;i<val.length;++i)cpp[2*i]==0&&cpp[2*i+1]==0&&val.charCodeAt(i)!=0&&(cpp[2*i]=95);for(i=0;i<cpp.length;++i)this[this.l+i]=cpp[i];size=cpp.length}else{for(val=val.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=val.length;++i)this[this.l+i]=val.charCodeAt(i)&255;size=val.length}else if(f==="hex"){for(;i<t;++i)this[this.l++]=parseInt(val.slice(2*i,2*i+2),16)||0;return this}else if(f==="utf16le"){var end2=Math.min(this.l+t,this.length);for(i=0;i<Math.min(val.length,t);++i){var cc=val.charCodeAt(i);this[this.l++]=cc&255,this[this.l++]=cc>>8}for(;this.l<end2;)this[this.l++]=0;return this}else switch(t){case 1:size=1,this[this.l]=val&255;break;case 2:size=2,this[this.l]=val&255,val>>>=8,this[this.l+1]=val&255;break;case 3:size=3,this[this.l]=val&255,val>>>=8,this[this.l+1]=val&255,val>>>=8,this[this.l+2]=val&255;break;case 4:size=4,__writeUInt32LE(this,val,this.l);break;case 8:if(size=8,f==="f"){write_double_le(this,val,this.l);break}case 16:break;case-4:size=4,__writeInt32LE(this,val,this.l);break}return this.l+=size,this}function CheckField(hexstr,fld){var m=__hexlify(this,this.l,hexstr.length>>1);if(m!==hexstr)throw new Error(fld+"Expected "+hexstr+" saw "+m);this.l+=hexstr.length>>1}function prep_blob(blob,pos){blob.l=pos,blob.read_shift=ReadShift,blob.chk=CheckField,blob.write_shift=WriteShift}function parsenoop(blob,length){blob.l+=length}function new_buf(sz){var o=new_raw_buf(sz);return prep_blob(o,0),o}function buf_array(){var bufs=[],blksz=has_buf?256:2048,newblk=function(sz){var o=new_buf(sz);return prep_blob(o,0),o},curbuf=newblk(blksz),endbuf=function(){curbuf&&(curbuf.l&&(curbuf.length>curbuf.l&&(curbuf=curbuf.slice(0,curbuf.l),curbuf.l=curbuf.length),curbuf.length>0&&bufs.push(curbuf)),curbuf=null)},next=function(sz){return curbuf&&sz<curbuf.length-curbuf.l?curbuf:(endbuf(),curbuf=newblk(Math.max(sz+1,blksz)))},end2=function(){return endbuf(),bconcat(bufs)},push=function(buf){endbuf(),curbuf=buf,curbuf.l==null&&(curbuf.l=curbuf.length),next(blksz)};return{next,push,end:end2,_bufs:bufs}}function write_record(ba,type,payload,length){var t=+type,l;if(!isNaN(t)){length||(length=XLSBRecordEnum[t].p||(payload||[]).length||0),l=1+(t>=128?1:0)+1,length>=128&&++l,length>=16384&&++l,length>=2097152&&++l;var o=ba.next(l);t<=127?o.write_shift(1,t):(o.write_shift(1,(t&127)+128),o.write_shift(1,t>>7));for(var i=0;i!=4;++i)if(length>=128)o.write_shift(1,(length&127)+128),length>>=7;else{o.write_shift(1,length);break}length>0&&is_buf(payload)&&ba.push(payload)}}function shift_cell_xls(cell,tgt,opts){var out=dup(cell);if(tgt.s?(out.cRel&&(out.c+=tgt.s.c),out.rRel&&(out.r+=tgt.s.r)):(out.cRel&&(out.c+=tgt.c),out.rRel&&(out.r+=tgt.r)),!opts||opts.biff<12){for(;out.c>=256;)out.c-=256;for(;out.r>=65536;)out.r-=65536}return out}function shift_range_xls(cell,range,opts){var out=dup(cell);return out.s=shift_cell_xls(out.s,range.s,opts),out.e=shift_cell_xls(out.e,range.s,opts),out}function encode_cell_xls(c,biff){if(c.cRel&&c.c<0)for(c=dup(c);c.c<0;)c.c+=biff>8?16384:256;if(c.rRel&&c.r<0)for(c=dup(c);c.r<0;)c.r+=biff>8?1048576:biff>5?65536:16384;var s=encode_cell(c);return!c.cRel&&c.cRel!=null&&(s=fix_col(s)),!c.rRel&&c.rRel!=null&&(s=fix_row(s)),s}function encode_range_xls(r,opts){return r.s.r==0&&!r.s.rRel&&r.e.r==(opts.biff>=12?1048575:opts.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+encode_col(r.s.c)+":"+(r.e.cRel?"":"$")+encode_col(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(opts.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+encode_row(r.s.r)+":"+(r.e.rRel?"":"$")+encode_row(r.e.r):encode_cell_xls(r.s,opts.biff)+":"+encode_cell_xls(r.e,opts.biff)}function decode_row(rowstr){return parseInt(unfix_row(rowstr),10)-1}function encode_row(row){return""+(row+1)}function fix_row(cstr){return cstr.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(cstr){return cstr.replace(/\$(\d+)$/,"$1")}function decode_col(colstr){for(var c=unfix_col(colstr),d=0,i=0;i!==c.length;++i)d=26*d+c.charCodeAt(i)-64;return d-1}function encode_col(col){if(col<0)throw new Error("invalid column "+col);var s="";for(++col;col;col=Math.floor((col-1)/26))s=String.fromCharCode((col-1)%26+65)+s;return s}function fix_col(cstr){return cstr.replace(/^([A-Z])/,"$$$1")}function unfix_col(cstr){return cstr.replace(/^\$([A-Z])/,"$1")}function split_cell(cstr){return cstr.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(cstr){for(var R=0,C=0,i=0;i<cstr.length;++i){var cc=cstr.charCodeAt(i);cc>=48&&cc<=57?R=10*R+(cc-48):cc>=65&&cc<=90&&(C=26*C+(cc-64))}return{c:C-1,r:R-1}}function encode_cell(cell){for(var col=cell.c+1,s="";col;col=(col-1)/26|0)s=String.fromCharCode((col-1)%26+65)+s;return s+(cell.r+1)}function decode_range(range){var idx=range.indexOf(":");return idx==-1?{s:decode_cell(range),e:decode_cell(range)}:{s:decode_cell(range.slice(0,idx)),e:decode_cell(range.slice(idx+1))}}function encode_range(cs,ce){return typeof ce>"u"||typeof ce=="number"?encode_range(cs.s,cs.e):(typeof cs!="string"&&(cs=encode_cell(cs)),typeof ce!="string"&&(ce=encode_cell(ce)),cs==ce?cs:cs+":"+ce)}function fix_range(a1){var s=decode_range(a1);return"$"+encode_col(s.s.c)+"$"+encode_row(s.s.r)+":$"+encode_col(s.e.c)+"$"+encode_row(s.e.r)}function formula_quote_sheet_name(sname,opts){if(!sname&&!(opts&&opts.biff<=5&&opts.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(sname)?"'"+sname.replace(/'/g,"''")+"'":sname}function safe_decode_range(range){var o={s:{c:0,r:0},e:{c:0,r:0}},idx=0,i=0,cc=0,len=range.length;for(idx=0;i<len&&!((cc=range.charCodeAt(i)-64)<1||cc>26);++i)idx=26*idx+cc;for(o.s.c=--idx,idx=0;i<len&&!((cc=range.charCodeAt(i)-48)<0||cc>9);++i)idx=10*idx+cc;if(o.s.r=--idx,i===len||cc!=10)return o.e.c=o.s.c,o.e.r=o.s.r,o;for(++i,idx=0;i!=len&&!((cc=range.charCodeAt(i)-64)<1||cc>26);++i)idx=26*idx+cc;for(o.e.c=--idx,idx=0;i!=len&&!((cc=range.charCodeAt(i)-48)<0||cc>9);++i)idx=10*idx+cc;return o.e.r=--idx,o}function safe_format_cell(cell,v){var q=cell.t=="d"&&v instanceof Date;if(cell.z!=null)try{return cell.w=SSF_format(cell.z,q?datenum(v):v)}catch{}try{return cell.w=SSF_format((cell.XF||{}).numFmtId||(q?14:0),q?datenum(v):v)}catch{return""+v}}function format_cell(cell,v,o){return cell==null||cell.t==null||cell.t=="z"?"":cell.w!==void 0?cell.w:(cell.t=="d"&&!cell.z&&o&&o.dateNF&&(cell.z=o.dateNF),cell.t=="e"?BErr[cell.v]||cell.v:v==null?safe_format_cell(cell,cell.v):safe_format_cell(cell,v))}function sheet_to_workbook(sheet,opts){var n=opts&&opts.sheet?opts.sheet:"Sheet1",sheets={};return sheets[n]=sheet,{SheetNames:[n],Sheets:sheets}}function sheet_new(opts){var out={},o=opts||{};return o.dense&&(out["!data"]=[]),out}function sheet_add_aoa(_ws,data,opts){var o=opts||{},dense=_ws?_ws["!data"]!=null:o.dense;DENSE!=null&&dense==null&&(dense=DENSE);var ws=_ws||{};dense&&!ws["!data"]&&(ws["!data"]=[]);var _R=0,_C=0;if(ws&&o.origin!=null)if(typeof o.origin=="number")_R=o.origin;else{var _origin=typeof o.origin=="string"?decode_cell(o.origin):o.origin;_R=_origin.r,_C=_origin.c}var range={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(ws["!ref"]){var _range=safe_decode_range(ws["!ref"]);range.s.c=_range.s.c,range.s.r=_range.s.r,range.e.c=Math.max(range.e.c,_range.e.c),range.e.r=Math.max(range.e.r,_range.e.r),_R==-1&&(range.e.r=_R=ws["!ref"]?_range.e.r+1:0)}else range.s.c=range.e.c=range.s.r=range.e.r=0;for(var row=[],seen=!1,R=0;R!=data.length;++R)if(data[R]){if(!Array.isArray(data[R]))throw new Error("aoa_to_sheet expects an array of arrays");var __R=_R+R,__Rstr=""+(__R+1);dense&&(ws["!data"][__R]||(ws["!data"][__R]=[]),row=ws["!data"][__R]);for(var C=0;C!=data[R].length;++C)if(!(typeof data[R][C]>"u")){var cell={v:data[R][C]},__C=_C+C;if(range.s.r>__R&&(range.s.r=__R),range.s.c>__C&&(range.s.c=__C),range.e.r<__R&&(range.e.r=__R),range.e.c<__C&&(range.e.c=__C),seen=!0,data[R][C]&&typeof data[R][C]=="object"&&!Array.isArray(data[R][C])&&!(data[R][C]instanceof Date))cell=data[R][C];else if(Array.isArray(cell.v)&&(cell.f=data[R][C][1],cell.v=cell.v[0]),cell.v===null)if(cell.f)cell.t="n";else if(o.nullError)cell.t="e",cell.v=0;else if(o.sheetStubs)cell.t="z";else continue;else typeof cell.v=="number"?cell.t="n":typeof cell.v=="boolean"?cell.t="b":cell.v instanceof Date?(cell.z=o.dateNF||table_fmt[14],o.UTC||(cell.v=local_to_utc(cell.v)),o.cellDates?(cell.t="d",cell.w=SSF_format(cell.z,datenum(cell.v,o.date1904))):(cell.t="n",cell.v=datenum(cell.v,o.date1904),cell.w=SSF_format(cell.z,cell.v))):cell.t="s";if(dense)row[__C]&&row[__C].z&&(cell.z=row[__C].z),row[__C]=cell;else{var cell_ref=encode_col(__C)+__Rstr;ws[cell_ref]&&ws[cell_ref].z&&(cell.z=ws[cell_ref].z),ws[cell_ref]=cell}}}return seen&&range.s.c<104e5&&(ws["!ref"]=encode_range(range)),ws}function aoa_to_sheet(data,opts){return sheet_add_aoa(null,data,opts)}function parse_Int32LE(data){return data.read_shift(4,"i")}function write_UInt32LE(x,o){return o||(o=new_buf(4)),o.write_shift(4,x),o}function parse_XLWideString(data){var cchCharacters=data.read_shift(4);return cchCharacters===0?"":data.read_shift(cchCharacters,"dbcs")}function write_XLWideString(data,o){var _null=!1;return o==null&&(_null=!0,o=new_buf(4+2*data.length)),o.write_shift(4,data.length),data.length>0&&o.write_shift(0,data,"dbcs"),_null?o.slice(0,o.l):o}function parse_StrRun(data){return{ich:data.read_shift(2),ifnt:data.read_shift(2)}}function write_StrRun(run,o){return o||(o=new_buf(4)),o.write_shift(2,run.ich||0),o.write_shift(2,run.ifnt||0),o}function parse_RichStr(data,length){var start2=data.l,flags=data.read_shift(1),str=parse_XLWideString(data),rgsStrRun=[],z={t:str,h:str};if(flags&1){for(var dwSizeStrRun=data.read_shift(4),i=0;i!=dwSizeStrRun;++i)rgsStrRun.push(parse_StrRun(data));z.r=rgsStrRun}else z.r=[{ich:0,ifnt:0}];return data.l=start2+length,z}function write_RichStr(str,o){var _null=!1;return o==null&&(_null=!0,o=new_buf(15+4*str.t.length)),o.write_shift(1,0),write_XLWideString(str.t,o),_null?o.slice(0,o.l):o}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(str,o){var _null=!1;return o==null&&(_null=!0,o=new_buf(23+4*str.t.length)),o.write_shift(1,1),write_XLWideString(str.t,o),o.write_shift(4,1),write_StrRun({ich:0,ifnt:0},o),_null?o.slice(0,o.l):o}function parse_XLSBCell(data){var col=data.read_shift(4),iStyleRef=data.read_shift(2);return iStyleRef+=data.read_shift(1)<<16,data.l++,{c:col,iStyleRef}}function write_XLSBCell(cell,o){return o==null&&(o=new_buf(8)),o.write_shift(-4,cell.c),o.write_shift(3,cell.iStyleRef||cell.s),o.write_shift(1,0),o}function parse_XLSBShortCell(data){var iStyleRef=data.read_shift(2);return iStyleRef+=data.read_shift(1)<<16,data.l++,{c:-1,iStyleRef}}function write_XLSBShortCell(cell,o){return o==null&&(o=new_buf(4)),o.write_shift(3,cell.iStyleRef||cell.s),o.write_shift(1,0),o}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(data){var cchCharacters=data.read_shift(4);return cchCharacters===0||cchCharacters===4294967295?"":data.read_shift(cchCharacters,"dbcs")}function write_XLNullableWideString(data,o){var _null=!1;return o==null&&(_null=!0,o=new_buf(127)),o.write_shift(4,data.length>0?data.length:4294967295),data.length>0&&o.write_shift(0,data,"dbcs"),_null?o.slice(0,o.l):o}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(data){var b=data.slice(data.l,data.l+4),fX100=b[0]&1,fInt=b[0]&2;data.l+=4;var RK=fInt===0?__double([0,0,0,0,b[0]&252,b[1],b[2],b[3]],0):__readInt32LE(b,0)>>2;return fX100?RK/100:RK}function write_RkNumber(data,o){o==null&&(o=new_buf(4));var fX100=0,fInt=0,d100=data*100;if(data==(data|0)&&data>=-(1<<29)&&data<1<<29?fInt=1:d100==(d100|0)&&d100>=-(1<<29)&&d100<1<<29&&(fInt=1,fX100=1),fInt)o.write_shift(-4,((fX100?d100:data)<<2)+(fX100+2));else throw new Error("unsupported RkNumber "+data)}function parse_RfX(data){var cell={s:{},e:{}};return cell.s.r=data.read_shift(4),cell.e.r=data.read_shift(4),cell.s.c=data.read_shift(4),cell.e.c=data.read_shift(4),cell}function write_RfX(r,o){return o||(o=new_buf(16)),o.write_shift(4,r.s.r),o.write_shift(4,r.e.r),o.write_shift(4,r.s.c),o.write_shift(4,r.e.c),o}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(data){if(data.length-data.l<8)throw"XLS Xnum Buffer underflow";return data.read_shift(8,"f")}function write_Xnum(data,o){return(o||new_buf(8)).write_shift(8,data,"f")}function parse_BrtColor(data){var out={},d=data.read_shift(1),xColorType=d>>>1,index=data.read_shift(1),nTS=data.read_shift(2,"i"),bR=data.read_shift(1),bG=data.read_shift(1),bB=data.read_shift(1);switch(data.l++,xColorType){case 0:out.auto=1;break;case 1:out.index=index;var icv=XLSIcv[index];icv&&(out.rgb=rgb2Hex(icv));break;case 2:out.rgb=rgb2Hex([bR,bG,bB]);break;case 3:out.theme=index;break}return nTS!=0&&(out.tint=nTS>0?nTS/32767:nTS/32768),out}function write_BrtColor(color,o){if(o||(o=new_buf(8)),!color||color.auto)return o.write_shift(4,0),o.write_shift(4,0),o;color.index!=null?(o.write_shift(1,2),o.write_shift(1,color.index)):color.theme!=null?(o.write_shift(1,6),o.write_shift(1,color.theme)):(o.write_shift(1,5),o.write_shift(1,0));var nTS=color.tint||0;if(nTS>0?nTS*=32767:nTS<0&&(nTS*=32768),o.write_shift(2,nTS),!color.rgb||color.theme!=null)o.write_shift(2,0),o.write_shift(1,0),o.write_shift(1,0);else{var rgb=color.rgb||"FFFFFF";typeof rgb=="number"&&(rgb=("000000"+rgb.toString(16)).slice(-6)),o.write_shift(1,parseInt(rgb.slice(0,2),16)),o.write_shift(1,parseInt(rgb.slice(2,4),16)),o.write_shift(1,parseInt(rgb.slice(4,6),16)),o.write_shift(1,255)}return o}function parse_FontFlags(data){var d=data.read_shift(1);data.l++;var out={fBold:d&1,fItalic:d&2,fUnderline:d&4,fStrikeout:d&8,fOutline:d&16,fShadow:d&32,fCondense:d&64,fExtend:d&128};return out}function write_FontFlags(font,o){o||(o=new_buf(2));var grbit=(font.italic?2:0)|(font.strike?8:0)|(font.outline?16:0)|(font.shadow?32:0)|(font.condense?64:0)|(font.extend?128:0);return o.write_shift(1,grbit),o.write_shift(1,0),o}var VT_I2=2,VT_I4=3,VT_BOOL=11;var VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80;var DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}};function rgbify(arr){return arr.map(function(x){return[x>>16&255,x>>8&255,x&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function write_ct(ct,opts,raw){var type2ct=evert_arr(ct2type),o=[],v;raw||(o[o.length]=XML_HEADER,o[o.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),o=o.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(x){return writextag("Default",null,{Extension:x[0],ContentType:x[1]})})));var f1=function(w){ct[w]&&ct[w].length>0&&(v=ct[w][0],o[o.length]=writextag("Override",null,{PartName:(v[0]=="/"?"":"/")+v,ContentType:CT_LIST[w][opts.bookType]||CT_LIST[w].xlsx}))},f2=function(w){(ct[w]||[]).forEach(function(v2){o[o.length]=writextag("Override",null,{PartName:(v2[0]=="/"?"":"/")+v2,ContentType:CT_LIST[w][opts.bookType]||CT_LIST[w].xlsx})})},f3=function(t){(ct[t]||[]).forEach(function(v2){o[o.length]=writextag("Override",null,{PartName:(v2[0]=="/"?"":"/")+v2,ContentType:type2ct[t][0]})})};return f1("workbooks"),f2("sheets"),f2("charts"),f3("themes"),["strs","styles"].forEach(f1),["coreprops","extprops","custprops"].forEach(f3),f3("vba"),f3("comments"),f3("threadedcomments"),f3("drawings"),f2("metadata"),f3("people"),!raw&&o.length>2&&(o[o.length]="</Types>",o[1]=o[1].replace("/>",">")),o.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(file){var n=file.lastIndexOf("/");return file.slice(0,n+1)+"_rels/"+file.slice(n+1)+".rels"}function write_rels(rels){var o=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(rels["!id"]).forEach(function(rid){o[o.length]=writextag("Relationship",null,rels["!id"][rid])}),o.length>2&&(o[o.length]="</Relationships>",o[1]=o[1].replace("/>",">")),o.join("")}function add_rels(rels,rId,f,type,relobj,targetmode){if(relobj||(relobj={}),rels["!id"]||(rels["!id"]={}),rels["!idx"]||(rels["!idx"]=1),rId<0)for(rId=rels["!idx"];rels["!id"]["rId"+rId];++rId);if(rels["!idx"]=rId+1,relobj.Id="rId"+rId,relobj.Type=type,relobj.Target=f,targetmode?relobj.TargetMode=targetmode:[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(relobj.Type)>-1&&(relobj.TargetMode="External"),rels["!id"][relobj.Id])throw new Error("Cannot rewrite rId "+rId);return rels["!id"][relobj.Id]=relobj,rels[("/"+relobj.Target).replace("//","/")]=relobj,rId}function write_manifest(manifest){var o=[XML_HEADER];o.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),o.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var i=0;i<manifest.length;++i)o.push('  <manifest:file-entry manifest:full-path="'+manifest[i][0]+'" manifest:media-type="'+manifest[i][1]+`"/>
`);return o.push("</manifest:manifest>"),o.join("")}function write_rdf_type(file,res,tag){return['  <rdf:Description rdf:about="'+file+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(tag||"odf")+"#"+res+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(base,file){return['  <rdf:Description rdf:about="'+base+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+file+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(rdf){var o=[XML_HEADER];o.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var i=0;i!=rdf.length;++i)o.push(write_rdf_type(rdf[i][0],rdf[i][1])),o.push(write_rdf_has("",rdf[i][0]));return o.push(write_rdf_type("","Document","pkg")),o.push("</rdf:RDF>"),o.join("")}function write_meta_ods(wb,opts){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function cp_doit(f,g,h,o,p){p[f]!=null||g==null||g===""||(p[f]=g,g=escapexml(g),o[o.length]=h?writextag(f,g,h):writetag(f,g))}function write_core_props(cp,_opts){var opts=_opts||{},o=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],p={};if(!cp&&!opts.Props)return o.join("");cp&&(cp.CreatedDate!=null&&cp_doit("dcterms:created",typeof cp.CreatedDate=="string"?cp.CreatedDate:write_w3cdtf(cp.CreatedDate,opts.WTF),{"xsi:type":"dcterms:W3CDTF"},o,p),cp.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof cp.ModifiedDate=="string"?cp.ModifiedDate:write_w3cdtf(cp.ModifiedDate,opts.WTF),{"xsi:type":"dcterms:W3CDTF"},o,p));for(var i=0;i!=CORE_PROPS.length;++i){var f=CORE_PROPS[i],v=opts.Props&&opts.Props[f[1]]!=null?opts.Props[f[1]]:cp?cp[f[1]]:null;v===!0?v="1":v===!1?v="0":typeof v=="number"&&(v=String(v)),v!=null&&cp_doit(f[0],v,null,o,p)}return o.length>2&&(o[o.length]="</cp:coreProperties>",o[1]=o[1].replace("/>",">")),o.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function write_ext_props(cp){var o=[],W=writextag;return cp||(cp={}),cp.Application="SheetJS",o[o.length]=XML_HEADER,o[o.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(f){if(cp[f[1]]!==void 0){var v;switch(f[2]){case"string":v=escapexml(String(cp[f[1]]));break;case"bool":v=cp[f[1]]?"true":"false";break}v!==void 0&&(o[o.length]=W(f[0],v))}}),o[o.length]=W("HeadingPairs",W("vt:vector",W("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+W("vt:variant",W("vt:i4",String(cp.Worksheets))),{size:2,baseType:"variant"})),o[o.length]=W("TitlesOfParts",W("vt:vector",cp.SheetNames.map(function(s){return"<vt:lpstr>"+escapexml(s)+"</vt:lpstr>"}).join(""),{size:cp.Worksheets,baseType:"lpstr"})),o.length>2&&(o[o.length]="</Properties>",o[1]=o[1].replace("/>",">")),o.join("")}function write_cust_props(cp){var o=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!cp)return o.join("");var pid=1;return keys(cp).forEach(function(k){++pid,o[o.length]=writextag("property",write_vt(cp[k],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid,name:escapexml(k)})}),o.length>2&&(o[o.length]="</Properties>",o[1]=o[1].replace("/>",">")),o.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xlml_write_docprops(Props,opts){var o=[];return keys(XLMLDocPropsMap).map(function(m){for(var i=0;i<CORE_PROPS.length;++i)if(CORE_PROPS[i][1]==m)return CORE_PROPS[i];for(i=0;i<EXT_PROPS.length;++i)if(EXT_PROPS[i][1]==m)return EXT_PROPS[i];throw m}).forEach(function(p){if(Props[p[1]]!=null){var m=opts&&opts.Props&&opts.Props[p[1]]!=null?opts.Props[p[1]]:Props[p[1]];switch(p[2]){case"date":m=new Date(m).toISOString().replace(/\.\d*Z/,"Z");break}typeof m=="number"?m=String(m):m===!0||m===!1?m=m?"1":"0":m instanceof Date&&(m=new Date(m).toISOString().replace(/\.\d*Z/,"")),o.push(writetag(XLMLDocPropsMap[p[1]]||p[1],m))}}),writextag("DocumentProperties",o.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(Props,Custprops){var BLACKLIST=["Worksheets","SheetNames"],T="CustomDocumentProperties",o=[];return Props&&keys(Props).forEach(function(k){if(Object.prototype.hasOwnProperty.call(Props,k)){for(var i=0;i<CORE_PROPS.length;++i)if(k==CORE_PROPS[i][1])return;for(i=0;i<EXT_PROPS.length;++i)if(k==EXT_PROPS[i][1])return;for(i=0;i<BLACKLIST.length;++i)if(k==BLACKLIST[i])return;var m=Props[k],t="string";typeof m=="number"?(t="float",m=String(m)):m===!0||m===!1?(t="boolean",m=m?"1":"0"):m=String(m),o.push(writextag(escapexmltag(k),m,{"dt:dt":t}))}}),Custprops&&keys(Custprops).forEach(function(k){if(Object.prototype.hasOwnProperty.call(Custprops,k)&&!(Props&&Object.prototype.hasOwnProperty.call(Props,k))){var m=Custprops[k],t="string";typeof m=="number"?(t="float",m=String(m)):m===!0||m===!1?(t="boolean",m=m?"1":"0"):m instanceof Date?(t="dateTime.tz",m=m.toISOString()):m=String(m),o.push(writextag(escapexmltag(k),m,{"dt:dt":t}))}}),"<"+T+' xmlns="'+XLMLNS.o+'">'+o.join("")+"</"+T+">"}function write_FILETIME(time){var date=typeof time=="string"?new Date(Date.parse(time)):time,t=date.getTime()/1e3+11644473600,l=t%Math.pow(2,32),h=(t-l)/Math.pow(2,32);l*=1e7,h*=1e7;var w=l/Math.pow(2,32)|0;w>0&&(l=l%Math.pow(2,32),h+=w);var o=new_buf(8);return o.write_shift(4,l),o.write_shift(4,h),o}function write_TypedPropertyValue(type,value){var o=new_buf(4),p=new_buf(4);switch(o.write_shift(4,type==80?31:type),type){case 3:p.write_shift(-4,value);break;case 5:p=new_buf(8),p.write_shift(8,value,"f");break;case 11:p.write_shift(4,value?1:0);break;case 64:p=write_FILETIME(value);break;case 31:case 80:for(p=new_buf(4+2*(value.length+1)+(value.length%2?0:2)),p.write_shift(4,value.length+1),p.write_shift(0,value,"dbcs");p.l!=p.length;)p.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+type+" "+value)}return bconcat([o,p])}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(val){switch(typeof val){case"boolean":return 11;case"number":return(val|0)==val?3:5;case"string":return 31;case"object":if(val instanceof Date)return 64;break}return-1}function write_PropertySet(entries,RE,PIDSI){var hdr=new_buf(8),piao=[],prop=[],sz=8,i=0,pr=new_buf(8),pio=new_buf(8);if(pr.write_shift(4,2),pr.write_shift(4,1200),pio.write_shift(4,1),prop.push(pr),piao.push(pio),sz+=8+pr.length,!RE){pio=new_buf(8),pio.write_shift(4,0),piao.unshift(pio);var bufs=[new_buf(4)];for(bufs[0].write_shift(4,entries.length),i=0;i<entries.length;++i){var value=entries[i][0];for(pr=new_buf(8+2*(value.length+1)+(value.length%2?0:2)),pr.write_shift(4,i+2),pr.write_shift(4,value.length+1),pr.write_shift(0,value,"dbcs");pr.l!=pr.length;)pr.write_shift(1,0);bufs.push(pr)}pr=bconcat(bufs),prop.unshift(pr),sz+=8+pr.length}for(i=0;i<entries.length;++i)if(!(RE&&!RE[entries[i][0]])&&!(XLSPSSkip.indexOf(entries[i][0])>-1||PseudoPropsPairs.indexOf(entries[i][0])>-1)&&entries[i][1]!=null){var val=entries[i][1],idx=0;if(RE){idx=+RE[entries[i][0]];var pinfo=PIDSI[idx];if(pinfo.p=="version"&&typeof val=="string"){var arr=val.split(".");val=(+arr[0]<<16)+(+arr[1]||0)}pr=write_TypedPropertyValue(pinfo.t,val)}else{var T=guess_property_type(val);T==-1&&(T=31,val=String(val)),pr=write_TypedPropertyValue(T,val)}prop.push(pr),pio=new_buf(8),pio.write_shift(4,RE?idx:2+i),piao.push(pio),sz+=8+pr.length}var w=8*(prop.length+1);for(i=0;i<prop.length;++i)piao[i].write_shift(4,w),w+=prop[i].length;return hdr.write_shift(4,sz),hdr.write_shift(4,prop.length),bconcat([hdr].concat(piao).concat(prop))}function write_PropertySetStream(entries,clsid,RE,PIDSI,entries2,clsid2){var hdr=new_buf(entries2?68:48),bufs=[hdr];hdr.write_shift(2,65534),hdr.write_shift(2,0),hdr.write_shift(4,842412599),hdr.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),hdr.write_shift(4,entries2?2:1),hdr.write_shift(16,clsid,"hex"),hdr.write_shift(4,entries2?68:48);var ps0=write_PropertySet(entries,RE,PIDSI);if(bufs.push(ps0),entries2){var ps1=write_PropertySet(entries2,null,null);hdr.write_shift(16,clsid2,"hex"),hdr.write_shift(4,68+ps0.length),bufs.push(ps1)}return bconcat(bufs)}function writezeroes(n,o){o||(o=new_buf(n));for(var j=0;j<n;++j)o.write_shift(1,0);return o}function parsebool(blob,length){return blob.read_shift(length)===1}function writebool(v,o){return o||(o=new_buf(2)),o.write_shift(2,+!!v),o}function parseuint16(blob){return blob.read_shift(2,"u")}function writeuint16(v,o){return o||(o=new_buf(2)),o.write_shift(2,v),o}function write_Bes(v,t,o){return o||(o=new_buf(2)),o.write_shift(1,t=="e"?+v:+!!v),o.write_shift(1,t=="e"?1:0),o}function parse_ShortXLUnicodeString(blob,length,opts){var cch=blob.read_shift(opts&&opts.biff>=12?2:1),encoding="sbcs-cont",cp=current_codepage;if(opts&&opts.biff>=8&&(current_codepage=1200),!opts||opts.biff==8){var fHighByte=blob.read_shift(1);fHighByte&&(encoding="dbcs-cont")}else opts.biff==12&&(encoding="wstr");opts.biff>=2&&opts.biff<=5&&(encoding="cpstr");var o=cch?blob.read_shift(cch,encoding):"";return current_codepage=cp,o}function write_XLUnicodeRichExtendedString(xlstr){var str=xlstr.t||"",nfmts=1,hdr=new_buf(3+(nfmts>1?2:0));hdr.write_shift(2,str.length),hdr.write_shift(1,(nfmts>1?8:0)|1),nfmts>1&&hdr.write_shift(2,nfmts);var otext=new_buf(2*str.length);otext.write_shift(2*str.length,str,"utf16le");var out=[hdr,otext];return bconcat(out)}function parse_XLUnicodeStringNoCch(blob,cch,opts){var retval;if(opts){if(opts.biff>=2&&opts.biff<=5)return blob.read_shift(cch,"cpstr");if(opts.biff>=12)return blob.read_shift(cch,"dbcs-cont")}var fHighByte=blob.read_shift(1);return fHighByte===0?retval=blob.read_shift(cch,"sbcs-cont"):retval=blob.read_shift(cch,"dbcs-cont"),retval}function parse_XLUnicodeString(blob,length,opts){var cch=blob.read_shift(opts&&opts.biff==2?1:2);return cch===0?(blob.l++,""):parse_XLUnicodeStringNoCch(blob,cch,opts)}function parse_XLUnicodeString2(blob,length,opts){if(opts.biff>5)return parse_XLUnicodeString(blob,length,opts);var cch=blob.read_shift(1);return cch===0?(blob.l++,""):blob.read_shift(cch,opts.biff<=4||!blob.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(str,opts,o){return o||(o=new_buf(3+2*str.length)),o.write_shift(2,str.length),o.write_shift(1,1),o.write_shift(31,str,"utf16le"),o}function write_HyperlinkString(str,o){o||(o=new_buf(6+str.length*2)),o.write_shift(4,1+str.length);for(var i=0;i<str.length;++i)o.write_shift(2,str.charCodeAt(i));return o.write_shift(2,0),o}function write_Hyperlink(hl){var out=new_buf(512),i=0,Target=hl.Target;Target.slice(0,7)=="file://"&&(Target=Target.slice(7));var hashidx=Target.indexOf("#"),F=hashidx>-1?31:23;switch(Target.charAt(0)){case"#":F=28;break;case".":F&=-3;break}out.write_shift(4,2),out.write_shift(4,F);var data=[8,6815827,6619237,4849780,83];for(i=0;i<data.length;++i)out.write_shift(4,data[i]);if(F==28)Target=Target.slice(1),write_HyperlinkString(Target,out);else if(F&2){for(data="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<data.length;++i)out.write_shift(1,parseInt(data[i],16));var Pretarget=hashidx>-1?Target.slice(0,hashidx):Target;for(out.write_shift(4,2*(Pretarget.length+1)),i=0;i<Pretarget.length;++i)out.write_shift(2,Pretarget.charCodeAt(i));out.write_shift(2,0),F&8&&write_HyperlinkString(hashidx>-1?Target.slice(hashidx+1):"",out)}else{for(data="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),i=0;i<data.length;++i)out.write_shift(1,parseInt(data[i],16));for(var P=0;Target.slice(P*3,P*3+3)=="../"||Target.slice(P*3,P*3+3)=="..\\";)++P;for(out.write_shift(2,P),out.write_shift(4,Target.length-3*P+1),i=0;i<Target.length-3*P;++i)out.write_shift(1,Target.charCodeAt(i+3*P)&255);for(out.write_shift(1,0),out.write_shift(2,65535),out.write_shift(2,57005),i=0;i<6;++i)out.write_shift(4,0)}return out.slice(0,out.l)}function write_XLSCell(R,C,ixfe,o){return o||(o=new_buf(6)),o.write_shift(2,R),o.write_shift(2,C),o.write_shift(2,ixfe||0),o}function parse_XTI(blob,length,opts){var w=opts.biff>8?4:2,iSupBook=blob.read_shift(w),itabFirst=blob.read_shift(w,"i"),itabLast=blob.read_shift(w,"i");return[iSupBook,itabFirst,itabLast]}function parse_Ref8U(blob){var rwFirst=blob.read_shift(2),rwLast=blob.read_shift(2),colFirst=blob.read_shift(2),colLast=blob.read_shift(2);return{s:{c:colFirst,r:rwFirst},e:{c:colLast,r:rwLast}}}function write_Ref8U(r,o){return o||(o=new_buf(8)),o.write_shift(2,r.s.r),o.write_shift(2,r.e.r),o.write_shift(2,r.s.c),o.write_shift(2,r.e.c),o}function write_BOF(wb,t,o){var h=1536,w=16;switch(o.bookType){case"biff8":break;case"biff5":h=1280,w=8;break;case"biff4":h=4,w=6;break;case"biff3":h=3,w=6;break;case"biff2":h=2,w=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var out=new_buf(w);return out.write_shift(2,h),out.write_shift(2,t),w>4&&out.write_shift(2,29282),w>6&&out.write_shift(2,1997),w>8&&(out.write_shift(2,49161),out.write_shift(2,1),out.write_shift(2,1798),out.write_shift(2,0)),out}function write_WriteAccess(s,opts){var b8=!opts||opts.biff==8,o=new_buf(b8?112:54);for(o.write_shift(opts.biff==8?2:1,7),b8&&o.write_shift(1,0),o.write_shift(4,859007059),o.write_shift(4,5458548|(b8?0:536870912));o.l<o.length;)o.write_shift(1,b8?0:32);return o}function write_BoundSheet8(data,opts){var w=!opts||opts.biff>=8?2:1,o=new_buf(8+w*data.name.length);o.write_shift(4,data.pos),o.write_shift(1,data.hs||0),o.write_shift(1,data.dt),o.write_shift(1,data.name.length),opts.biff>=8&&o.write_shift(1,1),o.write_shift(w*data.name.length,data.name,opts.biff<8?"sbcs":"utf16le");var out=o.slice(0,o.l);return out.l=o.l,out}function write_SST(sst,opts){var header=new_buf(8);header.write_shift(4,sst.Count),header.write_shift(4,sst.Unique);for(var strs=[],j=0;j<sst.length;++j)strs[j]=write_XLUnicodeRichExtendedString(sst[j],opts);var o=bconcat([header].concat(strs));return o.parts=[header.length].concat(strs.map(function(str){return str.length})),o}function write_Window1(){var o=new_buf(18);return o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,29280),o.write_shift(2,17600),o.write_shift(2,56),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,1),o.write_shift(2,500),o}function write_Window2(view){var o=new_buf(18),f=1718;return view&&view.RTL&&(f|=64),o.write_shift(2,f),o.write_shift(4,0),o.write_shift(4,64),o.write_shift(4,0),o.write_shift(4,0),o}function write_Font(data,opts){var name=data.name||"Arial",b5=opts&&opts.biff==5,w=b5?15+name.length:16+2*name.length,o=new_buf(w);return o.write_shift(2,(data.sz||12)*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,name.length),b5||o.write_shift(1,1),o.write_shift((b5?1:2)*name.length,name,b5?"sbcs":"utf16le"),o}function write_LabelSst(R,C,v,os){var o=new_buf(10);return write_XLSCell(R,C,os,o),o.write_shift(4,v),o}function write_Label(R,C,v,os,opts){var b8=!opts||opts.biff==8,o=new_buf(8+ +b8+(1+b8)*v.length);return write_XLSCell(R,C,os,o),o.write_shift(2,v.length),b8&&o.write_shift(1,1),o.write_shift((1+b8)*v.length,v,b8?"utf16le":"sbcs"),o}function write_Format(i,f,opts,o){var b5=opts&&opts.biff==5;o||(o=new_buf(b5?3+f.length:5+2*f.length)),o.write_shift(2,i),o.write_shift(b5?1:2,f.length),b5||o.write_shift(1,1),o.write_shift((b5?1:2)*f.length,f,b5?"sbcs":"utf16le");var out=o.length>o.l?o.slice(0,o.l):o;return out.l==null&&(out.l=out.length),out}function write_BIFF2Format(f){var o=new_buf(1+f.length);return o.write_shift(1,f.length),o.write_shift(f.length,f,"sbcs"),o}function write_BIFF4Format(f){var o=new_buf(3+f.length);return o.l+=2,o.write_shift(1,f.length),o.write_shift(f.length,f,"sbcs"),o}function write_Dimensions(range,opts){var w=opts.biff==8||!opts.biff?4:2,o=new_buf(2*w+6);return o.write_shift(w,range.s.r),o.write_shift(w,range.e.r+1),o.write_shift(2,range.s.c),o.write_shift(2,range.e.c+1),o.write_shift(2,0),o}function write_XF(data,ixfeP,opts,o){var b5=opts&&opts.biff==5;o||(o=new_buf(b5?16:20)),o.write_shift(2,0),data.style?(o.write_shift(2,data.numFmtId||0),o.write_shift(2,65524)):(o.write_shift(2,data.numFmtId||0),o.write_shift(2,ixfeP<<4));var f=0;return data.numFmtId>0&&b5&&(f|=1024),o.write_shift(4,f),o.write_shift(4,0),b5||o.write_shift(4,0),o.write_shift(2,0),o}function write_BIFF2XF(xf){var o=new_buf(4);return o.l+=2,o.write_shift(1,xf.numFmtId),o.l++,o}function write_BIFF3XF(xf){var o=new_buf(12);return o.l++,o.write_shift(1,xf.numFmtId),o.l+=10,o}var write_BIFF4XF=write_BIFF3XF;function write_Guts(guts){var o=new_buf(8);return o.write_shift(4,0),o.write_shift(2,guts[0]?guts[0]+1:0),o.write_shift(2,guts[1]?guts[1]+1:0),o}function write_BoolErr(R,C,v,os,opts,t){var o=new_buf(8);return write_XLSCell(R,C,os,o),write_Bes(v,t,o),o}function write_Number(R,C,v,os){var o=new_buf(14);return write_XLSCell(R,C,os,o),write_Xnum(v,o),o}function parse_ExternSheet(blob,length,opts){if(opts.biff<8||!(opts.biff>8)&&length==blob[blob.l]+(blob[blob.l+1]==3?1:0)+1)return parse_BIFF5ExternSheet(blob,length,opts);for(var o=[],target=blob.l+length,len=blob.read_shift(opts.biff>8?4:2);len--!==0;)o.push(parse_XTI(blob,opts.biff>8?12:6,opts));if(blob.l!=target)throw new Error("Bad ExternSheet: "+blob.l+" != "+target);return o}function parse_BIFF5ExternSheet(blob,length,opts){blob[blob.l+1]==3&&blob[blob.l]++;var o=parse_ShortXLUnicodeString(blob,length,opts);return o.charCodeAt(0)==3?o.slice(1):o}function write_NOTE_BIFF2(text,R,C,len){var o=new_buf(6+(len||text.length));return o.write_shift(2,R),o.write_shift(2,C),o.write_shift(2,len||text.length),o.write_shift(text.length,text,"sbcs"),o}function write_MergeCells(merges){var o=new_buf(2+merges.length*8);o.write_shift(2,merges.length);for(var i=0;i<merges.length;++i)write_Ref8U(merges[i],o);return o}function write_HLink(hl){var O=new_buf(24),ref=decode_cell(hl[0]);O.write_shift(2,ref.r),O.write_shift(2,ref.r),O.write_shift(2,ref.c),O.write_shift(2,ref.c);for(var clsid="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)O.write_shift(1,parseInt(clsid[i],16));return bconcat([O,write_Hyperlink(hl[1])])}function write_HLinkTooltip(hl){var TT=hl[1].Tooltip,O=new_buf(10+2*(TT.length+1));O.write_shift(2,2048);var ref=decode_cell(hl[0]);O.write_shift(2,ref.r),O.write_shift(2,ref.r),O.write_shift(2,ref.c),O.write_shift(2,ref.c);for(var i=0;i<TT.length;++i)O.write_shift(2,TT.charCodeAt(i));return O.write_shift(2,0),O}function write_Country(o){return o||(o=new_buf(4)),o.write_shift(2,1),o.write_shift(2,1),o}function parse_ColInfo(blob,length,opts){if(!opts.cellStyles)return parsenoop(blob,length);var w=opts&&opts.biff>=12?4:2,colFirst=blob.read_shift(w),colLast=blob.read_shift(w),coldx=blob.read_shift(w),ixfe=blob.read_shift(w),flags=blob.read_shift(2);w==2&&(blob.l+=2);var o={s:colFirst,e:colLast,w:coldx,ixfe,flags};return(opts.biff>=5||!opts.biff)&&(o.level=flags>>8&7),o}function write_ColInfo(col,idx){var o=new_buf(12);o.write_shift(2,idx),o.write_shift(2,idx),o.write_shift(2,col.width*256),o.write_shift(2,0);var f=0;return col.hidden&&(f|=1),o.write_shift(1,f),f=col.level||0,o.write_shift(1,f),o.write_shift(2,0),o}function write_RRTabId(n){for(var out=new_buf(2*n),i=0;i<n;++i)out.write_shift(2,i+1);return out}function write_BIFF2Cell(out,r,c,ixfe,ifmt){return out||(out=new_buf(7)),out.write_shift(2,r),out.write_shift(2,c),out.write_shift(1,ixfe||0),out.write_shift(1,ifmt||0),out.write_shift(1,0),out}function write_BIFF2NUM(r,c,val,ixfe,ifmt){var out=new_buf(15);return write_BIFF2Cell(out,r,c,ixfe||0,ifmt||0),out.write_shift(8,val,"f"),out}function write_BIFF2INT(r,c,val,ixfe,ifmt){var out=new_buf(9);return write_BIFF2Cell(out,r,c,ixfe||0,ifmt||0),out.write_shift(2,val),out}var DBF=function(){var dbf_codepage_map={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},dbf_reverse_map=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function dbf_to_aoa(buf,opts){var out=[],d=new_raw_buf(1);switch(opts.type){case"base64":d=s2a(Base64_decode(buf));break;case"binary":d=s2a(buf);break;case"buffer":case"array":d=buf;break}prep_blob(d,0);var ft=d.read_shift(1),memo=!!(ft&136),vfp=!1,l7=!1;switch(ft){case 2:break;case 3:break;case 48:vfp=!0,memo=!0;break;case 49:vfp=!0,memo=!0;break;case 131:break;case 139:break;case 140:l7=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+ft.toString(16))}var nrow=0,fpos=521;ft==2&&(nrow=d.read_shift(2)),d.l+=3,ft!=2&&(nrow=d.read_shift(4)),nrow>1048576&&(nrow=1e6),ft!=2&&(fpos=d.read_shift(2));var rlen=d.read_shift(2),current_cp=opts.codepage||1252;ft!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(current_cp=dbf_codepage_map[d[d.l]]),d.l+=1,d.l+=2),l7&&(d.l+=36);for(var fields=[],field={},hend=Math.min(d.length,ft==2?521:fpos-10-(vfp?264:0)),ww=l7?32:11;d.l<hend&&d[d.l]!=13;)switch(field={},field.name=(typeof $cptable<"u"?$cptable.utils.decode(current_cp,d.slice(d.l,d.l+ww)):a2s(d.slice(d.l,d.l+ww))).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=ww,field.type=String.fromCharCode(d.read_shift(1)),ft!=2&&!l7&&(field.offset=d.read_shift(4)),field.len=d.read_shift(1),ft==2&&(field.offset=d.read_shift(2)),field.dec=d.read_shift(1),field.name.length&&fields.push(field),ft!=2&&(d.l+=l7?13:14),field.type){case"B":(!vfp||field.len!=8)&&opts.WTF&&console.log("Skipping "+field.name+":"+field.type);break;case"G":case"P":opts.WTF&&console.log("Skipping "+field.name+":"+field.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+field.type)}if(d[d.l]!==13&&(d.l=fpos-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=fpos;var R=0,C=0;for(out[0]=[],C=0;C!=fields.length;++C)out[0][C]=fields[C].name;for(;nrow-- >0;){if(d[d.l]===42){d.l+=rlen;continue}for(++d.l,out[++R]=[],C=0,C=0;C!=fields.length;++C){var dd=d.slice(d.l,d.l+fields[C].len);d.l+=fields[C].len,prep_blob(dd,0);var s=typeof $cptable<"u"?$cptable.utils.decode(current_cp,dd):a2s(dd);switch(fields[C].type){case"C":s.trim().length&&(out[R][C]=s.replace(/([^\s])\s+$/,"$1"));break;case"D":s.length===8?(out[R][C]=new Date(Date.UTC(+s.slice(0,4),+s.slice(4,6)-1,+s.slice(6,8),0,0,0,0)),opts&&opts.UTC||(out[R][C]=utc_to_local(out[R][C]))):out[R][C]=s;break;case"F":out[R][C]=parseFloat(s.trim());break;case"+":case"I":out[R][C]=l7?dd.read_shift(-4,"i")^2147483648:dd.read_shift(4,"i");break;case"L":switch(s.trim().toUpperCase()){case"Y":case"T":out[R][C]=!0;break;case"N":case"F":out[R][C]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+s+"|")}break;case"M":if(!memo)throw new Error("DBF Unexpected MEMO for type "+ft.toString(16));out[R][C]="##MEMO##"+(l7?parseInt(s.trim(),10):dd.read_shift(4));break;case"N":s=s.replace(/\u0000/g,"").trim(),s&&s!="."&&(out[R][C]=+s||0);break;case"@":out[R][C]=new Date(dd.read_shift(-8,"f")-621356832e5);break;case"T":{var hi=dd.read_shift(4),lo=dd.read_shift(4);if(hi==0&&lo==0)break;out[R][C]=new Date((hi-2440588)*864e5+lo),opts&&opts.UTC||(out[R][C]=utc_to_local(out[R][C]))}break;case"Y":out[R][C]=dd.read_shift(4,"i")/1e4+dd.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":out[R][C]=-dd.read_shift(-8,"f");break;case"B":if(vfp&&fields[C].len==8){out[R][C]=dd.read_shift(8,"f");break}case"G":case"P":dd.l+=fields[C].len;break;case"0":if(fields[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+fields[C].type)}}}if(ft!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return opts&&opts.sheetRows&&(out=out.slice(0,opts.sheetRows)),opts.DBF=fields,out}function dbf_to_sheet(buf,opts){var o=opts||{};o.dateNF||(o.dateNF="yyyymmdd");var ws=aoa_to_sheet(dbf_to_aoa(buf,o),o);return ws["!cols"]=o.DBF.map(function(field){return{wch:field.len,DBF:field}}),delete o.DBF,ws}function dbf_to_workbook(buf,opts){try{var o=sheet_to_workbook(dbf_to_sheet(buf,opts),opts);return o.bookType="dbf",o}catch(e){if(opts&&opts.WTF)throw e}return{SheetNames:[],Sheets:{}}}var _RLEN={B:8,C:250,L:1,D:8,"?":0,"":0};function sheet_to_dbf(ws,opts){if(!ws["!ref"])throw new Error("Cannot export empty sheet to DBF");var o=opts||{},old_cp=current_codepage;if(+o.codepage>=0&&set_cp(+o.codepage),o.type=="string")throw new Error("Cannot write DBF to JS string");var ba=buf_array(),aoa=sheet_to_json(ws,{header:1,raw:!0,cellDates:!0}),headers=aoa[0],data=aoa.slice(1),cols=ws["!cols"]||[],i=0,j=0,hcnt=0,rlen=1;for(i=0;i<headers.length;++i){if(((cols[i]||{}).DBF||{}).name){headers[i]=cols[i].DBF.name,++hcnt;continue}if(headers[i]!=null){if(++hcnt,typeof headers[i]=="number"&&(headers[i]=headers[i].toString(10)),typeof headers[i]!="string")throw new Error("DBF Invalid column name "+headers[i]+" |"+typeof headers[i]+"|");if(headers.indexOf(headers[i])!==i){for(j=0;j<1024;++j)if(headers.indexOf(headers[i]+"_"+j)==-1){headers[i]+="_"+j;break}}}}var range=safe_decode_range(ws["!ref"]),coltypes=[],colwidths=[],coldecimals=[];for(i=0;i<=range.e.c-range.s.c;++i){var guess="",_guess="",maxlen=0,col=[];for(j=0;j<data.length;++j)data[j][i]!=null&&col.push(data[j][i]);if(col.length==0||headers[i]==null){coltypes[i]="?";continue}for(j=0;j<col.length;++j){switch(typeof col[j]){case"number":_guess="B";break;case"string":_guess="C";break;case"boolean":_guess="L";break;case"object":_guess=col[j]instanceof Date?"D":"C";break;default:_guess="C"}maxlen=Math.max(maxlen,(typeof $cptable<"u"&&typeof col[j]=="string"?$cptable.utils.encode(current_ansi,col[j]):String(col[j])).length),guess=guess&&guess!=_guess?"C":_guess}maxlen>250&&(maxlen=250),_guess=((cols[i]||{}).DBF||{}).type,_guess=="C"&&cols[i].DBF.len>maxlen&&(maxlen=cols[i].DBF.len),guess=="B"&&_guess=="N"&&(guess="N",coldecimals[i]=cols[i].DBF.dec,maxlen=cols[i].DBF.len),colwidths[i]=guess=="C"||_guess=="N"?maxlen:_RLEN[guess]||0,rlen+=colwidths[i],coltypes[i]=guess}var h=ba.next(32);for(h.write_shift(4,318902576),h.write_shift(4,data.length),h.write_shift(2,296+32*hcnt),h.write_shift(2,rlen),i=0;i<4;++i)h.write_shift(4,0);var cp=+dbf_reverse_map[current_codepage]||3;for(h.write_shift(4,0|cp<<8),dbf_codepage_map[cp]!=+o.codepage&&(o.codepage&&console.error("DBF Unsupported codepage "+current_codepage+", using 1252"),current_codepage=1252),i=0,j=0;i<headers.length;++i)if(headers[i]!=null){var hf=ba.next(32),_f=(headers[i].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);hf.write_shift(1,_f,"sbcs"),hf.write_shift(1,coltypes[i]=="?"?"C":coltypes[i],"sbcs"),hf.write_shift(4,j),hf.write_shift(1,colwidths[i]||_RLEN[coltypes[i]]||0),hf.write_shift(1,coldecimals[i]||0),hf.write_shift(1,2),hf.write_shift(4,0),hf.write_shift(1,0),hf.write_shift(4,0),hf.write_shift(4,0),j+=colwidths[i]||_RLEN[coltypes[i]]||0}var hb=ba.next(264);for(hb.write_shift(4,13),i=0;i<65;++i)hb.write_shift(4,0);for(i=0;i<data.length;++i){var rout=ba.next(rlen);for(rout.write_shift(1,0),j=0;j<headers.length;++j)if(headers[j]!=null)switch(coltypes[j]){case"L":rout.write_shift(1,data[i][j]==null?63:data[i][j]?84:70);break;case"B":rout.write_shift(8,data[i][j]||0,"f");break;case"N":var _n="0";for(typeof data[i][j]=="number"&&(_n=data[i][j].toFixed(coldecimals[j]||0)),_n.length>colwidths[j]&&(_n=_n.slice(0,colwidths[j])),hcnt=0;hcnt<colwidths[j]-_n.length;++hcnt)rout.write_shift(1,32);rout.write_shift(1,_n,"sbcs");break;case"D":data[i][j]?(rout.write_shift(4,("0000"+data[i][j].getFullYear()).slice(-4),"sbcs"),rout.write_shift(2,("00"+(data[i][j].getMonth()+1)).slice(-2),"sbcs"),rout.write_shift(2,("00"+data[i][j].getDate()).slice(-2),"sbcs")):rout.write_shift(8,"00000000","sbcs");break;case"C":var _l=rout.l,_s=String(data[i][j]!=null?data[i][j]:"").slice(0,colwidths[j]);for(rout.write_shift(1,_s,"cpstr"),_l+=colwidths[j]-rout.l,hcnt=0;hcnt<_l;++hcnt)rout.write_shift(1,32);break}}return current_codepage=old_cp,ba.next(1).write_shift(1,26),ba.end()}return{to_workbook:dbf_to_workbook,to_sheet:dbf_to_sheet,from_sheet:sheet_to_dbf}}(),SYLK=function(){var sylk_escapes={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},sylk_char_regex=new RegExp("\x1BN("+keys(sylk_escapes).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{sylk_char_regex=new RegExp("\x1BN("+keys(sylk_escapes).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var sylk_char_fn=function(_,$1){var o=sylk_escapes[$1];return typeof o=="number"?_getansi(o):o},decode_sylk_char=function($$,$1,$2){var newcc=$1.charCodeAt(0)-32<<4|$2.charCodeAt(0)-48;return newcc==59?$$:_getansi(newcc)};sylk_escapes["|"]=254;var encode_sylk_str=function($$){return $$.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function sylk_to_aoa(d,opts){switch(opts.type){case"base64":return sylk_to_aoa_str(Base64_decode(d),opts);case"binary":return sylk_to_aoa_str(d,opts);case"buffer":return sylk_to_aoa_str(has_buf&&Buffer.isBuffer(d)?d.toString("binary"):a2s(d),opts);case"array":return sylk_to_aoa_str(cc2str(d),opts)}throw new Error("Unrecognized type "+opts.type)}function sylk_to_aoa_str(str,opts){var records=str.split(/[\n\r]+/),R=-1,C=-1,ri=0,rj=0,arr=[],formats=[],next_cell_format=null,sht={},rowinfo=[],colinfo=[],cw=[],Mval=0,j,wb={Workbook:{WBProps:{},Names:[]}};for(+opts.codepage>=0&&set_cp(+opts.codepage);ri!==records.length;++ri){Mval=0;var rstr=records[ri].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,decode_sylk_char).replace(sylk_char_regex,sylk_char_fn),record=rstr.replace(/;;/g,"\0").split(";").map(function(x){return x.replace(/\u0000/g,";")}),RT=record[0],val;if(rstr.length>0)switch(RT){case"ID":break;case"E":break;case"B":break;case"O":for(rj=1;rj<record.length;++rj)switch(record[rj].charAt(0)){case"V":{var d1904=parseInt(record[rj].slice(1),10);d1904>=1&&d1904<=4&&(wb.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(record[1].charAt(0)){case"P":formats.push(rstr.slice(3).replace(/;;/g,";"));break}break;case"NN":{var nn={Sheet:0};for(rj=1;rj<record.length;++rj)switch(record[rj].charAt(0)){case"N":nn.Name=record[rj].slice(1);break;case"E":nn.Ref=(opts&&opts.sheet||"Sheet1")+"!"+rc_to_a1(record[rj].slice(1));break}wb.Workbook.Names.push(nn)}break;case"C":var C_seen_K=!1,C_seen_X=!1,C_seen_S=!1,C_seen_E=!1,_R=-1,_C=-1,formula="",cell_t="z",cmnt="";for(rj=1;rj<record.length;++rj)switch(record[rj].charAt(0)){case"A":cmnt=record[rj].slice(1);break;case"X":C=parseInt(record[rj].slice(1),10)-1,C_seen_X=!0;break;case"Y":for(R=parseInt(record[rj].slice(1),10)-1,C_seen_X||(C=0),j=arr.length;j<=R;++j)arr[j]=[];break;case"K":val=record[rj].slice(1),val.charAt(0)==='"'?(val=val.slice(1,val.length-1),cell_t="s"):val==="TRUE"||val==="FALSE"?(val=val==="TRUE",cell_t="b"):val.charAt(0)=="#"&&RBErr[val]!=null?(cell_t="e",val=RBErr[val]):isNaN(fuzzynum(val))||(val=fuzzynum(val),cell_t="n",next_cell_format!==null&&fmt_is_date(next_cell_format)&&opts.cellDates&&(val=numdate(wb.Workbook.WBProps.date1904?val+1462:val),cell_t=typeof val=="number"?"n":"d")),typeof $cptable<"u"&&typeof val=="string"&&(opts||{}).type!="string"&&(opts||{}).codepage&&(val=$cptable.utils.decode(opts.codepage,val)),C_seen_K=!0;break;case"E":C_seen_E=!0,formula=rc_to_a1(record[rj].slice(1),{r:R,c:C});break;case"S":C_seen_S=!0;break;case"G":break;case"R":_R=parseInt(record[rj].slice(1),10)-1;break;case"C":_C=parseInt(record[rj].slice(1),10)-1;break;default:if(opts&&opts.WTF)throw new Error("SYLK bad record "+rstr)}if(C_seen_K&&(arr[R][C]?(arr[R][C].t=cell_t,arr[R][C].v=val):arr[R][C]={t:cell_t,v:val},next_cell_format&&(arr[R][C].z=next_cell_format),opts.cellText!==!1&&next_cell_format&&(arr[R][C].w=SSF_format(arr[R][C].z,arr[R][C].v,{date1904:wb.Workbook.WBProps.date1904})),next_cell_format=null),C_seen_S){if(C_seen_E)throw new Error("SYLK shared formula cannot have own formula");var shrbase=_R>-1&&arr[_R][_C];if(!shrbase||!shrbase[1])throw new Error("SYLK shared formula cannot find base");formula=shift_formula_str(shrbase[1],{r:R-_R,c:C-_C})}formula&&(arr[R][C]?arr[R][C].f=formula:arr[R][C]={t:"n",f:formula}),cmnt&&(arr[R][C]||(arr[R][C]={t:"z"}),arr[R][C].c=[{a:"SheetJSYLK",t:cmnt}]);break;case"F":var F_seen=0;for(rj=1;rj<record.length;++rj)switch(record[rj].charAt(0)){case"X":C=parseInt(record[rj].slice(1),10)-1,++F_seen;break;case"Y":for(R=parseInt(record[rj].slice(1),10)-1,j=arr.length;j<=R;++j)arr[j]=[];break;case"M":Mval=parseInt(record[rj].slice(1),10)/20;break;case"F":break;case"G":break;case"P":next_cell_format=formats[parseInt(record[rj].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(cw=record[rj].slice(1).split(" "),j=parseInt(cw[0],10);j<=parseInt(cw[1],10);++j)Mval=parseInt(cw[2],10),colinfo[j-1]=Mval===0?{hidden:!0}:{wch:Mval};break;case"C":C=parseInt(record[rj].slice(1),10)-1,colinfo[C]||(colinfo[C]={});break;case"R":R=parseInt(record[rj].slice(1),10)-1,rowinfo[R]||(rowinfo[R]={}),Mval>0?(rowinfo[R].hpt=Mval,rowinfo[R].hpx=pt2px(Mval)):Mval===0&&(rowinfo[R].hidden=!0);break;default:if(opts&&opts.WTF)throw new Error("SYLK bad record "+rstr)}F_seen<1&&(next_cell_format=null);break;default:if(opts&&opts.WTF)throw new Error("SYLK bad record "+rstr)}}return rowinfo.length>0&&(sht["!rows"]=rowinfo),colinfo.length>0&&(sht["!cols"]=colinfo),colinfo.forEach(function(col){process_col(col)}),opts&&opts.sheetRows&&(arr=arr.slice(0,opts.sheetRows)),[arr,sht,wb]}function sylk_to_workbook(d,opts){var aoasht=sylk_to_aoa(d,opts),aoa=aoasht[0],ws=aoasht[1],wb=aoasht[2],_opts=dup(opts);_opts.date1904=(((wb||{}).Workbook||{}).WBProps||{}).date1904;var o=aoa_to_sheet(aoa,_opts);keys(ws).forEach(function(k){o[k]=ws[k]});var outwb=sheet_to_workbook(o,opts);return keys(wb).forEach(function(k){outwb[k]=wb[k]}),outwb.bookType="sylk",outwb}function write_ws_cell_sylk(cell,ws,R,C,opts,date1904){var o="C;Y"+(R+1)+";X"+(C+1)+";K";switch(cell.t){case"n":o+=cell.v||0,cell.f&&!cell.F&&(o+=";E"+a1_to_rc(cell.f,{r:R,c:C}));break;case"b":o+=cell.v?"TRUE":"FALSE";break;case"e":o+=cell.w||BErr[cell.v]||cell.v;break;case"d":o+=datenum(parseDate(cell.v,date1904),date1904);break;case"s":o+='"'+(cell.v==null?"":String(cell.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return o}function write_ws_cmnt_sylk(cmnt,R,C){var o="C;Y"+(R+1)+";X"+(C+1)+";A";return o+=encode_sylk_str(cmnt.map(function(c){return c.t}).join("")),o}function write_ws_cols_sylk(out,cols){cols.forEach(function(col,i){var rec="F;W"+(i+1)+" "+(i+1)+" ";col.hidden?rec+="0":(typeof col.width=="number"&&!col.wpx&&(col.wpx=width2px(col.width)),typeof col.wpx=="number"&&!col.wch&&(col.wch=px2char(col.wpx)),typeof col.wch=="number"&&(rec+=Math.round(col.wch))),rec.charAt(rec.length-1)!=" "&&out.push(rec)})}function write_ws_rows_sylk(out,rows){rows.forEach(function(row,i){var rec="F;";row.hidden?rec+="M0;":row.hpt?rec+="M"+20*row.hpt+";":row.hpx&&(rec+="M"+20*px2pt(row.hpx)+";"),rec.length>2&&out.push(rec+"R"+(i+1))})}function sheet_to_sylk(ws,opts,wb){opts||(opts={}),opts._formats=["General"];var preamble=["ID;PSheetJS;N;E"],o=[],r=safe_decode_range(ws["!ref"]||"A1"),cell,dense=ws["!data"]!=null,RS=`\r
`,d1904=(((wb||{}).Workbook||{}).WBProps||{}).date1904,_lastfmt="General";preamble.push("P;PGeneral");var R=r.s.r,C=r.s.c,p=[];if(ws["!ref"]){for(R=r.s.r;R<=r.e.r;++R)if(!(dense&&!ws["!data"][R])){for(p=[],C=r.s.c;C<=r.e.c;++C)cell=dense?ws["!data"][R][C]:ws[encode_col(C)+encode_row(R)],!(!cell||!cell.c)&&p.push(write_ws_cmnt_sylk(cell.c,R,C));p.length&&o.push(p.join(RS))}}if(ws["!ref"]){for(R=r.s.r;R<=r.e.r;++R)if(!(dense&&!ws["!data"][R])){for(p=[],C=r.s.c;C<=r.e.c;++C)if(cell=dense?ws["!data"][R][C]:ws[encode_col(C)+encode_row(R)],!(!cell||cell.v==null&&(!cell.f||cell.F))){if((cell.z||(cell.t=="d"?table_fmt[14]:"General"))!=_lastfmt){var ifmt=opts._formats.indexOf(cell.z);ifmt==-1&&(opts._formats.push(cell.z),ifmt=opts._formats.length-1,preamble.push("P;P"+cell.z.replace(/;/g,";;"))),p.push("F;P"+ifmt+";Y"+(R+1)+";X"+(C+1))}p.push(write_ws_cell_sylk(cell,ws,R,C,opts,d1904))}o.push(p.join(RS))}}return preamble.push("F;P0;DG0G8;M255"),ws["!cols"]&&write_ws_cols_sylk(preamble,ws["!cols"]),ws["!rows"]&&write_ws_rows_sylk(preamble,ws["!rows"]),ws["!ref"]&&preamble.push("B;Y"+(r.e.r-r.s.r+1)+";X"+(r.e.c-r.s.c+1)+";D"+[r.s.c,r.s.r,r.e.c,r.e.r].join(" ")),preamble.push("O;L;D;B"+(d1904?";V4":"")+";K47;G100 0.001"),delete opts._formats,preamble.join(RS)+RS+o.join(RS)+RS+"E"+RS}return{to_workbook:sylk_to_workbook,from_sheet:sheet_to_sylk}}(),DIF=function(){function dif_to_aoa(d,opts){switch(opts.type){case"base64":return dif_to_aoa_str(Base64_decode(d),opts);case"binary":return dif_to_aoa_str(d,opts);case"buffer":return dif_to_aoa_str(has_buf&&Buffer.isBuffer(d)?d.toString("binary"):a2s(d),opts);case"array":return dif_to_aoa_str(cc2str(d),opts)}throw new Error("Unrecognized type "+opts.type)}function dif_to_aoa_str(str,opts){for(var records=str.split(`
`),R=-1,C=-1,ri=0,arr=[];ri!==records.length;++ri){if(records[ri].trim()==="BOT"){arr[++R]=[],C=0;continue}if(!(R<0)){var metadata=records[ri].trim().split(","),type=metadata[0],value=metadata[1];++ri;for(var data=records[ri]||"";(data.match(/["]/g)||[]).length&1&&ri<records.length-1;)data+=`
`+records[++ri];switch(data=data.trim(),+type){case-1:if(data==="BOT"){arr[++R]=[],C=0;continue}else if(data!=="EOD")throw new Error("Unrecognized DIF special command "+data);break;case 0:data==="TRUE"?arr[R][C]=!0:data==="FALSE"?arr[R][C]=!1:isNaN(fuzzynum(value))?isNaN(fuzzydate(value).getDate())?arr[R][C]=value:(arr[R][C]=parseDate(value),opts&&opts.UTC||(arr[R][C]=utc_to_local(arr[R][C]))):arr[R][C]=fuzzynum(value),++C;break;case 1:data=data.slice(1,data.length-1),data=data.replace(/""/g,'"'),DIF_XL&&data&&data.match(/^=".*"$/)&&(data=data.slice(2,-1)),arr[R][C++]=data!==""?data:null;break}if(data==="EOD")break}}return opts&&opts.sheetRows&&(arr=arr.slice(0,opts.sheetRows)),arr}function dif_to_sheet(str,opts){return aoa_to_sheet(dif_to_aoa(str,opts),opts)}function dif_to_workbook(str,opts){var o=sheet_to_workbook(dif_to_sheet(str,opts),opts);return o.bookType="dif",o}function make_value(v,s){return"0,"+String(v)+`\r
`+s}function make_value_str(s){return`1,0\r
"`+s.replace(/"/g,'""')+'"'}function sheet_to_dif(ws){var _DIF_XL=DIF_XL;if(!ws["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var r=safe_decode_range(ws["!ref"]),dense=ws["!data"]!=null,o=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(r.e.r-r.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(r.e.c-r.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],R=r.s.r;R<=r.e.r;++R){for(var row=dense?ws["!data"][R]:[],p=`-1,0\r
BOT\r
`,C=r.s.c;C<=r.e.c;++C){var cell=dense?row&&row[C]:ws[encode_cell({r:R,c:C})];if(cell==null){p+=`1,0\r
""\r
`;continue}switch(cell.t){case"n":_DIF_XL?cell.w!=null?p+="0,"+cell.w+`\r
V`:cell.v!=null?p+=make_value(cell.v,"V"):cell.f!=null&&!cell.F?p+=make_value_str("="+cell.f):p+=`1,0\r
""`:cell.v==null?p+=`1,0\r
""`:p+=make_value(cell.v,"V");break;case"b":p+=cell.v?make_value(1,"TRUE"):make_value(0,"FALSE");break;case"s":p+=make_value_str(!_DIF_XL||isNaN(+cell.v)?cell.v:'="'+cell.v+'"');break;case"d":cell.w||(cell.w=SSF_format(cell.z||table_fmt[14],datenum(parseDate(cell.v)))),_DIF_XL?p+=make_value(cell.w,"V"):p+=make_value_str(cell.w);break;default:p+=`1,0\r
""`}p+=`\r
`}o.push(p)}return o.join("")+`-1,0\r
EOD`}return{to_workbook:dif_to_workbook,to_sheet:dif_to_sheet,from_sheet:sheet_to_dif}}(),ETH=function(){function decode(s){return s.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function encode(s){return s.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function eth_to_aoa(str,opts){for(var records=str.split(`
`),R=-1,C=-1,ri=0,arr=[];ri!==records.length;++ri){var record=records[ri].trim().split(":");if(record[0]==="cell"){var addr=decode_cell(record[1]);if(arr.length<=addr.r)for(R=arr.length;R<=addr.r;++R)arr[R]||(arr[R]=[]);switch(R=addr.r,C=addr.c,record[2]){case"t":arr[R][C]=decode(record[3]);break;case"v":arr[R][C]=+record[3];break;case"vtf":var _f=record[record.length-1];case"vtc":switch(record[3]){case"nl":arr[R][C]=!!+record[4];break;default:arr[R][C]=+record[4];break}record[2]=="vtf"&&(arr[R][C]=[arr[R][C],_f])}}}return opts&&opts.sheetRows&&(arr=arr.slice(0,opts.sheetRows)),arr}function eth_to_sheet(d,opts){return aoa_to_sheet(eth_to_aoa(d,opts),opts)}function eth_to_workbook(d,opts){return sheet_to_workbook(eth_to_sheet(d,opts),opts)}var header=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),sep=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,meta=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),end2="--SocialCalcSpreadsheetControlSave--";function sheet_to_eth_data(ws){if(!ws||!ws["!ref"])return"";for(var o=[],oo=[],cell,coord="",r=decode_range(ws["!ref"]),dense=ws["!data"]!=null,R=r.s.r;R<=r.e.r;++R)for(var C=r.s.c;C<=r.e.c;++C)if(coord=encode_cell({r:R,c:C}),cell=dense?(ws["!data"][R]||[])[C]:ws[coord],!(!cell||cell.v==null||cell.t==="z")){switch(oo=["cell",coord,"t"],cell.t){case"s":case"str":oo.push(encode(cell.v));break;case"n":cell.f?(oo[2]="vtf",oo[3]="n",oo[4]=cell.v,oo[5]=encode(cell.f)):(oo[2]="v",oo[3]=cell.v);break;case"b":oo[2]="vt"+(cell.f?"f":"c"),oo[3]="nl",oo[4]=cell.v?"1":"0",oo[5]=encode(cell.f||(cell.v?"TRUE":"FALSE"));break;case"d":var t=datenum(parseDate(cell.v));oo[2]="vtc",oo[3]="nd",oo[4]=""+t,oo[5]=cell.w||SSF_format(cell.z||table_fmt[14],t);break;case"e":continue}o.push(oo.join(":"))}return o.push("sheet:c:"+(r.e.c-r.s.c+1)+":r:"+(r.e.r-r.s.r+1)+":tvf:1"),o.push("valueformat:1:text-wiki"),o.join(`
`)}function sheet_to_eth(ws){return[header,sep,meta,sep,sheet_to_eth_data(ws),end2].join(`
`)}return{to_workbook:eth_to_workbook,to_sheet:eth_to_sheet,from_sheet:sheet_to_eth}}(),PRN=function(){function set_text_arr(data,arr,R,C,o){o.raw?arr[R][C]=data:data===""||(data==="TRUE"?arr[R][C]=!0:data==="FALSE"?arr[R][C]=!1:isNaN(fuzzynum(data))?isNaN(fuzzydate(data).getDate())?arr[R][C]=data:arr[R][C]=parseDate(data):arr[R][C]=fuzzynum(data))}function prn_to_aoa_str(f,opts){var o=opts||{},arr=[];if(!f||f.length===0)return arr;for(var lines=f.split(/[\r\n]/),L=lines.length-1;L>=0&&lines[L].length===0;)--L;for(var start2=10,idx=0,R=0;R<=L;++R)idx=lines[R].indexOf(" "),idx==-1?idx=lines[R].length:idx++,start2=Math.max(start2,idx);for(R=0;R<=L;++R){arr[R]=[];var C=0;for(set_text_arr(lines[R].slice(0,start2).trim(),arr,R,C,o),C=1;C<=(lines[R].length-start2)/10+1;++C)set_text_arr(lines[R].slice(start2+(C-1)*10,start2+C*10).trim(),arr,R,C,o)}return o.sheetRows&&(arr=arr.slice(0,o.sheetRows)),arr}var guess_seps={44:",",9:"	",59:";",124:"|"},guess_sep_weights={44:3,9:2,59:1,124:0};function guess_sep(str){for(var cnt={},instr=!1,end2=0,cc=0;end2<str.length;++end2)(cc=str.charCodeAt(end2))==34?instr=!instr:!instr&&cc in guess_seps&&(cnt[cc]=(cnt[cc]||0)+1);cc=[];for(end2 in cnt)Object.prototype.hasOwnProperty.call(cnt,end2)&&cc.push([cnt[end2],end2]);if(!cc.length){cnt=guess_sep_weights;for(end2 in cnt)Object.prototype.hasOwnProperty.call(cnt,end2)&&cc.push([cnt[end2],end2])}return cc.sort(function(a,b){return a[0]-b[0]||guess_sep_weights[a[1]]-guess_sep_weights[b[1]]}),guess_seps[cc.pop()[1]]||44}function dsv_to_sheet_str(str,opts){var o=opts||{},sep="";DENSE!=null&&o.dense==null&&(o.dense=DENSE);var ws={};o.dense&&(ws["!data"]=[]);var range={s:{c:0,r:0},e:{c:0,r:0}};str.slice(0,4)=="sep="?str.charCodeAt(5)==13&&str.charCodeAt(6)==10?(sep=str.charAt(4),str=str.slice(7)):str.charCodeAt(5)==13||str.charCodeAt(5)==10?(sep=str.charAt(4),str=str.slice(6)):sep=guess_sep(str.slice(0,1024)):o&&o.FS?sep=o.FS:sep=guess_sep(str.slice(0,1024));var R=0,C=0,v=0,start2=0,end2=0,sepcc=sep.charCodeAt(0),instr=!1,cc=0,startcc=str.charCodeAt(0),_re=o.dateNF!=null?dateNF_regex(o.dateNF):null;function finish_cell(){var s=str.slice(start2,end2);s.slice(-1)=="\r"&&(s=s.slice(0,-1));var cell={};if(s.charAt(0)=='"'&&s.charAt(s.length-1)=='"'&&(s=s.slice(1,-1).replace(/""/g,'"')),o.cellText!==!1&&(cell.w=s),s.length===0)cell.t="z";else if(o.raw)cell.t="s",cell.v=s;else if(s.trim().length===0)cell.t="s",cell.v=s;else if(s.charCodeAt(0)==61)s.charCodeAt(1)==34&&s.charCodeAt(s.length-1)==34?(cell.t="s",cell.v=s.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(s)?(cell.t="s",cell.f=s.slice(1),cell.v=s):(cell.t="s",cell.v=s);else if(s=="TRUE")cell.t="b",cell.v=!0;else if(s=="FALSE")cell.t="b",cell.v=!1;else if(!isNaN(v=fuzzynum(s)))cell.t="n",cell.v=v;else if(!isNaN((v=fuzzydate(s)).getDate())||_re&&s.match(_re)){if(cell.z=o.dateNF||table_fmt[14],_re&&s.match(_re)){var news=dateNF_fix(s,o.dateNF,s.match(_re)||[]);v=parseDate(news),o&&o.UTC===!1&&(v=utc_to_local(v))}else o&&o.UTC===!1?v=utc_to_local(v):o.cellText!==!1&&o.dateNF&&(cell.w=SSF_format(cell.z,v));o.cellDates?(cell.t="d",cell.v=v):(cell.t="n",cell.v=datenum(v)),o.cellNF||delete cell.z}else cell.t="s",cell.v=s;if(cell.t=="z"||(o.dense?(ws["!data"][R]||(ws["!data"][R]=[]),ws["!data"][R][C]=cell):ws[encode_cell({c:C,r:R})]=cell),start2=end2+1,startcc=str.charCodeAt(start2),range.e.c<C&&(range.e.c=C),range.e.r<R&&(range.e.r=R),cc==sepcc)++C;else if(C=0,++R,o.sheetRows&&o.sheetRows<=R)return!0}outer:for(;end2<str.length;++end2)switch(cc=str.charCodeAt(end2)){case 34:startcc===34&&(instr=!instr);break;case 13:if(instr)break;str.charCodeAt(end2+1)==10&&++end2;case sepcc:case 10:if(!instr&&finish_cell())break outer;break;default:break}return end2-start2>0&&finish_cell(),ws["!ref"]=encode_range(range),ws}function prn_to_sheet_str(str,opts){return!(opts&&opts.PRN)||opts.FS||str.slice(0,4)=="sep="||str.indexOf("	")>=0||str.indexOf(",")>=0||str.indexOf(";")>=0?dsv_to_sheet_str(str,opts):aoa_to_sheet(prn_to_aoa_str(str,opts),opts)}function prn_to_sheet(d,opts){var str="",bytes=opts.type=="string"?[0,0,0,0]:firstbyte(d,opts);switch(opts.type){case"base64":str=Base64_decode(d);break;case"binary":str=d;break;case"buffer":opts.codepage==65001?str=d.toString("utf8"):opts.codepage&&typeof $cptable<"u"?str=$cptable.utils.decode(opts.codepage,d):str=has_buf&&Buffer.isBuffer(d)?d.toString("binary"):a2s(d);break;case"array":str=cc2str(d);break;case"string":str=d;break;default:throw new Error("Unrecognized type "+opts.type)}return bytes[0]==239&&bytes[1]==187&&bytes[2]==191?str=utf8read(str.slice(3)):opts.type!="string"&&opts.type!="buffer"&&opts.codepage==65001?str=utf8read(str):opts.type=="binary"&&typeof $cptable<"u"&&opts.codepage&&(str=$cptable.utils.decode(opts.codepage,$cptable.utils.encode(28591,str))),str.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(opts.type=="string"?str:utf8read(str),opts):prn_to_sheet_str(str,opts)}function prn_to_workbook(d,opts){return sheet_to_workbook(prn_to_sheet(d,opts),opts)}function sheet_to_prn(ws){var o=[];if(!ws["!ref"])return"";for(var r=safe_decode_range(ws["!ref"]),cell,dense=ws["!data"]!=null,R=r.s.r;R<=r.e.r;++R){for(var oo=[],C=r.s.c;C<=r.e.c;++C){var coord=encode_cell({r:R,c:C});if(cell=dense?(ws["!data"][R]||[])[C]:ws[coord],!cell||cell.v==null){oo.push("          ");continue}for(var w=(cell.w||(format_cell(cell),cell.w)||"").slice(0,10);w.length<10;)w+=" ";oo.push(w+(C===0?" ":""))}o.push(oo.join(""))}return o.join(`
`)}return{to_workbook:prn_to_workbook,to_sheet:prn_to_sheet,from_sheet:sheet_to_prn}}();var WK_=function(){function lotushopper(data,cb,opts){if(data){prep_blob(data,data.l||0);for(var Enum=opts.Enum||WK1Enum;data.l<data.length;){var RT=data.read_shift(2),R=Enum[RT]||Enum[65535],length=data.read_shift(2),tgt=data.l+length,d=R.f&&R.f(data,length,opts);if(data.l=tgt,cb(d,R,RT))return}}}function lotus_to_workbook(d,opts){switch(opts.type){case"base64":return lotus_to_workbook_buf(s2a(Base64_decode(d)),opts);case"binary":return lotus_to_workbook_buf(s2a(d),opts);case"buffer":case"array":return lotus_to_workbook_buf(d,opts)}throw"Unsupported type "+opts.type}var LOTUS_DATE_FMTS=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function lotus_to_workbook_buf(d,opts){if(!d)return d;var o=opts||{};DENSE!=null&&o.dense==null&&(o.dense=DENSE);var s={},n="Sheet1",next_n="",sidx=0,sheets={},snames=[],realnames=[],sdata=[];o.dense&&(sdata=s["!data"]=[]);var refguess={s:{r:0,c:0},e:{r:0,c:0}},sheetRows=o.sheetRows||0,lastcell={};if(d[4]==81&&d[5]==80&&d[6]==87)return qpw_to_workbook_buf(d,opts);if(d[2]==0&&(d[3]==8||d[3]==9)&&d.length>=16&&d[14]==5&&d[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(d[2]==2)o.Enum=WK1Enum,lotushopper(d,function(val,R,RT){switch(RT){case 0:o.vers=val,val>=4096&&(o.qpro=!0);break;case 255:o.vers=val,o.works=!0;break;case 6:refguess=val;break;case 204:val&&(next_n=val);break;case 222:next_n=val;break;case 15:case 51:(!o.qpro&&!o.works||RT==51)&&val[1].v.charCodeAt(0)<48&&(val[1].v=val[1].v.slice(1)),(o.works||o.works2)&&(val[1].v=val[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(val[2]&112)==112&&(val[2]&15)>1&&(val[2]&15)<15&&(val[1].z=o.dateNF||LOTUS_DATE_FMTS[(val[2]&15)-1]||table_fmt[14],o.cellDates&&(val[1].v=numdate(val[1].v),val[1].t=typeof val[1].v=="number"?"n":"d")),o.qpro&&val[3]>sidx&&(s["!ref"]=encode_range(refguess),sheets[n]=s,snames.push(n),s={},o.dense&&(sdata=s["!data"]=[]),refguess={s:{r:0,c:0},e:{r:0,c:0}},sidx=val[3],n=next_n||"Sheet"+(sidx+1),next_n="");var tmpcell=o.dense?(sdata[val[0].r]||[])[val[0].c]:s[encode_cell(val[0])];if(tmpcell){tmpcell.t=val[1].t,tmpcell.v=val[1].v,val[1].z!=null&&(tmpcell.z=val[1].z),val[1].f!=null&&(tmpcell.f=val[1].f),lastcell=tmpcell;break}o.dense?(sdata[val[0].r]||(sdata[val[0].r]=[]),sdata[val[0].r][val[0].c]=val[1]):s[encode_cell(val[0])]=val[1],lastcell=val[1];break;case 21509:o.works2=!0;break;case 21506:val==5281&&(lastcell.z="hh:mm:ss",o.cellDates&&lastcell.t=="n"&&(lastcell.v=numdate(lastcell.v),lastcell.t=typeof lastcell.v=="number"?"n":"d"));break}},o);else if(d[2]==26||d[2]==14)o.Enum=WK3Enum,d[2]==14&&(o.qpro=!0,d.l=0),lotushopper(d,function(val,R,RT){switch(RT){case 204:n=val;break;case 22:val[1].v.charCodeAt(0)<48&&(val[1].v=val[1].v.slice(1)),val[1].v=val[1].v.replace(/\x0F./g,function($$){return String.fromCharCode($$.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(val[3]>sidx&&(s["!ref"]=encode_range(refguess),sheets[n]=s,snames.push(n),s={},o.dense&&(sdata=s["!data"]=[]),refguess={s:{r:0,c:0},e:{r:0,c:0}},sidx=val[3],n="Sheet"+(sidx+1)),sheetRows>0&&val[0].r>=sheetRows)break;o.dense?(sdata[val[0].r]||(sdata[val[0].r]=[]),sdata[val[0].r][val[0].c]=val[1]):s[encode_cell(val[0])]=val[1],refguess.e.c<val[0].c&&(refguess.e.c=val[0].c),refguess.e.r<val[0].r&&(refguess.e.r=val[0].r);break;case 27:val[14e3]&&(realnames[val[14e3][0]]=val[14e3][1]);break;case 1537:realnames[val[0]]=val[1],val[0]==sidx&&(n=val[1]);break;default:break}},o);else throw new Error("Unrecognized LOTUS BOF "+d[2]);if(s["!ref"]=encode_range(refguess),sheets[next_n||n]=s,snames.push(next_n||n),!realnames.length)return{SheetNames:snames,Sheets:sheets};for(var osheets={},rnames=[],i=0;i<realnames.length;++i)sheets[snames[i]]?(rnames.push(realnames[i]||snames[i]),osheets[realnames[i]]=sheets[realnames[i]]||sheets[snames[i]]):(rnames.push(realnames[i]),osheets[realnames[i]]={"!ref":"A1"});return{SheetNames:rnames,Sheets:osheets}}function sheet_to_wk1(ws,opts){var o=opts||{};if(+o.codepage>=0&&set_cp(+o.codepage),o.type=="string")throw new Error("Cannot write WK1 to JS string");var ba=buf_array();if(!ws["!ref"])throw new Error("Cannot export empty sheet to WK1");var range=safe_decode_range(ws["!ref"]),dense=ws["!data"]!=null,cols=[];write_biff_rec(ba,0,write_BOF_WK1(1030)),write_biff_rec(ba,6,write_RANGE(range));for(var max_R=Math.min(range.e.r,8191),C=range.s.c;C<=range.e.c;++C)cols[C]=encode_col(C);for(var R=range.s.r;R<=max_R;++R){var rr=encode_row(R);for(C=range.s.c;C<=range.e.c;++C){var cell=dense?(ws["!data"][R]||[])[C]:ws[cols[C]+rr];if(!(!cell||cell.t=="z"))switch(cell.t){case"n":(cell.v|0)==cell.v&&cell.v>=-32768&&cell.v<=32767?write_biff_rec(ba,13,write_INTEGER(R,C,cell)):write_biff_rec(ba,14,write_NUMBER(R,C,cell));break;case"d":var dc=datenum(cell.v);(dc|0)==dc&&dc>=-32768&&dc<=32767?write_biff_rec(ba,13,write_INTEGER(R,C,{t:"n",v:dc,z:cell.z||table_fmt[14]})):write_biff_rec(ba,14,write_NUMBER(R,C,{t:"n",v:dc,z:cell.z||table_fmt[14]}));break;default:var str=format_cell(cell);write_biff_rec(ba,15,write_LABEL(R,C,str.slice(0,239)))}}}return write_biff_rec(ba,1),ba.end()}function book_to_wk3(wb,opts){var o=opts||{};if(+o.codepage>=0&&set_cp(+o.codepage),o.type=="string")throw new Error("Cannot write WK3 to JS string");var ba=buf_array();write_biff_rec(ba,0,write_BOF_WK3(wb));for(var i=0,cnt=0;i<wb.SheetNames.length;++i)(wb.Sheets[wb.SheetNames[i]]||{})["!ref"]&&write_biff_rec(ba,27,write_XFORMAT_SHEETNAME(wb.SheetNames[i],cnt++));var wsidx=0;for(i=0;i<wb.SheetNames.length;++i){var ws=wb.Sheets[wb.SheetNames[i]];if(!(!ws||!ws["!ref"])){for(var range=safe_decode_range(ws["!ref"]),dense=ws["!data"]!=null,cols=[],max_R=Math.min(range.e.r,8191),R=range.s.r;R<=max_R;++R)for(var rr=encode_row(R),C=range.s.c;C<=range.e.c;++C){R===range.s.r&&(cols[C]=encode_col(C));var ref=cols[C]+rr,cell=dense?(ws["!data"][R]||[])[C]:ws[ref];if(!(!cell||cell.t=="z"))if(cell.t=="n")write_biff_rec(ba,23,write_NUMBER_17(R,C,wsidx,cell.v));else{var str=format_cell(cell);write_biff_rec(ba,22,write_LABEL_16(R,C,wsidx,str.slice(0,239)))}}++wsidx}}return write_biff_rec(ba,1),ba.end()}function write_BOF_WK1(v){var out=new_buf(2);return out.write_shift(2,v),out}function write_BOF_WK3(wb){var out=new_buf(26);out.write_shift(2,4096),out.write_shift(2,4),out.write_shift(4,0);for(var rows=0,cols=0,wscnt=0,i=0;i<wb.SheetNames.length;++i){var name=wb.SheetNames[i],ws=wb.Sheets[name];if(!(!ws||!ws["!ref"])){++wscnt;var range=decode_range(ws["!ref"]);rows<range.e.r&&(rows=range.e.r),cols<range.e.c&&(cols=range.e.c)}}return rows>8191&&(rows=8191),out.write_shift(2,rows),out.write_shift(1,wscnt),out.write_shift(1,cols),out.write_shift(2,0),out.write_shift(2,0),out.write_shift(1,1),out.write_shift(1,2),out.write_shift(4,0),out.write_shift(4,0),out}function parse_RANGE(blob,length,opts){var o={s:{c:0,r:0},e:{c:0,r:0}};return length==8&&opts.qpro?(o.s.c=blob.read_shift(1),blob.l++,o.s.r=blob.read_shift(2),o.e.c=blob.read_shift(1),blob.l++,o.e.r=blob.read_shift(2),o):(o.s.c=blob.read_shift(2),o.s.r=blob.read_shift(2),length==12&&opts.qpro&&(blob.l+=2),o.e.c=blob.read_shift(2),o.e.r=blob.read_shift(2),length==12&&opts.qpro&&(blob.l+=2),o.s.c==65535&&(o.s.c=o.e.c=o.s.r=o.e.r=0),o)}function write_RANGE(range){var out=new_buf(8);return out.write_shift(2,range.s.c),out.write_shift(2,range.s.r),out.write_shift(2,range.e.c),out.write_shift(2,range.e.r),out}function parse_cell(blob,length,opts){var o=[{c:0,r:0},{t:"n",v:0},0,0];return opts.qpro&&opts.vers!=20768?(o[0].c=blob.read_shift(1),o[3]=blob.read_shift(1),o[0].r=blob.read_shift(2),blob.l+=2):opts.works?(o[0].c=blob.read_shift(2),o[0].r=blob.read_shift(2),o[2]=blob.read_shift(2)):(o[2]=blob.read_shift(1),o[0].c=blob.read_shift(2),o[0].r=blob.read_shift(2)),o}function get_wk1_fmt(cell){return cell.z&&fmt_is_date(cell.z)?240|(LOTUS_DATE_FMTS.indexOf(cell.z)+1||2):255}function parse_LABEL(blob,length,opts){var tgt=blob.l+length,o=parse_cell(blob,length,opts);if(o[1].t="s",(opts.vers&65534)==20768){blob.l++;var len=blob.read_shift(1);return o[1].v=blob.read_shift(len,"utf8"),o}return opts.qpro&&blob.l++,o[1].v=blob.read_shift(tgt-blob.l,"cstr"),o}function write_LABEL(R,C,s){var o=new_buf(7+s.length);o.write_shift(1,255),o.write_shift(2,C),o.write_shift(2,R),o.write_shift(1,39);for(var i=0;i<o.length;++i){var cc=s.charCodeAt(i);o.write_shift(1,cc>=128?95:cc)}return o.write_shift(1,0),o}function parse_STRING(blob,length,opts){var tgt=blob.l+length,o=parse_cell(blob,length,opts);if(o[1].t="s",opts.vers==20768){var len=blob.read_shift(1);return o[1].v=blob.read_shift(len,"utf8"),o}return o[1].v=blob.read_shift(tgt-blob.l,"cstr"),o}function parse_INTEGER(blob,length,opts){var o=parse_cell(blob,length,opts);return o[1].v=blob.read_shift(2,"i"),o}function write_INTEGER(R,C,cell){var o=new_buf(7);return o.write_shift(1,get_wk1_fmt(cell)),o.write_shift(2,C),o.write_shift(2,R),o.write_shift(2,cell.v,"i"),o}function parse_NUMBER(blob,length,opts){var o=parse_cell(blob,length,opts);return o[1].v=blob.read_shift(8,"f"),o}function write_NUMBER(R,C,cell){var o=new_buf(13);return o.write_shift(1,get_wk1_fmt(cell)),o.write_shift(2,C),o.write_shift(2,R),o.write_shift(8,cell.v,"f"),o}function parse_FORMULA(blob,length,opts){var tgt=blob.l+length,o=parse_cell(blob,length,opts);if(o[1].v=blob.read_shift(8,"f"),opts.qpro)blob.l=tgt;else{var flen=blob.read_shift(2);wk1_fmla_to_csf(blob.slice(blob.l,blob.l+flen),o),blob.l+=flen}return o}function wk1_parse_rc(B,V,col){var rel=V&32768;return V&=-32769,V=(rel?B:0)+(V>=8192?V-16384:V),(rel?"":"$")+(col?encode_col(V):encode_row(V))}var FuncTab={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},BinOpTab=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function wk1_fmla_to_csf(blob,o){prep_blob(blob,0);for(var out=[],argc=0,R="",C="",argL="",argR="";blob.l<blob.length;){var cc=blob[blob.l++];switch(cc){case 0:out.push(blob.read_shift(8,"f"));break;case 1:C=wk1_parse_rc(o[0].c,blob.read_shift(2),!0),R=wk1_parse_rc(o[0].r,blob.read_shift(2),!1),out.push(C+R);break;case 2:{var c=wk1_parse_rc(o[0].c,blob.read_shift(2),!0),r=wk1_parse_rc(o[0].r,blob.read_shift(2),!1);C=wk1_parse_rc(o[0].c,blob.read_shift(2),!0),R=wk1_parse_rc(o[0].r,blob.read_shift(2),!1),out.push(c+r+":"+C+R)}break;case 3:if(blob.l<blob.length){console.error("WK1 premature formula end");return}break;case 4:out.push("("+out.pop()+")");break;case 5:out.push(blob.read_shift(2));break;case 6:{for(var Z="";cc=blob[blob.l++];)Z+=String.fromCharCode(cc);out.push('"'+Z.replace(/"/g,'""')+'"')}break;case 8:out.push("-"+out.pop());break;case 23:out.push("+"+out.pop());break;case 22:out.push("NOT("+out.pop()+")");break;case 20:case 21:argR=out.pop(),argL=out.pop(),out.push(["AND","OR"][cc-20]+"("+argL+","+argR+")");break;default:if(cc<32&&BinOpTab[cc])argR=out.pop(),argL=out.pop(),out.push(argL+BinOpTab[cc]+argR);else if(FuncTab[cc]){if(argc=FuncTab[cc][1],argc==69&&(argc=blob[blob.l++]),argc>out.length){console.error("WK1 bad formula parse 0x"+cc.toString(16)+":|"+out.join("|")+"|");return}var args=out.slice(-argc);out.length-=argc,out.push(FuncTab[cc][0]+"("+args.join(",")+")")}else return cc<=7?console.error("WK1 invalid opcode "+cc.toString(16)):cc<=24?console.error("WK1 unsupported op "+cc.toString(16)):cc<=30?console.error("WK1 invalid opcode "+cc.toString(16)):cc<=115?console.error("WK1 unsupported function opcode "+cc.toString(16)):console.error("WK1 unrecognized opcode "+cc.toString(16))}}out.length==1?o[1].f=""+out[0]:console.error("WK1 bad formula parse |"+out.join("|")+"|")}function parse_cell_3(blob){var o=[{c:0,r:0},{t:"n",v:0},0];return o[0].r=blob.read_shift(2),o[3]=blob[blob.l++],o[0].c=blob[blob.l++],o}function parse_LABEL_16(blob,length){var o=parse_cell_3(blob,length);return o[1].t="s",o[1].v=blob.read_shift(length-4,"cstr"),o}function write_LABEL_16(R,C,wsidx,s){var o=new_buf(6+s.length);o.write_shift(2,R),o.write_shift(1,wsidx),o.write_shift(1,C),o.write_shift(1,39);for(var i=0;i<s.length;++i){var cc=s.charCodeAt(i);o.write_shift(1,cc>=128?95:cc)}return o.write_shift(1,0),o}function parse_NUMBER_18(blob,length){var o=parse_cell_3(blob,length);o[1].v=blob.read_shift(2);var v=o[1].v>>1;if(o[1].v&1)switch(v&7){case 0:v=(v>>3)*5e3;break;case 1:v=(v>>3)*500;break;case 2:v=(v>>3)/20;break;case 3:v=(v>>3)/200;break;case 4:v=(v>>3)/2e3;break;case 5:v=(v>>3)/2e4;break;case 6:v=(v>>3)/16;break;case 7:v=(v>>3)/64;break}return o[1].v=v,o}function parse_NUMBER_17(blob,length){var o=parse_cell_3(blob,length),v1=blob.read_shift(4),v2=blob.read_shift(4),e=blob.read_shift(2);if(e==65535)return v1===0&&v2===3221225472?(o[1].t="e",o[1].v=15):v1===0&&v2===3489660928?(o[1].t="e",o[1].v=42):o[1].v=0,o;var s=e&32768;return e=(e&32767)-16446,o[1].v=(1-s*2)*(v2*Math.pow(2,e+32)+v1*Math.pow(2,e)),o}function write_NUMBER_17(R,C,wsidx,v){var o=new_buf(14);if(o.write_shift(2,R),o.write_shift(1,wsidx),o.write_shift(1,C),v==0)return o.write_shift(4,0),o.write_shift(4,0),o.write_shift(2,65535),o;var s=0,e=0,v1=0,v2=0;return v<0&&(s=1,v=-v),e=Math.log2(v)|0,v/=Math.pow(2,e-31),v2=v>>>0,v2&2147483648||(v/=2,++e,v2=v>>>0),v-=v2,v2|=2147483648,v2>>>=0,v*=Math.pow(2,32),v1=v>>>0,o.write_shift(4,v1),o.write_shift(4,v2),e+=16383+(s?32768:0),o.write_shift(2,e),o}function parse_FORMULA_19(blob,length){var o=parse_NUMBER_17(blob,14);return blob.l+=length-14,o}function parse_NUMBER_25(blob,length){var o=parse_cell_3(blob,length),v1=blob.read_shift(4);return o[1].v=v1>>6,o}function parse_NUMBER_27(blob,length){var o=parse_cell_3(blob,length),v1=blob.read_shift(8,"f");return o[1].v=v1,o}function parse_FORMULA_28(blob,length){var o=parse_NUMBER_27(blob,12);return blob.l+=length-12,o}function parse_SHEETNAMECS(blob,length){return blob[blob.l+length-1]==0?blob.read_shift(length,"cstr"):""}function parse_SHEETNAMELP(blob,length){var len=blob[blob.l++];len>length-1&&(len=length-1);for(var o="";o.length<len;)o+=String.fromCharCode(blob[blob.l++]);return o}function parse_SHEETINFOQP(blob,length,opts){if(!(!opts.qpro||length<21)){var id=blob.read_shift(1);blob.l+=17,blob.l+=1,blob.l+=2;var nm=blob.read_shift(length-21,"cstr");return[id,nm]}}function parse_XFORMAT(blob,length){for(var o={},tgt=blob.l+length;blob.l<tgt;){var dt=blob.read_shift(2);if(dt==14e3){for(o[dt]=[0,""],o[dt][0]=blob.read_shift(2);blob[blob.l];)o[dt][1]+=String.fromCharCode(blob[blob.l]),blob.l++;blob.l++}}return o}function write_XFORMAT_SHEETNAME(name,wsidx){var out=new_buf(5+name.length);out.write_shift(2,14e3),out.write_shift(2,wsidx);for(var i=0;i<name.length;++i){var cc=name.charCodeAt(i);out[out.l++]=cc>127?95:cc}return out[out.l++]=0,out}var WK1Enum={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:parse_RANGE},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:parse_INTEGER},14:{n:"NUMBER",f:parse_NUMBER},15:{n:"LABEL",f:parse_LABEL},16:{n:"FORMULA",f:parse_FORMULA},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:parse_STRING},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:parse_SHEETNAMECS},222:{n:"SHEETNAMELP",f:parse_SHEETNAMELP},255:{n:"BOF",f:parseuint16},21506:{n:"WKSNF",f:parseuint16},65535:{n:""}},WK3Enum={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:parse_LABEL_16},23:{n:"NUMBER17",f:parse_NUMBER_17},24:{n:"NUMBER18",f:parse_NUMBER_18},25:{n:"FORMULA19",f:parse_FORMULA_19},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:parse_XFORMAT},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:parse_NUMBER_25},38:{n:"??"},39:{n:"NUMBER27",f:parse_NUMBER_27},40:{n:"FORMULA28",f:parse_FORMULA_28},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:parse_SHEETNAMECS},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:parse_SHEETINFOQP},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},QPWNFTable={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function parse_qpw_str(p){var cch=p.read_shift(2),flags=p.read_shift(1);if(flags!=0)throw"unsupported QPW string type "+flags.toString(16);return p.read_shift(cch,"sbcs-cont")}function qpw_to_workbook_buf(d,opts){prep_blob(d,0);var o=opts||{};DENSE!=null&&o.dense==null&&(o.dense=DENSE);var s={};o.dense&&(s["!data"]=[]);var SST=[],sname="",formulae=[],range={s:{r:-1,c:-1},e:{r:-1,c:-1}},cnt=0,type=0,C=0,R=0,wb={SheetNames:[],Sheets:{}},FMTS=[];outer:for(;d.l<d.length;){var RT=d.read_shift(2),length=d.read_shift(2),p=d.slice(d.l,d.l+length);switch(prep_blob(p,0),RT){case 1:if(p.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break outer;case 8:break;case 10:for(var fcnt=p.read_shift(4),step=(p.length-p.l)/fcnt|0,ifmt=0;ifmt<fcnt;++ifmt){var end2=p.l+step,fmt={};p.l+=2,fmt.numFmtId=p.read_shift(2),QPWNFTable[fmt.numFmtId]&&(fmt.z=QPWNFTable[fmt.numFmtId]),p.l=end2,FMTS.push(fmt)}break;case 1025:break;case 1026:break;case 1031:for(p.l+=12;p.l<p.length;)cnt=p.read_shift(2),type=p.read_shift(1),SST.push(p.read_shift(cnt,"cstr"));break;case 1032:break;case 1537:{var sidx=p.read_shift(2);s={},o.dense&&(s["!data"]=[]),range.s.c=p.read_shift(2),range.e.c=p.read_shift(2),range.s.r=p.read_shift(4),range.e.r=p.read_shift(4),p.l+=4,p.l+2<p.length&&(cnt=p.read_shift(2),type=p.read_shift(1),sname=cnt==0?"":p.read_shift(cnt,"cstr")),sname||(sname=encode_col(sidx))}break;case 1538:{if(range.s.c>255||range.s.r>999999)break;range.e.c<range.s.c&&(range.e.c=range.s.c),range.e.r<range.s.r&&(range.e.r=range.s.r),s["!ref"]=encode_range(range),book_append_sheet(wb,s,sname)}break;case 2561:C=p.read_shift(2),range.e.c<C&&(range.e.c=C),range.s.c>C&&(range.s.c=C),R=p.read_shift(4),range.s.r>R&&(range.s.r=R),R=p.read_shift(4),range.e.r<R&&(range.e.r=R);break;case 3073:{R=p.read_shift(4),cnt=p.read_shift(4),range.s.r>R&&(range.s.r=R),range.e.r<R+cnt-1&&(range.e.r=R+cnt-1);for(var CC=encode_col(C);p.l<p.length;){var cell={t:"z"},flags=p.read_shift(1),fmtidx=-1;flags&128&&(fmtidx=p.read_shift(2));var mul=flags&64?p.read_shift(2)-1:0;switch(flags&31){case 0:break;case 1:break;case 2:cell={t:"n",v:p.read_shift(2)};break;case 3:cell={t:"n",v:p.read_shift(2,"i")};break;case 4:cell={t:"n",v:parse_RkNumber(p)};break;case 5:cell={t:"n",v:p.read_shift(8,"f")};break;case 7:cell={t:"s",v:SST[type=p.read_shift(4)-1]};break;case 8:cell={t:"n",v:p.read_shift(8,"f")},p.l+=2,p.l+=4,isNaN(cell.v)&&(cell={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(flags&31)}fmtidx!=-1&&(FMTS[fmtidx-1]||{}).z&&(cell.z=FMTS[fmtidx-1].z);var delta=0;if(flags&32)switch(flags&31){case 2:delta=p.read_shift(2);break;case 3:delta=p.read_shift(2,"i");break;case 7:delta=p.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(flags&31)}if(!(!o.sheetStubs&&cell.t=="z")){var newcell=dup(cell);cell.t=="n"&&cell.z&&fmt_is_date(cell.z)&&o.cellDates&&(newcell.v=numdate(cell.v),newcell.t=typeof newcell.v=="number"?"n":"d"),s["!data"]!=null?(s["!data"][R]||(s["!data"][R]=[]),s["!data"][R][C]=newcell):s[CC+encode_row(R)]=newcell}for(++R,--cnt;mul-- >0&&cnt>=0;){if(flags&32)switch(flags&31){case 2:cell={t:"n",v:cell.v+delta&65535};break;case 3:cell={t:"n",v:cell.v+delta&65535},cell.v>32767&&(cell.v-=65536);break;case 7:cell={t:"s",v:SST[type=type+delta>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(flags&31)}else switch(flags&31){case 1:cell={t:"z"};break;case 2:cell={t:"n",v:p.read_shift(2)};break;case 7:cell={t:"s",v:SST[type=p.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(flags&31)}fmtidx!=-1,!o.sheetStubs&&cell.t=="z"||(s["!data"]!=null?(s["!data"][R]||(s["!data"][R]=[]),s["!data"][R][C]=cell):s[CC+encode_row(R)]=cell),++R,--cnt}}}break;case 3074:{C=p.read_shift(2),R=p.read_shift(4);var str=parse_qpw_str(p);s["!data"]!=null?(s["!data"][R]||(s["!data"][R]=[]),s["!data"][R][C]={t:"s",v:str}):s[encode_col(C)+encode_row(R)]={t:"s",v:str}}break;default:break}d.l+=length}return wb}return{sheet_to_wk1,book_to_wk3,to_workbook:lotus_to_workbook}}();var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(sst,opts){if(!opts.bookSST)return"";var o=[XML_HEADER];o[o.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:sst.Count,uniqueCount:sst.Unique});for(var i=0;i!=sst.length;++i)if(sst[i]!=null){var s=sst[i],sitag="<si>";s.r?sitag+=s.r:(sitag+="<t",s.t||(s.t=""),typeof s.t!="string"&&(s.t=String(s.t)),s.t.match(straywsregex)&&(sitag+=' xml:space="preserve"'),sitag+=">"+escapexml(s.t)+"</t>"),sitag+="</si>",o[o.length]=sitag}return o.length>2&&(o[o.length]="</sst>",o[1]=o[1].replace("/>",">")),o.join("")}function parse_BrtBeginSst(data){return[data.read_shift(4),data.read_shift(4)]}function write_BrtBeginSst(sst,o){return o||(o=new_buf(8)),o.write_shift(4,sst.Count),o.write_shift(4,sst.Unique),o}var write_BrtSSTItem=write_RichStr;function write_sst_bin(sst){var ba=buf_array();write_record(ba,159,write_BrtBeginSst(sst));for(var i=0;i<sst.length;++i)write_record(ba,19,write_BrtSSTItem(sst[i]));return write_record(ba,160),ba.end()}function _JS2ANSI(str){if(typeof $cptable<"u")return $cptable.utils.encode(current_ansi,str);for(var o=[],oo=str.split(""),i=0;i<oo.length;++i)o[i]=oo[i].charCodeAt(0);return o}function crypto_CreatePasswordVerifier_Method1(Password){var Verifier=0,PasswordArray,PasswordDecoded=_JS2ANSI(Password),len=PasswordDecoded.length+1,i,PasswordByte,Intermediate1,Intermediate2,Intermediate3;for(PasswordArray=new_raw_buf(len),PasswordArray[0]=PasswordDecoded.length,i=1;i!=len;++i)PasswordArray[i]=PasswordDecoded[i-1];for(i=len-1;i>=0;--i)PasswordByte=PasswordArray[i],Intermediate1=Verifier&16384?1:0,Intermediate2=Verifier<<1&32767,Intermediate3=Intermediate1|Intermediate2,Verifier=Intermediate3^PasswordByte;return Verifier^52811}function sheet_to_rtf(ws,opts){var o=["{\\rtf1\\ansi"];if(!ws["!ref"])return o[0]+"}";for(var r=safe_decode_range(ws["!ref"]),cell,dense=ws["!data"]!=null,row=[],R=r.s.r;R<=r.e.r;++R){o.push("\\trowd\\trautofit1");for(var C=r.s.c;C<=r.e.c;++C)o.push("\\cellx"+(C+1));for(o.push("\\pard\\intbl"),dense&&(row=ws["!data"][R]||[]),C=r.s.c;C<=r.e.c;++C){var coord=encode_cell({r:R,c:C});if(cell=dense?row[C]:ws[coord],!cell||cell.v==null&&(!cell.f||cell.F)){o.push(" \\cell");continue}o.push(" "+(cell.w||(format_cell(cell),cell.w)||"").replace(/[\r\n]/g,"\\par ")),o.push("\\cell")}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}function rgb2Hex(rgb){for(var i=0,o=1;i!=3;++i)o=o*256+(rgb[i]>255?255:rgb[i]<0?0:rgb[i]);return o.toString(16).toUpperCase().slice(1)}var DEF_MDW=6;var MDW=DEF_MDW;function width2px(width){return Math.floor((width+Math.round(128/MDW)/256)*MDW)}function px2char(px){return Math.floor((px-5)/MDW*100+.5)/100}function char2width(chr){return Math.round((chr*MDW+5)/MDW*256)/256}function process_col(coll){coll.width?(coll.wpx=width2px(coll.width),coll.wch=px2char(coll.wpx),coll.MDW=MDW):coll.wpx?(coll.wch=px2char(coll.wpx),coll.width=char2width(coll.wch),coll.MDW=MDW):typeof coll.wch=="number"&&(coll.width=char2width(coll.wch),coll.wpx=width2px(coll.width),coll.MDW=MDW),coll.customWidth&&delete coll.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(px){return px*96/PPI}function pt2px(pt){return pt*PPI/96}function write_numFmts(NF){var o=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)NF[i]!=null&&(o[o.length]=writextag("numFmt",null,{numFmtId:i,formatCode:escapexml(NF[i])}))}),o.length===1?"":(o[o.length]="</numFmts>",o[0]=writextag("numFmts",null,{count:o.length-2}).replace("/>",">"),o.join(""))}function write_cellXfs(cellXfs){var o=[];return o[o.length]=writextag("cellXfs",null),cellXfs.forEach(function(c){o[o.length]=writextag("xf",null,c)}),o[o.length]="</cellXfs>",o.length===2?"":(o[0]=writextag("cellXfs",null,{count:o.length-2}).replace("/>",">"),o.join(""))}function write_sty_xml(wb,opts){var o=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],w;return wb.SSF&&(w=write_numFmts(wb.SSF))!=null&&(o[o.length]=w),o[o.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',o[o.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',o[o.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',o[o.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(w=write_cellXfs(opts.cellXfs))&&(o[o.length]=w),o[o.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',o[o.length]='<dxfs count="0"/>',o[o.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',o.length>2&&(o[o.length]="</styleSheet>",o[1]=o[1].replace("/>",">")),o.join("")}function parse_BrtFmt(data,length){var numFmtId=data.read_shift(2),stFmtCode=parse_XLWideString(data,length-2);return[numFmtId,stFmtCode]}function write_BrtFmt(i,f,o){o||(o=new_buf(6+4*f.length)),o.write_shift(2,i),write_XLWideString(f,o);var out=o.length>o.l?o.slice(0,o.l):o;return o.l==null&&(o.l=o.length),out}function parse_BrtFont(data,length,opts){var out={};out.sz=data.read_shift(2)/20;var grbit=parse_FontFlags(data,2,opts);grbit.fItalic&&(out.italic=1),grbit.fCondense&&(out.condense=1),grbit.fExtend&&(out.extend=1),grbit.fShadow&&(out.shadow=1),grbit.fOutline&&(out.outline=1),grbit.fStrikeout&&(out.strike=1);var bls=data.read_shift(2);switch(bls===700&&(out.bold=1),data.read_shift(2)){case 1:out.vertAlign="superscript";break;case 2:out.vertAlign="subscript";break}var underline=data.read_shift(1);underline!=0&&(out.underline=underline);var family=data.read_shift(1);family>0&&(out.family=family);var bCharSet=data.read_shift(1);switch(bCharSet>0&&(out.charset=bCharSet),data.l++,out.color=parse_BrtColor(data,8),data.read_shift(1)){case 1:out.scheme="major";break;case 2:out.scheme="minor";break}return out.name=parse_XLWideString(data,length-21),out}function write_BrtFont(font,o){o||(o=new_buf(25+4*32)),o.write_shift(2,font.sz*20),write_FontFlags(font,o),o.write_shift(2,font.bold?700:400);var sss=0;font.vertAlign=="superscript"?sss=1:font.vertAlign=="subscript"&&(sss=2),o.write_shift(2,sss),o.write_shift(1,font.underline||0),o.write_shift(1,font.family||0),o.write_shift(1,font.charset||0),o.write_shift(1,0),write_BrtColor(font.color,o);var scheme=0;return font.scheme=="major"&&(scheme=1),font.scheme=="minor"&&(scheme=2),o.write_shift(1,scheme),write_XLWideString(font.name,o),o.length>o.l?o.slice(0,o.l):o}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(fill2,o){o||(o=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var fls=rev_XLSBFillPTNames[fill2.patternType];fls==null&&(fls=40),o.write_shift(4,fls);var j=0;if(fls!=40)for(write_BrtColor({auto:1},o),write_BrtColor({auto:1},o);j<12;++j)o.write_shift(4,0);else{for(;j<4;++j)o.write_shift(4,0);for(;j<12;++j)o.write_shift(4,0)}return o.length>o.l?o.slice(0,o.l):o}function parse_BrtXF(data,length){var tgt=data.l+length,ixfeParent=data.read_shift(2),ifmt=data.read_shift(2);return data.l=tgt,{ixfe:ixfeParent,numFmtId:ifmt}}function write_BrtXF(data,ixfeP,o){o||(o=new_buf(16)),o.write_shift(2,ixfeP||0),o.write_shift(2,data.numFmtId||0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(1,0),o.write_shift(1,0);var flow=0;return o.write_shift(1,flow),o.write_shift(1,0),o.write_shift(1,0),o.write_shift(1,0),o}function write_Blxf(data,o){return o||(o=new_buf(10)),o.write_shift(1,0),o.write_shift(1,0),o.write_shift(4,0),o.write_shift(4,0),o}var parse_BrtBorder=parsenoop;function write_BrtBorder(border,o){return o||(o=new_buf(51)),o.write_shift(1,0),write_Blxf(null,o),write_Blxf(null,o),write_Blxf(null,o),write_Blxf(null,o),write_Blxf(null,o),o.length>o.l?o.slice(0,o.l):o}function write_BrtStyle(style,o){return o||(o=new_buf(12+4*10)),o.write_shift(4,style.xfId),o.write_shift(2,1),o.write_shift(1,+style.builtinId),o.write_shift(1,0),write_XLNullableWideString(style.name||"",o),o.length>o.l?o.slice(0,o.l):o}function write_BrtBeginTableStyles(cnt,defTableStyle,defPivotStyle){var o=new_buf(2052);return o.write_shift(4,cnt),write_XLNullableWideString(defTableStyle,o),write_XLNullableWideString(defPivotStyle,o),o.length>o.l?o.slice(0,o.l):o}function write_FMTS_bin(ba,NF){if(NF){var cnt=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)NF[i]!=null&&++cnt}),cnt!=0&&(write_record(ba,615,write_UInt32LE(cnt)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)NF[i]!=null&&write_record(ba,44,write_BrtFmt(i,NF[i]))}),write_record(ba,616))}}function write_FONTS_bin(ba){var cnt=1;cnt!=0&&(write_record(ba,611,write_UInt32LE(cnt)),write_record(ba,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),write_record(ba,612))}function write_FILLS_bin(ba){var cnt=2;cnt!=0&&(write_record(ba,603,write_UInt32LE(cnt)),write_record(ba,45,write_BrtFill({patternType:"none"})),write_record(ba,45,write_BrtFill({patternType:"gray125"})),write_record(ba,604))}function write_BORDERS_bin(ba){var cnt=1;cnt!=0&&(write_record(ba,613,write_UInt32LE(cnt)),write_record(ba,46,write_BrtBorder({})),write_record(ba,614))}function write_CELLSTYLEXFS_bin(ba){var cnt=1;write_record(ba,626,write_UInt32LE(cnt)),write_record(ba,47,write_BrtXF({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),write_record(ba,627)}function write_CELLXFS_bin(ba,data){write_record(ba,617,write_UInt32LE(data.length)),data.forEach(function(c){write_record(ba,47,write_BrtXF(c,0))}),write_record(ba,618)}function write_STYLES_bin(ba){var cnt=1;write_record(ba,619,write_UInt32LE(cnt)),write_record(ba,48,write_BrtStyle({xfId:0,builtinId:0,name:"Normal"})),write_record(ba,620)}function write_DXFS_bin(ba){var cnt=0;write_record(ba,505,write_UInt32LE(cnt)),write_record(ba,506)}function write_TABLESTYLES_bin(ba){var cnt=0;write_record(ba,508,write_BrtBeginTableStyles(cnt,"TableStyleMedium9","PivotStyleMedium4")),write_record(ba,509)}function write_sty_bin(wb,opts){var ba=buf_array();return write_record(ba,278),write_FMTS_bin(ba,wb.SSF),write_FONTS_bin(ba,wb),write_FILLS_bin(ba,wb),write_BORDERS_bin(ba,wb),write_CELLSTYLEXFS_bin(ba,wb),write_CELLXFS_bin(ba,opts.cellXfs),write_STYLES_bin(ba,wb),write_DXFS_bin(ba,wb),write_TABLESTYLES_bin(ba,wb),write_record(ba,279),ba.end()}function write_theme(Themes,opts){if(opts&&opts.themeXLSX)return opts.themeXLSX;if(Themes&&typeof Themes.raw=="string")return Themes.raw;var o=[XML_HEADER];return o[o.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',o[o.length]="<a:themeElements>",o[o.length]='<a:clrScheme name="Office">',o[o.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',o[o.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',o[o.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',o[o.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',o[o.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',o[o.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',o[o.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',o[o.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',o[o.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',o[o.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',o[o.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',o[o.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',o[o.length]="</a:clrScheme>",o[o.length]='<a:fontScheme name="Office">',o[o.length]="<a:majorFont>",o[o.length]='<a:latin typeface="Cambria"/>',o[o.length]='<a:ea typeface=""/>',o[o.length]='<a:cs typeface=""/>',o[o.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',o[o.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',o[o.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',o[o.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',o[o.length]='<a:font script="Arab" typeface="Times New Roman"/>',o[o.length]='<a:font script="Hebr" typeface="Times New Roman"/>',o[o.length]='<a:font script="Thai" typeface="Tahoma"/>',o[o.length]='<a:font script="Ethi" typeface="Nyala"/>',o[o.length]='<a:font script="Beng" typeface="Vrinda"/>',o[o.length]='<a:font script="Gujr" typeface="Shruti"/>',o[o.length]='<a:font script="Khmr" typeface="MoolBoran"/>',o[o.length]='<a:font script="Knda" typeface="Tunga"/>',o[o.length]='<a:font script="Guru" typeface="Raavi"/>',o[o.length]='<a:font script="Cans" typeface="Euphemia"/>',o[o.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o[o.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o[o.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o[o.length]='<a:font script="Thaa" typeface="MV Boli"/>',o[o.length]='<a:font script="Deva" typeface="Mangal"/>',o[o.length]='<a:font script="Telu" typeface="Gautami"/>',o[o.length]='<a:font script="Taml" typeface="Latha"/>',o[o.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o[o.length]='<a:font script="Orya" typeface="Kalinga"/>',o[o.length]='<a:font script="Mlym" typeface="Kartika"/>',o[o.length]='<a:font script="Laoo" typeface="DokChampa"/>',o[o.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o[o.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o[o.length]='<a:font script="Viet" typeface="Times New Roman"/>',o[o.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o[o.length]='<a:font script="Geor" typeface="Sylfaen"/>',o[o.length]="</a:majorFont>",o[o.length]="<a:minorFont>",o[o.length]='<a:latin typeface="Calibri"/>',o[o.length]='<a:ea typeface=""/>',o[o.length]='<a:cs typeface=""/>',o[o.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',o[o.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',o[o.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',o[o.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',o[o.length]='<a:font script="Arab" typeface="Arial"/>',o[o.length]='<a:font script="Hebr" typeface="Arial"/>',o[o.length]='<a:font script="Thai" typeface="Tahoma"/>',o[o.length]='<a:font script="Ethi" typeface="Nyala"/>',o[o.length]='<a:font script="Beng" typeface="Vrinda"/>',o[o.length]='<a:font script="Gujr" typeface="Shruti"/>',o[o.length]='<a:font script="Khmr" typeface="DaunPenh"/>',o[o.length]='<a:font script="Knda" typeface="Tunga"/>',o[o.length]='<a:font script="Guru" typeface="Raavi"/>',o[o.length]='<a:font script="Cans" typeface="Euphemia"/>',o[o.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o[o.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o[o.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o[o.length]='<a:font script="Thaa" typeface="MV Boli"/>',o[o.length]='<a:font script="Deva" typeface="Mangal"/>',o[o.length]='<a:font script="Telu" typeface="Gautami"/>',o[o.length]='<a:font script="Taml" typeface="Latha"/>',o[o.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o[o.length]='<a:font script="Orya" typeface="Kalinga"/>',o[o.length]='<a:font script="Mlym" typeface="Kartika"/>',o[o.length]='<a:font script="Laoo" typeface="DokChampa"/>',o[o.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o[o.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o[o.length]='<a:font script="Viet" typeface="Arial"/>',o[o.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o[o.length]='<a:font script="Geor" typeface="Sylfaen"/>',o[o.length]="</a:minorFont>",o[o.length]="</a:fontScheme>",o[o.length]='<a:fmtScheme name="Office">',o[o.length]="<a:fillStyleLst>",o[o.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:lin ang="16200000" scaled="1"/>',o[o.length]="</a:gradFill>",o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:lin ang="16200000" scaled="0"/>',o[o.length]="</a:gradFill>",o[o.length]="</a:fillStyleLst>",o[o.length]="<a:lnStyleLst>",o[o.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]="</a:lnStyleLst>",o[o.length]="<a:effectStyleLst>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]="</a:effectStyle>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]="</a:effectStyle>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',o[o.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',o[o.length]="</a:effectStyle>",o[o.length]="</a:effectStyleLst>",o[o.length]="<a:bgFillStyleLst>",o[o.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',o[o.length]="</a:gradFill>",o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',o[o.length]="</a:gradFill>",o[o.length]="</a:bgFillStyleLst>",o[o.length]="</a:fmtScheme>",o[o.length]="</a:themeElements>",o[o.length]="<a:objectDefaults>",o[o.length]="<a:spDef>",o[o.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',o[o.length]="</a:spDef>",o[o.length]="<a:lnDef>",o[o.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',o[o.length]="</a:lnDef>",o[o.length]="</a:objectDefaults>",o[o.length]="<a:extraClrSchemeLst/>",o[o.length]="</a:theme>",o.join("")}function parse_BrtMdtinfo(data,length){return{flags:data.read_shift(4),version:data.read_shift(4),name:parse_XLWideString(data,length-8)}}function write_BrtMdtinfo(data){var o=new_buf(12+2*data.name.length);return o.write_shift(4,data.flags),o.write_shift(4,data.version),write_XLWideString(data.name,o),o.slice(0,o.l)}function parse_BrtMdb(data){for(var out=[],cnt=data.read_shift(4);cnt-- >0;)out.push([data.read_shift(4),data.read_shift(4)]);return out}function write_BrtMdb(mdb){var o=new_buf(4+8*mdb.length);o.write_shift(4,mdb.length);for(var i=0;i<mdb.length;++i)o.write_shift(4,mdb[i][0]),o.write_shift(4,mdb[i][1]);return o}function write_BrtBeginEsfmd(cnt,name){var o=new_buf(8+2*name.length);return o.write_shift(4,cnt),write_XLWideString(name,o),o.slice(0,o.l)}function parse_BrtBeginEsmdb(data){return data.l+=4,data.read_shift(4)!=0}function write_BrtBeginEsmdb(cnt,cm){var o=new_buf(8);return o.write_shift(4,cnt),o.write_shift(4,cm?1:0),o}function write_xlmeta_bin(){var ba=buf_array();return write_record(ba,332),write_record(ba,334,write_UInt32LE(1)),write_record(ba,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(ba,336),write_record(ba,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(ba,52),write_record(ba,35,write_UInt32LE(514)),write_record(ba,4096,write_UInt32LE(0)),write_record(ba,4097,writeuint16(1)),write_record(ba,36),write_record(ba,53),write_record(ba,340),write_record(ba,337,write_BrtBeginEsmdb(1,!0)),write_record(ba,51,write_BrtMdb([[1,0]])),write_record(ba,338),write_record(ba,333),ba.end()}function write_xlmeta_xml(){var o=[XML_HEADER];return o.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),o.join("")}function parse_BrtCalcChainItem$(data){var out={};out.i=data.read_shift(4);var cell={};cell.r=data.read_shift(4),cell.c=data.read_shift(4),out.r=encode_cell(cell);var flags=data.read_shift(1);return flags&2&&(out.l="1"),flags&8&&(out.a="1"),out}function write_vml(rId,comments,ws){var csize=[21600,21600],bbox=["m0,0l0",csize[1],csize[0],csize[1],csize[0],"0xe"].join(","),o=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:rId}),{"v:ext":"edit"})],_shapeid=65536*rId,_comments=comments||[];return _comments.length>0&&o.push(writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:csize.join(","),"o:spt":202,path:bbox})),_comments.forEach(function(x){++_shapeid,o.push(write_vml_comment(x,_shapeid))}),o.push("</xml>"),o.join("")}function write_vml_comment(x,_shapeid,ws){var c=decode_cell(x[0]),fillopts={color2:"#BEFF82",type:"gradient"};fillopts.type=="gradient"&&(fillopts.angle="-180");var fillparm=fillopts.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,fillxml=writextag("v:fill",fillparm,fillopts),shadata={on:"t",obscured:"t"};return["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(x[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",fillxml,writextag("v:shadow",null,shadata),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(c.r)),writetag("x:Column",String(c.c)),x[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function write_comments_xml(data){var o=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],iauthor=[];return o.push("<authors>"),data.forEach(function(x){x[1].forEach(function(w){var a=escapexml(w.a);iauthor.indexOf(a)==-1&&(iauthor.push(a),o.push("<author>"+a+"</author>")),w.T&&w.ID&&iauthor.indexOf("tc="+w.ID)==-1&&(iauthor.push("tc="+w.ID),o.push("<author>tc="+w.ID+"</author>"))})}),iauthor.length==0&&(iauthor.push("SheetJ5"),o.push("<author>SheetJ5</author>")),o.push("</authors>"),o.push("<commentList>"),data.forEach(function(d){var lastauthor=0,ts=[],tcnt=0;if(d[1][0]&&d[1][0].T&&d[1][0].ID&&(lastauthor=iauthor.indexOf("tc="+d[1][0].ID)),d[1].forEach(function(c){c.a&&(lastauthor=iauthor.indexOf(escapexml(c.a))),c.T&&++tcnt,ts.push(c.t==null?"":escapexml(c.t))}),tcnt===0)d[1].forEach(function(c){o.push('<comment ref="'+d[0]+'" authorId="'+iauthor.indexOf(escapexml(c.a))+'"><text>'),o.push(writetag("t",c.t==null?"":escapexml(c.t))),o.push("</text></comment>")});else{d[1][0]&&d[1][0].T&&d[1][0].ID&&(lastauthor=iauthor.indexOf("tc="+d[1][0].ID)),o.push('<comment ref="'+d[0]+'" authorId="'+lastauthor+'"><text>');for(var t=`Comment:
    `+ts[0]+`
`,i=1;i<ts.length;++i)t+=`Reply:
    `+ts[i]+`
`;o.push(writetag("t",escapexml(t))),o.push("</text></comment>")}}),o.push("</commentList>"),o.length>2&&(o[o.length]="</comments>",o[1]=o[1].replace("/>",">")),o.join("")}function write_tcmnt_xml(comments,people,opts){var o=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return comments.forEach(function(carr){var rootid="";(carr[1]||[]).forEach(function(c,idx){if(!c.T){delete c.ID;return}c.a&&people.indexOf(c.a)==-1&&people.push(c.a);var tcopts={ref:carr[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+opts.tcid++).slice(-12)+"}"};idx==0?rootid=tcopts.id:tcopts.parentId=rootid,c.ID=tcopts.id,c.a&&(tcopts.personId="{54EE7950-7262-4200-6969-"+("000000000000"+people.indexOf(c.a)).slice(-12)+"}"),o.push(writextag("threadedComment",writetag("text",c.t||""),tcopts))})}),o.push("</ThreadedComments>"),o.join("")}function write_people_xml(people){var o=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return people.forEach(function(person,idx){o.push(writextag("person",null,{displayName:person,id:"{54EE7950-7262-4200-6969-"+("000000000000"+idx).slice(-12)+"}",userId:person,providerId:"None"}))}),o.push("</personList>"),o.join("")}function parse_BrtBeginComment(data){var out={};out.iauthor=data.read_shift(4);var rfx=parse_UncheckedRfX(data,16);return out.rfx=rfx.s,out.ref=encode_cell(rfx.s),data.l+=16,out}function write_BrtBeginComment(data,o){return o==null&&(o=new_buf(36)),o.write_shift(4,data[1].iauthor),write_UncheckedRfX(data[0],o),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(data){return write_XLWideString(data.slice(0,54))}function write_comments_bin(data){var ba=buf_array(),iauthor=[];return write_record(ba,628),write_record(ba,630),data.forEach(function(comment){comment[1].forEach(function(c){iauthor.indexOf(c.a)>-1||(iauthor.push(c.a.slice(0,54)),write_record(ba,632,write_BrtCommentAuthor(c.a)),c.T&&c.ID&&iauthor.indexOf("tc="+c.ID)==-1&&(iauthor.push("tc="+c.ID),write_record(ba,632,write_BrtCommentAuthor("tc="+c.ID))))})}),write_record(ba,631),write_record(ba,633),data.forEach(function(comment){comment[1].forEach(function(c){var _ia=-1;c.ID&&(_ia=iauthor.indexOf("tc="+c.ID)),_ia==-1&&comment[1][0].T&&comment[1][0].ID&&(_ia=iauthor.indexOf("tc="+comment[1][0].ID)),_ia==-1&&(_ia=iauthor.indexOf(c.a)),c.iauthor=_ia;var range={s:decode_cell(comment[0]),e:decode_cell(comment[0])};write_record(ba,635,write_BrtBeginComment([range,c])),c.t&&c.t.length>0&&write_record(ba,637,write_BrtCommentText(c)),write_record(ba,636),delete c.iauthor})}),write_record(ba,634),write_record(ba,629),ba.end()}function fill_vba_xls(cfb,vba){vba.FullPaths.forEach(function(p,i){if(i!=0){var newpath=p.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");newpath.slice(-1)!=="/"&&CFB.utils.cfb_add(cfb,newpath,vba.FileIndex[i].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];var rc_to_a1=function(){var rcregex=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,rcbase={r:0,c:0};function rcfunc($$,$1,$2,$3){var cRel=!1,rRel=!1;$2.length==0?rRel=!0:$2.charAt(0)=="["&&(rRel=!0,$2=$2.slice(1,-1)),$3.length==0?cRel=!0:$3.charAt(0)=="["&&(cRel=!0,$3=$3.slice(1,-1));var R=$2.length>0?parseInt($2,10)|0:0,C=$3.length>0?parseInt($3,10)|0:0;return cRel?C+=rcbase.c:--C,rRel?R+=rcbase.r:--R,$1+(cRel?"":"$")+encode_col(C)+(rRel?"":"$")+encode_row(R)}return function(fstr,base){return rcbase=base,fstr.replace(rcregex,rcfunc)}}(),crefregex=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var a1_to_rc=function(){return function(fstr,base){return fstr.replace(crefregex,function($0,$1,$2,$3,$4,$5){var c=decode_col($3)-($2?0:base.c),r=decode_row($5)-($4?0:base.r),R=$4=="$"?r+1:r==0?"":"["+r+"]",C=$2=="$"?c+1:c==0?"":"["+c+"]";return $1+"R"+R+"C"+C})}}();function shift_formula_str(f,delta){return f.replace(crefregex,function($0,$1,$2,$3,$4,$5){return $1+($2=="$"?$2+$3:encode_col(decode_col($3)+delta.c))+($4=="$"?$4+$5:encode_row(decode_row($5)+delta.r))})}function fuzzyfmla(f){return f.length!=1}function parseread1(blob){blob.l+=1}function parse_ColRelU(blob,length){var c=blob.read_shift(length==1?1:2);return[c&16383,c>>14&1,c>>15&1]}function parse_RgceArea(blob,length,opts){var w=2;if(opts){if(opts.biff>=2&&opts.biff<=5)return parse_RgceArea_BIFF2(blob,length,opts);opts.biff==12&&(w=4)}var r=blob.read_shift(w),R=blob.read_shift(w),c=parse_ColRelU(blob,2),C=parse_ColRelU(blob,2);return{s:{r,c:c[0],cRel:c[1],rRel:c[2]},e:{r:R,c:C[0],cRel:C[1],rRel:C[2]}}}function parse_RgceArea_BIFF2(blob){var r=parse_ColRelU(blob,2),R=parse_ColRelU(blob,2),c=blob.read_shift(1),C=blob.read_shift(1);return{s:{r:r[0],c,cRel:r[1],rRel:r[2]},e:{r:R[0],c:C,cRel:R[1],rRel:R[2]}}}function parse_RgceAreaRel(blob,length,opts){if(opts.biff<8)return parse_RgceArea_BIFF2(blob,length,opts);var r=blob.read_shift(opts.biff==12?4:2),R=blob.read_shift(opts.biff==12?4:2),c=parse_ColRelU(blob,2),C=parse_ColRelU(blob,2);return{s:{r,c:c[0],cRel:c[1],rRel:c[2]},e:{r:R,c:C[0],cRel:C[1],rRel:C[2]}}}function parse_RgceLoc(blob,length,opts){if(opts&&opts.biff>=2&&opts.biff<=5)return parse_RgceLoc_BIFF2(blob,length,opts);var r=blob.read_shift(opts&&opts.biff==12?4:2),c=parse_ColRelU(blob,2);return{r,c:c[0],cRel:c[1],rRel:c[2]}}function parse_RgceLoc_BIFF2(blob){var r=parse_ColRelU(blob,2),c=blob.read_shift(1);return{r:r[0],c,cRel:r[1],rRel:r[2]}}function parse_RgceElfLoc(blob){var r=blob.read_shift(2),c=blob.read_shift(2);return{r,c:c&255,fQuoted:!!(c&16384),cRel:c>>15,rRel:c>>15}}function parse_RgceLocRel(blob,length,opts){var biff=opts&&opts.biff?opts.biff:8;if(biff>=2&&biff<=5)return parse_RgceLocRel_BIFF2(blob,length,opts);var r=blob.read_shift(biff>=12?4:2),cl=blob.read_shift(2),cRel=(cl&16384)>>14,rRel=(cl&32768)>>15;if(cl&=16383,rRel==1)for(;r>524287;)r-=1048576;if(cRel==1)for(;cl>8191;)cl=cl-16384;return{r,c:cl,cRel,rRel}}function parse_RgceLocRel_BIFF2(blob){var rl=blob.read_shift(2),c=blob.read_shift(1),rRel=(rl&32768)>>15,cRel=(rl&16384)>>14;return rl&=16383,rRel==1&&rl>=8192&&(rl=rl-16384),cRel==1&&c>=128&&(c=c-256),{r:rl,c,cRel,rRel}}function parse_PtgArea(blob,length,opts){var type=(blob[blob.l++]&96)>>5,area=parse_RgceArea(blob,opts.biff>=2&&opts.biff<=5?6:8,opts);return[type,area]}function parse_PtgArea3d(blob,length,opts){var type=(blob[blob.l++]&96)>>5,ixti=blob.read_shift(2,"i"),w=8;if(opts)switch(opts.biff){case 5:blob.l+=12,w=6;break;case 12:w=12;break}var area=parse_RgceArea(blob,w,opts);return[type,ixti,area]}function parse_PtgAreaErr(blob,length,opts){var type=(blob[blob.l++]&96)>>5;return blob.l+=opts&&opts.biff>8?12:opts.biff<8?6:8,[type]}function parse_PtgAreaErr3d(blob,length,opts){var type=(blob[blob.l++]&96)>>5,ixti=blob.read_shift(2),w=8;if(opts)switch(opts.biff){case 5:blob.l+=12,w=6;break;case 12:w=12;break}return blob.l+=w,[type,ixti]}function parse_PtgAreaN(blob,length,opts){var type=(blob[blob.l++]&96)>>5,area=parse_RgceAreaRel(blob,length-1,opts);return[type,area]}function parse_PtgArray(blob,length,opts){var type=(blob[blob.l++]&96)>>5;return blob.l+=opts.biff==2?6:opts.biff==12?14:7,[type]}function parse_PtgAttrBaxcel(blob){var bitSemi=blob[blob.l+1]&1,bitBaxcel=1;return blob.l+=4,[bitSemi,bitBaxcel]}function parse_PtgAttrChoose(blob,length,opts){blob.l+=2;for(var offset2=blob.read_shift(opts&&opts.biff==2?1:2),o=[],i=0;i<=offset2;++i)o.push(blob.read_shift(opts&&opts.biff==2?1:2));return o}function parse_PtgAttrGoto(blob,length,opts){var bitGoto=blob[blob.l+1]&255?1:0;return blob.l+=2,[bitGoto,blob.read_shift(opts&&opts.biff==2?1:2)]}function parse_PtgAttrIf(blob,length,opts){var bitIf=blob[blob.l+1]&255?1:0;return blob.l+=2,[bitIf,blob.read_shift(opts&&opts.biff==2?1:2)]}function parse_PtgAttrIfError(blob){var bitIf=blob[blob.l+1]&255?1:0;return blob.l+=2,[bitIf,blob.read_shift(2)]}function parse_PtgAttrSemi(blob,length,opts){var bitSemi=blob[blob.l+1]&255?1:0;return blob.l+=opts&&opts.biff==2?3:4,[bitSemi]}function parse_PtgAttrSpaceType(blob){var type=blob.read_shift(1),cch=blob.read_shift(1);return[type,cch]}function parse_PtgAttrSpace(blob){return blob.read_shift(2),parse_PtgAttrSpaceType(blob,2)}function parse_PtgAttrSpaceSemi(blob){return blob.read_shift(2),parse_PtgAttrSpaceType(blob,2)}function parse_PtgRef(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var loc=parse_RgceLoc(blob,0,opts);return[type,loc]}function parse_PtgRefN(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var loc=parse_RgceLocRel(blob,0,opts);return[type,loc]}function parse_PtgRef3d(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var ixti=blob.read_shift(2);opts&&opts.biff==5&&(blob.l+=12);var loc=parse_RgceLoc(blob,0,opts);return[type,ixti,loc]}function parse_PtgFunc(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var iftab=blob.read_shift(opts&&opts.biff<=3?1:2);return[FtabArgc[iftab],Ftab[iftab],type]}function parse_PtgFuncVar(blob,length,opts){var type=blob[blob.l++],cparams=blob.read_shift(1),tab=opts&&opts.biff<=3?[type==88?-1:0,blob.read_shift(1)]:parsetab(blob);return[cparams,(tab[0]===0?Ftab:Cetab)[tab[1]]]}function parsetab(blob){return[blob[blob.l+1]>>7,blob.read_shift(2)&32767]}function parse_PtgAttrSum(blob,length,opts){blob.l+=opts&&opts.biff==2?3:4}function parse_PtgExp(blob,length,opts){if(blob.l++,opts&&opts.biff==12)return[blob.read_shift(4,"i"),0];var row=blob.read_shift(2),col=blob.read_shift(opts&&opts.biff==2?1:2);return[row,col]}function parse_PtgErr(blob){return blob.l++,BErr[blob.read_shift(1)]}function parse_PtgInt(blob){return blob.l++,blob.read_shift(2)}function parse_PtgBool(blob){return blob.l++,blob.read_shift(1)!==0}function parse_PtgNum(blob){return blob.l++,parse_Xnum(blob,8)}function parse_PtgStr(blob,length,opts){return blob.l++,parse_ShortXLUnicodeString(blob,length-1,opts)}function parse_SerAr(blob,biff){var val=[blob.read_shift(1)];if(biff==12)switch(val[0]){case 2:val[0]=4;break;case 4:val[0]=16;break;case 0:val[0]=1;break;case 1:val[0]=2;break}switch(val[0]){case 4:val[1]=parsebool(blob,1)?"TRUE":"FALSE",biff!=12&&(blob.l+=7);break;case 37:case 16:val[1]=BErr[blob[blob.l]],blob.l+=biff==12?4:8;break;case 0:blob.l+=8;break;case 1:val[1]=parse_Xnum(blob,8);break;case 2:val[1]=parse_XLUnicodeString2(blob,0,{biff:biff>0&&biff<8?2:biff});break;default:throw new Error("Bad SerAr: "+val[0])}return val}function parse_PtgExtraMem(blob,cce,opts){for(var count=blob.read_shift(opts.biff==12?4:2),out=[],i=0;i!=count;++i)out.push((opts.biff==12?parse_UncheckedRfX:parse_Ref8U)(blob,8));return out}function parse_PtgExtraArray(blob,length,opts){var rows=0,cols=0;opts.biff==12?(rows=blob.read_shift(4),cols=blob.read_shift(4)):(cols=1+blob.read_shift(1),rows=1+blob.read_shift(2)),opts.biff>=2&&opts.biff<8&&(--rows,--cols==0&&(cols=256));for(var i=0,o=[];i!=rows&&(o[i]=[]);++i)for(var j=0;j!=cols;++j)o[i][j]=parse_SerAr(blob,opts.biff);return o}function parse_PtgName(blob,length,opts){var type=blob.read_shift(1)>>>5&3,w=!opts||opts.biff>=8?4:2,nameindex=blob.read_shift(w);switch(opts.biff){case 2:blob.l+=5;break;case 3:case 4:blob.l+=8;break;case 5:blob.l+=12;break}return[type,0,nameindex]}function parse_PtgNameX(blob,length,opts){if(opts.biff==5)return parse_PtgNameX_BIFF5(blob,length,opts);var type=blob.read_shift(1)>>>5&3,ixti=blob.read_shift(2),nameindex=blob.read_shift(4);return[type,ixti,nameindex]}function parse_PtgNameX_BIFF5(blob){var type=blob.read_shift(1)>>>5&3,ixti=blob.read_shift(2,"i");blob.l+=8;var nameindex=blob.read_shift(2);return blob.l+=12,[type,ixti,nameindex]}function parse_PtgMemArea(blob,length,opts){var type=blob.read_shift(1)>>>5&3;blob.l+=opts&&opts.biff==2?3:4;var cce=blob.read_shift(opts&&opts.biff==2?1:2);return[type,cce]}function parse_PtgMemFunc(blob,length,opts){var type=blob.read_shift(1)>>>5&3,cce=blob.read_shift(opts&&opts.biff==2?1:2);return[type,cce]}function parse_PtgRefErr(blob,length,opts){var type=blob.read_shift(1)>>>5&3;return blob.l+=4,opts.biff<8&&blob.l--,opts.biff==12&&(blob.l+=2),[type]}function parse_PtgRefErr3d(blob,length,opts){var type=(blob[blob.l++]&96)>>5,ixti=blob.read_shift(2),w=4;if(opts)switch(opts.biff){case 5:w=15;break;case 12:w=6;break}return blob.l+=w,[type,ixti]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(blob,length,opts){return blob.l+=2,[parse_RgceElfLoc(blob,4,opts)]}function parse_PtgElfNoop(blob){return blob.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(blob){return blob.l+=2,[parseuint16(blob),blob.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(blob){blob.l+=2;var ixti=blob.read_shift(2),flags=blob.read_shift(2),idx=blob.read_shift(4),c=blob.read_shift(2),C=blob.read_shift(2),rt=PtgListRT[flags>>2&31];return{ixti,coltype:flags&3,rt,idx,c,C}}function parse_PtgSxName(blob){return blob.l+=2,[blob.read_shift(4)]}function parse_PtgSheet(blob,length,opts){return blob.l+=5,blob.l+=2,blob.l+=opts.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(blob,length,opts){return blob.l+=opts.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(blob){var type=blob.read_shift(1)>>>5&3,cce=blob.read_shift(2);return[type,cce]}function parse_PtgMemNoMemN(blob){var type=blob.read_shift(1)>>>5&3,cce=blob.read_shift(2);return[type,cce]}function parse_PtgAttrNoop(blob){return blob.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(blob,length,rgce,opts){if(opts.biff<8)return parsenoop(blob,length);for(var target=blob.l+length,o=[],i=0;i!==rgce.length;++i)switch(rgce[i][0]){case"PtgArray":rgce[i][1]=parse_PtgExtraArray(blob,0,opts),o.push(rgce[i][1]);break;case"PtgMemArea":rgce[i][2]=parse_PtgExtraMem(blob,rgce[i][1],opts),o.push(rgce[i][2]);break;case"PtgExp":opts&&opts.biff==12&&(rgce[i][1][1]=blob.read_shift(4),o.push(rgce[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+rgce[i][0];default:break}return length=target-blob.l,length!==0&&o.push(parsenoop(blob,length)),o}function parse_Rgce(blob,length,opts){for(var target=blob.l+length,R,id,ptgs=[];target!=blob.l;)length=target-blob.l,id=blob[blob.l],R=PtgTypes[id]||PtgTypes[PtgDupes[id]],(id===24||id===25)&&(R=(id===24?Ptg18:Ptg19)[blob[blob.l+1]]),!R||!R.f?parsenoop(blob,length):ptgs.push([R.n,R.f(blob,length,opts)]);return ptgs}function stringify_array(f){for(var o=[],i=0;i<f.length;++i){for(var x=f[i],r=[],j=0;j<x.length;++j){var y=x[j];if(y)switch(y[0]){case 2:r.push('"'+y[1].replace(/"/g,'""')+'"');break;default:r.push(y[1])}else r.push("")}o.push(r.join(","))}return o.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function make_3d_range(start2,end2){var s=start2.lastIndexOf("!"),e=end2.lastIndexOf("!");return s==-1&&e==-1?start2+":"+end2:s>0&&e>0&&start2.slice(0,s).toLowerCase()==end2.slice(0,e).toLowerCase()?start2+":"+end2.slice(e+1):(console.error("Cannot hydrate range",start2,end2),start2+":"+end2)}function get_ixti_raw(supbooks,ixti,opts){if(!supbooks)return"SH33TJSERR0";if(opts.biff>8&&(!supbooks.XTI||!supbooks.XTI[ixti]))return supbooks.SheetNames[ixti];if(!supbooks.XTI)return"SH33TJSERR6";var XTI=supbooks.XTI[ixti];if(opts.biff<8)return ixti>1e4&&(ixti-=65536),ixti<0&&(ixti=-ixti),ixti==0?"":supbooks.XTI[ixti-1];if(!XTI)return"SH33TJSERR1";var o="";if(opts.biff>8)switch(supbooks[XTI[0]][0]){case 357:return o=XTI[1]==-1?"#REF":supbooks.SheetNames[XTI[1]],XTI[1]==XTI[2]?o:o+":"+supbooks.SheetNames[XTI[2]];case 358:return opts.SID!=null?supbooks.SheetNames[opts.SID]:"SH33TJSSAME"+supbooks[XTI[0]][0];case 355:default:return"SH33TJSSRC"+supbooks[XTI[0]][0]}switch(supbooks[XTI[0]][0][0]){case 1025:return o=XTI[1]==-1?"#REF":supbooks.SheetNames[XTI[1]]||"SH33TJSERR3",XTI[1]==XTI[2]?o:o+":"+supbooks.SheetNames[XTI[2]];case 14849:return supbooks[XTI[0]].slice(1).map(function(name){return name.Name}).join(";;");default:return supbooks[XTI[0]][0][3]?(o=XTI[1]==-1?"#REF":supbooks[XTI[0]][0][3][XTI[1]]||"SH33TJSERR4",XTI[1]==XTI[2]?o:o+":"+supbooks[XTI[0]][0][3][XTI[2]]):"SH33TJSERR2"}}function get_ixti(supbooks,ixti,opts){var ixtiraw=get_ixti_raw(supbooks,ixti,opts);return ixtiraw=="#REF"?ixtiraw:formula_quote_sheet_name(ixtiraw,opts)}function stringify_formula(formula,range,cell,supbooks,opts){var biff=opts&&opts.biff||8,_range={s:{c:0,r:0},e:{c:0,r:0}},stack=[],e1,e2,c,ixti=0,nameidx=0,r,sname="";if(!formula[0]||!formula[0][0])return"";for(var last_sp=-1,sp="",ff=0,fflen=formula[0].length;ff<fflen;++ff){var f=formula[0][ff];switch(f[0]){case"PtgUminus":stack.push("-"+stack.pop());break;case"PtgUplus":stack.push("+"+stack.pop());break;case"PtgPercent":stack.push(stack.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(e1=stack.pop(),e2=stack.pop(),last_sp>=0){switch(formula[0][last_sp][1][0]){case 0:sp=fill(" ",formula[0][last_sp][1][1]);break;case 1:sp=fill("\r",formula[0][last_sp][1][1]);break;default:if(sp="",opts.WTF)throw new Error("Unexpected PtgAttrSpaceType "+formula[0][last_sp][1][0])}e2=e2+sp,last_sp=-1}stack.push(e2+PtgBinOp[f[0]]+e1);break;case"PtgIsect":e1=stack.pop(),e2=stack.pop(),stack.push(e2+" "+e1);break;case"PtgUnion":e1=stack.pop(),e2=stack.pop(),stack.push(e2+","+e1);break;case"PtgRange":e1=stack.pop(),e2=stack.pop(),stack.push(make_3d_range(e2,e1));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=shift_cell_xls(f[1][1],_range,opts),stack.push(encode_cell_xls(c,biff));break;case"PtgRefN":c=cell?shift_cell_xls(f[1][1],cell,opts):f[1][1],stack.push(encode_cell_xls(c,biff));break;case"PtgRef3d":ixti=f[1][1],c=shift_cell_xls(f[1][2],_range,opts),sname=get_ixti(supbooks,ixti,opts);var w=sname;stack.push(sname+"!"+encode_cell_xls(c,biff));break;case"PtgFunc":case"PtgFuncVar":var argc=f[1][0],func=f[1][1];argc||(argc=0),argc&=127;var args=argc==0?[]:stack.slice(-argc);stack.length-=argc,func==="User"&&(func=args.shift()),stack.push(func+"("+args.join(",")+")");break;case"PtgBool":stack.push(f[1]?"TRUE":"FALSE");break;case"PtgInt":stack.push(f[1]);break;case"PtgNum":stack.push(String(f[1]));break;case"PtgStr":stack.push('"'+f[1].replace(/"/g,'""')+'"');break;case"PtgErr":stack.push(f[1]);break;case"PtgAreaN":r=shift_range_xls(f[1][1],cell?{s:cell}:_range,opts),stack.push(encode_range_xls(r,opts));break;case"PtgArea":r=shift_range_xls(f[1][1],_range,opts),stack.push(encode_range_xls(r,opts));break;case"PtgArea3d":ixti=f[1][1],r=f[1][2],sname=get_ixti(supbooks,ixti,opts),stack.push(sname+"!"+encode_range_xls(r,opts));break;case"PtgAttrSum":stack.push("SUM("+stack.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":nameidx=f[1][2];var lbl=(supbooks.names||[])[nameidx-1]||(supbooks[0]||[])[nameidx],name=lbl?lbl.Name:"SH33TJSNAME"+String(nameidx);name&&name.slice(0,6)=="_xlfn."&&!opts.xlfn&&(name=name.slice(6)),stack.push(name);break;case"PtgNameX":var bookidx=f[1][1];nameidx=f[1][2];var externbook;if(opts.biff<=5)bookidx<0&&(bookidx=-bookidx),supbooks[bookidx]&&(externbook=supbooks[bookidx][nameidx]);else{var o="";if(((supbooks[bookidx]||[])[0]||[])[0]==14849||(((supbooks[bookidx]||[])[0]||[])[0]==1025?supbooks[bookidx][nameidx]&&supbooks[bookidx][nameidx].itab>0&&(o=supbooks.SheetNames[supbooks[bookidx][nameidx].itab-1]+"!"):o=supbooks.SheetNames[nameidx-1]+"!"),supbooks[bookidx]&&supbooks[bookidx][nameidx])o+=supbooks[bookidx][nameidx].Name;else if(supbooks[0]&&supbooks[0][nameidx])o+=supbooks[0][nameidx].Name;else{var ixtidata=(get_ixti_raw(supbooks,bookidx,opts)||"").split(";;");ixtidata[nameidx-1]?o=ixtidata[nameidx-1]:o+="SH33TJSERRX"}stack.push(o);break}externbook||(externbook={Name:"SH33TJSERRY"}),stack.push(externbook.Name);break;case"PtgParen":var lp="(",rp=")";if(last_sp>=0){switch(sp="",formula[0][last_sp][1][0]){case 2:lp=fill(" ",formula[0][last_sp][1][1])+lp;break;case 3:lp=fill("\r",formula[0][last_sp][1][1])+lp;break;case 4:rp=fill(" ",formula[0][last_sp][1][1])+rp;break;case 5:rp=fill("\r",formula[0][last_sp][1][1])+rp;break;default:if(opts.WTF)throw new Error("Unexpected PtgAttrSpaceType "+formula[0][last_sp][1][0])}last_sp=-1}stack.push(lp+stack.pop()+rp);break;case"PtgRefErr":stack.push("#REF!");break;case"PtgRefErr3d":stack.push("#REF!");break;case"PtgExp":c={c:f[1][1],r:f[1][0]};var q={c:cell.c,r:cell.r};if(supbooks.sharedf[encode_cell(c)]){var parsedf=supbooks.sharedf[encode_cell(c)];stack.push(stringify_formula(parsedf,_range,q,supbooks,opts))}else{var fnd=!1;for(e1=0;e1!=supbooks.arrayf.length;++e1)if(e2=supbooks.arrayf[e1],!(c.c<e2[0].s.c||c.c>e2[0].e.c)&&!(c.r<e2[0].s.r||c.r>e2[0].e.r)){stack.push(stringify_formula(e2[1],_range,q,supbooks,opts)),fnd=!0;break}fnd||stack.push(f[1])}break;case"PtgArray":stack.push("{"+stringify_array(f[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":last_sp=ff;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":stack.push("");break;case"PtgAreaErr":stack.push("#REF!");break;case"PtgAreaErr3d":stack.push("#REF!");break;case"PtgList":stack.push("Table"+f[1].idx+"[#"+f[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(f));default:throw new Error("Unrecognized Formula Token: "+String(f))}var PtgNonDisp=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(opts.biff!=3&&last_sp>=0&&PtgNonDisp.indexOf(formula[0][ff][0])==-1){f=formula[0][last_sp];var _left=!0;switch(f[1][0]){case 4:_left=!1;case 0:sp=fill(" ",f[1][1]);break;case 5:_left=!1;case 1:sp=fill("\r",f[1][1]);break;default:if(sp="",opts.WTF)throw new Error("Unexpected PtgAttrSpaceType "+f[1][0])}stack.push((_left?sp:"")+stack.pop()+(_left?"":sp)),last_sp=-1}}if(stack.length>1&&opts.WTF)throw new Error("bad formula stack");return stack[0]=="TRUE"?!0:stack[0]=="FALSE"?!1:stack[0]}function write_FormulaValue(value){if(value==null){var o=new_buf(8);return o.write_shift(1,3),o.write_shift(1,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,65535),o}else if(typeof value=="number")return write_Xnum(value);return write_Xnum(0)}function write_Formula(cell,R,C,opts,os){var o1=write_XLSCell(R,C,os),o2=write_FormulaValue(cell.v),o3=new_buf(6),flags=33;o3.write_shift(2,flags),o3.write_shift(4,0);for(var bf=new_buf(cell.bf.length),i=0;i<cell.bf.length;++i)bf[i]=cell.bf[i];var out=bconcat([o1,o2,o3,bf]);return out}function parse_XLSBParsedFormula(data,length,opts){var cce=data.read_shift(4),rgce=parse_Rgce(data,cce,opts),cb=data.read_shift(4),rgcb=cb>0?parse_RgbExtra(data,cb,rgce,opts):null;return[rgce,rgcb]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula;function write_XLSBFormulaNum(val){if((val|0)==val&&val<Math.pow(2,16)&&val>=0){var oint=new_buf(11);return oint.write_shift(4,3),oint.write_shift(1,30),oint.write_shift(2,val),oint.write_shift(4,0),oint}var num=new_buf(17);return num.write_shift(4,11),num.write_shift(1,31),num.write_shift(8,val),num.write_shift(4,0),num}function write_XLSBFormulaErr(val){var oint=new_buf(10);return oint.write_shift(4,2),oint.write_shift(1,28),oint.write_shift(1,val),oint.write_shift(4,0),oint}function write_XLSBFormulaBool(val){var oint=new_buf(10);return oint.write_shift(4,2),oint.write_shift(1,29),oint.write_shift(1,val?1:0),oint.write_shift(4,0),oint}function write_XLSBFormulaStr(val){var preamble=new_buf(7);preamble.write_shift(4,3+2*val.length),preamble.write_shift(1,23),preamble.write_shift(2,val.length);var body=new_buf(2*val.length);body.write_shift(2*val.length,val,"utf16le");var postamble=new_buf(4);return postamble.write_shift(4,0),bconcat([preamble,body,postamble])}function write_XLSBFormulaRef(str){var cell=decode_cell(str),out=new_buf(15);return out.write_shift(4,7),out.write_shift(1,36),out.write_shift(4,cell.r),out.write_shift(2,cell.c|(str.charAt(0)=="$"?0:1)<<14|(str.match(/\$\d/)?0:1)<<15),out.write_shift(4,0),out}function write_XLSBFormulaRef3D(str,wb){var lastbang=str.lastIndexOf("!"),sname=str.slice(0,lastbang);str=str.slice(lastbang+1);var cell=decode_cell(str);sname.charAt(0)=="'"&&(sname=sname.slice(1,-1).replace(/''/g,"'"));var out=new_buf(17);return out.write_shift(4,9),out.write_shift(1,58),out.write_shift(2,2+wb.SheetNames.map(function(n){return n.toLowerCase()}).indexOf(sname.toLowerCase())),out.write_shift(4,cell.r),out.write_shift(2,cell.c|(str.charAt(0)=="$"?0:1)<<14|(str.match(/\$\d/)?0:1)<<15),out.write_shift(4,0),out}function write_XLSBFormulaRefErr3D(str,wb){var lastbang=str.lastIndexOf("!"),sname=str.slice(0,lastbang);str=str.slice(lastbang+1),sname.charAt(0)=="'"&&(sname=sname.slice(1,-1).replace(/''/g,"'"));var out=new_buf(17);return out.write_shift(4,9),out.write_shift(1,60),out.write_shift(2,2+wb.SheetNames.map(function(n){return n.toLowerCase()}).indexOf(sname.toLowerCase())),out.write_shift(4,0),out.write_shift(2,0),out.write_shift(4,0),out}function write_XLSBFormulaRange(_str){var parts=_str.split(":"),str=parts[0],out=new_buf(23);out.write_shift(4,15),str=parts[0];var cell=decode_cell(str);return out.write_shift(1,36),out.write_shift(4,cell.r),out.write_shift(2,cell.c|(str.charAt(0)=="$"?0:1)<<14|(str.match(/\$\d/)?0:1)<<15),out.write_shift(4,0),str=parts[1],cell=decode_cell(str),out.write_shift(1,36),out.write_shift(4,cell.r),out.write_shift(2,cell.c|(str.charAt(0)=="$"?0:1)<<14|(str.match(/\$\d/)?0:1)<<15),out.write_shift(4,0),out.write_shift(1,17),out.write_shift(4,0),out}function write_XLSBFormulaRangeWS(_str,wb){var lastbang=_str.lastIndexOf("!"),sname=_str.slice(0,lastbang);_str=_str.slice(lastbang+1),sname.charAt(0)=="'"&&(sname=sname.slice(1,-1).replace(/''/g,"'"));var parts=_str.split(":"),out=new_buf(27);out.write_shift(4,19);var str=parts[0],cell=decode_cell(str);return out.write_shift(1,58),out.write_shift(2,2+wb.SheetNames.map(function(n){return n.toLowerCase()}).indexOf(sname.toLowerCase())),out.write_shift(4,cell.r),out.write_shift(2,cell.c|(str.charAt(0)=="$"?0:1)<<14|(str.match(/\$\d/)?0:1)<<15),str=parts[1],cell=decode_cell(str),out.write_shift(1,58),out.write_shift(2,2+wb.SheetNames.map(function(n){return n.toLowerCase()}).indexOf(sname.toLowerCase())),out.write_shift(4,cell.r),out.write_shift(2,cell.c|(str.charAt(0)=="$"?0:1)<<14|(str.match(/\$\d/)?0:1)<<15),out.write_shift(1,17),out.write_shift(4,0),out}function write_XLSBFormulaArea3D(_str,wb){var lastbang=_str.lastIndexOf("!"),sname=_str.slice(0,lastbang);_str=_str.slice(lastbang+1),sname.charAt(0)=="'"&&(sname=sname.slice(1,-1).replace(/''/g,"'"));var range=decode_range(_str),out=new_buf(23);return out.write_shift(4,15),out.write_shift(1,59),out.write_shift(2,2+wb.SheetNames.map(function(n){return n.toLowerCase()}).indexOf(sname.toLowerCase())),out.write_shift(4,range.s.r),out.write_shift(4,range.e.r),out.write_shift(2,range.s.c),out.write_shift(2,range.e.c),out.write_shift(4,0),out}function write_XLSBFormula(val,wb){if(typeof val=="number")return write_XLSBFormulaNum(val);if(typeof val=="boolean")return write_XLSBFormulaBool(val);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(val))return write_XLSBFormulaErr(+RBErr[val]);if(val.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRef(val);if(val.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRange(val);if(val.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaArea3D(val,wb);if(val.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRef3D(val,wb);if(val.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRangeWS(val,wb);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(val))return write_XLSBFormulaRefErr3D(val,wb);if(/^".*"$/.test(val))return write_XLSBFormulaStr(val);if(/^[+-]\d+$/.test(val))return write_XLSBFormulaNum(parseInt(val,10));throw"Formula |"+val+"| not supported for XLSB"}var write_XLSBNameParsedFormula=write_XLSBFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function csf_to_ods_formula(f){var o="of:="+f.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return o.replace(/;/g,"|").replace(/,/g,";")}function csf_to_ods_3D(r){return r.replace(/!/,".").replace(/:/,":.")}var browser_has_Map=typeof Map<"u";function get_sst_id(sst,str,rev){var i=0,len=sst.length;if(rev){if(browser_has_Map?rev.has(str):Object.prototype.hasOwnProperty.call(rev,str)){for(var revarr=browser_has_Map?rev.get(str):rev[str];i<revarr.length;++i)if(sst[revarr[i]].t===str)return sst.Count++,revarr[i]}}else for(;i<len;++i)if(sst[i].t===str)return sst.Count++,i;return sst[len]={t:str},sst.Count++,sst.Unique++,rev&&(browser_has_Map?(rev.has(str)||rev.set(str,[]),rev.get(str).push(len)):(Object.prototype.hasOwnProperty.call(rev,str)||(rev[str]=[]),rev[str].push(len))),len}function col_obj_w(C,col){var p={min:C+1,max:C+1},wch=-1;return col.MDW&&(MDW=col.MDW),col.width!=null?p.customWidth=1:col.wpx!=null?wch=px2char(col.wpx):col.wch!=null&&(wch=col.wch),wch>-1?(p.width=char2width(wch),p.customWidth=1):col.width!=null&&(p.width=col.width),col.hidden&&(p.hidden=!0),col.level!=null&&(p.outlineLevel=p.level=col.level),p}function default_margins(margins,mode){if(margins){var defs=[.7,.7,.75,.75,.3,.3];mode=="xlml"&&(defs=[1,1,1,1,.5,.5]),margins.left==null&&(margins.left=defs[0]),margins.right==null&&(margins.right=defs[1]),margins.top==null&&(margins.top=defs[2]),margins.bottom==null&&(margins.bottom=defs[3]),margins.header==null&&(margins.header=defs[4]),margins.footer==null&&(margins.footer=defs[5])}}function get_cell_style(styles,cell,opts){var z=opts.revssf[cell.z!=null?cell.z:"General"],i=60,len=styles.length;if(z==null&&opts.ssf){for(;i<392;++i)if(opts.ssf[i]==null){SSF__load(cell.z,i),opts.ssf[i]=cell.z,opts.revssf[cell.z]=z=i;break}}for(i=0;i!=len;++i)if(styles[i].numFmtId===z)return i;return styles[len]={numFmtId:z,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},len}function check_ws(ws,sname,i){if(ws&&ws["!ref"]){var range=safe_decode_range(ws["!ref"]);if(range.e.c<range.s.c||range.e.r<range.s.r)throw new Error("Bad range ("+i+"): "+ws["!ref"])}}function write_ws_xml_merges(merges){if(merges.length===0)return"";for(var o='<mergeCells count="'+merges.length+'">',i=0;i!=merges.length;++i)o+='<mergeCell ref="'+encode_range(merges[i])+'"/>';return o+"</mergeCells>"}function write_ws_xml_sheetpr(ws,wb,idx,opts,o){var needed=!1,props={},payload=null;if(opts.bookType!=="xlsx"&&wb.vbaraw){var cname=wb.SheetNames[idx];try{wb.Workbook&&(cname=wb.Workbook.Sheets[idx].CodeName||cname)}catch{}needed=!0,props.codeName=utf8write(escapexml(cname))}if(ws&&ws["!outline"]){var outlineprops={summaryBelow:1,summaryRight:1};ws["!outline"].above&&(outlineprops.summaryBelow=0),ws["!outline"].left&&(outlineprops.summaryRight=0),payload=(payload||"")+writextag("outlinePr",null,outlineprops)}!needed&&!payload||(o[o.length]=writextag("sheetPr",payload,props))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(sp){var o={sheet:1};return sheetprot_deffalse.forEach(function(n){sp[n]!=null&&sp[n]&&(o[n]="1")}),sheetprot_deftrue.forEach(function(n){sp[n]!=null&&!sp[n]&&(o[n]="0")}),sp.password&&(o.password=crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase()),writextag("sheetProtection",null,o)}function write_ws_xml_margins(margin){return default_margins(margin),writextag("pageMargins",null,margin)}function write_ws_xml_cols(ws,cols){for(var o=["<cols>"],col,i=0;i!=cols.length;++i)(col=cols[i])&&(o[o.length]=writextag("col",null,col_obj_w(i,col)));return o[o.length]="</cols>",o.join("")}function write_ws_xml_autofilter(data,ws,wb,idx){var ref=typeof data.ref=="string"?data.ref:encode_range(data.ref);wb.Workbook||(wb.Workbook={Sheets:[]}),wb.Workbook.Names||(wb.Workbook.Names=[]);var names=wb.Workbook.Names,range=decode_range(ref);range.s.r==range.e.r&&(range.e.r=decode_range(ws["!ref"]).e.r,ref=encode_range(range));for(var i=0;i<names.length;++i){var name=names[i];if(name.Name=="_xlnm._FilterDatabase"&&name.Sheet==idx){name.Ref=formula_quote_sheet_name(wb.SheetNames[idx])+"!"+fix_range(ref);break}}return i==names.length&&names.push({Name:"_xlnm._FilterDatabase",Sheet:idx,Ref:"'"+wb.SheetNames[idx]+"'!"+ref}),writextag("autoFilter",null,{ref})}function write_ws_xml_sheetviews(ws,opts,idx,wb){var sview={workbookViewId:"0"};return(((wb||{}).Workbook||{}).Views||[])[0]&&(sview.rightToLeft=wb.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,sview),{})}function write_ws_xml_cell(cell,ref,ws,opts,idx,wb,date1904){if(cell.c&&ws["!comments"].push([ref,cell.c]),(cell.v===void 0||cell.t==="z"&&!(opts||{}).sheetStubs)&&typeof cell.f!="string"&&typeof cell.z>"u")return"";var vv="",oldt=cell.t,oldv=cell.v;if(cell.t!=="z")switch(cell.t){case"b":vv=cell.v?"1":"0";break;case"n":isNaN(cell.v)?(cell.t="e",vv=BErr[cell.v=36]):isFinite(cell.v)?vv=""+cell.v:(cell.t="e",vv=BErr[cell.v=7]);break;case"e":vv=BErr[cell.v];break;case"d":if(opts&&opts.cellDates){var _vv=parseDate(cell.v,date1904);vv=_vv.toISOString(),_vv.getUTCFullYear()<1900&&(vv=vv.slice(vv.indexOf("T")+1).replace("Z",""))}else cell=dup(cell),cell.t="n",vv=""+(cell.v=datenum(parseDate(cell.v,date1904),date1904));typeof cell.z>"u"&&(cell.z=table_fmt[14]);break;default:vv=cell.v;break}var v=cell.t=="z"||cell.v==null?"":writetag("v",escapexml(vv)),o={r:ref},os=get_cell_style(opts.cellXfs,cell,opts);switch(os!==0&&(o.s=os),cell.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(cell.v==null){delete cell.t;break}if(cell.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(opts&&opts.bookSST){v=writetag("v",""+get_sst_id(opts.Strings,cell.v,opts.revStrings)),o.t="s";break}else o.t="str";break}if(cell.t!=oldt&&(cell.t=oldt,cell.v=oldv),typeof cell.f=="string"&&cell.f){var ff=cell.F&&cell.F.slice(0,ref.length)==ref?{t:"array",ref:cell.F}:null;v=writextag("f",escapexml(cell.f),ff)+(cell.v!=null?v:"")}return cell.l&&(cell.l.display=escapexml(vv),ws["!links"].push([ref,cell.l])),cell.D&&(o.cm=1),writextag("c",v,o)}function write_ws_xml_data(ws,opts,idx,wb){var o=[],r=[],range=safe_decode_range(ws["!ref"]),cell="",ref,rr="",cols=[],R=0,C=0,rows=ws["!rows"],dense=ws["!data"]!=null,params={r:rr},row,height=-1,date1904=(((wb||{}).Workbook||{}).WBProps||{}).date1904;for(C=range.s.c;C<=range.e.c;++C)cols[C]=encode_col(C);for(R=range.s.r;R<=range.e.r;++R){for(r=[],rr=encode_row(R),C=range.s.c;C<=range.e.c;++C){ref=cols[C]+rr;var _cell=dense?(ws["!data"][R]||[])[C]:ws[ref];_cell!==void 0&&(cell=write_ws_xml_cell(_cell,ref,ws,opts,idx,wb,date1904))!=null&&r.push(cell)}(r.length>0||rows&&rows[R])&&(params={r:rr},rows&&rows[R]&&(row=rows[R],row.hidden&&(params.hidden=1),height=-1,row.hpx?height=px2pt(row.hpx):row.hpt&&(height=row.hpt),height>-1&&(params.ht=height,params.customHeight=1),row.level&&(params.outlineLevel=row.level)),o[o.length]=writextag("row",r.join(""),params))}if(rows)for(;R<rows.length;++R)rows&&rows[R]&&(params={r:R+1},row=rows[R],row.hidden&&(params.hidden=1),height=-1,row.hpx?height=px2pt(row.hpx):row.hpt&&(height=row.hpt),height>-1&&(params.ht=height,params.customHeight=1),row.level&&(params.outlineLevel=row.level),o[o.length]=writextag("row","",params));return o.join("")}function write_ws_xml(idx,opts,wb,rels){var o=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],s=wb.SheetNames[idx],sidx=0,rdata="",ws=wb.Sheets[s];ws==null&&(ws={});var ref=ws["!ref"]||"A1",range=safe_decode_range(ref);if(range.e.c>16383||range.e.r>1048575){if(opts.WTF)throw new Error("Range "+ref+" exceeds format limit A1:XFD1048576");range.e.c=Math.min(range.e.c,16383),range.e.r=Math.min(range.e.c,1048575),ref=encode_range(range)}rels||(rels={}),ws["!comments"]=[];var _drawing=[];write_ws_xml_sheetpr(ws,wb,idx,opts,o),o[o.length]=writextag("dimension",null,{ref}),o[o.length]=write_ws_xml_sheetviews(ws,opts,idx,wb),opts.sheetFormat&&(o[o.length]=writextag("sheetFormatPr",null,{defaultRowHeight:opts.sheetFormat.defaultRowHeight||"16",baseColWidth:opts.sheetFormat.baseColWidth||"10",outlineLevelRow:opts.sheetFormat.outlineLevelRow||"7"})),ws["!cols"]!=null&&ws["!cols"].length>0&&(o[o.length]=write_ws_xml_cols(ws,ws["!cols"])),o[sidx=o.length]="<sheetData/>",ws["!links"]=[],ws["!ref"]!=null&&(rdata=write_ws_xml_data(ws,opts,idx,wb,rels),rdata.length>0&&(o[o.length]=rdata)),o.length>sidx+1&&(o[o.length]="</sheetData>",o[sidx]=o[sidx].replace("/>",">")),ws["!protect"]&&(o[o.length]=write_ws_xml_protection(ws["!protect"])),ws["!autofilter"]!=null&&(o[o.length]=write_ws_xml_autofilter(ws["!autofilter"],ws,wb,idx)),ws["!merges"]!=null&&ws["!merges"].length>0&&(o[o.length]=write_ws_xml_merges(ws["!merges"]));var relc=-1,rel,rId=-1;return ws["!links"].length>0&&(o[o.length]="<hyperlinks>",ws["!links"].forEach(function(l){l[1].Target&&(rel={ref:l[0]},l[1].Target.charAt(0)!="#"&&(rId=add_rels(rels,-1,escapexml(l[1].Target).replace(/#[\s\S]*$/,""),RELS.HLINK),rel["r:id"]="rId"+rId),(relc=l[1].Target.indexOf("#"))>-1&&(rel.location=escapexml(l[1].Target.slice(relc+1))),l[1].Tooltip&&(rel.tooltip=escapexml(l[1].Tooltip)),rel.display=l[1].display,o[o.length]=writextag("hyperlink",null,rel))}),o[o.length]="</hyperlinks>"),delete ws["!links"],ws["!margins"]!=null&&(o[o.length]=write_ws_xml_margins(ws["!margins"])),(!opts||opts.ignoreEC||opts.ignoreEC==null)&&(o[o.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:ref}))),_drawing.length>0&&(rId=add_rels(rels,-1,"../drawings/drawing"+(idx+1)+".xml",RELS.DRAW),o[o.length]=writextag("drawing",null,{"r:id":"rId"+rId}),ws["!drawing"]=_drawing),ws["!comments"].length>0&&(rId=add_rels(rels,-1,"../drawings/vmlDrawing"+(idx+1)+".vml",RELS.VML),o[o.length]=writextag("legacyDrawing",null,{"r:id":"rId"+rId}),ws["!legacy"]=rId),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function parse_BrtRowHdr(data,length){var z={},tgt=data.l+length;z.r=data.read_shift(4),data.l+=4;var miyRw=data.read_shift(2);data.l+=1;var flags=data.read_shift(1);return data.l=tgt,flags&7&&(z.level=flags&7),flags&16&&(z.hidden=!0),flags&32&&(z.hpt=miyRw/20),z}function write_BrtRowHdr(R,range,ws){var o=new_buf(145),row=(ws["!rows"]||[])[R]||{};o.write_shift(4,R),o.write_shift(4,0);var miyRw=320;row.hpx?miyRw=px2pt(row.hpx)*20:row.hpt&&(miyRw=row.hpt*20),o.write_shift(2,miyRw),o.write_shift(1,0);var flags=0;row.level&&(flags|=row.level),row.hidden&&(flags|=16),(row.hpx||row.hpt)&&(flags|=32),o.write_shift(1,flags),o.write_shift(1,0);var ncolspan=0,lcs=o.l;o.l+=4;for(var caddr={r:R,c:0},dense=ws["!data"]!=null,i=0;i<16;++i)if(!(range.s.c>i+1<<10||range.e.c<i<<10)){for(var first=-1,last=-1,j=i<<10;j<i+1<<10;++j){caddr.c=j;var cell=dense?(ws["!data"][caddr.r]||[])[caddr.c]:ws[encode_cell(caddr)];cell&&(first<0&&(first=j),last=j)}first<0||(++ncolspan,o.write_shift(4,first),o.write_shift(4,last))}var l=o.l;return o.l=lcs,o.write_shift(4,ncolspan),o.l=l,o.length>o.l?o.slice(0,o.l):o}function write_row_header(ba,ws,range,R){var o=write_BrtRowHdr(R,range,ws);(o.length>17||(ws["!rows"]||[])[R])&&write_record(ba,0,o)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(data,length){var z={},f=data[data.l];return++data.l,z.above=!(f&64),z.left=!(f&128),data.l+=18,z.name=parse_XLSBCodeName(data,length-19),z}function write_BrtWsProp(str,outl,o){o==null&&(o=new_buf(84+4*str.length));var f=192;outl&&(outl.above&&(f&=-65),outl.left&&(f&=-129)),o.write_shift(1,f);for(var i=1;i<3;++i)o.write_shift(1,0);return write_BrtColor({auto:1},o),o.write_shift(-4,-1),o.write_shift(-4,-1),write_XLSBCodeName(str,o),o.slice(0,o.l)}function parse_BrtCellBlank(data){var cell=parse_XLSBCell(data);return[cell]}function write_BrtCellBlank(cell,ncell,o){return o==null&&(o=new_buf(8)),write_XLSBCell(ncell,o)}function parse_BrtShortBlank(data){var cell=parse_XLSBShortCell(data);return[cell]}function write_BrtShortBlank(cell,ncell,o){return o==null&&(o=new_buf(4)),write_XLSBShortCell(ncell,o)}function parse_BrtCellBool(data){var cell=parse_XLSBCell(data),fBool=data.read_shift(1);return[cell,fBool,"b"]}function write_BrtCellBool(cell,ncell,o){return o==null&&(o=new_buf(9)),write_XLSBCell(ncell,o),o.write_shift(1,cell.v?1:0),o}function parse_BrtShortBool(data){var cell=parse_XLSBShortCell(data),fBool=data.read_shift(1);return[cell,fBool,"b"]}function write_BrtShortBool(cell,ncell,o){return o==null&&(o=new_buf(5)),write_XLSBShortCell(ncell,o),o.write_shift(1,cell.v?1:0),o}function parse_BrtCellError(data){var cell=parse_XLSBCell(data),bError=data.read_shift(1);return[cell,bError,"e"]}function write_BrtCellError(cell,ncell,o){return o==null&&(o=new_buf(9)),write_XLSBCell(ncell,o),o.write_shift(1,cell.v),o}function parse_BrtShortError(data){var cell=parse_XLSBShortCell(data),bError=data.read_shift(1);return[cell,bError,"e"]}function write_BrtShortError(cell,ncell,o){return o==null&&(o=new_buf(8)),write_XLSBShortCell(ncell,o),o.write_shift(1,cell.v),o.write_shift(2,0),o.write_shift(1,0),o}function parse_BrtCellIsst(data){var cell=parse_XLSBCell(data),isst=data.read_shift(4);return[cell,isst,"s"]}function write_BrtCellIsst(cell,ncell,o){return o==null&&(o=new_buf(12)),write_XLSBCell(ncell,o),o.write_shift(4,ncell.v),o}function parse_BrtShortIsst(data){var cell=parse_XLSBShortCell(data),isst=data.read_shift(4);return[cell,isst,"s"]}function write_BrtShortIsst(cell,ncell,o){return o==null&&(o=new_buf(8)),write_XLSBShortCell(ncell,o),o.write_shift(4,ncell.v),o}function parse_BrtCellReal(data){var cell=parse_XLSBCell(data),value=parse_Xnum(data);return[cell,value,"n"]}function write_BrtCellReal(cell,ncell,o){return o==null&&(o=new_buf(16)),write_XLSBCell(ncell,o),write_Xnum(cell.v,o),o}function parse_BrtShortReal(data){var cell=parse_XLSBShortCell(data),value=parse_Xnum(data);return[cell,value,"n"]}function write_BrtShortReal(cell,ncell,o){return o==null&&(o=new_buf(12)),write_XLSBShortCell(ncell,o),write_Xnum(cell.v,o),o}function parse_BrtCellRk(data){var cell=parse_XLSBCell(data),value=parse_RkNumber(data);return[cell,value,"n"]}function write_BrtCellRk(cell,ncell,o){return o==null&&(o=new_buf(12)),write_XLSBCell(ncell,o),write_RkNumber(cell.v,o),o}function parse_BrtShortRk(data){var cell=parse_XLSBShortCell(data),value=parse_RkNumber(data);return[cell,value,"n"]}function write_BrtShortRk(cell,ncell,o){return o==null&&(o=new_buf(8)),write_XLSBShortCell(ncell,o),write_RkNumber(cell.v,o),o}function parse_BrtCellRString(data){var cell=parse_XLSBCell(data),value=parse_RichStr(data);return[cell,value,"is"]}function parse_BrtCellSt(data){var cell=parse_XLSBCell(data),value=parse_XLWideString(data);return[cell,value,"str"]}function write_BrtCellSt(cell,ncell,o){var data=cell.v==null?"":String(cell.v);return o==null&&(o=new_buf(12+4*cell.v.length)),write_XLSBCell(ncell,o),write_XLWideString(data,o),o.length>o.l?o.slice(0,o.l):o}function parse_BrtShortSt(data){var cell=parse_XLSBShortCell(data),value=parse_XLWideString(data);return[cell,value,"str"]}function write_BrtShortSt(cell,ncell,o){var data=cell.v==null?"":String(cell.v);return o==null&&(o=new_buf(8+4*data.length)),write_XLSBShortCell(ncell,o),write_XLWideString(data,o),o.length>o.l?o.slice(0,o.l):o}function parse_BrtFmlaBool(data,length,opts){var end2=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=data.read_shift(1),o=[cell,value,"b"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end2-data.l,opts);o[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end2;return o}function parse_BrtFmlaError(data,length,opts){var end2=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=data.read_shift(1),o=[cell,value,"e"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end2-data.l,opts);o[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end2;return o}function parse_BrtFmlaNum(data,length,opts){var end2=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=parse_Xnum(data),o=[cell,value,"n"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end2-data.l,opts);o[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end2;return o}function parse_BrtFmlaString(data,length,opts){var end2=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=parse_XLWideString(data),o=[cell,value,"str"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end2-data.l,opts);o[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end2;return o}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(cnt,o){return o==null&&(o=new_buf(4)),o.write_shift(4,cnt),o}function parse_BrtHLink(data,length){var end2=data.l+length,rfx=parse_UncheckedRfX(data,16),relId=parse_XLNullableWideString(data),loc=parse_XLWideString(data),tooltip=parse_XLWideString(data),display=parse_XLWideString(data);data.l=end2;var o={rfx,relId,loc,display};return tooltip&&(o.Tooltip=tooltip),o}function write_BrtHLink(l,rId){var o=new_buf(50+4*(l[1].Target.length+(l[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(l[0]),e:decode_cell(l[0])},o),write_RelID("rId"+rId,o);var locidx=l[1].Target.indexOf("#"),loc=locidx==-1?"":l[1].Target.slice(locidx+1);return write_XLWideString(loc||"",o),write_XLWideString(l[1].Tooltip||"",o),write_XLWideString("",o),o.slice(0,o.l)}function parse_BrtPane(){}function parse_BrtArrFmla(data,length,opts){var end2=data.l+length,rfx=parse_RfX(data,16),fAlwaysCalc=data.read_shift(1),o=[rfx];if(o[2]=fAlwaysCalc,opts.cellFormula){var formula=parse_XLSBArrayParsedFormula(data,end2-data.l,opts);o[1]=formula}else data.l=end2;return o}function parse_BrtShrFmla(data,length,opts){var end2=data.l+length,rfx=parse_UncheckedRfX(data,16),o=[rfx];if(opts.cellFormula){var formula=parse_XLSBSharedParsedFormula(data,end2-data.l,opts);o[1]=formula,data.l=end2}else data.l=end2;return o}function write_BrtColInfo(C,col,o){o==null&&(o=new_buf(18));var p=col_obj_w(C,col);o.write_shift(-4,C),o.write_shift(-4,C),o.write_shift(4,(p.width||10)*256),o.write_shift(4,0);var flags=0;return col.hidden&&(flags|=1),typeof p.width=="number"&&(flags|=2),col.level&&(flags|=col.level<<8),o.write_shift(2,flags),o}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(data){var margins={};return BrtMarginKeys.forEach(function(k){margins[k]=parse_Xnum(data,8)}),margins}function write_BrtMargins(margins,o){return o==null&&(o=new_buf(6*8)),default_margins(margins),BrtMarginKeys.forEach(function(k){write_Xnum(margins[k],o)}),o}function parse_BrtBeginWsView(data){var f=data.read_shift(2);return data.l+=28,{RTL:f&32}}function write_BrtBeginWsView(ws,Workbook,o){o==null&&(o=new_buf(30));var f=924;return(((Workbook||{}).Views||[])[0]||{}).RTL&&(f|=32),o.write_shift(2,f),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(1,0),o.write_shift(1,0),o.write_shift(2,0),o.write_shift(2,100),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o}function write_BrtCellIgnoreEC(ref){var o=new_buf(24);return o.write_shift(4,4),o.write_shift(4,1),write_UncheckedRfX(ref,o),o}function write_BrtSheetProtection(sp,o){return o==null&&(o=new_buf(16*4+2)),o.write_shift(2,sp.password?crypto_CreatePasswordVerifier_Method1(sp.password):0),o.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?o.write_shift(4,sp[n[0]]!=null&&!sp[n[0]]?1:0):o.write_shift(4,sp[n[0]]!=null&&sp[n[0]]?0:1)}),o}function parse_BrtDVal(){}function parse_BrtDVal14(){}function write_ws_bin_cell(ba,cell,R,C,opts,ws,last_seen,date1904){var o={r:R,c:C};if(cell.c&&ws["!comments"].push([encode_cell(o),cell.c]),cell.v===void 0)return!1;var vv="";switch(cell.t){case"b":vv=cell.v?"1":"0";break;case"d":cell=dup(cell),cell.z=cell.z||table_fmt[14],cell.v=datenum(parseDate(cell.v,date1904),date1904),cell.t="n";break;case"n":case"e":vv=""+cell.v;break;default:vv=cell.v;break}switch(o.s=get_cell_style(opts.cellXfs,cell,opts),cell.l&&ws["!links"].push([encode_cell(o),cell.l]),cell.t){case"s":case"str":return opts.bookSST?(vv=get_sst_id(opts.Strings,cell.v==null?"":String(cell.v),opts.revStrings),o.t="s",o.v=vv,last_seen?write_record(ba,18,write_BrtShortIsst(cell,o)):write_record(ba,7,write_BrtCellIsst(cell,o))):(o.t="str",last_seen?write_record(ba,17,write_BrtShortSt(cell,o)):write_record(ba,6,write_BrtCellSt(cell,o))),!0;case"n":return cell.v==(cell.v|0)&&cell.v>-1e3&&cell.v<1e3?last_seen?write_record(ba,13,write_BrtShortRk(cell,o)):write_record(ba,2,write_BrtCellRk(cell,o)):isNaN(cell.v)?last_seen?write_record(ba,14,write_BrtShortError({t:"e",v:36},o)):write_record(ba,3,write_BrtCellError({t:"e",v:36},o)):isFinite(cell.v)?last_seen?write_record(ba,16,write_BrtShortReal(cell,o)):write_record(ba,5,write_BrtCellReal(cell,o)):last_seen?write_record(ba,14,write_BrtShortError({t:"e",v:7},o)):write_record(ba,3,write_BrtCellError({t:"e",v:7},o)),!0;case"b":return o.t="b",last_seen?write_record(ba,15,write_BrtShortBool(cell,o)):write_record(ba,4,write_BrtCellBool(cell,o)),!0;case"e":return o.t="e",last_seen?write_record(ba,14,write_BrtShortError(cell,o)):write_record(ba,3,write_BrtCellError(cell,o)),!0}return last_seen?write_record(ba,12,write_BrtShortBlank(cell,o)):write_record(ba,1,write_BrtCellBlank(cell,o)),!0}function write_CELLTABLE(ba,ws,idx,opts,wb){var range=safe_decode_range(ws["!ref"]||"A1"),ref,rr="",cols=[],date1904=(((wb||{}).Workbook||{}).WBProps||{}).date1904;write_record(ba,145);var dense=ws["!data"]!=null,cap=range.e.r;ws["!rows"]&&(cap=Math.max(range.e.r,ws["!rows"].length-1));for(var R=range.s.r;R<=cap;++R){rr=encode_row(R),write_row_header(ba,ws,range,R);var last_seen=!1;if(R<=range.e.r)for(var C=range.s.c;C<=range.e.c;++C){R===range.s.r&&(cols[C]=encode_col(C)),ref=cols[C]+rr;var cell=dense?(ws["!data"][R]||[])[C]:ws[ref];if(!cell){last_seen=!1;continue}last_seen=write_ws_bin_cell(ba,cell,R,C,opts,ws,last_seen,date1904)}}write_record(ba,146)}function write_MERGECELLS(ba,ws){!ws||!ws["!merges"]||(write_record(ba,177,write_BrtBeginMergeCells(ws["!merges"].length)),ws["!merges"].forEach(function(m){write_record(ba,176,write_BrtMergeCell(m))}),write_record(ba,178))}function write_COLINFOS(ba,ws){!ws||!ws["!cols"]||(write_record(ba,390),ws["!cols"].forEach(function(m,i){m&&write_record(ba,60,write_BrtColInfo(i,m))}),write_record(ba,391))}function write_IGNOREECS(ba,ws){!ws||!ws["!ref"]||(write_record(ba,648),write_record(ba,649,write_BrtCellIgnoreEC(safe_decode_range(ws["!ref"]))),write_record(ba,650))}function write_HLINKS(ba,ws,rels){ws["!links"].forEach(function(l){if(l[1].Target){var rId=add_rels(rels,-1,l[1].Target.replace(/#[\s\S]*$/,""),RELS.HLINK);write_record(ba,494,write_BrtHLink(l,rId))}}),delete ws["!links"]}function write_LEGACYDRAWING(ba,ws,idx,rels){if(ws["!comments"].length>0){var rId=add_rels(rels,-1,"../drawings/vmlDrawing"+(idx+1)+".vml",RELS.VML);write_record(ba,551,write_RelID("rId"+rId)),ws["!legacy"]=rId}}function write_AUTOFILTER(ba,ws,wb,idx){if(ws["!autofilter"]){var data=ws["!autofilter"],ref=typeof data.ref=="string"?data.ref:encode_range(data.ref);wb.Workbook||(wb.Workbook={Sheets:[]}),wb.Workbook.Names||(wb.Workbook.Names=[]);var names=wb.Workbook.Names,range=decode_range(ref);range.s.r==range.e.r&&(range.e.r=decode_range(ws["!ref"]).e.r,ref=encode_range(range));for(var i=0;i<names.length;++i){var name=names[i];if(name.Name=="_xlnm._FilterDatabase"&&name.Sheet==idx){name.Ref=formula_quote_sheet_name(wb.SheetNames[idx])+"!"+fix_range(ref);break}}i==names.length&&names.push({Name:"_xlnm._FilterDatabase",Sheet:idx,Ref:formula_quote_sheet_name(wb.SheetNames[idx])+"!"+fix_range(ref)}),write_record(ba,161,write_UncheckedRfX(safe_decode_range(ref))),write_record(ba,162)}}function write_WSVIEWS2(ba,ws,Workbook){write_record(ba,133),write_record(ba,137,write_BrtBeginWsView(ws,Workbook)),write_record(ba,138),write_record(ba,134)}function write_SHEETPROTECT(ba,ws){ws["!protect"]&&write_record(ba,535,write_BrtSheetProtection(ws["!protect"]))}function write_ws_bin(idx,opts,wb,rels){var ba=buf_array(),s=wb.SheetNames[idx],ws=wb.Sheets[s]||{},c=s;try{wb&&wb.Workbook&&(c=wb.Workbook.Sheets[idx].CodeName||c)}catch{}var r=safe_decode_range(ws["!ref"]||"A1");if(r.e.c>16383||r.e.r>1048575){if(opts.WTF)throw new Error("Range "+(ws["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");r.e.c=Math.min(r.e.c,16383),r.e.r=Math.min(r.e.c,1048575)}return ws["!links"]=[],ws["!comments"]=[],write_record(ba,129),(wb.vbaraw||ws["!outline"])&&write_record(ba,147,write_BrtWsProp(c,ws["!outline"])),write_record(ba,148,write_BrtWsDim(r)),write_WSVIEWS2(ba,ws,wb.Workbook),write_COLINFOS(ba,ws,idx,opts,wb),write_CELLTABLE(ba,ws,idx,opts,wb),write_SHEETPROTECT(ba,ws),write_AUTOFILTER(ba,ws,wb,idx),write_MERGECELLS(ba,ws),write_HLINKS(ba,ws,rels),ws["!margins"]&&write_record(ba,476,write_BrtMargins(ws["!margins"])),(!opts||opts.ignoreEC||opts.ignoreEC==null)&&write_IGNOREECS(ba,ws),write_LEGACYDRAWING(ba,ws,idx,rels),write_record(ba,130),ba.end()}function parse_BrtCsProp(data,length){data.l+=10;var name=parse_XLWideString(data,length-10);return{name}}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function safe1904(wb){return!wb.Workbook||!wb.Workbook.WBProps?"false":parsexmlbool(wb.Workbook.WBProps.date1904)?"true":"false"}var badchars=":][*?/\\".split("");function check_ws_name(n,safe){try{if(n=="")throw new Error("Sheet name cannot be blank");if(n.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(n.charCodeAt(0)==39||n.charCodeAt(n.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(n.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");badchars.forEach(function(c){if(n.indexOf(c)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(e){if(safe)return!1;throw e}return!0}function check_wb_names(N,S,codes){N.forEach(function(n,i){check_ws_name(n);for(var j=0;j<i;++j)if(n==N[j])throw new Error("Duplicate Sheet Name: "+n);if(codes){var cn=S&&S[i]&&S[i].CodeName||n;if(cn.charCodeAt(0)==95&&cn.length>22)throw new Error("Bad Code Name: Worksheet"+cn)}})}function check_wb(wb){if(!wb||!wb.SheetNames||!wb.Sheets)throw new Error("Invalid Workbook");if(!wb.SheetNames.length)throw new Error("Workbook is empty");var Sheets=wb.Workbook&&wb.Workbook.Sheets||[];check_wb_names(wb.SheetNames,Sheets,!!wb.vbaraw);for(var i=0;i<wb.SheetNames.length;++i)check_ws(wb.Sheets[wb.SheetNames[i]],wb.SheetNames[i],i);wb.SheetNames.forEach(function(n,i2){var ws=wb.Sheets[n];if(!(!ws||!ws["!autofilter"])){var DN;wb.Workbook||(wb.Workbook={}),wb.Workbook.Names||(wb.Workbook.Names=[]),wb.Workbook.Names.forEach(function(dn){dn.Name=="_xlnm._FilterDatabase"&&dn.Sheet==i2&&(DN=dn)});var nn=formula_quote_sheet_name(n)+"!"+fix_range(ws["!autofilter"].ref);DN?DN.Ref=nn:wb.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i2,Ref:nn})}})}function write_wb_xml(wb){var o=[XML_HEADER];o[o.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var write_names=wb.Workbook&&(wb.Workbook.Names||[]).length>0,workbookPr={codeName:"ThisWorkbook"};wb.Workbook&&wb.Workbook.WBProps&&(WBPropsDef.forEach(function(x){wb.Workbook.WBProps[x[0]]!=null&&wb.Workbook.WBProps[x[0]]!=x[1]&&(workbookPr[x[0]]=wb.Workbook.WBProps[x[0]])}),wb.Workbook.WBProps.CodeName&&(workbookPr.codeName=wb.Workbook.WBProps.CodeName,delete workbookPr.CodeName)),o[o.length]=writextag("workbookPr",null,workbookPr);var sheets=wb.Workbook&&wb.Workbook.Sheets||[],i=0;if(sheets&&sheets[0]&&sheets[0].Hidden){for(o[o.length]="<bookViews>",i=0;i!=wb.SheetNames.length&&!(!sheets[i]||!sheets[i].Hidden);++i);i==wb.SheetNames.length&&(i=0),o[o.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',o[o.length]="</bookViews>"}for(o[o.length]="<sheets>",i=0;i!=wb.SheetNames.length;++i){var sht={name:escapexml(wb.SheetNames[i].slice(0,31))};if(sht.sheetId=""+(i+1),sht["r:id"]="rId"+(i+1),sheets[i])switch(sheets[i].Hidden){case 1:sht.state="hidden";break;case 2:sht.state="veryHidden";break}o[o.length]=writextag("sheet",null,sht)}return o[o.length]="</sheets>",write_names&&(o[o.length]="<definedNames>",wb.Workbook&&wb.Workbook.Names&&wb.Workbook.Names.forEach(function(n){var d={name:n.Name};n.Comment&&(d.comment=n.Comment),n.Sheet!=null&&(d.localSheetId=""+n.Sheet),n.Hidden&&(d.hidden="1"),n.Ref&&(o[o.length]=writextag("definedName",escapexml(n.Ref),d))}),o[o.length]="</definedNames>"),o.length>2&&(o[o.length]="</workbook>",o[1]=o[1].replace("/>",">")),o.join("")}function parse_BrtBundleSh(data,length){var z={};return z.Hidden=data.read_shift(4),z.iTabID=data.read_shift(4),z.strRelID=parse_RelID(data,length-8),z.name=parse_XLWideString(data),z}function write_BrtBundleSh(data,o){return o||(o=new_buf(127)),o.write_shift(4,data.Hidden),o.write_shift(4,data.iTabID),write_RelID(data.strRelID,o),write_XLWideString(data.name.slice(0,31),o),o.length>o.l?o.slice(0,o.l):o}function parse_BrtWbProp(data,length){var o={},flags=data.read_shift(4);o.defaultThemeVersion=data.read_shift(4);var strName=length>8?parse_XLWideString(data):"";return strName.length>0&&(o.CodeName=strName),o.autoCompressPictures=!!(flags&65536),o.backupFile=!!(flags&64),o.checkCompatibility=!!(flags&4096),o.date1904=!!(flags&1),o.filterPrivacy=!!(flags&8),o.hidePivotFieldList=!!(flags&1024),o.promptedSolutions=!!(flags&16),o.publishItems=!!(flags&2048),o.refreshAllConnections=!!(flags&262144),o.saveExternalLinkValues=!!(flags&128),o.showBorderUnselectedTables=!!(flags&4),o.showInkAnnotation=!!(flags&32),o.showObjects=["all","placeholders","none"][flags>>13&3],o.showPivotChartFilter=!!(flags&32768),o.updateLinks=["userSet","never","always"][flags>>8&3],o}function write_BrtWbProp(data,o){o||(o=new_buf(72));var flags=0;return data&&(data.date1904&&(flags|=1),data.filterPrivacy&&(flags|=8)),o.write_shift(4,flags),o.write_shift(4,0),write_XLSBCodeName(data&&data.CodeName||"ThisWorkbook",o),o.slice(0,o.l)}function parse_BrtName(data,length,opts){var end2=data.l+length,flags=data.read_shift(4);data.l+=1;var itab=data.read_shift(4),name=parse_XLNameWideString(data),formula,comment="";try{formula=parse_XLSBNameParsedFormula(data,0,opts);try{comment=parse_XLNullableWideString(data)}catch{}}catch{console.error("Could not parse defined name "+name)}flags&32&&(name="_xlnm."+name),data.l=end2;var out={Name:name,Ptg:formula,Flags:flags};return itab<268435455&&(out.Sheet=itab),comment&&(out.Comment=comment),out}function write_BrtName(name,wb){var o=new_buf(9),flags=0,dname=name.Name;XLSLblBuiltIn.indexOf(dname)>-1&&(flags|=32,dname=dname.slice(6)),o.write_shift(4,flags),o.write_shift(1,0),o.write_shift(4,name.Sheet==null?4294967295:name.Sheet);var arr=[o,write_XLWideString(dname),write_XLSBNameParsedFormula(name.Ref,wb)];if(name.Comment)arr.push(write_XLNullableWideString(name.Comment));else{var x=new_buf(4);x.write_shift(4,4294967295),arr.push(x)}return bconcat(arr)}function write_BUNDLESHS(ba,wb){write_record(ba,143);for(var idx=0;idx!=wb.SheetNames.length;++idx){var viz=wb.Workbook&&wb.Workbook.Sheets&&wb.Workbook.Sheets[idx]&&wb.Workbook.Sheets[idx].Hidden||0,d={Hidden:viz,iTabID:idx+1,strRelID:"rId"+(idx+1),name:wb.SheetNames[idx]};write_record(ba,156,write_BrtBundleSh(d))}write_record(ba,144)}function write_BrtFileVersion(data,o){o||(o=new_buf(127));for(var i=0;i!=4;++i)o.write_shift(4,0);return write_XLWideString("SheetJS",o),write_XLWideString(XLSX.version,o),write_XLWideString(XLSX.version,o),write_XLWideString("7262",o),o.length>o.l?o.slice(0,o.l):o}function write_BrtBookView(idx,o){o||(o=new_buf(29)),o.write_shift(-4,0),o.write_shift(-4,460),o.write_shift(4,28800),o.write_shift(4,17600),o.write_shift(4,500),o.write_shift(4,idx),o.write_shift(4,idx);var flags=120;return o.write_shift(1,flags),o.length>o.l?o.slice(0,o.l):o}function write_BOOKVIEWS(ba,wb){if(!(!wb.Workbook||!wb.Workbook.Sheets)){for(var sheets=wb.Workbook.Sheets,i=0,vistab=-1,hidden=-1;i<sheets.length;++i)!sheets[i]||!sheets[i].Hidden&&vistab==-1?vistab=i:sheets[i].Hidden==1&&hidden==-1&&(hidden=i);hidden>vistab||(write_record(ba,135),write_record(ba,158,write_BrtBookView(vistab)),write_record(ba,136))}}function write_BRTNAMES(ba,wb){!wb.Workbook||!wb.Workbook.Names||wb.Workbook.Names.forEach(function(name){try{if(name.Flags&14)return;write_record(ba,39,write_BrtName(name,wb))}catch{console.error("Could not serialize defined name "+JSON.stringify(name))}})}function write_SELF_EXTERNS_xlsb(wb){var L=wb.SheetNames.length,o=new_buf(12*L+28);o.write_shift(4,L+2),o.write_shift(4,0),o.write_shift(4,-2),o.write_shift(4,-2),o.write_shift(4,0),o.write_shift(4,-1),o.write_shift(4,-1);for(var i=0;i<L;++i)o.write_shift(4,0),o.write_shift(4,i),o.write_shift(4,i);return o}function write_EXTERNALS_xlsb(ba,wb){write_record(ba,353),write_record(ba,357),write_record(ba,362,write_SELF_EXTERNS_xlsb(wb,0)),write_record(ba,354)}function write_wb_bin(wb,opts){var ba=buf_array();return write_record(ba,131),write_record(ba,128,write_BrtFileVersion()),write_record(ba,153,write_BrtWbProp(wb.Workbook&&wb.Workbook.WBProps||null)),write_BOOKVIEWS(ba,wb,opts),write_BUNDLESHS(ba,wb,opts),write_EXTERNALS_xlsb(ba,wb),(wb.Workbook||{}).Names&&write_BRTNAMES(ba,wb),write_record(ba,132),ba.end()}function write_props_xlml(wb,opts){var o=[];return wb.Props&&o.push(xlml_write_docprops(wb.Props,opts)),wb.Custprops&&o.push(xlml_write_custprops(wb.Props,wb.Custprops,opts)),o.join("")}function write_wb_xlml(wb){return(((wb||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function write_sty_xlml(wb,opts){var styles=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return opts.cellXfs.forEach(function(xf,id){var payload=[];payload.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[xf.numFmtId])}));var o={"ss:ID":"s"+(21+id)};styles.push(writextag("Style",payload.join(""),o))}),writextag("Styles",styles.join(""))}function write_name_xlml(n){return writextag("NamedRange",null,{"ss:Name":n.Name.slice(0,6)=="_xlnm."?n.Name.slice(6):n.Name,"ss:RefersTo":"="+a1_to_rc(n.Ref,{r:0,c:0})})}function write_names_xlml(wb){if(!((wb||{}).Workbook||{}).Names)return"";for(var names=wb.Workbook.Names,out=[],i=0;i<names.length;++i){var n=names[i];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||out.push(write_name_xlml(n)))}return writextag("Names",out.join(""))}function write_ws_xlml_names(ws,opts,idx,wb){if(!ws||!((wb||{}).Workbook||{}).Names)return"";for(var names=wb.Workbook.Names,out=[],i=0;i<names.length;++i){var n=names[i];n.Sheet==idx&&(n.Name.match(/^_xlfn\./)||out.push(write_name_xlml(n)))}return out.join("")}function write_ws_xlml_wsopts(ws,opts,idx,wb){if(!ws)return"";var o=[];if(ws["!margins"]&&(o.push("<PageSetup>"),ws["!margins"].header&&o.push(writextag("Header",null,{"x:Margin":ws["!margins"].header})),ws["!margins"].footer&&o.push(writextag("Footer",null,{"x:Margin":ws["!margins"].footer})),o.push(writextag("PageMargins",null,{"x:Bottom":ws["!margins"].bottom||"0.75","x:Left":ws["!margins"].left||"0.7","x:Right":ws["!margins"].right||"0.7","x:Top":ws["!margins"].top||"0.75"})),o.push("</PageSetup>")),wb&&wb.Workbook&&wb.Workbook.Sheets&&wb.Workbook.Sheets[idx])if(wb.Workbook.Sheets[idx].Hidden)o.push(writextag("Visible",wb.Workbook.Sheets[idx].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<idx&&!(wb.Workbook.Sheets[i]&&!wb.Workbook.Sheets[i].Hidden);++i);i==idx&&o.push("<Selected/>")}return((((wb||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),ws["!protect"]&&(o.push(writetag("ProtectContents","True")),ws["!protect"].objects&&o.push(writetag("ProtectObjects","True")),ws["!protect"].scenarios&&o.push(writetag("ProtectScenarios","True")),ws["!protect"].selectLockedCells!=null&&!ws["!protect"].selectLockedCells?o.push(writetag("EnableSelection","NoSelection")):ws["!protect"].selectUnlockedCells!=null&&!ws["!protect"].selectUnlockedCells&&o.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(x){ws["!protect"][x[0]]&&o.push("<"+x[1]+"/>")})),o.length==0?"":writextag("WorksheetOptions",o.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(comments){return comments.map(function(c){var t=xlml_unfixstr(c.t||""),d=writextag("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"}),p={};return c.a&&(p["ss:Author"]=c.a),comments.hidden||(p["ss:ShowAlways"]="1"),writextag("Comment",d,p)}).join("")}function write_ws_xlml_cell(cell,ref,ws,opts,idx,wb,addr){if(!cell||cell.v==null&&cell.f==null)return"";var attr={};if(cell.f&&(attr["ss:Formula"]="="+escapexml(a1_to_rc(cell.f,addr))),cell.F&&cell.F.slice(0,ref.length)==ref){var end2=decode_cell(cell.F.slice(ref.length+1));attr["ss:ArrayRange"]="RC:R"+(end2.r==addr.r?"":"["+(end2.r-addr.r)+"]")+"C"+(end2.c==addr.c?"":"["+(end2.c-addr.c)+"]")}if(cell.l&&cell.l.Target&&(attr["ss:HRef"]=escapexml(cell.l.Target),cell.l.Tooltip&&(attr["x:HRefScreenTip"]=escapexml(cell.l.Tooltip))),ws["!merges"])for(var marr=ws["!merges"],mi=0;mi!=marr.length;++mi)marr[mi].s.c!=addr.c||marr[mi].s.r!=addr.r||(marr[mi].e.c>marr[mi].s.c&&(attr["ss:MergeAcross"]=marr[mi].e.c-marr[mi].s.c),marr[mi].e.r>marr[mi].s.r&&(attr["ss:MergeDown"]=marr[mi].e.r-marr[mi].s.r));var t="",p="";switch(cell.t){case"z":if(!opts.sheetStubs)return"";break;case"n":t="Number",p=String(cell.v);break;case"b":t="Boolean",p=cell.v?"1":"0";break;case"e":t="Error",p=BErr[cell.v];break;case"d":t="DateTime",p=new Date(cell.v).toISOString(),cell.z==null&&(cell.z=cell.z||table_fmt[14]);break;case"s":t="String",p=escapexlml(cell.v||"");break}var os=get_cell_style(opts.cellXfs,cell,opts);attr["ss:StyleID"]="s"+(21+os),attr["ss:Index"]=addr.c+1;var _v=cell.v!=null?p:"",m=cell.t=="z"?"":'<Data ss:Type="'+t+'">'+_v+"</Data>";return(cell.c||[]).length>0&&(m+=write_ws_xlml_comment(cell.c)),writextag("Cell",m,attr)}function write_ws_xlml_row(R,row){var o='<Row ss:Index="'+(R+1)+'"';return row&&(row.hpt&&!row.hpx&&(row.hpx=pt2px(row.hpt)),row.hpx&&(o+=' ss:AutoFitHeight="0" ss:Height="'+row.hpx+'"'),row.hidden&&(o+=' ss:Hidden="1"')),o+">"}function write_ws_xlml_table(ws,opts,idx,wb){if(!ws["!ref"])return"";var range=safe_decode_range(ws["!ref"]),marr=ws["!merges"]||[],mi=0,o=[];ws["!cols"]&&ws["!cols"].forEach(function(n,i){process_col(n);var w=!!n.width,p=col_obj_w(i,n),k={"ss:Index":i+1};w&&(k["ss:Width"]=width2px(p.width)),n.hidden&&(k["ss:Hidden"]="1"),o.push(writextag("Column",null,k))});for(var dense=ws["!data"]!=null,R=range.s.r;R<=range.e.r;++R){for(var row=[write_ws_xlml_row(R,(ws["!rows"]||[])[R])],C=range.s.c;C<=range.e.c;++C){var skip=!1;for(mi=0;mi!=marr.length;++mi)if(!(marr[mi].s.c>C)&&!(marr[mi].s.r>R)&&!(marr[mi].e.c<C)&&!(marr[mi].e.r<R)){(marr[mi].s.c!=C||marr[mi].s.r!=R)&&(skip=!0);break}if(!skip){var addr={r:R,c:C},ref=encode_col(C)+encode_row(R),cell=dense?(ws["!data"][R]||[])[C]:ws[ref];row.push(write_ws_xlml_cell(cell,ref,ws,opts,idx,wb,addr))}}row.push("</Row>"),row.length>2&&o.push(row.join(""))}return o.join("")}function write_ws_xlml(idx,opts,wb){var o=[],s=wb.SheetNames[idx],ws=wb.Sheets[s],t=ws?write_ws_xlml_names(ws,opts,idx,wb):"";return t.length>0&&o.push("<Names>"+t+"</Names>"),t=ws?write_ws_xlml_table(ws,opts,idx,wb):"",t.length>0&&o.push("<Table>"+t+"</Table>"),o.push(write_ws_xlml_wsopts(ws,opts,idx,wb)),ws["!autofilter"]&&o.push('<AutoFilter x:Range="'+a1_to_rc(fix_range(ws["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),o.join("")}function write_xlml(wb,opts){opts||(opts={}),wb.SSF||(wb.SSF=dup(table_fmt)),wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),opts.revssf=evert_num(wb.SSF),opts.revssf[wb.SSF[65535]]=0,opts.ssf=wb.SSF,opts.cellXfs=[],get_cell_style(opts.cellXfs,{},{revssf:{General:0}}));var d=[];d.push(write_props_xlml(wb,opts)),d.push(write_wb_xlml(wb,opts)),d.push(""),d.push("");for(var i=0;i<wb.SheetNames.length;++i)d.push(writextag("Worksheet",write_ws_xlml(i,opts,wb),{"ss:Name":escapexml(wb.SheetNames[i])}));return d[2]=write_sty_xlml(wb,opts),d[3]=write_names_xlml(wb,opts),XML_HEADER+writextag("Workbook",d.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function write_xls_props(wb,cfb){var DSEntries=[],SEntries=[],CEntries=[],i=0,Keys,DocSummaryRE=evert_key(DocSummaryPIDDSI,"n"),SummaryRE=evert_key(SummaryPIDSI,"n");if(wb.Props)for(Keys=keys(wb.Props),i=0;i<Keys.length;++i)(Object.prototype.hasOwnProperty.call(DocSummaryRE,Keys[i])?DSEntries:Object.prototype.hasOwnProperty.call(SummaryRE,Keys[i])?SEntries:CEntries).push([Keys[i],wb.Props[Keys[i]]]);if(wb.Custprops)for(Keys=keys(wb.Custprops),i=0;i<Keys.length;++i)Object.prototype.hasOwnProperty.call(wb.Props||{},Keys[i])||(Object.prototype.hasOwnProperty.call(DocSummaryRE,Keys[i])?DSEntries:Object.prototype.hasOwnProperty.call(SummaryRE,Keys[i])?SEntries:CEntries).push([Keys[i],wb.Custprops[Keys[i]]]);var CEntries2=[];for(i=0;i<CEntries.length;++i)XLSPSSkip.indexOf(CEntries[i][0])>-1||PseudoPropsPairs.indexOf(CEntries[i][0])>-1||CEntries[i][1]!=null&&CEntries2.push(CEntries[i]);SEntries.length&&CFB.utils.cfb_add(cfb,"/SummaryInformation",write_PropertySetStream(SEntries,PSCLSID.SI,SummaryRE,SummaryPIDSI)),(DSEntries.length||CEntries2.length)&&CFB.utils.cfb_add(cfb,"/DocumentSummaryInformation",write_PropertySetStream(DSEntries,PSCLSID.DSI,DocSummaryRE,DocSummaryPIDDSI,CEntries2.length?CEntries2:null,PSCLSID.UDI))}function write_xlscfb(wb,opts){var o=opts||{},cfb=CFB.utils.cfb_new({root:"R"}),wbpath="/Workbook";switch(o.bookType||"xls"){case"xls":o.bookType="biff8";case"xla":o.bookType||(o.bookType="xla");case"biff8":wbpath="/Workbook",o.biff=8;break;case"biff5":wbpath="/Book",o.biff=5;break;default:throw new Error("invalid type "+o.bookType+" for XLS CFB")}return CFB.utils.cfb_add(cfb,wbpath,write_biff_buf(wb,o)),o.biff==8&&(wb.Props||wb.Custprops)&&write_xls_props(wb,cfb),o.biff==8&&wb.vbaraw&&fill_vba_xls(cfb,CFB.read(wb.vbaraw,{type:typeof wb.vbaraw=="string"?"binary":"buffer"})),cfb}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{f:parse_XLNullableWideString},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function write_biff_rec(ba,type,payload,length){var t=type;if(!isNaN(t)){var len=length||(payload||[]).length||0,o=ba.next(4);o.write_shift(2,t),o.write_shift(2,len),len>0&&is_buf(payload)&&ba.push(payload)}}function write_biff_continue(ba,type,payload,length){var len=length||(payload||[]).length||0;if(len<=8224)return write_biff_rec(ba,type,payload,len);var t=type;if(!isNaN(t)){for(var parts=payload.parts||[],sidx=0,i=0,w=0;w+(parts[sidx]||8224)<=8224;)w+=parts[sidx]||8224,sidx++;var o=ba.next(4);for(o.write_shift(2,t),o.write_shift(2,w),ba.push(payload.slice(i,i+w)),i+=w;i<len;){for(o=ba.next(4),o.write_shift(2,60),w=0;w+(parts[sidx]||8224)<=8224;)w+=parts[sidx]||8224,sidx++;o.write_shift(2,w),ba.push(payload.slice(i,i+w)),i+=w}}}function write_BIFF2BERR(r,c,val,t){var out=new_buf(9);return write_BIFF2Cell(out,r,c),write_Bes(val,t||"b",out),out}function write_BIFF2LABEL(r,c,val){var out=new_buf(8+2*val.length);return write_BIFF2Cell(out,r,c),out.write_shift(1,val.length),out.write_shift(val.length,val,"sbcs"),out.l<out.length?out.slice(0,out.l):out}function write_comments_biff2(ba,comments){comments.forEach(function(data){var text=data[0].map(function(cc){return cc.t}).join("");if(text.length<=2048)return write_biff_rec(ba,28,write_NOTE_BIFF2(text,data[1],data[2]));write_biff_rec(ba,28,write_NOTE_BIFF2(text.slice(0,2048),data[1],data[2],text.length));for(var i=2048;i<text.length;i+=2048)write_biff_rec(ba,28,write_NOTE_BIFF2(text.slice(i,Math.min(i+2048,text.length)),-1,-1,Math.min(2048,text.length-i)))})}function write_ws_biff2_cell(ba,cell,R,C,opts,date1904){var ifmt=0;cell.z!=null&&(ifmt=opts._BIFF2FmtTable.indexOf(cell.z),ifmt==-1&&(opts._BIFF2FmtTable.push(cell.z),ifmt=opts._BIFF2FmtTable.length-1));var ixfe=0;if(cell.z!=null){for(;ixfe<opts.cellXfs.length&&opts.cellXfs[ixfe].numFmtId!=ifmt;++ixfe);ixfe==opts.cellXfs.length&&opts.cellXfs.push({numFmtId:ifmt})}if(cell.v!=null)switch(cell.t){case"d":case"n":var v=cell.t=="d"?datenum(parseDate(cell.v,date1904),date1904):cell.v;opts.biff==2&&v==(v|0)&&v>=0&&v<65536?write_biff_rec(ba,2,write_BIFF2INT(R,C,v,ixfe,ifmt)):isNaN(v)?write_biff_rec(ba,5,write_BIFF2BERR(R,C,36,"e")):isFinite(v)?write_biff_rec(ba,3,write_BIFF2NUM(R,C,v,ixfe,ifmt)):write_biff_rec(ba,5,write_BIFF2BERR(R,C,7,"e"));return;case"b":case"e":write_biff_rec(ba,5,write_BIFF2BERR(R,C,cell.v,cell.t));return;case"s":case"str":write_biff_rec(ba,4,write_BIFF2LABEL(R,C,cell.v==null?"":String(cell.v).slice(0,255)));return}write_biff_rec(ba,1,write_BIFF2Cell(null,R,C))}function write_ws_biff2(ba,ws,idx,opts,wb){var dense=ws["!data"]!=null,range=safe_decode_range(ws["!ref"]||"A1"),rr="",cols=[];if(range.e.c>255||range.e.r>16383){if(opts.WTF)throw new Error("Range "+(ws["!ref"]||"A1")+" exceeds format limit A1:IV16384");range.e.c=Math.min(range.e.c,255),range.e.r=Math.min(range.e.c,16383)}for(var date1904=(((wb||{}).Workbook||{}).WBProps||{}).date1904,row=[],comments=[],C=range.s.c;C<=range.e.c;++C)cols[C]=encode_col(C);for(var R=range.s.r;R<=range.e.r;++R)for(dense&&(row=ws["!data"][R]||[]),rr=encode_row(R),C=range.s.c;C<=range.e.c;++C){var cell=dense?row[C]:ws[cols[C]+rr];cell&&(write_ws_biff2_cell(ba,cell,R,C,opts,date1904),cell.c&&comments.push([cell.c,R,C]))}write_comments_biff2(ba,comments)}function write_biff2_buf(wb,opts){for(var o=opts||{},ba=buf_array(),idx=0,i=0;i<wb.SheetNames.length;++i)wb.SheetNames[i]==o.sheet&&(idx=i);if(idx==0&&o.sheet&&wb.SheetNames[0]!=o.sheet)throw new Error("Sheet not found: "+o.sheet);write_biff_rec(ba,o.biff==4?1033:o.biff==3?521:9,write_BOF(wb,16,o)),((wb.Workbook||{}).WBProps||{}).date1904&&write_biff_rec(ba,34,writebool(!0)),o.cellXfs=[{numFmtId:0}],o._BIFF2FmtTable=["General"],o._Fonts=[];var body=buf_array();return write_ws_biff2(body,wb.Sheets[wb.SheetNames[idx]],idx,o,wb),o._BIFF2FmtTable.forEach(function(f){o.biff<=3?write_biff_rec(ba,30,write_BIFF2Format(f)):write_biff_rec(ba,1054,write_BIFF4Format(f))}),o.cellXfs.forEach(function(xf){switch(o.biff){case 2:write_biff_rec(ba,67,write_BIFF2XF(xf));break;case 3:write_biff_rec(ba,579,write_BIFF3XF(xf));break;case 4:write_biff_rec(ba,1091,write_BIFF4XF(xf));break}}),delete o._BIFF2FmtTable,delete o.cellXfs,delete o._Fonts,ba.push(body.end()),write_biff_rec(ba,10),ba.end()}var b8oid=1,b8ocnts=[];function write_MsoDrawingGroup(){var buf=new_buf(82+8*b8ocnts.length);buf.write_shift(2,15),buf.write_shift(2,61440),buf.write_shift(4,74+8*b8ocnts.length);{buf.write_shift(2,0),buf.write_shift(2,61446),buf.write_shift(4,16+8*b8ocnts.length);{buf.write_shift(4,b8oid),buf.write_shift(4,b8ocnts.length+1);for(var acc=0,i=0;i<b8ocnts.length;++i)acc+=b8ocnts[i]&&b8ocnts[i][1]||0;buf.write_shift(4,acc),buf.write_shift(4,b8ocnts.length)}b8ocnts.forEach(function(b8){buf.write_shift(4,b8[0]),buf.write_shift(4,b8[2])})}return buf.write_shift(2,51),buf.write_shift(2,61451),buf.write_shift(4,18),buf.write_shift(2,191),buf.write_shift(4,524296),buf.write_shift(2,385),buf.write_shift(4,134217793),buf.write_shift(2,448),buf.write_shift(4,134217792),buf.write_shift(2,64),buf.write_shift(2,61726),buf.write_shift(4,16),buf.write_shift(4,134217741),buf.write_shift(4,134217740),buf.write_shift(4,134217751),buf.write_shift(4,268435703),buf}function write_comments_biff8(ba,comments){var notes=[],sz=0,pl=buf_array(),baseid=b8oid,_oasc;comments.forEach(function(c,ci){var author="",text=c[0].map(function(t){return t.a&&!author&&(author=t.a),t.t}).join("");++b8oid;{var oasc=new_buf(150);oasc.write_shift(2,15),oasc.write_shift(2,61444),oasc.write_shift(4,150),oasc.write_shift(2,3234),oasc.write_shift(2,61450),oasc.write_shift(4,8),oasc.write_shift(4,b8oid),oasc.write_shift(4,2560),oasc.write_shift(2,227),oasc.write_shift(2,61451),oasc.write_shift(4,84),oasc.write_shift(2,128),oasc.write_shift(4,0),oasc.write_shift(2,139),oasc.write_shift(4,2),oasc.write_shift(2,191),oasc.write_shift(4,524296),oasc.write_shift(2,344),oasc.l+=4,oasc.write_shift(2,385),oasc.write_shift(4,134217808),oasc.write_shift(2,387),oasc.write_shift(4,134217808),oasc.write_shift(2,389),oasc.write_shift(4,268435700),oasc.write_shift(2,447),oasc.write_shift(4,1048592),oasc.write_shift(2,448),oasc.write_shift(4,134217809),oasc.write_shift(2,451),oasc.write_shift(4,268435700),oasc.write_shift(2,513),oasc.write_shift(4,134217809),oasc.write_shift(2,515),oasc.write_shift(4,268435700),oasc.write_shift(2,575),oasc.write_shift(4,196609),oasc.write_shift(2,959),oasc.write_shift(4,131072|(c[0].hidden?2:0)),oasc.l+=2,oasc.write_shift(2,61456),oasc.write_shift(4,18),oasc.write_shift(2,3),oasc.write_shift(2,c[2]+2),oasc.l+=2,oasc.write_shift(2,c[1]+1),oasc.l+=2,oasc.write_shift(2,c[2]+4),oasc.l+=2,oasc.write_shift(2,c[1]+5),oasc.l+=2,oasc.l+=2,oasc.write_shift(2,61457),oasc.l+=4,oasc.l=150,ci==0?_oasc=oasc:write_biff_rec(pl,236,oasc)}sz+=150;{var obj=new_buf(52);obj.write_shift(2,21),obj.write_shift(2,18),obj.write_shift(2,25),obj.write_shift(2,b8oid),obj.write_shift(2,0),obj.l=22,obj.write_shift(2,13),obj.write_shift(2,22),obj.write_shift(4,1651663474),obj.write_shift(4,2503426821),obj.write_shift(4,2150634280),obj.write_shift(4,1768515844+b8oid*256),obj.write_shift(2,0),obj.write_shift(4,0),obj.l+=4,write_biff_rec(pl,93,obj)}{var oact=new_buf(8);oact.l+=2,oact.write_shift(2,61453),oact.l+=4,write_biff_rec(pl,236,oact)}sz+=8;{var txo=new_buf(18);txo.write_shift(2,18),txo.l+=8,txo.write_shift(2,text.length),txo.write_shift(2,16),txo.l+=4,write_biff_rec(pl,438,txo);{var cont=new_buf(1+text.length);cont.write_shift(1,0),cont.write_shift(text.length,text,"sbcs"),write_biff_rec(pl,60,cont)}{var conf=new_buf(16);conf.l+=8,conf.write_shift(2,text.length),conf.l+=6,write_biff_rec(pl,60,conf)}}{var notesh=new_buf(12+author.length);notesh.write_shift(2,c[1]),notesh.write_shift(2,c[2]),notesh.write_shift(2,0|(c[0].hidden?0:2)),notesh.write_shift(2,b8oid),notesh.write_shift(2,author.length),notesh.write_shift(1,0),notesh.write_shift(author.length,author,"sbcs"),notesh.l++,notes.push(notesh)}});{var hdr=new_buf(80);hdr.write_shift(2,15),hdr.write_shift(2,61442),hdr.write_shift(4,sz+hdr.length-8),hdr.write_shift(2,16),hdr.write_shift(2,61448),hdr.write_shift(4,8),hdr.write_shift(4,comments.length+1),hdr.write_shift(4,b8oid),hdr.write_shift(2,15),hdr.write_shift(2,61443),hdr.write_shift(4,sz+48),hdr.write_shift(2,15),hdr.write_shift(2,61444),hdr.write_shift(4,40),hdr.write_shift(2,1),hdr.write_shift(2,61449),hdr.write_shift(4,16),hdr.l+=16,hdr.write_shift(2,2),hdr.write_shift(2,61450),hdr.write_shift(4,8),hdr.write_shift(4,baseid),hdr.write_shift(4,5),write_biff_rec(ba,236,_oasc?bconcat([hdr,_oasc]):hdr)}ba.push(pl.end()),notes.forEach(function(n){write_biff_rec(ba,28,n)}),b8ocnts.push([baseid,comments.length+1,b8oid]),++b8oid}function write_FONTS_biff8(ba,data,opts){write_biff_rec(ba,49,write_Font({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},opts))}function write_FMTS_biff8(ba,NF,opts){NF&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)NF[i]!=null&&write_biff_rec(ba,1054,write_Format(i,NF[i],opts))})}function write_FEAT(ba,ws){var o=new_buf(19);o.write_shift(4,2151),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(2,3),o.write_shift(1,1),o.write_shift(4,0),write_biff_rec(ba,2151,o),o=new_buf(39),o.write_shift(4,2152),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(2,3),o.write_shift(1,0),o.write_shift(4,0),o.write_shift(2,1),o.write_shift(4,4),o.write_shift(2,0),write_Ref8U(safe_decode_range(ws["!ref"]||"A1"),o),o.write_shift(4,4),write_biff_rec(ba,2152,o)}function write_CELLXFS_biff8(ba,opts){for(var i=0;i<16;++i)write_biff_rec(ba,224,write_XF({numFmtId:0,style:!0},0,opts));opts.cellXfs.forEach(function(c){write_biff_rec(ba,224,write_XF(c,0,opts))})}function write_ws_biff8_hlinks(ba,ws){for(var R=0;R<ws["!links"].length;++R){var HL=ws["!links"][R];write_biff_rec(ba,440,write_HLink(HL)),HL[1].Tooltip&&write_biff_rec(ba,2048,write_HLinkTooltip(HL))}delete ws["!links"]}function write_ws_cols_biff8(ba,cols){if(cols){var cnt=0;cols.forEach(function(col,idx){++cnt<=256&&col&&write_biff_rec(ba,125,write_ColInfo(col_obj_w(idx,col),idx))})}}function write_ws_biff8_cell(ba,cell,R,C,opts,date1904){var os=16+get_cell_style(opts.cellXfs,cell,opts);if(cell.v==null&&!cell.bf){write_biff_rec(ba,513,write_XLSCell(R,C,os));return}if(cell.bf)write_biff_rec(ba,6,write_Formula(cell,R,C,opts,os));else switch(cell.t){case"d":case"n":var v=cell.t=="d"?datenum(parseDate(cell.v,date1904),date1904):cell.v;isNaN(v)?write_biff_rec(ba,517,write_BoolErr(R,C,36,os,opts,"e")):isFinite(v)?write_biff_rec(ba,515,write_Number(R,C,v,os,opts)):write_biff_rec(ba,517,write_BoolErr(R,C,7,os,opts,"e"));break;case"b":case"e":write_biff_rec(ba,517,write_BoolErr(R,C,cell.v,os,opts,cell.t));break;case"s":case"str":if(opts.bookSST){var isst=get_sst_id(opts.Strings,cell.v==null?"":String(cell.v),opts.revStrings);write_biff_rec(ba,253,write_LabelSst(R,C,isst,os,opts))}else write_biff_rec(ba,516,write_Label(R,C,(cell.v==null?"":String(cell.v)).slice(0,255),os,opts));break;default:write_biff_rec(ba,513,write_XLSCell(R,C,os))}}function write_ws_biff8(idx,opts,wb){var ba=buf_array(),s=wb.SheetNames[idx],ws=wb.Sheets[s]||{},_WB=(wb||{}).Workbook||{},_sheet=(_WB.Sheets||[])[idx]||{},dense=ws["!data"]!=null,b8=opts.biff==8,ref,rr="",cols=[],range=safe_decode_range(ws["!ref"]||"A1"),MAX_ROWS=b8?65536:16384;if(range.e.c>255||range.e.r>=MAX_ROWS){if(opts.WTF)throw new Error("Range "+(ws["!ref"]||"A1")+" exceeds format limit A1:IV16384");range.e.c=Math.min(range.e.c,255),range.e.r=Math.min(range.e.c,MAX_ROWS-1)}write_biff_rec(ba,2057,write_BOF(wb,16,opts)),write_biff_rec(ba,13,writeuint16(1)),write_biff_rec(ba,12,writeuint16(100)),write_biff_rec(ba,15,writebool(!0)),write_biff_rec(ba,17,writebool(!1)),write_biff_rec(ba,16,write_Xnum(.001)),write_biff_rec(ba,95,writebool(!0)),write_biff_rec(ba,42,writebool(!1)),write_biff_rec(ba,43,writebool(!1)),write_biff_rec(ba,130,writeuint16(1)),write_biff_rec(ba,128,write_Guts([0,0])),write_biff_rec(ba,131,writebool(!1)),write_biff_rec(ba,132,writebool(!1)),b8&&write_ws_cols_biff8(ba,ws["!cols"]),write_biff_rec(ba,512,write_Dimensions(range,opts));var date1904=(((wb||{}).Workbook||{}).WBProps||{}).date1904;b8&&(ws["!links"]=[]);for(var C=range.s.c;C<=range.e.c;++C)cols[C]=encode_col(C);for(var comments=[],row=[],R=range.s.r;R<=range.e.r;++R)for(dense&&(row=ws["!data"][R]||[]),rr=encode_row(R),C=range.s.c;C<=range.e.c;++C){ref=cols[C]+rr;var cell=dense?row[C]:ws[ref];cell&&(write_ws_biff8_cell(ba,cell,R,C,opts,date1904),b8&&cell.l&&ws["!links"].push([ref,cell.l]),cell.c&&comments.push([cell.c,R,C]))}var cname=_sheet.CodeName||_sheet.name||s;return b8?write_comments_biff8(ba,comments):write_comments_biff2(ba,comments),b8&&write_biff_rec(ba,574,write_Window2((_WB.Views||[])[0])),b8&&(ws["!merges"]||[]).length&&write_biff_rec(ba,229,write_MergeCells(ws["!merges"])),b8&&write_ws_biff8_hlinks(ba,ws),write_biff_rec(ba,442,write_XLUnicodeString(cname,opts)),b8&&write_FEAT(ba,ws),write_biff_rec(ba,10),ba.end()}function write_biff8_global(wb,bufs,opts){var A=buf_array(),_WB=(wb||{}).Workbook||{},_sheets=_WB.Sheets||[],_wb=_WB.WBProps||{},b8=opts.biff==8,b5=opts.biff==5;if(write_biff_rec(A,2057,write_BOF(wb,5,opts)),opts.bookType=="xla"&&write_biff_rec(A,135),write_biff_rec(A,225,b8?writeuint16(1200):null),write_biff_rec(A,193,writezeroes(2)),b5&&write_biff_rec(A,191),b5&&write_biff_rec(A,192),write_biff_rec(A,226),write_biff_rec(A,92,write_WriteAccess("SheetJS",opts)),write_biff_rec(A,66,writeuint16(b8?1200:1252)),b8&&write_biff_rec(A,353,writeuint16(0)),b8&&write_biff_rec(A,448),write_biff_rec(A,317,write_RRTabId(wb.SheetNames.length)),b8&&wb.vbaraw&&write_biff_rec(A,211),b8&&wb.vbaraw){var cname=_wb.CodeName||"ThisWorkbook";write_biff_rec(A,442,write_XLUnicodeString(cname,opts))}write_biff_rec(A,156,writeuint16(17)),write_biff_rec(A,25,writebool(!1)),write_biff_rec(A,18,writebool(!1)),write_biff_rec(A,19,writeuint16(0)),b8&&write_biff_rec(A,431,writebool(!1)),b8&&write_biff_rec(A,444,writeuint16(0)),write_biff_rec(A,61,write_Window1(opts)),write_biff_rec(A,64,writebool(!1)),write_biff_rec(A,141,writeuint16(0)),write_biff_rec(A,34,writebool(safe1904(wb)=="true")),write_biff_rec(A,14,writebool(!0)),b8&&write_biff_rec(A,439,writebool(!1)),write_biff_rec(A,218,writeuint16(0)),write_FONTS_biff8(A,wb,opts),write_FMTS_biff8(A,wb.SSF,opts),write_CELLXFS_biff8(A,opts),b8&&write_biff_rec(A,352,writebool(!1));var a=A.end(),C=buf_array();b8&&write_biff_rec(C,140,write_Country()),b8&&b8ocnts.length&&write_biff_rec(C,235,write_MsoDrawingGroup()),b8&&opts.Strings&&write_biff_continue(C,252,write_SST(opts.Strings,opts)),write_biff_rec(C,10);var c=C.end(),B=buf_array(),blen=0,j=0;for(j=0;j<wb.SheetNames.length;++j)blen+=(b8?12:11)+(b8?2:1)*wb.SheetNames[j].length;var start2=a.length+blen+c.length;for(j=0;j<wb.SheetNames.length;++j){var _sheet=_sheets[j]||{};write_biff_rec(B,133,write_BoundSheet8({pos:start2,hs:_sheet.Hidden||0,dt:0,name:wb.SheetNames[j]},opts)),start2+=bufs[j].length}var b=B.end();if(blen!=b.length)throw new Error("BS8 "+blen+" != "+b.length);var out=[];return a.length&&out.push(a),b.length&&out.push(b),c.length&&out.push(c),bconcat(out)}function write_biff8_buf(wb,opts){var o=opts||{},bufs=[];wb&&!wb.SSF&&(wb.SSF=dup(table_fmt)),wb&&wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),o.revssf=evert_num(wb.SSF),o.revssf[wb.SSF[65535]]=0,o.ssf=wb.SSF),b8oid=1,b8ocnts=[],o.Strings=[],o.Strings.Count=0,o.Strings.Unique=0,fix_write_opts(o),o.cellXfs=[],get_cell_style(o.cellXfs,{},{revssf:{General:0}}),wb.Props||(wb.Props={});for(var i=0;i<wb.SheetNames.length;++i)bufs[bufs.length]=write_ws_biff8(i,o,wb);return bufs.unshift(write_biff8_global(wb,bufs,o)),bconcat(bufs)}function write_biff_buf(wb,opts){for(var i=0;i<=wb.SheetNames.length;++i){var ws=wb.Sheets[wb.SheetNames[i]];if(!(!ws||!ws["!ref"])){var range=decode_range(ws["!ref"]);range.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+wb.SheetNames[i]+"' extends beyond column IV (255).  Data may be lost.")}}var o=opts||{};switch(o.biff||2){case 8:case 5:return write_biff8_buf(wb,opts);case 4:case 3:case 2:return write_biff2_buf(wb,opts)}throw new Error("invalid type "+o.bookType+" for BIFF")}function make_html_row(ws,r,R,o){for(var M=ws["!merges"]||[],oo=[],sp={},dense=ws["!data"]!=null,C=r.s.c;C<=r.e.c;++C){for(var RS=0,CS=0,j=0;j<M.length;++j)if(!(M[j].s.r>R||M[j].s.c>C)&&!(M[j].e.r<R||M[j].e.c<C)){if(M[j].s.r<R||M[j].s.c<C){RS=-1;break}RS=M[j].e.r-M[j].s.r+1,CS=M[j].e.c-M[j].s.c+1;break}if(!(RS<0)){var coord=encode_col(C)+encode_row(R),cell=dense?(ws["!data"][R]||[])[C]:ws[coord],w=cell&&cell.v!=null&&(cell.h||escapehtml(cell.w||(format_cell(cell),cell.w)||""))||"";sp={},RS>1&&(sp.rowspan=RS),CS>1&&(sp.colspan=CS),o.editable?w='<span contenteditable="true">'+w+"</span>":cell&&(sp["data-t"]=cell&&cell.t||"z",cell.v!=null&&(sp["data-v"]=escapehtml(cell.v instanceof Date?cell.v.toISOString():cell.v)),cell.z!=null&&(sp["data-z"]=cell.z),cell.l&&(cell.l.Target||"#").charAt(0)!="#"&&(w='<a href="'+escapehtml(cell.l.Target)+'">'+w+"</a>")),sp.id=(o.id||"sjs")+"-"+coord,oo.push(writextag("td",w,sp))}}var preamble="<tr>";return preamble+oo.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function make_html_preamble(ws,R,o){var out=[];return out.join("")+"<table"+(o&&o.id?' id="'+o.id+'"':"")+">"}function sheet_to_html(ws,opts){var o=opts||{},header=o.header!=null?o.header:HTML_BEGIN,footer=o.footer!=null?o.footer:HTML_END,out=[header],r=decode_range(ws["!ref"]||"A1");if(out.push(make_html_preamble(ws,r,o)),ws["!ref"])for(var R=r.s.r;R<=r.e.r;++R)out.push(make_html_row(ws,r,R,o));return out.push("</table>"+footer),out.join("")}function sheet_add_dom(ws,table,_opts){var rows=table.rows;if(!rows)throw"Unsupported origin when "+table.tagName+" is not a TABLE";var opts=_opts||{},dense=ws["!data"]!=null,or_R=0,or_C=0;if(opts.origin!=null)if(typeof opts.origin=="number")or_R=opts.origin;else{var _origin=typeof opts.origin=="string"?decode_cell(opts.origin):opts.origin;or_R=_origin.r,or_C=_origin.c}var sheetRows=Math.min(opts.sheetRows||1e7,rows.length),range={s:{r:0,c:0},e:{r:or_R,c:or_C}};if(ws["!ref"]){var _range=decode_range(ws["!ref"]);range.s.r=Math.min(range.s.r,_range.s.r),range.s.c=Math.min(range.s.c,_range.s.c),range.e.r=Math.max(range.e.r,_range.e.r),range.e.c=Math.max(range.e.c,_range.e.c),or_R==-1&&(range.e.r=or_R=_range.e.r+1)}var merges=[],midx=0,rowinfo=ws["!rows"]||(ws["!rows"]=[]),_R=0,R=0,_C=0,C=0,RS=0,CS=0;for(ws["!cols"]||(ws["!cols"]=[]);_R<rows.length&&R<sheetRows;++_R){var row=rows[_R];if(is_dom_element_hidden(row)){if(opts.display)continue;rowinfo[R]={hidden:!0}}var elts=row.cells;for(_C=C=0;_C<elts.length;++_C){var elt=elts[_C];if(!(opts.display&&is_dom_element_hidden(elt))){var v=elt.hasAttribute("data-v")?elt.getAttribute("data-v"):elt.hasAttribute("v")?elt.getAttribute("v"):htmldecode(elt.innerHTML),z=elt.getAttribute("data-z")||elt.getAttribute("z");for(midx=0;midx<merges.length;++midx){var m=merges[midx];m.s.c==C+or_C&&m.s.r<R+or_R&&R+or_R<=m.e.r&&(C=m.e.c+1-or_C,midx=-1)}CS=+elt.getAttribute("colspan")||1,((RS=+elt.getAttribute("rowspan")||1)>1||CS>1)&&merges.push({s:{r:R+or_R,c:C+or_C},e:{r:R+or_R+(RS||1)-1,c:C+or_C+(CS||1)-1}});var o={t:"s",v},_t=elt.getAttribute("data-t")||elt.getAttribute("t")||"";v!=null&&(v.length==0?o.t=_t||"z":opts.raw||v.trim().length==0||_t=="s"||(v==="TRUE"?o={t:"b",v:!0}:v==="FALSE"?o={t:"b",v:!1}:isNaN(fuzzynum(v))?isNaN(fuzzydate(v).getDate())||(o={t:"d",v:parseDate(v)},opts.UTC&&(o.v=local_to_utc(o.v)),opts.cellDates||(o={t:"n",v:datenum(o.v)}),o.z=opts.dateNF||table_fmt[14]):o={t:"n",v:fuzzynum(v)})),o.z===void 0&&z!=null&&(o.z=z);var l="",Aelts=elt.getElementsByTagName("A");if(Aelts&&Aelts.length)for(var Aelti=0;Aelti<Aelts.length&&!(Aelts[Aelti].hasAttribute("href")&&(l=Aelts[Aelti].getAttribute("href"),l.charAt(0)!="#"));++Aelti);l&&l.charAt(0)!="#"&&l.slice(0,11).toLowerCase()!="javascript:"&&(o.l={Target:l}),dense?(ws["!data"][R+or_R]||(ws["!data"][R+or_R]=[]),ws["!data"][R+or_R][C+or_C]=o):ws[encode_cell({c:C+or_C,r:R+or_R})]=o,range.e.c<C+or_C&&(range.e.c=C+or_C),C+=CS}}++R}return merges.length&&(ws["!merges"]=(ws["!merges"]||[]).concat(merges)),range.e.r=Math.max(range.e.r,R-1+or_R),ws["!ref"]=encode_range(range),R>=sheetRows&&(ws["!fullref"]=encode_range((range.e.r=rows.length-_R+R-1+or_R,range))),ws}function parse_dom_table(table,_opts){var opts=_opts||{},ws={};return opts.dense&&(ws["!data"]=[]),sheet_add_dom(ws,table,_opts)}function table_to_book(table,opts){var o=sheet_to_workbook(parse_dom_table(table,opts),opts);return o}function is_dom_element_hidden(element){var display="",get_computed_style=get_get_computed_style_function(element);return get_computed_style&&(display=get_computed_style(element).getPropertyValue("display")),display||(display=element.style&&element.style.display),display==="none"}function get_get_computed_style_function(element){return element.ownerDocument.defaultView&&typeof element.ownerDocument.defaultView.getComputedStyle=="function"?element.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var write_styles_ods=function(){var master_styles=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),payload="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+master_styles+"</office:document-styles>";return function(){return XML_HEADER+payload}}();function write_number_format_ods(nf,nfidx){var type="number",payload="",nopts={"style:name":nfidx},c="",i=0;nf=nf.replace(/"[$]"/g,"$");j:{if(nf.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+nf),nf=nf.slice(0,nf.indexOf(";"))),nf=="@"){type="text",payload="<number:text-content/>";break j}if(nf.indexOf(/\$/)>-1&&(type="currency"),nf[i]=='"'){for(c="";nf[++i]!='"'||nf[++i]=='"';)c+=nf[i];--i,nf[i+1]=="*"?(i++,payload+="<number:fill-character>"+escapexml(c.replace(/""/g,'"'))+"</number:fill-character>"):payload+="<number:text>"+escapexml(c.replace(/""/g,'"'))+"</number:text>",nf=nf.slice(i+1),i=0}var t=nf.match(/# (\?+)\/(\?+)/);if(t){payload+=writextag("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":t[1].length,"number:max-denominator-value":Math.max(+t[1].replace(/./g,"9"),+t[2].replace(/./g,"9"))});break j}if(t=nf.match(/# (\?+)\/(\d+)/)){payload+=writextag("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":t[1].length,"number:denominator-value":+t[2]});break j}if(t=nf.match(/\b(\d+)(|\.\d+)%/)){type="percentage",payload+=writextag("number:number",null,{"number:decimal-places":t[2]&&t.length-1||0,"number:min-decimal-places":t[2]&&t.length-1||0,"number:min-integer-digits":t[1].length})+"<number:text>%</number:text>";break j}var has_time=!1;if(["y","m","d"].indexOf(nf[0])>-1){type="date";k:for(;i<nf.length;++i)switch(c=nf[i].toLowerCase()){case"h":case"s":has_time=!0,--i;break k;case"m":l:for(var h=i+1;h<nf.length;++h)switch(nf[h]){case"y":case"d":break l;case"h":case"s":has_time=!0,--i;break k}case"y":case"d":for(;(nf[++i]||"").toLowerCase()==c[0];)c+=c[0];switch(--i,c){case"y":case"yy":payload+="<number:year/>";break;case"yyy":case"yyyy":payload+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":payload+='<number:month number:style="'+(c.length%2?"short":"long")+'" number:textual="'+(c.length>=3?"true":"false")+'"/>';break;case"d":case"dd":payload+='<number:day number:style="'+(c.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":payload+='<number:day-of-week number:style="'+(c.length%2?"short":"long")+'"/>';break}break;case'"':for(;nf[++i]!='"'||nf[++i]=='"';)c+=nf[i];--i,payload+="<number:text>"+escapexml(c.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":c=nf[++i],payload+="<number:text>"+escapexml(c)+"</number:text>";break;case"/":case":":payload+="<number:text>"+escapexml(c)+"</number:text>";break;default:console.error("unrecognized character "+c+" in ODF format "+nf)}if(!has_time)break j;nf=nf.slice(i+1),i=0}if(nf.match(/^\[?[hms]/)){for(type=="number"&&(type="time"),nf.match(/\[/)&&(nf=nf.replace(/[\[\]]/g,""),nopts["number:truncate-on-overflow"]="false");i<nf.length;++i)switch(c=nf[i].toLowerCase()){case"h":case"m":case"s":for(;(nf[++i]||"").toLowerCase()==c[0];)c+=c[0];switch(--i,c){case"h":case"hh":payload+='<number:hours number:style="'+(c.length%2?"short":"long")+'"/>';break;case"m":case"mm":payload+='<number:minutes number:style="'+(c.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(nf[i+1]==".")do c+=nf[i+1],++i;while(nf[i+1]=="0");payload+='<number:seconds number:style="'+(c.match("ss")?"long":"short")+'"'+(c.match(/\./)?' number:decimal-places="'+(c.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;nf[++i]!='"'||nf[++i]=='"';)c+=nf[i];--i,payload+="<number:text>"+escapexml(c.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":payload+="<number:text>"+escapexml(c)+"</number:text>";break;case"a":if(nf.slice(i,i+3).toLowerCase()=="a/p"){payload+="<number:am-pm/>",i+=2;break}if(nf.slice(i,i+5).toLowerCase()=="am/pm"){payload+="<number:am-pm/>",i+=4;break}default:console.error("unrecognized character "+c+" in ODF format "+nf)}break j}if(nf.indexOf(/\$/)>-1&&(type="currency"),nf[0]=="$"&&(payload+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',nf=nf.slice(1),i=0),i=0,nf[i]=='"'){for(;nf[++i]!='"'||nf[++i]=='"';)c+=nf[i];--i,nf[i+1]=="*"?(i++,payload+="<number:fill-character>"+escapexml(c.replace(/""/g,'"'))+"</number:fill-character>"):payload+="<number:text>"+escapexml(c.replace(/""/g,'"'))+"</number:text>",nf=nf.slice(i+1),i=0}var np=nf.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!np||!np[0])console.error("Could not find numeric part of "+nf);else{var base=np[1].replace(/,/g,"");payload+="<number:"+(np[3]?"scientific-":"")+'number number:min-integer-digits="'+(base.indexOf("0")==-1?"0":base.length-base.indexOf("0"))+'"'+(np[0].indexOf(",")>-1?' number:grouping="true"':"")+(np[2]&&' number:decimal-places="'+(np[2].length-1)+'"'||' number:decimal-places="0"')+(np[3]&&np[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(np[3]?' number:min-exponent-digits="'+np[3].match(/0+/)[0].length+'"':"")+"></number:"+(np[3]?"scientific-":"")+"number>",i=np.index+np[0].length}if(nf[i]=='"'){for(c="";nf[++i]!='"'||nf[++i]=='"';)c+=nf[i];--i,payload+="<number:text>"+escapexml(c.replace(/""/g,'"'))+"</number:text>"}}return payload?writextag("number:"+type+"-style",payload,nopts):(console.error("Could not generate ODS number format for |"+nf+"|"),"")}function write_names_ods(Names,SheetNames,idx){for(var scoped=[],namei=0;namei<Names.length;++namei){var name=Names[namei];name&&name.Sheet==(idx==-1?null:idx)&&scoped.push(name)}return scoped.length?`      <table:named-expressions>
`+scoped.map(function(name2){var odsref=(idx==-1?"$":"")+csf_to_ods_3D(name2.Ref);return"        "+writextag("table:named-range",null,{"table:name":name2.Name,"table:cell-range-address":odsref,"table:base-cell-address":odsref.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var write_content_ods=function(){var write_text_p=function(text,span){return escapexml(text).replace(/  +/g,function($$){return'<text:s text:c="'+$$.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,span?"<text:line-break/>":"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},null_cell_xml=`          <table:table-cell />
`,write_ws=function(ws,wb,i,opts,nfs,date1904){var o=[];o.push('      <table:table table:name="'+escapexml(wb.SheetNames[i])+`" table:style-name="ta1">
`);var R=0,C=0,range=decode_range(ws["!ref"]||"A1"),marr=ws["!merges"]||[],mi=0,dense=ws["!data"]!=null;if(ws["!cols"])for(C=0;C<=range.e.c;++C)o.push("        <table:table-column"+(ws["!cols"][C]?' table:style-name="co'+ws["!cols"][C].ods+'"':"")+`></table:table-column>
`);var H="",ROWS=ws["!rows"]||[];for(R=0;R<range.s.r;++R)H=ROWS[R]?' table:style-name="ro'+ROWS[R].ods+'"':"",o.push("        <table:table-row"+H+`></table:table-row>
`);for(;R<=range.e.r;++R){for(H=ROWS[R]?' table:style-name="ro'+ROWS[R].ods+'"':"",o.push("        <table:table-row"+H+`>
`),C=0;C<range.s.c;++C)o.push(null_cell_xml);for(;C<=range.e.c;++C){var skip=!1,ct={},textp="";for(mi=0;mi!=marr.length;++mi)if(!(marr[mi].s.c>C)&&!(marr[mi].s.r>R)&&!(marr[mi].e.c<C)&&!(marr[mi].e.r<R)){(marr[mi].s.c!=C||marr[mi].s.r!=R)&&(skip=!0),ct["table:number-columns-spanned"]=marr[mi].e.c-marr[mi].s.c+1,ct["table:number-rows-spanned"]=marr[mi].e.r-marr[mi].s.r+1;break}if(skip){o.push(`          <table:covered-table-cell/>
`);continue}var ref=encode_cell({r:R,c:C}),cell=dense?(ws["!data"][R]||[])[C]:ws[ref];if(cell&&cell.f&&(ct["table:formula"]=escapexml(csf_to_ods_formula(cell.f)),cell.F&&cell.F.slice(0,ref.length)==ref)){var _Fref=decode_range(cell.F);ct["table:number-matrix-columns-spanned"]=_Fref.e.c-_Fref.s.c+1,ct["table:number-matrix-rows-spanned"]=_Fref.e.r-_Fref.s.r+1}if(!cell){o.push(null_cell_xml);continue}switch(cell.t){case"b":textp=cell.v?"TRUE":"FALSE",ct["office:value-type"]="boolean",ct["office:boolean-value"]=cell.v?"true":"false";break;case"n":textp=cell.w||String(cell.v||0),ct["office:value-type"]="float",ct["office:value"]=cell.v||0;break;case"s":case"str":textp=cell.v==null?"":cell.v,ct["office:value-type"]="string";break;case"d":textp=cell.w||parseDate(cell.v,date1904).toISOString(),ct["office:value-type"]="date",ct["office:date-value"]=parseDate(cell.v,date1904).toISOString(),ct["table:style-name"]="ce1";break;default:o.push(null_cell_xml);continue}var text_p=write_text_p(textp);if(cell.l&&cell.l.Target){var _tgt=cell.l.Target;_tgt=_tgt.charAt(0)=="#"?"#"+csf_to_ods_3D(_tgt.slice(1)):_tgt,_tgt.charAt(0)!="#"&&!_tgt.match(/^\w+:/)&&(_tgt="../"+_tgt),text_p=writextag("text:a",text_p,{"xlink:href":_tgt.replace(/&/g,"&amp;")})}nfs[cell.z]&&(ct["table:style-name"]="ce"+nfs[cell.z].slice(1));var payload=writextag("text:p",text_p,{});if(cell.c){for(var acreator="",apayload="",aprops={},ci=0;ci<cell.c.length;++ci)!acreator&&cell.c[ci].a&&(acreator=cell.c[ci].a),apayload+="<text:p>"+write_text_p(cell.c[ci].t)+"</text:p>";cell.c.hidden||(aprops["office:display"]=!0),payload=writextag("office:annotation",apayload,aprops)+payload}o.push("          "+writextag("table:table-cell",payload,ct)+`
`)}o.push(`        </table:table-row>
`)}return(wb.Workbook||{}).Names&&o.push(write_names_ods(wb.Workbook.Names,wb.SheetNames,i)),o.push(`      </table:table>
`),o.join("")},write_automatic_styles_ods=function(o,wb){o.push(` <office:automatic-styles>
`);var cidx=0;wb.SheetNames.map(function(n){return wb.Sheets[n]}).forEach(function(ws){if(ws&&ws["!cols"]){for(var C=0;C<ws["!cols"].length;++C)if(ws["!cols"][C]){var colobj=ws["!cols"][C];if(colobj.width==null&&colobj.wpx==null&&colobj.wch==null)continue;process_col(colobj),colobj.ods=cidx;var w=ws["!cols"][C].wpx+"px";o.push('  <style:style style:name="co'+cidx+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+w+`"/>
`),o.push(`  </style:style>
`),++cidx}}});var ridx=0;wb.SheetNames.map(function(n){return wb.Sheets[n]}).forEach(function(ws){if(ws&&ws["!rows"]){for(var R=0;R<ws["!rows"].length;++R)if(ws["!rows"][R]){ws["!rows"][R].ods=ridx;var h=ws["!rows"][R].hpx+"px";o.push('  <style:style style:name="ro'+ridx+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),o.push(`  </style:style>
`),++ridx}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var nfs={},nfi=69;return wb.SheetNames.map(function(n){return wb.Sheets[n]}).forEach(function(ws){if(ws){var dense=ws["!data"]!=null;if(ws["!ref"])for(var range=decode_range(ws["!ref"]),R=0;R<=range.e.r;++R)for(var C=0;C<=range.e.c;++C){var c=dense?(ws["!data"][R]||[])[C]:ws[encode_cell({r:R,c:C})];if(!(!c||!c.z||c.z.toLowerCase()=="general")&&!nfs[c.z]){var out=write_number_format_ods(c.z,"N"+nfi);out&&(nfs[c.z]="N"+nfi,++nfi,o.push(out+`
`))}}}}),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),keys(nfs).forEach(function(nf){o.push('<style:style style:name="ce'+nfs[nf].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+nfs[nf]+`"/>
`)}),o.push(` </office:automatic-styles>
`),nfs};return function(wb,opts){var o=[XML_HEADER],attr=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),fods=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});opts.bookType=="fods"?(o.push("<office:document"+attr+fods+`>
`),o.push(write_meta_ods().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):o.push("<office:document-content"+attr+`>
`);var nfs=write_automatic_styles_ods(o,wb);o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`),((wb.Workbook||{}).WBProps||{}).date1904&&o.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var i=0;i!=wb.SheetNames.length;++i)o.push(write_ws(wb.Sheets[wb.SheetNames[i]],wb,i,opts,nfs,((wb.Workbook||{}).WBProps||{}).date1904));return(wb.Workbook||{}).Names&&o.push(write_names_ods(wb.Workbook.Names,wb.SheetNames,-1)),o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),opts.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function write_ods(wb,opts){if(opts.bookType=="fods")return write_content_ods(wb,opts);var zip=zip_new(),f="",manifest=[],rdf=[];return f="mimetype",zip_add_file(zip,f,"application/vnd.oasis.opendocument.spreadsheet"),f="content.xml",zip_add_file(zip,f,write_content_ods(wb,opts)),manifest.push([f,"text/xml"]),rdf.push([f,"ContentFile"]),f="styles.xml",zip_add_file(zip,f,write_styles_ods(wb,opts)),manifest.push([f,"text/xml"]),rdf.push([f,"StylesFile"]),f="meta.xml",zip_add_file(zip,f,XML_HEADER+write_meta_ods()),manifest.push([f,"text/xml"]),rdf.push([f,"MetadataFile"]),f="manifest.rdf",zip_add_file(zip,f,write_rdf(rdf)),manifest.push([f,"application/rdf+xml"]),f="META-INF/manifest.xml",zip_add_file(zip,f,write_manifest(manifest)),zip}var subarray=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function u8_to_dataview(array){return new DataView(array.buffer,array.byteOffset,array.byteLength)}function u8str(u8){return typeof TextDecoder<"u"?new TextDecoder().decode(u8):utf8read(a2s(u8))}function stru8(str){return typeof TextEncoder<"u"?new TextEncoder().encode(str):s2a(utf8write(str))}function u8concat(u8a){for(var len=0,i=0;i<u8a.length;++i)len+=u8a[i].length;var out=new Uint8Array(len),off=0;for(i=0;i<u8a.length;++i){var u8=u8a[i],L=u8.length;if(L<250)for(var j=0;j<L;++j)out[off++]=u8[j];else out.set(u8,off),off+=L}return out}function writeDecimal128LE(buf,offset2,value){var exp=Math.floor(value==0?0:Math.LOG10E*Math.log(Math.abs(value)))+6176-16,mantissa=value/Math.pow(10,exp-6176);buf[offset2+15]|=exp>>7,buf[offset2+14]|=(exp&127)<<1;for(var i=0;mantissa>=1;++i,mantissa/=256)buf[offset2+i]=mantissa&255;buf[offset2+15]|=value>=0?0:128}function parse_varint49(buf,ptr){var l=ptr.l,usz=buf[l]&127;varint:if(buf[l++]>=128&&(usz|=(buf[l]&127)<<7,buf[l++]<128||(usz|=(buf[l]&127)<<14,buf[l++]<128)||(usz|=(buf[l]&127)<<21,buf[l++]<128)||(usz+=(buf[l]&127)*Math.pow(2,28),++l,buf[l++]<128)||(usz+=(buf[l]&127)*Math.pow(2,35),++l,buf[l++]<128)||(usz+=(buf[l]&127)*Math.pow(2,42),++l,buf[l++]<128)))break varint;return ptr.l=l,usz}function write_varint49(v){var usz=new Uint8Array(7);usz[0]=v&127;var L=1;sz:if(v>127){if(usz[L-1]|=128,usz[L]=v>>7&127,++L,v<=16383||(usz[L-1]|=128,usz[L]=v>>14&127,++L,v<=2097151)||(usz[L-1]|=128,usz[L]=v>>21&127,++L,v<=268435455)||(usz[L-1]|=128,usz[L]=v/256>>>21&127,++L,v<=34359738367)||(usz[L-1]|=128,usz[L]=v/65536>>>21&127,++L,v<=4398046511103))break sz;usz[L-1]|=128,usz[L]=v/16777216>>>21&127,++L}return usz[subarray](0,L)}function parse_packed_varints(buf){for(var ptr={l:0},out=[];ptr.l<buf.length;)out.push(parse_varint49(buf,ptr));return out}function write_packed_varints(nums){return u8concat(nums.map(function(x){return write_varint49(x)}))}function varint_to_i32(buf){var l=0,i32=buf[l]&127;return buf[l++]<128||(i32|=(buf[l]&127)<<7,buf[l++]<128)||(i32|=(buf[l]&127)<<14,buf[l++]<128)||(i32|=(buf[l]&127)<<21,buf[l++]<128)||(i32|=(buf[l]&15)<<28),i32}function parse_shallow(buf){for(var out=[],ptr={l:0};ptr.l<buf.length;){var off=ptr.l,num=parse_varint49(buf,ptr),type=num&7;num=num/8|0;var data,l=ptr.l;switch(type){case 0:{for(;buf[l++]>=128;);data=buf[subarray](ptr.l,l),ptr.l=l}break;case 1:data=buf[subarray](l,l+8),ptr.l=l+8;break;case 2:{var len=parse_varint49(buf,ptr);data=buf[subarray](ptr.l,ptr.l+len),ptr.l+=len}break;case 5:data=buf[subarray](l,l+4),ptr.l=l+4;break;default:throw new Error("PB Type ".concat(type," for Field ").concat(num," at offset ").concat(off))}var v={data,type};out[num]==null&&(out[num]=[]),out[num].push(v)}return out}function write_shallow(proto){var out=[];return proto.forEach(function(field,idx){idx!=0&&field.forEach(function(item){item.data&&(out.push(write_varint49(idx*8+item.type)),item.type==2&&out.push(write_varint49(item.data.length)),out.push(item.data))})}),u8concat(out)}function mappa(data,cb){return data?.map(function(d){return cb(d.data)})||[]}function parse_iwa_file(buf){for(var _a,out=[],ptr={l:0};ptr.l<buf.length;){var len=parse_varint49(buf,ptr),ai=parse_shallow(buf[subarray](ptr.l,ptr.l+len));ptr.l+=len;var res={id:varint_to_i32(ai[1][0].data),messages:[]};ai[2].forEach(function(b){var mi=parse_shallow(b.data),fl=varint_to_i32(mi[3][0].data);res.messages.push({meta:mi,data:buf[subarray](ptr.l,ptr.l+fl)}),ptr.l+=fl}),(_a=ai[3])!=null&&_a[0]&&(res.merge=varint_to_i32(ai[3][0].data)>>>0>0),out.push(res)}return out}function write_iwa_file(ias){var bufs=[];return ias.forEach(function(ia){var ai=[[],[{data:write_varint49(ia.id),type:0}],[]];ia.merge!=null&&(ai[3]=[{data:write_varint49(+!!ia.merge),type:0}]);var midata=[];ia.messages.forEach(function(mi){midata.push(mi.data),mi.meta[3]=[{type:0,data:write_varint49(mi.data.length)}],ai[2].push({data:write_shallow(mi.meta),type:2})});var aipayload=write_shallow(ai);bufs.push(write_varint49(aipayload.length)),bufs.push(aipayload),midata.forEach(function(mid){return bufs.push(mid)})}),u8concat(bufs)}function parse_snappy_chunk(type,buf){if(type!=0)throw new Error("Unexpected Snappy chunk type ".concat(type));for(var ptr={l:0},usz=parse_varint49(buf,ptr),chunks=[],l=ptr.l;l<buf.length;){var tag=buf[l]&3;if(tag==0){var len=buf[l++]>>2;if(len<60)++len;else{var c=len-59;len=buf[l],c>1&&(len|=buf[l+1]<<8),c>2&&(len|=buf[l+2]<<16),c>3&&(len|=buf[l+3]<<24),len>>>=0,len++,l+=c}chunks.push(buf[subarray](l,l+len)),l+=len;continue}else{var offset2=0,length=0;if(tag==1?(length=(buf[l]>>2&7)+4,offset2=(buf[l++]&224)<<3,offset2|=buf[l++]):(length=(buf[l++]>>2)+1,tag==2?(offset2=buf[l]|buf[l+1]<<8,l+=2):(offset2=(buf[l]|buf[l+1]<<8|buf[l+2]<<16|buf[l+3]<<24)>>>0,l+=4)),offset2==0)throw new Error("Invalid offset 0");for(var j=chunks.length-1,off=offset2;j>=0&&off>=chunks[j].length;)off-=chunks[j].length,--j;if(j<0)if(off==0)off=chunks[j=0].length;else throw new Error("Invalid offset beyond length");if(length<off)chunks.push(chunks[j][subarray](chunks[j].length-off,chunks[j].length-off+length));else{for(off>0&&(chunks.push(chunks[j][subarray](chunks[j].length-off)),length-=off),++j;length>=chunks[j].length;)chunks.push(chunks[j]),length-=chunks[j].length,++j;length&&chunks.push(chunks[j][subarray](0,length))}chunks.length>25&&(chunks=[u8concat(chunks)])}}for(var clen=0,u8i=0;u8i<chunks.length;++u8i)clen+=chunks[u8i].length;if(clen!=usz)throw new Error("Unexpected length: ".concat(clen," != ").concat(usz));return chunks}function decompress_iwa_file(buf){Array.isArray(buf)&&(buf=new Uint8Array(buf));for(var out=[],l=0;l<buf.length;){var t=buf[l++],len=buf[l]|buf[l+1]<<8|buf[l+2]<<16;l+=3,out.push.apply(out,parse_snappy_chunk(t,buf[subarray](l,l+len))),l+=len}if(l!==buf.length)throw new Error("data is not a valid framed stream!");return out.length==1?out[0]:u8concat(out)}function compress_iwa_file(buf){for(var out=[],l=0;l<buf.length;){var c=Math.min(buf.length-l,268435455),frame=new Uint8Array(4);out.push(frame);var usz=write_varint49(c),L=usz.length;out.push(usz),c<=60?(L++,out.push(new Uint8Array([c-1<<2]))):c<=256?(L+=2,out.push(new Uint8Array([240,c-1&255]))):c<=65536?(L+=3,out.push(new Uint8Array([244,c-1&255,c-1>>8&255]))):c<=16777216?(L+=4,out.push(new Uint8Array([248,c-1&255,c-1>>8&255,c-1>>16&255]))):c<=4294967296&&(L+=5,out.push(new Uint8Array([252,c-1&255,c-1>>8&255,c-1>>16&255,c-1>>>24&255]))),out.push(buf[subarray](l,l+c)),L+=c,frame[0]=0,frame[1]=L&255,frame[2]=L>>8&255,frame[3]=L>>16&255,l+=c}return u8concat(out)}function write_new_storage(cell,lut){var out=new Uint8Array(32),dv=u8_to_dataview(out),l=12,fields=0;switch(out[0]=5,cell.t){case"n":if(cell.z&&fmt_is_date(cell.z)){out[1]=5,dv.setFloat64(l,(numdate(cell.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),fields|=4,l+=8;break}else out[1]=2,writeDecimal128LE(out,l,cell.v),fields|=1,l+=16;break;case"b":out[1]=6,dv.setFloat64(l,cell.v?1:0,!0),fields|=2,l+=8;break;case"s":{var s=cell.v==null?"":String(cell.v);if(cell.l){var irsst=lut.rsst.findIndex(function(v){var _a;return v.v==s&&v.l==((_a=cell.l)==null?void 0:_a.Target)});irsst==-1&&(lut.rsst[irsst=lut.rsst.length]={v:s,l:cell.l.Target}),out[1]=9,dv.setUint32(l,irsst,!0),fields|=16,l+=4}else{var isst=lut.sst.indexOf(s);isst==-1&&(lut.sst[isst=lut.sst.length]=s),out[1]=3,dv.setUint32(l,isst,!0),fields|=8,l+=4}}break;case"d":out[1]=5,dv.setFloat64(l,(cell.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),fields|=4,l+=8;break;case"z":out[1]=0;break;default:throw"unsupported cell type "+cell.t}return cell.c&&(lut.cmnt.push(s5s_to_iwa_comment(cell.c)),dv.setUint32(l,lut.cmnt.length-1,!0),fields|=524288,l+=4),dv.setUint32(8,fields,!0),out[subarray](0,l)}function write_old_storage(cell,lut){var out=new Uint8Array(32),dv=u8_to_dataview(out),l=12,fields=0,s="";switch(out[0]=4,cell.t){case"n":break;case"b":break;case"s":if(s=cell.v==null?"":String(cell.v),cell.l){var irsst=lut.rsst.findIndex(function(v){var _a;return v.v==s&&v.l==((_a=cell.l)==null?void 0:_a.Target)});irsst==-1&&(lut.rsst[irsst=lut.rsst.length]={v:s,l:cell.l.Target}),out[1]=9,dv.setUint32(l,irsst,!0),fields|=512,l+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+cell.t}switch(cell.c&&(dv.setUint32(l,lut.cmnt.length-1,!0),fields|=4096,l+=4),cell.t){case"n":out[1]=2,dv.setFloat64(l,cell.v,!0),fields|=32,l+=8;break;case"b":out[1]=6,dv.setFloat64(l,cell.v?1:0,!0),fields|=32,l+=8;break;case"s":if(s=cell.v==null?"":String(cell.v),!cell.l){var isst=lut.sst.indexOf(s);isst==-1&&(lut.sst[isst=lut.sst.length]=s),out[1]=3,dv.setUint32(l,isst,!0),fields|=16,l+=4}break;case"d":out[1]=5,dv.setFloat64(l,(cell.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),fields|=64,l+=8;break;case"z":out[1]=0;break;default:throw"unsupported cell type "+cell.t}return dv.setUint32(8,fields,!0),out[subarray](0,l)}function parse_TSP_Reference(buf){var pb=parse_shallow(buf);return varint_to_i32(pb[1][0].data)}function write_TSP_Reference(idx){return write_shallow([[],[{type:0,data:write_varint49(idx)}]])}function numbers_add_oref(iwa,ref){var _a,orefs=(_a=iwa.messages[0].meta[5])!=null&&_a[0]?parse_packed_varints(iwa.messages[0].meta[5][0].data):[],orefidx=orefs.indexOf(ref);orefidx==-1&&(orefs.push(ref),iwa.messages[0].meta[5]=[{type:2,data:write_packed_varints(orefs)}])}function numbers_del_oref(iwa,ref){var _a,orefs=(_a=iwa.messages[0].meta[5])!=null&&_a[0]?parse_packed_varints(iwa.messages[0].meta[5][0].data):[];iwa.messages[0].meta[5]=[{type:2,data:write_packed_varints(orefs.filter(function(r){return r!=ref}))}]}function s5s_to_iwa_comment(s5s){for(var out={a:"",t:"",replies:[]},i=0;i<s5s.length;++i)i==0?(out.a=s5s[i].a,out.t=s5s[i].t):out.replies.push({a:s5s[i].a,t:s5s[i].t});return out}function write_TST_TileRowInfo(data,lut,wide){var _a,_b,_c,tri=[[],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:write_varint49(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:write_varint49(1)}]];if(!((_a=tri[6])!=null&&_a[0])||!((_b=tri[7])!=null&&_b[0]))throw"Mutation only works on post-BNC storages!";var cnt=0;if(tri[7][0].data.length<2*data.length){var new_7=new Uint8Array(2*data.length);new_7.set(tri[7][0].data),tri[7][0].data=new_7}if(tri[4][0].data.length<2*data.length){var new_4=new Uint8Array(2*data.length);new_4.set(tri[4][0].data),tri[4][0].data=new_4}for(var dv=u8_to_dataview(tri[7][0].data),last_offset=0,cell_storage=[],_dv=u8_to_dataview(tri[4][0].data),_last_offset=0,_cell_storage=[],width=wide?4:1,C=0;C<data.length;++C){if(data[C]==null||data[C].t=="z"&&!((_c=data[C].c)!=null&&_c.length)||data[C].t=="e"){dv.setUint16(C*2,65535,!0),_dv.setUint16(C*2,65535);continue}dv.setUint16(C*2,last_offset/width,!0),_dv.setUint16(C*2,_last_offset/width,!0);var celload,_celload;switch(data[C].t){case"d":if(data[C].v instanceof Date){celload=write_new_storage(data[C],lut),_celload=write_old_storage(data[C],lut);break}celload=write_new_storage(data[C],lut),_celload=write_old_storage(data[C],lut);break;case"s":case"n":case"b":case"z":celload=write_new_storage(data[C],lut),_celload=write_old_storage(data[C],lut);break;default:throw new Error("Unsupported value "+data[C])}cell_storage.push(celload),last_offset+=celload.length,_cell_storage.push(_celload),_last_offset+=_celload.length,++cnt}for(tri[2][0].data=write_varint49(cnt),tri[5][0].data=write_varint49(5);C<tri[7][0].data.length/2;++C)dv.setUint16(C*2,65535,!0),_dv.setUint16(C*2,65535,!0);return tri[6][0].data=u8concat(cell_storage),tri[3][0].data=u8concat(_cell_storage),tri[8]=[{type:0,data:write_varint49(wide?1:0)}],tri}function write_iwam(type,payload){return{meta:[[],[{type:0,data:write_varint49(type)}]],data:payload}}function get_unique_msgid(dep,dependents){dependents.last||(dependents.last=927262);for(var i=dependents.last;i<2e6;++i)if(!dependents[i])return dependents[dependents.last=i]=dep,i;throw new Error("Too many messages")}function build_numbers_deps(cfb){var dependents={},indices=[];return cfb.FileIndex.map(function(fi,idx){return[fi,cfb.FullPaths[idx]]}).forEach(function(row){var fi=row[0],fp=row[1];fi.type==2&&fi.name.match(/\.iwa/)&&fi.content[0]==0&&parse_iwa_file(decompress_iwa_file(fi.content)).forEach(function(packet){indices.push(packet.id),dependents[packet.id]={deps:[],location:fp,type:varint_to_i32(packet.messages[0].meta[1][0].data)}})}),cfb.FileIndex.forEach(function(fi){fi.name.match(/\.iwa/)&&fi.content[0]==0&&parse_iwa_file(decompress_iwa_file(fi.content)).forEach(function(ia){ia.messages.forEach(function(mess){[5,6].forEach(function(f){mess.meta[f]&&mess.meta[f].forEach(function(x){dependents[ia.id].deps.push(varint_to_i32(x.data))})})})})}),dependents}function write_TSP_Color_RGB(r,g,b){return write_shallow([[],[{type:0,data:write_varint49(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([g/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([b/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:write_varint49(1)}]])}function get_author_color(n){switch(n){case 0:return write_TSP_Color_RGB(99,222,171);case 1:return write_TSP_Color_RGB(162,197,240);case 2:return write_TSP_Color_RGB(255,189,189)}return write_TSP_Color_RGB(Math.random()*255,Math.random()*255,Math.random()*255)}function write_numbers_iwa(wb,opts){if(!opts||!opts.numbers)throw new Error("Must pass a `numbers` option -- check the README");var cfb=CFB.read(opts.numbers,{type:"base64"}),deps=build_numbers_deps(cfb),docroot=numbers_iwa_find(cfb,deps,1);if(docroot==null)throw"Could not find message ".concat(1," in Numbers template");var sheetrefs=mappa(parse_shallow(docroot.messages[0].data)[1],parse_TSP_Reference);if(sheetrefs.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return wb.SheetNames.forEach(function(name,idx){idx>=1&&(numbers_add_ws(cfb,deps,idx+1),docroot=numbers_iwa_find(cfb,deps,1),sheetrefs=mappa(parse_shallow(docroot.messages[0].data)[1],parse_TSP_Reference)),write_numbers_ws(cfb,deps,wb.Sheets[name],name,idx,sheetrefs[idx])}),cfb}function numbers_iwa_doit(cfb,deps,id,cb){var entry=CFB.find(cfb,deps[id].location);if(!entry)throw"Could not find ".concat(deps[id].location," in Numbers template");var x=parse_iwa_file(decompress_iwa_file(entry.content)),ainfo=x.find(function(packet){return packet.id==id});cb(ainfo,x),entry.content=compress_iwa_file(write_iwa_file(x)),entry.size=entry.content.length}function numbers_iwa_find(cfb,deps,id){var entry=CFB.find(cfb,deps[id].location);if(!entry)throw"Could not find ".concat(deps[id].location," in Numbers template");var x=parse_iwa_file(decompress_iwa_file(entry.content)),ainfo=x.find(function(packet){return packet.id==id});return ainfo}function numbers_add_meta(mlist,newid,newloc){mlist[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(newid)}],[{type:2,data:stru8(newloc.replace(/-[\s\S]*$/,""))}],[{type:2,data:stru8(newloc)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(0)}]])}),mlist[1]=[{type:0,data:write_varint49(Math.max(newid+1,varint_to_i32(mlist[1][0].data)))}]}function numbers_add_msg(cfb,type,msg,path,deps,id){id||(id=get_unique_msgid({deps:[],location:"",type},deps));var loc="".concat(path,"-").concat(id,".iwa");deps[id].location="Root Entry"+loc,CFB.utils.cfb_add(cfb,loc,compress_iwa_file(write_iwa_file([{id,messages:[write_iwam(type,write_shallow(msg))]}])));var newloc=loc.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_add_meta(mlist,id||0,newloc),ai.messages[0].data=write_shallow(mlist)}),id}function numbers_meta_add_dep(mlist,deps,id,dep){var loc=deps[id].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),parentidx=mlist[3].findIndex(function(m){var _a,_b,mm=parse_shallow(m.data);return(_a=mm[3])!=null&&_a[0]?u8str(mm[3][0].data)==loc:!!((_b=mm[2])!=null&&_b[0]&&u8str(mm[2][0].data)==loc)}),parent=parse_shallow(mlist[3][parentidx].data);parent[6]||(parent[6]=[]),(Array.isArray(dep)?dep:[dep]).forEach(function(dep2){parent[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(dep2)}]])})}),mlist[3][parentidx].data=write_shallow(parent)}function numbers_meta_del_dep(mlist,deps,id,dep){var loc=deps[id].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),parentidx=mlist[3].findIndex(function(m){var _a,_b,mm=parse_shallow(m.data);return(_a=mm[3])!=null&&_a[0]?u8str(mm[3][0].data)==loc:!!((_b=mm[2])!=null&&_b[0]&&u8str(mm[2][0].data)==loc)}),parent=parse_shallow(mlist[3][parentidx].data);parent[6]||(parent[6]=[]),parent[6]=parent[6].filter(function(m){return varint_to_i32(parse_shallow(m.data)[1][0].data)!=dep}),mlist[3][parentidx].data=write_shallow(parent)}function numbers_add_ws(cfb,deps,wsidx){var sheetref=-1,newsheetref=-1,remap={};numbers_iwa_doit(cfb,deps,1,function(docroot,arch){var doc=parse_shallow(docroot.messages[0].data);sheetref=parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data),newsheetref=get_unique_msgid({deps:[1],location:deps[sheetref].location,type:2},deps),remap[sheetref]=newsheetref,numbers_add_oref(docroot,newsheetref),doc[1].push({type:2,data:write_TSP_Reference(newsheetref)});var sheet=numbers_iwa_find(cfb,deps,sheetref);sheet.id=newsheetref,deps[1].location==deps[newsheetref].location?arch.push(sheet):numbers_iwa_doit(cfb,deps,newsheetref,function(_,x){return x.push(sheet)}),docroot.messages[0].data=write_shallow(doc)});var tiaref=-1;numbers_iwa_doit(cfb,deps,newsheetref,function(sheetroot,arch){for(var sa=parse_shallow(sheetroot.messages[0].data),i=3;i<=69;++i)delete sa[i];var drawables=mappa(sa[2],parse_TSP_Reference);drawables.forEach(function(n){return numbers_del_oref(sheetroot,n)}),tiaref=get_unique_msgid({deps:[newsheetref],location:deps[drawables[0]].location,type:deps[drawables[0]].type},deps),numbers_add_oref(sheetroot,tiaref),remap[drawables[0]]=tiaref,sa[2]=[{type:2,data:write_TSP_Reference(tiaref)}];var tia=numbers_iwa_find(cfb,deps,drawables[0]);tia.id=tiaref,deps[drawables[0]].location==deps[newsheetref].location?arch.push(tia):(numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_meta_add_dep(mlist,deps,newsheetref,tiaref),ai.messages[0].data=write_shallow(mlist)}),numbers_iwa_doit(cfb,deps,tiaref,function(_,x){return x.push(tia)})),sheetroot.messages[0].data=write_shallow(sa)});var tmaref=-1;numbers_iwa_doit(cfb,deps,tiaref,function(tiaroot,arch){for(var tia=parse_shallow(tiaroot.messages[0].data),da=parse_shallow(tia[1][0].data),i=3;i<=69;++i)delete da[i];var dap=parse_TSP_Reference(da[2][0].data);da[2][0].data=write_TSP_Reference(remap[dap]),tia[1][0].data=write_shallow(da);var oldtmaref=parse_TSP_Reference(tia[2][0].data);numbers_del_oref(tiaroot,oldtmaref),tmaref=get_unique_msgid({deps:[tiaref],location:deps[oldtmaref].location,type:deps[oldtmaref].type},deps),numbers_add_oref(tiaroot,tmaref),remap[oldtmaref]=tmaref,tia[2][0].data=write_TSP_Reference(tmaref);var tma=numbers_iwa_find(cfb,deps,oldtmaref);tma.id=tmaref,deps[tiaref].location==deps[tmaref].location?arch.push(tma):numbers_iwa_doit(cfb,deps,tmaref,function(_,x){return x.push(tma)}),tiaroot.messages[0].data=write_shallow(tia)}),numbers_iwa_doit(cfb,deps,tmaref,function(tmaroot,arch){var _a,_b,tma=parse_shallow(tmaroot.messages[0].data),uuid=u8str(tma[1][0].data),new_uuid=uuid.replace(/-[A-Z0-9]*/,"-".concat(("0000"+wsidx.toString(16)).slice(-4)));if(tma[1][0].data=stru8(new_uuid),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(n){return delete tma[n]}),tma[45]){var srrta=parse_shallow(tma[45][0].data),ref=parse_TSP_Reference(srrta[1][0].data);numbers_del_oref(tmaroot,ref),delete tma[45]}if(tma[70]){var hsoa=parse_shallow(tma[70][0].data);(_a=hsoa[2])==null||_a.forEach(function(item){var hsa=parse_shallow(item.data);[2,3].map(function(n){return hsa[n][0]}).forEach(function(hseadata){var hsea=parse_shallow(hseadata.data);if(hsea[8]){var ref2=parse_TSP_Reference(hsea[8][0].data);numbers_del_oref(tmaroot,ref2)}})}),delete tma[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(n){if(tma[n]){var ref2=parse_TSP_Reference(tma[n][0].data);delete tma[n],numbers_del_oref(tmaroot,ref2)}});var store=parse_shallow(tma[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(n){var _a2;if((_a2=store[n])!=null&&_a2[0]){var oldref=parse_TSP_Reference(store[n][0].data),newref=get_unique_msgid({deps:[tmaref],location:deps[oldref].location,type:deps[oldref].type},deps);numbers_del_oref(tmaroot,oldref),numbers_add_oref(tmaroot,newref),remap[oldref]=newref;var msg=numbers_iwa_find(cfb,deps,oldref);if(msg.id=newref,deps[oldref].location==deps[tmaref].location)arch.push(msg);else{deps[newref].location=deps[oldref].location.replace(oldref.toString(),newref.toString()),deps[newref].location==deps[oldref].location&&(deps[newref].location=deps[newref].location.replace(/\.iwa/,"-".concat(newref,".iwa"))),CFB.utils.cfb_add(cfb,deps[newref].location,compress_iwa_file(write_iwa_file([msg])));var newloc=deps[newref].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_add_meta(mlist,newref,newloc),numbers_meta_add_dep(mlist,deps,tmaref,newref),ai.messages[0].data=write_shallow(mlist)})}store[n][0].data=write_TSP_Reference(newref)}});var row_headers=parse_shallow(store[1][0].data);(_b=row_headers[2])==null||_b.forEach(function(tspref){var oldref=parse_TSP_Reference(tspref.data),newref=get_unique_msgid({deps:[tmaref],location:deps[oldref].location,type:deps[oldref].type},deps);numbers_del_oref(tmaroot,oldref),numbers_add_oref(tmaroot,newref),remap[oldref]=newref;var msg=numbers_iwa_find(cfb,deps,oldref);if(msg.id=newref,deps[oldref].location==deps[tmaref].location)arch.push(msg);else{deps[newref].location=deps[oldref].location.replace(oldref.toString(),newref.toString()),deps[newref].location==deps[oldref].location&&(deps[newref].location=deps[newref].location.replace(/\.iwa/,"-".concat(newref,".iwa"))),CFB.utils.cfb_add(cfb,deps[newref].location,compress_iwa_file(write_iwa_file([msg])));var newloc=deps[newref].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_add_meta(mlist,newref,newloc),numbers_meta_add_dep(mlist,deps,tmaref,newref),ai.messages[0].data=write_shallow(mlist)})}tspref.data=write_TSP_Reference(newref)}),store[1][0].data=write_shallow(row_headers);var tiles=parse_shallow(store[3][0].data);tiles[1].forEach(function(t){var tst=parse_shallow(t.data),oldtileref=parse_TSP_Reference(tst[2][0].data),newtileref=remap[oldtileref];if(!remap[oldtileref]){newtileref=get_unique_msgid({deps:[tmaref],location:"",type:deps[oldtileref].type},deps),deps[newtileref].location="Root Entry/Index/Tables/Tile-".concat(newtileref,".iwa"),remap[oldtileref]=newtileref;var oldtile=numbers_iwa_find(cfb,deps,oldtileref);oldtile.id=newtileref,numbers_del_oref(tmaroot,oldtileref),numbers_add_oref(tmaroot,newtileref),CFB.utils.cfb_add(cfb,"/Index/Tables/Tile-".concat(newtileref,".iwa"),compress_iwa_file(write_iwa_file([oldtile]))),numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);mlist[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(newtileref)}],[{type:2,data:stru8("Tables/Tile")}],[{type:2,data:stru8("Tables/Tile-".concat(newtileref))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(0)}]])}),mlist[1]=[{type:0,data:write_varint49(Math.max(newtileref+1,varint_to_i32(mlist[1][0].data)))}],numbers_meta_add_dep(mlist,deps,tmaref,newtileref),ai.messages[0].data=write_shallow(mlist)})}tst[2][0].data=write_TSP_Reference(newtileref),t.data=write_shallow(tst)}),store[3][0].data=write_shallow(tiles)}tma[4][0].data=write_shallow(store),tmaroot.messages[0].data=write_shallow(tma)})}function write_numbers_ws(cfb,deps,ws,wsname,sheetidx,rootref){var drawables=[];numbers_iwa_doit(cfb,deps,rootref,function(docroot){var sheetref=parse_shallow(docroot.messages[0].data);sheetref[1]=[{type:2,data:stru8(wsname)}],drawables=mappa(sheetref[2],parse_TSP_Reference),docroot.messages[0].data=write_shallow(sheetref)});var tia=numbers_iwa_find(cfb,deps,drawables[0]),tmaref=parse_TSP_Reference(parse_shallow(tia.messages[0].data)[2][0].data);numbers_iwa_doit(cfb,deps,tmaref,function(docroot,x){return write_numbers_tma(cfb,deps,ws,docroot,x,tmaref)})}var USE_WIDE_ROWS=!0;function write_numbers_tma(cfb,deps,ws,tmaroot,tmafile,tmaref){if(!ws["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var range=decode_range(ws["!ref"]);range.s.r=range.s.c=0;var trunc=!1;range.e.c>999&&(trunc=!0,range.e.c=999),range.e.r>999999&&(trunc=!0,range.e.r=999999),trunc&&console.error("Truncating to ".concat(encode_range(range)));var data=[];if(ws["!data"])data=ws["!data"];else{for(var colstr=[],_C=0;_C<=range.e.c;++_C)colstr[_C]=encode_col(_C);for(var R_=0;R_<=range.e.r;++R_){data[R_]=[];var _R=""+(R_+1);for(_C=0;_C<=range.e.c;++_C){var _cell=ws[colstr[_C]+_R];_cell&&(data[R_][_C]=_cell)}}}var LUT={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],ferr:[],fmla:[],nfmt:[],ofmt:[],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},pb=parse_shallow(tmaroot.messages[0].data);{pb[6][0].data=write_varint49(range.e.r+1),pb[7][0].data=write_varint49(range.e.c+1),delete pb[46];var store=parse_shallow(pb[4][0].data);{var row_header_ref=parse_TSP_Reference(parse_shallow(store[1][0].data)[2][0].data);numbers_iwa_doit(cfb,deps,row_header_ref,function(rowhead,_x){var _a,base_bucket=parse_shallow(rowhead.messages[0].data);if((_a=base_bucket?.[2])!=null&&_a[0])for(var R2=0;R2<data.length;++R2){var _bucket=parse_shallow(base_bucket[2][0].data);_bucket[1][0].data=write_varint49(R2),_bucket[4][0].data=write_varint49(data[R2].length),base_bucket[2][R2]={type:base_bucket[2][0].type,data:write_shallow(_bucket)}}rowhead.messages[0].data=write_shallow(base_bucket)});var col_header_ref=parse_TSP_Reference(store[2][0].data);numbers_iwa_doit(cfb,deps,col_header_ref,function(colhead,_x){for(var base_bucket=parse_shallow(colhead.messages[0].data),C=0;C<=range.e.c;++C){var _bucket=parse_shallow(base_bucket[2][0].data);_bucket[1][0].data=write_varint49(C),_bucket[4][0].data=write_varint49(range.e.r+1),base_bucket[2][C]={type:base_bucket[2][0].type,data:write_shallow(_bucket)}}colhead.messages[0].data=write_shallow(base_bucket)});var rbtree=parse_shallow(store[9][0].data);rbtree[1]=[];var tilestore=parse_shallow(store[3][0].data);{var tstride=256;tilestore[2]=[{type:0,data:write_varint49(tstride)}];var tileref=parse_TSP_Reference(parse_shallow(tilestore[1][0].data)[2][0].data),save_token=function(){var metadata=numbers_iwa_find(cfb,deps,2),mlist=parse_shallow(metadata.messages[0].data),mlst=mlist[3].filter(function(m){return varint_to_i32(parse_shallow(m.data)[1][0].data)==tileref});return mlst?.length?varint_to_i32(parse_shallow(mlst[0].data)[12][0].data):0}();CFB.utils.cfb_del(cfb,deps[tileref].location),numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);mlist[3]=mlist[3].filter(function(m){return varint_to_i32(parse_shallow(m.data)[1][0].data)!=tileref}),numbers_meta_del_dep(mlist,deps,tmaref,tileref),ai.messages[0].data=write_shallow(mlist)}),numbers_del_oref(tmaroot,tileref),tilestore[1]=[];for(var ntiles=Math.ceil((range.e.r+1)/tstride),tidx=0;tidx<ntiles;++tidx){var newtileid=get_unique_msgid({deps:[],location:"",type:6002},deps);deps[newtileid].location="Root Entry/Index/Tables/Tile-".concat(newtileid,".iwa");for(var tiledata=[[],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(Math.min(range.e.r+1,(tidx+1)*tstride))}],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(Math.min((tidx+1)*tstride,range.e.r+1)-tidx*tstride)}],[],[{type:0,data:write_varint49(5)}],[{type:0,data:write_varint49(1)}],[{type:0,data:write_varint49(USE_WIDE_ROWS?1:0)}]],R=tidx*tstride;R<=Math.min(range.e.r,(tidx+1)*tstride-1);++R){var tilerow=write_TST_TileRowInfo(data[R],LUT,USE_WIDE_ROWS);tilerow[1][0].data=write_varint49(R-tidx*tstride),tiledata[5].push({data:write_shallow(tilerow),type:2})}tilestore[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(tidx)}],[{type:2,data:write_TSP_Reference(newtileid)}]])});var newtile={id:newtileid,messages:[write_iwam(6002,write_shallow(tiledata))]},tilecontent=compress_iwa_file(write_iwa_file([newtile]));CFB.utils.cfb_add(cfb,"/Index/Tables/Tile-".concat(newtileid,".iwa"),tilecontent),numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);mlist[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(newtileid)}],[{type:2,data:stru8("Tables/Tile")}],[{type:2,data:stru8("Tables/Tile-".concat(newtileid))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(save_token)}]])}),mlist[1]=[{type:0,data:write_varint49(Math.max(newtileid+1,varint_to_i32(mlist[1][0].data)))}],numbers_meta_add_dep(mlist,deps,tmaref,newtileid),ai.messages[0].data=write_shallow(mlist)}),numbers_add_oref(tmaroot,newtileid),rbtree[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(tidx*tstride)}],[{type:0,data:write_varint49(tidx)}]])})}}if(store[3][0].data=write_shallow(tilestore),store[9][0].data=write_shallow(rbtree),store[10]=[{type:2,data:new Uint8Array([])}],ws["!merges"]){var mergeid=get_unique_msgid({type:6144,deps:[tmaref],location:deps[tmaref].location},deps);tmafile.push({id:mergeid,messages:[write_iwam(6144,write_shallow([[],ws["!merges"].map(function(m){return{type:2,data:write_shallow([[],[{type:2,data:write_shallow([[],[{type:5,data:new Uint8Array(new Uint16Array([m.s.r,m.s.c]).buffer)}]])}],[{type:2,data:write_shallow([[],[{type:5,data:new Uint8Array(new Uint16Array([m.e.r-m.s.r+1,m.e.c-m.s.c+1]).buffer)}]])}]])}})]))]}),store[13]=[{type:2,data:write_TSP_Reference(mergeid)}],numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_meta_add_dep(mlist,deps,tmaref,mergeid),ai.messages[0].data=write_shallow(mlist)}),numbers_add_oref(tmaroot,mergeid)}else delete store[13];var sstref=parse_TSP_Reference(store[4][0].data);numbers_iwa_doit(cfb,deps,sstref,function(sstroot){var sstdata=parse_shallow(sstroot.messages[0].data);sstdata[3]=[],LUT.sst.forEach(function(str,i){i!=0&&sstdata[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(i)}],[{type:0,data:write_varint49(1)}],[{type:2,data:stru8(str)}]])})}),sstroot.messages[0].data=write_shallow(sstdata)});var rsstref=parse_TSP_Reference(store[17][0].data);if(numbers_iwa_doit(cfb,deps,rsstref,function(rsstroot){var rsstdata=parse_shallow(rsstroot.messages[0].data);rsstdata[3]=[];var style_indices=[904980,903835,903815,903845];LUT.rsst.forEach(function(rsst,i){if(i!=0){var tswpsa=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:stru8(rsst.v)}]];tswpsa[10]=[{type:0,data:new Uint8Array([1])}],tswpsa[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],tswpsa[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],tswpsa[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],tswpsa[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],tswpsa[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],tswpsa[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],tswpsa[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],tswpsa[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var tswpsaid=get_unique_msgid({deps:[],location:"",type:2001},deps),tswpsarefs=[];if(rsst.l){var newhlinkid=numbers_add_msg(cfb,2032,[[],[],[{type:2,data:stru8(rsst.l)}]],"/Index/Tables/DataList",deps);tswpsa[11]=[];var smartfield=[[],[]];smartfield[1]||(smartfield[1]=[]),smartfield[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(0)}],[{type:2,data:write_TSP_Reference(newhlinkid)}]])}),tswpsa[11][0]={type:2,data:write_shallow(smartfield)},tswpsarefs.push(newhlinkid)}numbers_add_msg(cfb,2001,tswpsa,"/Index/Tables/DataList",deps,tswpsaid),numbers_iwa_doit(cfb,deps,tswpsaid,function(iwa){style_indices.forEach(function(ref){return numbers_add_oref(iwa,ref)}),tswpsarefs.forEach(function(ref){return numbers_add_oref(iwa,ref)})});var rtpaid=numbers_add_msg(cfb,6218,[[],[{type:2,data:write_TSP_Reference(tswpsaid)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",deps);numbers_iwa_doit(cfb,deps,rtpaid,function(iwa){return numbers_add_oref(iwa,tswpsaid)}),rsstdata[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(i)}],[{type:0,data:write_varint49(1)}],[],[],[],[],[],[],[{type:2,data:write_TSP_Reference(rtpaid)}]])}),numbers_add_oref(rsstroot,rtpaid),numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_meta_add_dep(mlist,deps,rsstref,rtpaid),numbers_meta_add_dep(mlist,deps,rtpaid,tswpsaid),numbers_meta_add_dep(mlist,deps,tswpsaid,tswpsarefs),numbers_meta_add_dep(mlist,deps,tswpsaid,style_indices),ai.messages[0].data=write_shallow(mlist)})}}),rsstroot.messages[0].data=write_shallow(rsstdata)}),LUT.cmnt.length>1){var cmntref=parse_TSP_Reference(store[19][0].data),authors={},iauthor=0;numbers_iwa_doit(cfb,deps,cmntref,function(cmntroot){var cmntdata=parse_shallow(cmntroot.messages[0].data);cmntdata[3]=[],LUT.cmnt.forEach(function(cc,i){if(i!=0){var replies=[];cc.replies&&cc.replies.forEach(function(c){authors[c.a||""]||(authors[c.a||""]=numbers_add_msg(cfb,212,[[],[{type:2,data:stru8(c.a||"")}],[{type:2,data:get_author_color(++iauthor)}],[],[{type:0,data:write_varint49(0)}]],"/Index/Tables/DataList",deps));var aaaid2=authors[c.a||""],csaid2=numbers_add_msg(cfb,3056,[[],[{type:2,data:stru8(c.t||"")}],[{type:2,data:write_shallow([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:write_TSP_Reference(aaaid2)}]],"/Index/Tables/DataList",deps);numbers_iwa_doit(cfb,deps,csaid2,function(iwa){return numbers_add_oref(iwa,aaaid2)}),replies.push(csaid2),numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_meta_add_dep(mlist,deps,csaid2,aaaid2),ai.messages[0].data=write_shallow(mlist)})}),authors[cc.a||""]||(authors[cc.a||""]=numbers_add_msg(cfb,212,[[],[{type:2,data:stru8(cc.a||"")}],[{type:2,data:get_author_color(++iauthor)}],[],[{type:0,data:write_varint49(0)}]],"/Index/Tables/DataList",deps));var aaaid=authors[cc.a||""],csaid=numbers_add_msg(cfb,3056,[[],[{type:2,data:stru8(cc.t||"")}],[{type:2,data:write_shallow([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:write_TSP_Reference(aaaid)}],replies.map(function(r){return{type:2,data:write_TSP_Reference(r)}}),[{type:2,data:write_shallow([[],[{type:0,data:write_varint49(i)}],[{type:0,data:write_varint49(0)}]])}]],"/Index/Tables/DataList",deps);numbers_iwa_doit(cfb,deps,csaid,function(iwa){numbers_add_oref(iwa,aaaid),replies.forEach(function(r){return numbers_add_oref(iwa,r)})}),cmntdata[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(i)}],[{type:0,data:write_varint49(1)}],[],[],[],[],[],[],[],[{type:2,data:write_TSP_Reference(csaid)}]])}),numbers_add_oref(cmntroot,csaid),numbers_iwa_doit(cfb,deps,2,function(ai){var mlist=parse_shallow(ai.messages[0].data);numbers_meta_add_dep(mlist,deps,cmntref,csaid),numbers_meta_add_dep(mlist,deps,csaid,aaaid),replies.length&&numbers_meta_add_dep(mlist,deps,csaid,replies),ai.messages[0].data=write_shallow(mlist)})}}),cmntdata[2][0].data=write_varint49(LUT.cmnt.length+1),cmntroot.messages[0].data=write_shallow(cmntdata)})}}pb[4][0].data=write_shallow(store)}tmaroot.messages[0].data=write_shallow(pb)}function fix_opts_func(defaults){return function(opts){for(var i=0;i!=defaults.length;++i){var d=defaults[i];opts[d[0]]===void 0&&(opts[d[0]]=d[1]),d[2]==="n"&&(opts[d[0]]=Number(opts[d[0]]))}}}function fix_write_opts(opts){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(opts)}function write_zip_xlsb(wb,opts){wb&&!wb.SSF&&(wb.SSF=dup(table_fmt)),wb&&wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),opts.revssf=evert_num(wb.SSF),opts.revssf[wb.SSF[65535]]=0,opts.ssf=wb.SSF),opts.rels={},opts.wbrels={},opts.Strings=[],opts.Strings.Count=0,opts.Strings.Unique=0,browser_has_Map?opts.revStrings=new Map:(opts.revStrings={},opts.revStrings.foo=[],delete opts.revStrings.foo);var wbext="bin",vbafmt=!0,ct=new_ct();fix_write_opts(opts=opts||{});var zip=zip_new(),f="",rId=0;if(opts.cellXfs=[],get_cell_style(opts.cellXfs,{},{revssf:{General:0}}),wb.Props||(wb.Props={}),f="docProps/core.xml",zip_add_file(zip,f,write_core_props(wb.Props,opts)),ct.coreprops.push(f),add_rels(opts.rels,2,f,RELS.CORE_PROPS),f="docProps/app.xml",!(wb.Props&&wb.Props.SheetNames))if(!wb.Workbook||!wb.Workbook.Sheets)wb.Props.SheetNames=wb.SheetNames;else{for(var _sn=[],_i=0;_i<wb.SheetNames.length;++_i)(wb.Workbook.Sheets[_i]||{}).Hidden!=2&&_sn.push(wb.SheetNames[_i]);wb.Props.SheetNames=_sn}wb.Props.Worksheets=wb.Props.SheetNames.length,zip_add_file(zip,f,write_ext_props(wb.Props,opts)),ct.extprops.push(f),add_rels(opts.rels,3,f,RELS.EXT_PROPS),wb.Custprops!==wb.Props&&keys(wb.Custprops||{}).length>0&&(f="docProps/custom.xml",zip_add_file(zip,f,write_cust_props(wb.Custprops,opts)),ct.custprops.push(f),add_rels(opts.rels,4,f,RELS.CUST_PROPS));var people=["SheetJ5"];for(opts.tcid=0,rId=1;rId<=wb.SheetNames.length;++rId){var wsrels={"!id":{}},ws=wb.Sheets[wb.SheetNames[rId-1]],_type=(ws||{})["!type"]||"sheet";switch(_type){case"chart":default:f="xl/worksheets/sheet"+rId+"."+wbext,zip_add_file(zip,f,write_ws_bin(rId-1,opts,wb,wsrels)),ct.sheets.push(f),add_rels(opts.wbrels,-1,"worksheets/sheet"+rId+"."+wbext,RELS.WS[0])}if(ws){var comments=ws["!comments"],need_vml=!1,cf="";if(comments&&comments.length>0){var needtc=!1;comments.forEach(function(carr){carr[1].forEach(function(c){c.T==!0&&(needtc=!0)})}),needtc&&(cf="xl/threadedComments/threadedComment"+rId+".xml",zip_add_file(zip,cf,write_tcmnt_xml(comments,people,opts)),ct.threadedcomments.push(cf),add_rels(wsrels,-1,"../threadedComments/threadedComment"+rId+".xml",RELS.TCMNT)),cf="xl/comments"+rId+"."+wbext,zip_add_file(zip,cf,write_comments_bin(comments,opts)),ct.comments.push(cf),add_rels(wsrels,-1,"../comments"+rId+"."+wbext,RELS.CMNT),need_vml=!0}ws["!legacy"]&&need_vml&&zip_add_file(zip,"xl/drawings/vmlDrawing"+rId+".vml",write_vml(rId,ws["!comments"])),delete ws["!comments"],delete ws["!legacy"]}wsrels["!id"].rId1&&zip_add_file(zip,get_rels_path(f),write_rels(wsrels))}opts.Strings!=null&&opts.Strings.length>0&&(f="xl/sharedStrings."+wbext,zip_add_file(zip,f,write_sst_bin(opts.Strings,opts)),ct.strs.push(f),add_rels(opts.wbrels,-1,"sharedStrings."+wbext,RELS.SST)),f="xl/workbook."+wbext,zip_add_file(zip,f,write_wb_bin(wb,opts)),ct.workbooks.push(f),add_rels(opts.rels,1,f,RELS.WB),f="xl/theme/theme1.xml";var ww=write_theme(wb.Themes,opts);return zip_add_file(zip,f,ww),ct.themes.push(f),add_rels(opts.wbrels,-1,"theme/theme1.xml",RELS.THEME),f="xl/styles."+wbext,zip_add_file(zip,f,write_sty_bin(wb,opts)),ct.styles.push(f),add_rels(opts.wbrels,-1,"styles."+wbext,RELS.STY),wb.vbaraw&&vbafmt&&(f="xl/vbaProject.bin",zip_add_file(zip,f,wb.vbaraw),ct.vba.push(f),add_rels(opts.wbrels,-1,"vbaProject.bin",RELS.VBA)),f="xl/metadata."+wbext,zip_add_file(zip,f,write_xlmeta_bin()),ct.metadata.push(f),add_rels(opts.wbrels,-1,"metadata."+wbext,RELS.XLMETA),people.length>1&&(f="xl/persons/person.xml",zip_add_file(zip,f,write_people_xml(people,opts)),ct.people.push(f),add_rels(opts.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(zip,"[Content_Types].xml",write_ct(ct,opts)),zip_add_file(zip,"_rels/.rels",write_rels(opts.rels)),zip_add_file(zip,"xl/_rels/workbook."+wbext+".rels",write_rels(opts.wbrels)),delete opts.revssf,delete opts.ssf,zip}function write_zip_xlsx(wb,opts){wb&&!wb.SSF&&(wb.SSF=dup(table_fmt)),wb&&wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),opts.revssf=evert_num(wb.SSF),opts.revssf[wb.SSF[65535]]=0,opts.ssf=wb.SSF),opts.rels={},opts.wbrels={},opts.Strings=[],opts.Strings.Count=0,opts.Strings.Unique=0,browser_has_Map?opts.revStrings=new Map:(opts.revStrings={},opts.revStrings.foo=[],delete opts.revStrings.foo);var wbext="xml",vbafmt=VBAFMTS.indexOf(opts.bookType)>-1,ct=new_ct();fix_write_opts(opts=opts||{});var zip=zip_new(),f="",rId=0;if(opts.cellXfs=[],get_cell_style(opts.cellXfs,{},{revssf:{General:0}}),wb.Props||(wb.Props={}),f="docProps/core.xml",zip_add_file(zip,f,write_core_props(wb.Props,opts)),ct.coreprops.push(f),add_rels(opts.rels,2,f,RELS.CORE_PROPS),f="docProps/app.xml",!(wb.Props&&wb.Props.SheetNames))if(!wb.Workbook||!wb.Workbook.Sheets)wb.Props.SheetNames=wb.SheetNames;else{for(var _sn=[],_i=0;_i<wb.SheetNames.length;++_i)(wb.Workbook.Sheets[_i]||{}).Hidden!=2&&_sn.push(wb.SheetNames[_i]);wb.Props.SheetNames=_sn}wb.Props.Worksheets=wb.Props.SheetNames.length,zip_add_file(zip,f,write_ext_props(wb.Props,opts)),ct.extprops.push(f),add_rels(opts.rels,3,f,RELS.EXT_PROPS),wb.Custprops!==wb.Props&&keys(wb.Custprops||{}).length>0&&(f="docProps/custom.xml",zip_add_file(zip,f,write_cust_props(wb.Custprops,opts)),ct.custprops.push(f),add_rels(opts.rels,4,f,RELS.CUST_PROPS));var people=["SheetJ5"];for(opts.tcid=0,rId=1;rId<=wb.SheetNames.length;++rId){var wsrels={"!id":{}},ws=wb.Sheets[wb.SheetNames[rId-1]],_type=(ws||{})["!type"]||"sheet";switch(_type){case"chart":default:f="xl/worksheets/sheet"+rId+"."+wbext,zip_add_file(zip,f,write_ws_xml(rId-1,opts,wb,wsrels)),ct.sheets.push(f),add_rels(opts.wbrels,-1,"worksheets/sheet"+rId+"."+wbext,RELS.WS[0])}if(ws){var comments=ws["!comments"],need_vml=!1,cf="";if(comments&&comments.length>0){var needtc=!1;comments.forEach(function(carr){carr[1].forEach(function(c){c.T==!0&&(needtc=!0)})}),needtc&&(cf="xl/threadedComments/threadedComment"+rId+".xml",zip_add_file(zip,cf,write_tcmnt_xml(comments,people,opts)),ct.threadedcomments.push(cf),add_rels(wsrels,-1,"../threadedComments/threadedComment"+rId+".xml",RELS.TCMNT)),cf="xl/comments"+rId+"."+wbext,zip_add_file(zip,cf,write_comments_xml(comments,opts)),ct.comments.push(cf),add_rels(wsrels,-1,"../comments"+rId+"."+wbext,RELS.CMNT),need_vml=!0}ws["!legacy"]&&need_vml&&zip_add_file(zip,"xl/drawings/vmlDrawing"+rId+".vml",write_vml(rId,ws["!comments"])),delete ws["!comments"],delete ws["!legacy"]}wsrels["!id"].rId1&&zip_add_file(zip,get_rels_path(f),write_rels(wsrels))}return opts.Strings!=null&&opts.Strings.length>0&&(f="xl/sharedStrings."+wbext,zip_add_file(zip,f,write_sst_xml(opts.Strings,opts)),ct.strs.push(f),add_rels(opts.wbrels,-1,"sharedStrings."+wbext,RELS.SST)),f="xl/workbook."+wbext,zip_add_file(zip,f,write_wb_xml(wb,opts)),ct.workbooks.push(f),add_rels(opts.rels,1,f,RELS.WB),f="xl/theme/theme1.xml",zip_add_file(zip,f,write_theme(wb.Themes,opts)),ct.themes.push(f),add_rels(opts.wbrels,-1,"theme/theme1.xml",RELS.THEME),f="xl/styles."+wbext,zip_add_file(zip,f,write_sty_xml(wb,opts)),ct.styles.push(f),add_rels(opts.wbrels,-1,"styles."+wbext,RELS.STY),wb.vbaraw&&vbafmt&&(f="xl/vbaProject.bin",zip_add_file(zip,f,wb.vbaraw),ct.vba.push(f),add_rels(opts.wbrels,-1,"vbaProject.bin",RELS.VBA)),f="xl/metadata."+wbext,zip_add_file(zip,f,write_xlmeta_xml()),ct.metadata.push(f),add_rels(opts.wbrels,-1,"metadata."+wbext,RELS.XLMETA),people.length>1&&(f="xl/persons/person.xml",zip_add_file(zip,f,write_people_xml(people,opts)),ct.people.push(f),add_rels(opts.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(zip,"[Content_Types].xml",write_ct(ct,opts)),zip_add_file(zip,"_rels/.rels",write_rels(opts.rels)),zip_add_file(zip,"xl/_rels/workbook."+wbext+".rels",write_rels(opts.wbrels)),delete opts.revssf,delete opts.ssf,zip}function firstbyte(f,o){var x="";switch((o||{}).type||"base64"){case"buffer":return[f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7]];case"base64":x=Base64_decode(f.slice(0,12));break;case"binary":x=f;break;case"array":return[f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7]];default:throw new Error("Unrecognized type "+(o&&o.type||"undefined"))}return[x.charCodeAt(0),x.charCodeAt(1),x.charCodeAt(2),x.charCodeAt(3),x.charCodeAt(4),x.charCodeAt(5),x.charCodeAt(6),x.charCodeAt(7)]}function write_cfb_ctr(cfb,o){switch(o.type){case"base64":case"binary":break;case"buffer":case"array":o.type="";break;case"file":return write_dl(o.file,CFB.write(cfb,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+o.bookType+"' files");default:throw new Error("Unrecognized type "+o.type)}return CFB.write(cfb,o)}function write_zip(wb,opts){switch(opts.bookType){case"ods":return write_ods(wb,opts);case"numbers":return write_numbers_iwa(wb,opts);case"xlsb":return write_zip_xlsb(wb,opts);default:return write_zip_xlsx(wb,opts)}}function write_zip_type(wb,opts){var o=dup(opts||{}),z=write_zip(wb,o);return write_zip_denouement(z,o)}function write_zip_denouement(z,o){var oopts={},ftype=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(o.compression&&(oopts.compression="DEFLATE"),o.password)oopts.type=ftype;else switch(o.type){case"base64":oopts.type="base64";break;case"binary":oopts.type="string";break;case"string":throw new Error("'string' output type invalid for '"+o.bookType+"' files");case"buffer":case"file":oopts.type=ftype;break;default:throw new Error("Unrecognized type "+o.type)}var out=z.FullPaths?CFB.write(z,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[oopts.type]||oopts.type,compression:!!o.compression}):z.generate(oopts);if(typeof Deno<"u"&&typeof out=="string"){if(o.type=="binary"||o.type=="base64")return out;out=new Uint8Array(s2ab2(out))}return o.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(out,o.password),o):o.type==="file"?write_dl(o.file,out):o.type=="string"?utf8read(out):out}function write_cfb_type(wb,opts){var o=opts||{},cfb=write_xlscfb(wb,o);return write_cfb_ctr(cfb,o)}function write_string_type(out,opts,bom){bom||(bom="");var o=bom+out;switch(opts.type){case"base64":return Base64_encode(utf8write(o));case"binary":return utf8write(o);case"string":return out;case"file":return write_dl(opts.file,o,"utf8");case"buffer":return has_buf?Buffer_from(o,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(o):write_string_type(o,{type:"binary"}).split("").map(function(c){return c.charCodeAt(0)})}throw new Error("Unrecognized type "+opts.type)}function write_stxt_type(out,opts){switch(opts.type){case"base64":return Base64_encode_pass(out);case"binary":return out;case"string":return out;case"file":return write_dl(opts.file,out,"binary");case"buffer":return has_buf?Buffer_from(out,"binary"):out.split("").map(function(c){return c.charCodeAt(0)})}throw new Error("Unrecognized type "+opts.type)}function write_binary_type(out,opts){switch(opts.type){case"string":case"base64":case"binary":for(var bstr="",i=0;i<out.length;++i)bstr+=String.fromCharCode(out[i]);return opts.type=="base64"?Base64_encode(bstr):opts.type=="string"?utf8read(bstr):bstr;case"file":return write_dl(opts.file,out);case"buffer":return out;default:throw new Error("Unrecognized type "+opts.type)}}function writeSync(wb,opts){reset_cp(),check_wb(wb);var o=dup(opts||{});if(o.cellStyles&&(o.cellNF=!0,o.sheetStubs=!0),o.type=="array"){o.type="binary";var out=writeSync(wb,o);return o.type="array",s2ab2(out)}var idx=0;if(o.sheet&&(typeof o.sheet=="number"?idx=o.sheet:idx=wb.SheetNames.indexOf(o.sheet),!wb.SheetNames[idx]))throw new Error("Sheet not found: "+o.sheet+" : "+typeof o.sheet);switch(o.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(wb,o),o);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]],o,wb),o);case"htm":case"html":return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]],o),o);case"txt":return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]],o),o);case"csv":return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]],o),o,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]],o),o);case"dbf":return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]],o),o);case"prn":return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]],o),o);case"rtf":return write_string_type(sheet_to_rtf(wb.Sheets[wb.SheetNames[idx]],o),o);case"eth":return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]],o),o);case"fods":return write_string_type(write_ods(wb,o),o);case"wk1":return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]],o),o);case"wk3":return write_binary_type(WK_.book_to_wk3(wb,o),o);case"biff2":o.biff||(o.biff=2);case"biff3":o.biff||(o.biff=3);case"biff4":return o.biff||(o.biff=4),write_binary_type(write_biff_buf(wb,o),o);case"biff5":o.biff||(o.biff=5);case"biff8":case"xla":case"xls":return o.biff||(o.biff=8),write_cfb_type(wb,o);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(wb,o);default:throw new Error("Unrecognized bookType |"+o.bookType+"|")}}function make_json_row(sheet,r,R,cols,header,hdr,o){var rr=encode_row(R),defval=o.defval,raw=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),isempty=!0,dense=sheet["!data"]!=null,row=header===1?[]:{};if(header!==1)if(Object.defineProperty)try{Object.defineProperty(row,"__rowNum__",{value:R,enumerable:!1})}catch{row.__rowNum__=R}else row.__rowNum__=R;if(!dense||sheet["!data"][R])for(var C=r.s.c;C<=r.e.c;++C){var val=dense?(sheet["!data"][R]||[])[C]:sheet[cols[C]+rr];if(val==null||val.t===void 0){if(defval===void 0)continue;hdr[C]!=null&&(row[hdr[C]]=defval);continue}var v=val.v;switch(val.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"b":case"n":if(!val.z||!fmt_is_date(val.z)||(v=numdate(v),typeof v=="number"))break;case"d":o&&(o.UTC||o.raw===!1)||(v=utc_to_local(new Date(v)));break;default:throw new Error("unrecognized type "+val.t)}if(hdr[C]!=null){if(v==null)if(val.t=="e"&&v===null)row[hdr[C]]=null;else if(defval!==void 0)row[hdr[C]]=defval;else if(raw&&v===null)row[hdr[C]]=null;else continue;else row[hdr[C]]=(val.t==="n"&&typeof o.rawNumbers=="boolean"?o.rawNumbers:raw)?v:format_cell(val,v,o);v!=null&&(isempty=!1)}}return{row,isempty}}function sheet_to_json(sheet,opts){if(sheet==null||sheet["!ref"]==null)return[];var val={t:"n",v:0},header=0,offset2=1,hdr=[],v=0,vv="",r={s:{r:0,c:0},e:{r:0,c:0}},o=opts||{},range=o.range!=null?o.range:sheet["!ref"];switch(o.header===1?header=1:o.header==="A"?header=2:Array.isArray(o.header)?header=3:o.header==null&&(header=0),typeof range){case"string":r=safe_decode_range(range);break;case"number":r=safe_decode_range(sheet["!ref"]),r.s.r=range;break;default:r=range}header>0&&(offset2=0);var rr=encode_row(r.s.r),cols=[],out=[],outi=0,counter=0,dense=sheet["!data"]!=null,R=r.s.r,C=0,header_cnt={};dense&&!sheet["!data"][R]&&(sheet["!data"][R]=[]);var colinfo=o.skipHidden&&sheet["!cols"]||[],rowinfo=o.skipHidden&&sheet["!rows"]||[];for(C=r.s.c;C<=r.e.c;++C)if(!(colinfo[C]||{}).hidden)switch(cols[C]=encode_col(C),val=dense?sheet["!data"][R][C]:sheet[cols[C]+rr],header){case 1:hdr[C]=C-r.s.c;break;case 2:hdr[C]=cols[C];break;case 3:hdr[C]=o.header[C-r.s.c];break;default:if(val==null&&(val={w:"__EMPTY",t:"s"}),vv=v=format_cell(val,null,o),counter=header_cnt[v]||0,!counter)header_cnt[v]=1;else{do vv=v+"_"+counter++;while(header_cnt[vv]);header_cnt[v]=counter,header_cnt[vv]=1}hdr[C]=vv}for(R=r.s.r+offset2;R<=r.e.r;++R)if(!(rowinfo[R]||{}).hidden){var row=make_json_row(sheet,r,R,cols,header,hdr,o);(row.isempty===!1||(header===1?o.blankrows!==!1:o.blankrows))&&(out[outi++]=row.row)}return out.length=outi,out}var qreg=/"/g;function make_csv_row(sheet,r,R,cols,fs,rs,FS,o){for(var isempty=!0,row=[],txt="",rr=encode_row(R),dense=sheet["!data"]!=null,datarow=dense&&sheet["!data"][R]||[],C=r.s.c;C<=r.e.c;++C)if(cols[C]){var val=dense?datarow[C]:sheet[cols[C]+rr];if(val==null)txt="";else if(val.v!=null){isempty=!1,txt=""+(o.rawNumbers&&val.t=="n"?val.v:format_cell(val,null,o));for(var i=0,cc=0;i!==txt.length;++i)if((cc=txt.charCodeAt(i))===fs||cc===rs||cc===34||o.forceQuotes){txt='"'+txt.replace(qreg,'""')+'"';break}txt=="ID"&&(txt='"ID"')}else val.f!=null&&!val.F?(isempty=!1,txt="="+val.f,txt.indexOf(",")>=0&&(txt='"'+txt.replace(qreg,'""')+'"')):txt="";row.push(txt)}if(o.strip)for(;row[row.length-1]==="";)--row.length;return o.blankrows===!1&&isempty?null:row.join(FS)}function sheet_to_csv(sheet,opts){var out=[],o=opts??{};if(sheet==null||sheet["!ref"]==null)return"";for(var r=safe_decode_range(sheet["!ref"]),FS=o.FS!==void 0?o.FS:",",fs=FS.charCodeAt(0),RS=o.RS!==void 0?o.RS:`
`,rs=RS.charCodeAt(0),row="",cols=[],colinfo=o.skipHidden&&sheet["!cols"]||[],rowinfo=o.skipHidden&&sheet["!rows"]||[],C=r.s.c;C<=r.e.c;++C)(colinfo[C]||{}).hidden||(cols[C]=encode_col(C));for(var w=0,R=r.s.r;R<=r.e.r;++R)(rowinfo[R]||{}).hidden||(row=make_csv_row(sheet,r,R,cols,fs,rs,FS,o),row!=null&&(row||o.blankrows!==!1)&&out.push((w++?RS:"")+row));return out.join("")}function sheet_to_txt(sheet,opts){opts||(opts={}),opts.FS="	",opts.RS=`
`;var s=sheet_to_csv(sheet,opts);if(typeof $cptable>"u"||opts.type=="string")return s;var o=$cptable.utils.encode(1200,s,"str");return"\xFF\xFE"+o}function sheet_to_formulae(sheet){var y="",x,val="";if(sheet==null||sheet["!ref"]==null)return[];var r=safe_decode_range(sheet["!ref"]),rr="",cols=[],C,cmds=[],dense=sheet["!data"]!=null;for(C=r.s.c;C<=r.e.c;++C)cols[C]=encode_col(C);for(var R=r.s.r;R<=r.e.r;++R)for(rr=encode_row(R),C=r.s.c;C<=r.e.c;++C)if(y=cols[C]+rr,x=dense?(sheet["!data"][R]||[])[C]:sheet[y],val="",x!==void 0){if(x.F!=null){if(y=x.F,!x.f)continue;val=x.f,y.indexOf(":")==-1&&(y=y+":"+y)}if(x.f!=null)val=x.f;else{if(x.t=="z")continue;if(x.t=="n"&&x.v!=null)val=""+x.v;else if(x.t=="b")val=x.v?"TRUE":"FALSE";else if(x.w!==void 0)val="'"+x.w;else{if(x.v===void 0)continue;x.t=="s"?val="'"+x.v:val=""+x.v}}cmds[cmds.length]=y+"="+val}return cmds}function sheet_add_json(_ws,js,opts){var o=opts||{},dense=_ws?_ws["!data"]!=null:o.dense;DENSE!=null&&dense==null&&(dense=DENSE);var offset2=+!o.skipHeader,ws=_ws||{};!_ws&&dense&&(ws["!data"]=[]);var _R=0,_C=0;if(ws&&o.origin!=null)if(typeof o.origin=="number")_R=o.origin;else{var _origin=typeof o.origin=="string"?decode_cell(o.origin):o.origin;_R=_origin.r,_C=_origin.c}var range={s:{c:0,r:0},e:{c:_C,r:_R+js.length-1+offset2}};if(ws["!ref"]){var _range=safe_decode_range(ws["!ref"]);range.e.c=Math.max(range.e.c,_range.e.c),range.e.r=Math.max(range.e.r,_range.e.r),_R==-1&&(_R=_range.e.r+1,range.e.r=_R+js.length-1+offset2)}else _R==-1&&(_R=0,range.e.r=js.length-1+offset2);var hdr=o.header||[],C=0,ROW=[];js.forEach(function(JS,R){dense&&!ws["!data"][_R+R+offset2]&&(ws["!data"][_R+R+offset2]=[]),dense&&(ROW=ws["!data"][_R+R+offset2]),keys(JS).forEach(function(k){(C=hdr.indexOf(k))==-1&&(hdr[C=hdr.length]=k);var v=JS[k],t="z",z="",ref=dense?"":encode_col(_C+C)+encode_row(_R+R+offset2),cell=dense?ROW[_C+C]:ws[ref];v&&typeof v=="object"&&!(v instanceof Date)?dense?ROW[_C+C]=v:ws[ref]=v:(typeof v=="number"?t="n":typeof v=="boolean"?t="b":typeof v=="string"?t="s":v instanceof Date?(t="d",o.UTC||(v=local_to_utc(v)),o.cellDates||(t="n",v=datenum(v)),z=cell!=null&&cell.z&&fmt_is_date(cell.z)?cell.z:o.dateNF||table_fmt[14]):v===null&&o.nullError&&(t="e",v=0),cell?(cell.t=t,cell.v=v,delete cell.w,delete cell.R,z&&(cell.z=z)):dense?ROW[_C+C]=cell={t,v}:ws[ref]=cell={t,v},z&&(cell.z=z))})}),range.e.c=Math.max(range.e.c,_C+hdr.length-1);var __R=encode_row(_R);if(dense&&!ws["!data"][_R]&&(ws["!data"][_R]=[]),offset2)for(C=0;C<hdr.length;++C)dense?ws["!data"][_R][C+_C]={t:"s",v:hdr[C]}:ws[encode_col(C+_C)+__R]={t:"s",v:hdr[C]};return ws["!ref"]=encode_range(range),ws}function json_to_sheet(js,opts){return sheet_add_json(null,js,opts)}function ws_get_cell_stub(ws,R,C){if(typeof R=="string"){if(ws["!data"]!=null){var RC=decode_cell(R);return ws["!data"][RC.r]||(ws["!data"][RC.r]=[]),ws["!data"][RC.r][RC.c]||(ws["!data"][RC.r][RC.c]={t:"z"})}return ws[R]||(ws[R]={t:"z"})}return typeof R!="number"?ws_get_cell_stub(ws,encode_cell(R)):ws_get_cell_stub(ws,encode_col(C||0)+encode_row(R))}function wb_sheet_idx(wb,sh){if(typeof sh=="number"){if(sh>=0&&wb.SheetNames.length>sh)return sh;throw new Error("Cannot find sheet # "+sh)}else if(typeof sh=="string"){var idx=wb.SheetNames.indexOf(sh);if(idx>-1)return idx;throw new Error("Cannot find sheet name |"+sh+"|")}else throw new Error("Cannot find sheet |"+sh+"|")}function book_new(ws,wsname){var wb={SheetNames:[],Sheets:{}};return ws&&book_append_sheet(wb,ws,wsname||"Sheet1"),wb}function book_append_sheet(wb,ws,name,roll){var i=1;if(!name)for(;i<=65535&&wb.SheetNames.indexOf(name="Sheet"+i)!=-1;++i,name=void 0);if(!name||wb.SheetNames.length>=65535)throw new Error("Too many worksheets");if(roll&&wb.SheetNames.indexOf(name)>=0&&name.length<32){var m=name.match(/\d+$/);i=m&&+m[0]||0;var root=m&&name.slice(0,m.index)||name;for(++i;i<=65535&&wb.SheetNames.indexOf(name=root+i)!=-1;++i);}if(check_ws_name(name),wb.SheetNames.indexOf(name)>=0)throw new Error("Worksheet with name |"+name+"| already exists!");return wb.SheetNames.push(name),wb.Sheets[name]=ws,name}function book_set_sheet_visibility(wb,sh,vis){wb.Workbook||(wb.Workbook={}),wb.Workbook.Sheets||(wb.Workbook.Sheets=[]);var idx=wb_sheet_idx(wb,sh);switch(wb.Workbook.Sheets[idx]||(wb.Workbook.Sheets[idx]={}),vis){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+vis)}wb.Workbook.Sheets[idx].Hidden=vis}function cell_set_number_format(cell,fmt){return cell.z=fmt,cell}function cell_set_hyperlink(cell,target,tooltip){return target?(cell.l={Target:target},tooltip&&(cell.l.Tooltip=tooltip)):delete cell.l,cell}function cell_set_internal_link(cell,range,tooltip){return cell_set_hyperlink(cell,"#"+range,tooltip)}function cell_add_comment(cell,text,author){cell.c||(cell.c=[]),cell.c.push({t:text,a:author||"SheetJS"})}function sheet_set_array_formula(ws,range,formula,dynamic){for(var rng=typeof range!="string"?range:safe_decode_range(range),rngstr=typeof range=="string"?range:encode_range(range),R=rng.s.r;R<=rng.e.r;++R)for(var C=rng.s.c;C<=rng.e.c;++C){var cell=ws_get_cell_stub(ws,R,C);cell.t="n",cell.F=rngstr,delete cell.v,R==rng.s.r&&C==rng.s.c&&(cell.f=formula,dynamic&&(cell.D=!0))}var wsr=decode_range(ws["!ref"]);return wsr.s.r>rng.s.r&&(wsr.s.r=rng.s.r),wsr.s.c>rng.s.c&&(wsr.s.c=rng.s.c),wsr.e.r<rng.e.r&&(wsr.e.r=rng.e.r),wsr.e.c<rng.e.c&&(wsr.e.c=rng.e.c),ws["!ref"]=encode_range(wsr),ws}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_new,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var version=XLSX.version;function getYYYYMMDD(date){let leftPaddedMonth=(date.getMonth()+1).toString().padStart(2,"0"),leftPaddedDate=date.getDate().toString().padStart(2,"0");return`${date.getFullYear()}${leftPaddedMonth}${leftPaddedDate}`}function getNowDateKey(){return getYYYYMMDD(new Date)}function idToName(name,template){if(!name&&!template)return"";let cleanIsh=s=>(s=s.replace(/\s+/g,"_"),s=s.replace(/\(/g,""),s=s.replace(/\)/g,""),s);if(name||(name=""),name=cleanIsh(name),!template)return name;let domain=window.location.host;if(domain.indexOf(".")!==-1){let domainParts=domain.split(".");domainParts.length>1&&(domain=domainParts[domainParts.length-2])}let varToVal={$NAME:name,$DOMAIN:domain,$DATE:getNowDateKey(),$ISO_DATETIME:new Date().toISOString()},filename=template;return Object.keys(varToVal).forEach(key=>{filename.indexOf(key)!==-1&&key in varToVal&&(filename=filename.replace(key,varToVal[key]))}),cleanIsh(filename)}function exportArrayOfArraysToCSVP(data,sheetname,filename,delimiter){return new Promise((resolve,reject)=>{try{resolve(exportArrayOfArraysToCSV(data,sheetname,filename,delimiter))}catch(err){reject(err)}})}function exportArrayOfArraysToCSV(data,sheetname,filename,delimiter){sheetname=sheetname||"Table Capture";let sheet=utils.aoa_to_sheet(data),wb=utils.book_new();return utils.book_append_sheet(wb,sheet,sheetname),writeWorkbookToCsv(wb,filename,delimiter)}function writeWorkbookToCsv(wb,filename,delimiter){filename=(filename||"table-capture")+".csv",delimiter=delimiter||",";let wbout;try{wbout=writeSync(wb,{bookType:"csv",bookSST:!0,type:"binary",FS:delimiter})}catch(err){throw console.log(err),delimiter!==","?`Error using custom delimiter (${delimiter})`:`Error exporting table: ${filename}`}try{(0,import_file_saver.default)(new Blob([s2ab(wbout)],{type:"text/csv"}),filename)}catch(e){throw console.log(e,wbout),`Error exporting table: ${filename}`}return wbout}function exportArrayOfArraysToExcelP(data,sheetname,filename,opts={}){return new Promise((resolve,reject)=>{try{resolve(exportArrayOfArraysToExcel(data,sheetname,filename,opts))}catch(err){reject(err)}})}function exportArrayOfArraysToExcel(data,sheetname,filename,opts={}){let{numberAsNumber=!1,numDecimalChar=".",numThousandChar=","}=opts;numberAsNumber&&_tcInPlaceNumberization(data,numDecimalChar,numThousandChar),sheetname=sheetname||"Table Capture";let sheet=utils.aoa_to_sheet(data),wb=utils.book_new();return utils.book_append_sheet(wb,sheet,sheetname),writeWorkbookToExcel(wb,filename)}function writeWorkbookToExcel(wb,filename){let type="xlsx";filename=filename||"table-capture",filename+="."+type;let wbout=writeSync(wb,{bookType:type,bookSST:!0,type:"binary"});try{let excelFileBlob=new Blob([s2ab(wbout)],{type:"application/vnd.ms-excel"});(0,import_file_saver.default)(excelFileBlob,filename)}catch(e){throw console.log(e,wbout),`Error exporting table: ${filename}`}return wbout}function isInShadowDOM(el){let currentNode=el;for(;currentNode;){if(currentNode instanceof ShadowRoot)return!0;currentNode=currentNode.parentNode}return!1}var import_html2canvas=__toESM(require_html2canvas(),1);function sendRuntimeMessage(params){return new Promise((resolve,reject)=>{chrome.runtime.sendMessage(params,response=>hasRuntimeError()?reject(getRuntimeError()):response&&response.err?typeof response.err=="string"?reject(new Error(response.err)):reject(response.err):resolve(response))})}function cropImageForElement(dataUrl,element){throw new Error("Not implemented")}function wrappedHtml2canvas(domElement){if(!domElement)return Promise.reject(new Error("No element to capture"));let hasClass=domElement.classList.contains(CLASSNAME_TABLE_HIGHLIGHTED);try{domElement.classList.remove(CLASSNAME_TABLE_HIGHLIGHTED)}catch{}try{if(typeof import_html2canvas.default>"u"){let params={action:"SCREENSHOT_VISIBLE_TAB"};return sendRuntimeMessage(params).then(response=>cropImageForElement(response.dataUrl,domElement))}else return(0,import_html2canvas.default)(domElement).then(canvas=>{let data=canvas.toDataURL();if(isCanvasDataNull(data))throw new Error("Unable to get canvas data");return hasClass&&domElement.classList.add(CLASSNAME_TABLE_HIGHLIGHTED),data})}catch(err){return Promise.reject(err)}}function isCanvasDataNull(data){return!data||!data.trim()||data.trim()=="data:,"}function forceDownloadBlob(filename,blob){let url=(window.URL||window.webkitURL).createObjectURL(blob),link=document.createElement("a");link.setAttribute("style","display: none"),document.body.appendChild(link),link.href=url,link.download=filename;try{link.click()}catch{let click=document.createEvent("Event");click.initEvent("click",!0,!0),link.dispatchEvent(click)}window.URL.revokeObjectURL(url)}var BorderStyle="2px solid coral",BoxShadowStyle="0px 0px 20px 12px coral";function applySelectionNodeStyles(element){element&&(element.style.border=BorderStyle,element.style.boxShadow=BoxShadowStyle)}function removeSelectionNodeStyles(element){element&&(element.style.border===BorderStyle&&(element.style.border=""),element.style.boxShadow===BoxShadowStyle&&(element.style.boxShadow=""))}var CLASSNAME_TABLE_SELECTED="_tc_table_selected",CLASSNAME_TABLE_HIGHLIGHTED="_tc_table_highlighted",CLASSNAME_TABLE_JUST_HIGHLIGHTED="_tc_just_highlighted",ElementWrapper=class{domElement_;scrollTimeout_;url;pageTitle;def_=null;userConfig_;constructor(element,url,userConfig){this.domElement_=element,this.scrollTimeout_=null,this.url=url,this.pageTitle=typeof document<"u"&&document&&document.title?document.title:void 0,this.userConfig_=userConfig}setFrameId(frameId){this.def_||(this.def_={}),this.def_.frameId=frameId??null}setTableIndex(tableIndex){this.def_||(this.def_={}),this.def_.index=tableIndex}setPageTitle(pageTitle){this.pageTitle=pageTitle}getDirect(){return{url:this.url,pageTitle:this.pageTitle,def:this.def_}}getAsString(outputFormat){throw new Error("Not implemented in parent class")}getAsArrays(){throw new Error("Not implemented in parent class")}getTableId(){throw new Error("Not implemented in parent class")}isSpecialCaseWrapper(){return!1}getElementWrapperType(){throw new Error("Not implemented in parent class")}isTableWrapper(){return!1}isSelectionWrapper(){return!1}isRecipeWrapper(){return!1}getRecipeDefinition(){return{name:this.pageTitle??void 0,description:`A recipe for the page: ${this.pageTitle}`,urlRegex:`https://.*${window.location.host}..*`,urlExample:window.location.href,selector:_tcSpecificGetSelectorForEl(this.domElement_)??void 0,disabled:!1,autoClip:!1}}getReproOptions(){return{treatAsTable:!0}}getFilename(){return idToName(this.getTableId(),this.userConfig_.filenameTemplate)}getDomElement(){return this.domElement_}getDomAttributes_(){if(!this.domElement_)throw new Error("No element found");let id=this.domElement_.getAttribute("id"),name=this.domElement_.getAttribute("name"),className=this.domElement_.getAttribute("class"),pathTo=_tcGetPathTo(this.domElement_);(id===null||id==="")&&(id="",[name,className].forEach(el=>{el!==null&&el!==""&&(id?.length&&(id+=", "),id+=el)}));let adjustedId=id;return adjustedId&&adjustedId.length>16&&(adjustedId=adjustedId.substring(0,15)+"..."),{id,adjustedId,name,className,pathTo:pathTo??void 0}}toJSON(){return{...this.def_}}isMassiveTable_(){return(this.def_?.numCells??0)>500*10}supportsInlineMenu(){return!1}performRepro(repro){return repro.messageAction==="SCREENSHOT"?this.screenshot():repro.messageAction==="CSV"?this.csv():repro.messageAction==="EXCEL"?this.excel():repro.messageAction==="COPY"?this.copy(repro.outputFormat||"CLIPBOARD"):Promise.reject(new Error("Unsupported Table Capture reproduction: "+repro.messageAction))}excel(){_tcLogTableWrapperMessageAction(this,"EXCEL","EXCEL",this.userConfig_);let opts={numberAsNumber:this.userConfig_.numberAsNumber,numDecimalChar:this.userConfig_.numDecimalChar,numThousandChar:this.userConfig_.numThousandChar},sheetname="Sheet 1 via Table Capture",data=this.getAsArrays(),filename=this.getFilename();return exportArrayOfArraysToExcelP(data,sheetname,filename,opts)}csv(){_tcLogTableWrapperMessageAction(this,"CSV","CSV",this.userConfig_);let data=this.getAsArrays(),filename=this.getFilename();return exportArrayOfArraysToCSVP(data,"Sheet",filename,this.userConfig_.csvDelimiter)}scrollTo(){if(this.domElement_)try{if(this.isMassiveTable_()||!isBehindOtherElement(this.domElement_,!1))return;this.domElement_.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}),this.scrollTimeout_&&window.clearTimeout(this.scrollTimeout_),this.scrollTimeout_=window.setTimeout(()=>{this.scrollTimeout_=null,this.domElement_&&isBehindOtherElement(this.domElement_,!0)&&this.domElement_.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},1e3)}catch{document.body.scrollTop=this.domElement_.offsetTop}}select(){this.domElement_?.classList.add(CLASSNAME_TABLE_SELECTED),this.scrollTo()}deselect(){this.domElement_?.classList.remove(CLASSNAME_TABLE_SELECTED)}highlight(){this.isMassiveTable_()||!this.domElement_||(isInShadowDOM(this.domElement_)?applySelectionNodeStyles(this.domElement_):this.domElement_.classList.add(CLASSNAME_TABLE_HIGHLIGHTED),this.scrollTo())}flash(){isInShadowDOM(this.domElement_)?applySelectionNodeStyles(this.domElement_):this.domElement_?.classList.add(CLASSNAME_TABLE_HIGHLIGHTED),window.setTimeout(()=>{this.domElement_?.classList.remove(CLASSNAME_TABLE_HIGHLIGHTED),removeSelectionNodeStyles(this.domElement_)},500)}screenshotDataUrl(){return wrappedHtml2canvas(this.domElement_)}screenshot(){return wrappedHtml2canvas(this.domElement_).then(dataUrl=>{if(this.userConfig_.copyImagesToClipboard)copyImageToClipboard(dataUrl);else{let blob=new Blob([base64ToUint8Array(dataUrl)],{type:"image/png"});forceDownloadBlob("image.png",blob)}return Promise.resolve()})}async copy(outputFormat){let tableString=this.getAsString(outputFormat),params={action:"COPY_TABLE_STRING",tableString};if(await canUseClipboard())try{await copyToClipboardNew(tableString)}catch{copyToClipboard(tableString)}else copyToClipboard(tableString);return sendRuntimeMessage(params).then(()=>(this.highlightPostCopy(),Promise.resolve()))}highlightPostCopy(){let element=this.domElement_;element?.classList.add(CLASSNAME_TABLE_JUST_HIGHLIGHTED),setTimeout(()=>{element?.classList.remove(CLASSNAME_TABLE_JUST_HIGHLIGHTED)},5*1e3)}unhighlight(){this.scrollTimeout_&&(window.clearTimeout(this.scrollTimeout_),this.scrollTimeout_=null),!this.isMassiveTable_()&&(this.domElement_?.classList.remove(CLASSNAME_TABLE_HIGHLIGHTED),removeSelectionNodeStyles(this.domElement_))}destroy(){this.unhighlight()}};var MinValidNumCells=3,TableWrapper=class extends ElementWrapper{windowName;constructor(table,url,windowName,userConfig){super(table,url,userConfig),this.domElement_=table,this.windowName=windowName,this.define_()}isTableWrapper(){return!0}getElementWrapperType(){return"TABLE"}destroy(){super.destroy(),this.domElement_=null}getRecipeDefinition(){let baseRecipe=super.getRecipeDefinition();return baseRecipe.selector||(baseRecipe.selector="table"),{...baseRecipe}}getTableIndex(){return this.def_?.index??null}setTableIndex(tableIndex){this.def_||(this.def_={}),this.def_.index=tableIndex}inferTableIndex(){let matchingIndex=Array.from(document.querySelectorAll("table")).filter(t=>!t.classList.contains("tc-ignore")).map((table,index)=>({table,tableIndex:index})).filter(pair=>pair.table===this.domElement_);matchingIndex.length===1&&this.setTableIndex(matchingIndex[0].tableIndex)}supportsInlineMenu(){return!0}getTableId(){return this.def_.id}isValid(){return!this.def_||(this.def_.numCells??0)<=MinValidNumCells||!this.domElement_||this.domElement_.classList.contains("tc-ignore")||this.userConfig_.ignoreHiddenTables&&(this.domElement_.offsetHeight<1||this.domElement_.offsetWidth<1)?!1:this.def_.cols!==void 0&&this.def_.cols!==0&&this.def_.rows!==void 0&&this.def_.rows!==0}define_(){let table=this.domElement_;if(!table)return;let{id,adjustedId,pathTo}=this.getDomAttributes_(),rows=Array.from(table.getElementsByTagName("TR")),nRows=rows.length,nCols=this.getNumTableColumns_(rows),size=`(${nRows} x ${nCols}) `;this.def_={index:this.def_?.index??void 0,windowName:this.windowName,pathTo,id:size+id,adjusted:size+adjustedId,rows:nRows,cols:nCols,numCells:nRows*nCols}}getNumTableColumns_(rows){return!rows||rows.length===0?0:Array.from(rows).map(row=>row.childElementCount).sort((a,b)=>b-a)[0]}screenshot(){return _tcLogTableWrapperMessageAction(this,"SCREENSHOT",null,this.userConfig_),super.screenshot()}getAsString(outputFormat){let str=tableNodeToString(this.domElement_,TABULAR_COPY_CONST.rowSeparator,TABULAR_COPY_CONST.colSeparator,this.userConfig_);return postProcessFinalString(str,outputFormat,TABULAR_COPY_CONST.rowSeparator,TABULAR_COPY_CONST.colSeparator,this.userConfig_)}getAsArrays(){return nodeToArrays(this.domElement_,TABULAR_COPY_CONST.rowSeparator,TABULAR_COPY_CONST.colSeparator,this.userConfig_,!0)}copy(outputFormat){return _tcLogTableWrapperMessageAction(this,"COPY",outputFormat,this.userConfig_),super.copy(outputFormat)}};function i8n(key){return chrome.i18n.getMessage(key)}function getDomainFromUrl(url){try{return new URL(url).host}catch{}return null}var CloudLicenseProducts=["tablecapturecloud"];var AdjacentProducts=["edgecapture","foxcapture","tablecapture","tablecapturepro","tablecapturelife","tablecapturecloud","tabletoexcel"];var LicenseUrl=`${BASE_API_URL}/licensing/charge`;var GMikeApiError=class extends Error{code;message;constructor(code,message){super(message),this.code=code,this.message=message}};var ApiConfig={auth:`${BASE_API_URL}/licensing/charge/user/auth`,cloud:{signup:`${BASE_API_URL}/licensing/charge/cloudsignup`,licenses:`${BASE_API_URL}/licensing/charge/user/cloudlicenses`,capturedefinition:`${BASE_API_URL}/cloud/capturedefinition`},ping:`${BASE_API_URL}/licensing/charge/ping`},GMikeAPI=class{checkJsonResponse_;localStorageApi_;constructor(){this.checkJsonResponse_=response=>{if(!response.ok)throw new GMikeApiError(response.status,response.statusText);return response.json()},this.localStorageApi_=getLocalStorageApi()}checkApiAvailability(){return new Promise(resolve=>{let timeout=window.setTimeout(()=>{resolve(!1)},2e3),url=ApiConfig.ping;fetch(url).then(response=>{resolve(!!response.ok),timeout&&window.clearTimeout(timeout)}).catch(err=>resolve(!1))})}getLicenseStatusString(license){let now=new Date().getTime(),{cancelled,expiration}=license;return cancelled?"Canceled":Number(expiration)<now?"Expired":"Active"}createStubAccountInfo(accountInfo={}){return{hasCloudLicenses:!1,hasActiveCloudLicense:!1,activeCloudLicenses:[],activeLicenses:[],nonTableCaptureLicenses:[],tableCaptureLicenses:[],apiKeys:void 0,localAccountMetadata:void 0,...accountInfo}}processCloudLicenseResponse(cloudLicenseResponse){let now=new Date().getTime(),{cloudLicenses,licenses,metadata:cloudAccountMetadata,account:cloudAccount}=cloudLicenseResponse,activeTableCaptureLicenses=licenses.filter(l=>!l.cancelled).filter(l=>Number(l.expiration)>now).filter(l=>AdjacentProducts.includes(l.product))||[],tableCaptureLicenses=(licenses||[]).filter(l=>AdjacentProducts.includes(l.product)).filter(l=>!CloudLicenseProducts.includes(l.product)),nonTableCaptureLicenses=licenses.filter(l=>!AdjacentProducts.includes(l.product))||[],activeCloudLicenses=cloudLicenses.filter(l=>!l.cancelled).filter(l=>Number(l.expiration)>now)||[],gptApiKey=cloudAccount&&cloudAccount.gptApiKey||null;return this.localStorageApi_.getP("gptTokensConsumed").then(values=>{let localAccountMetadata={gptTokensConsumed:values.gptTokensConsumed||0};return{hasCloudLicenses:!!cloudLicenses.length,hasActiveCloudLicense:activeCloudLicenses.length>0,activeCloudLicenses,activeLicenses:activeTableCaptureLicenses,nonTableCaptureLicenses,tableCaptureLicenses,localAccountMetadata,cloudAccountMetadata,hasGptEnabled:!!gptApiKey,apiKeys:{gptApiKey}}})}getCloudLicensesWithToken(token,logActivation=!1){if(!token)return Promise.reject({err:"Please provide a valid token."});let url=ApiConfig.cloud.licenses;logActivation&&(url=ApiConfig.cloud.licenses+"?activate=1");let params={method:"POST",body:JSON.stringify({token}),headers:{"Content-Type":"application/json"}};return fetch(url,params).then(this.checkJsonResponse_).catch(err=>err&&err.code&&err.code===403?Promise.reject(err):Promise.reject({err:err.message||"Unable to retrieve cloud licenses"}))}getUserEmailWithToken(token){let url=ApiConfig.auth,params={method:"POST",body:JSON.stringify({token}),headers:{"Content-Type":"application/json"}};return fetch(url,params).then(this.checkJsonResponse_).catch(err=>Promise.reject({err:err.message||"Unable to get user email"}))}signupForCloud(bodyParams){let url=ApiConfig.cloud.signup,params={method:"POST",body:JSON.stringify(bodyParams),headers:{"Content-Type":"application/json"}};return fetch(url,params).then(response=>{if(!response.ok)throw Error(response.statusText)})}saveCloudCaptureDefinition(token,captureDefinition){if(!token)return Promise.reject({err:"Please provide a valid token."});let url=ApiConfig.cloud.capturedefinition,params={method:"POST",body:JSON.stringify({token,captureDefinition}),headers:{"Content-Type":"application/json"}};return fetch(url,params).then(this.checkJsonResponse_).catch(err=>Promise.reject({err:err.message||"Unable to save your table capture definition."}))}};function getExtensionActivityLogData(){let key=LogKey;return getLocalStorageApi().getP(key).then(values=>values&&values[key]?formatActivityLogData(values[key]):null)}function formatActivityLogData(logData){let newLogData={...logData};return Object.values(newLogData).filter(entry=>entry&&typeof entry=="object").forEach(logItem=>{Object.values(logItem.elements).forEach(element=>{element.name||(element.id?element.name=`Table#${element.id}`:element.pathTo?element.name=`Table (${element.pathTo})`:element.name="Table")})}),logData}function getReadableOutputFormat(outputFormat){return outputFormat==="CLIPBOARD_DOCUMENT"?"DOCUMENT":outputFormat}function getReadableMessageAction(messageAction){return messageAction?messageAction=="COPY_TABLE_STRING"||messageAction=="COPY_STRING"?"COPY":messageAction=="COPY_TABLE_IMAGE"||messageAction.includes("SCREENSHOT")?"SCREENSHOT":messageAction.includes("EXCEL")?"EXCEL":messageAction.includes("CSV")?"CSV":messageAction==="AI_COLUMN_EXTRACTION"?"MAGIC COLUMNS":messageAction:null}function summarizeLatestRepro(repros){if(!repros||repros.length===0)return null;let latestRepro=repros[repros.length-1];return summarizeRepro(latestRepro)}function summarizeRepro({messageAction,outputFormat}){let messageActionStr=messageAction?.toString(),outputFormatStr=outputFormat?.toString(),readableMessageAction=getReadableMessageAction(messageAction);if(messageAction&&messageActionStr===outputFormatStr)return`EXPORT \u2192 ${readableMessageAction}`;if(messageAction&&outputFormat){let readableOutputFormat=getReadableOutputFormat(outputFormat);return`${readableMessageAction} \u2192 ${readableOutputFormat}`}return messageAction?readableMessageAction:"EXPORT"}function createSeparator(){let span=document.createElement("span");return span.innerHTML="&nbsp;&middot;&nbsp;",span}var lib_exports={};__export(lib_exports,{afterMain:()=>afterMain,afterRead:()=>afterRead,afterWrite:()=>afterWrite,applyStyles:()=>applyStyles_default,arrow:()=>arrow_default,auto:()=>auto,basePlacements:()=>basePlacements,beforeMain:()=>beforeMain,beforeRead:()=>beforeRead,beforeWrite:()=>beforeWrite,bottom:()=>bottom,clippingParents:()=>clippingParents,computeStyles:()=>computeStyles_default,createPopper:()=>createPopper3,createPopperBase:()=>createPopper,createPopperLite:()=>createPopper2,detectOverflow:()=>detectOverflow,end:()=>end,eventListeners:()=>eventListeners_default,flip:()=>flip_default,hide:()=>hide_default,left:()=>left,main:()=>main,modifierPhases:()=>modifierPhases,offset:()=>offset_default,placements:()=>placements,popper:()=>popper,popperGenerator:()=>popperGenerator,popperOffsets:()=>popperOffsets_default,preventOverflow:()=>preventOverflow_default,read:()=>read,reference:()=>reference,right:()=>right,start:()=>start,top:()=>top,variationPlacements:()=>variationPlacements,viewport:()=>viewport,write:()=>write});var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(acc,placement){return acc.concat([placement+"-"+start,placement+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(acc,placement){return acc.concat([placement,placement+"-"+start,placement+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(element){return element?(element.nodeName||"").toLowerCase():null}function getWindow(node){if(node==null)return window;if(node.toString()!=="[object Window]"){var ownerDocument=node.ownerDocument;return ownerDocument&&ownerDocument.defaultView||window}return node}function isElement(node){var OwnElement=getWindow(node).Element;return node instanceof OwnElement||node instanceof Element}function isHTMLElement(node){var OwnElement=getWindow(node).HTMLElement;return node instanceof OwnElement||node instanceof HTMLElement}function isShadowRoot(node){if(typeof ShadowRoot>"u")return!1;var OwnElement=getWindow(node).ShadowRoot;return node instanceof OwnElement||node instanceof ShadowRoot}function applyStyles(_ref){var state=_ref.state;Object.keys(state.elements).forEach(function(name){var style=state.styles[name]||{},attributes=state.attributes[name]||{},element=state.elements[name];!isHTMLElement(element)||!getNodeName(element)||(Object.assign(element.style,style),Object.keys(attributes).forEach(function(name2){var value=attributes[name2];value===!1?element.removeAttribute(name2):element.setAttribute(name2,value===!0?"":value)}))})}function effect(_ref2){var state=_ref2.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow),function(){Object.keys(state.elements).forEach(function(name){var element=state.elements[name],attributes=state.attributes[name]||{},styleProperties=Object.keys(state.styles.hasOwnProperty(name)?state.styles[name]:initialStyles[name]),style=styleProperties.reduce(function(style2,property){return style2[property]="",style2},{});!isHTMLElement(element)||!getNodeName(element)||(Object.assign(element.style,style),Object.keys(attributes).forEach(function(attribute){element.removeAttribute(attribute)}))})}}var applyStyles_default={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect,requires:["computeStyles"]};function getBasePlacement(placement){return placement.split("-")[0]}var max=Math.max,min=Math.min,round=Math.round;function getUAString(){var uaData=navigator.userAgentData;return uaData!=null&&uaData.brands&&Array.isArray(uaData.brands)?uaData.brands.map(function(item){return item.brand+"/"+item.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(element,includeScale,isFixedStrategy){includeScale===void 0&&(includeScale=!1),isFixedStrategy===void 0&&(isFixedStrategy=!1);var clientRect=element.getBoundingClientRect(),scaleX=1,scaleY=1;includeScale&&isHTMLElement(element)&&(scaleX=element.offsetWidth>0&&round(clientRect.width)/element.offsetWidth||1,scaleY=element.offsetHeight>0&&round(clientRect.height)/element.offsetHeight||1);var _ref=isElement(element)?getWindow(element):window,visualViewport=_ref.visualViewport,addVisualOffsets=!isLayoutViewport()&&isFixedStrategy,x=(clientRect.left+(addVisualOffsets&&visualViewport?visualViewport.offsetLeft:0))/scaleX,y=(clientRect.top+(addVisualOffsets&&visualViewport?visualViewport.offsetTop:0))/scaleY,width=clientRect.width/scaleX,height=clientRect.height/scaleY;return{width,height,top:y,right:x+width,bottom:y+height,left:x,x,y}}function getLayoutRect(element){var clientRect=getBoundingClientRect(element),width=element.offsetWidth,height=element.offsetHeight;return Math.abs(clientRect.width-width)<=1&&(width=clientRect.width),Math.abs(clientRect.height-height)<=1&&(height=clientRect.height),{x:element.offsetLeft,y:element.offsetTop,width,height}}function contains(parent,child){var rootNode=child.getRootNode&&child.getRootNode();if(parent.contains(child))return!0;if(rootNode&&isShadowRoot(rootNode)){var next=child;do{if(next&&parent.isSameNode(next))return!0;next=next.parentNode||next.host}while(next)}return!1}function getComputedStyle2(element){return getWindow(element).getComputedStyle(element)}function isTableElement(element){return["table","td","th"].indexOf(getNodeName(element))>=0}function getDocumentElement(element){return((isElement(element)?element.ownerDocument:element.document)||window.document).documentElement}function getParentNode(element){return getNodeName(element)==="html"?element:element.assignedSlot||element.parentNode||(isShadowRoot(element)?element.host:null)||getDocumentElement(element)}function getTrueOffsetParent(element){return!isHTMLElement(element)||getComputedStyle2(element).position==="fixed"?null:element.offsetParent}function getContainingBlock(element){var isFirefox=/firefox/i.test(getUAString()),isIE=/Trident/i.test(getUAString());if(isIE&&isHTMLElement(element)){var elementCss=getComputedStyle2(element);if(elementCss.position==="fixed")return null}var currentNode=getParentNode(element);for(isShadowRoot(currentNode)&&(currentNode=currentNode.host);isHTMLElement(currentNode)&&["html","body"].indexOf(getNodeName(currentNode))<0;){var css=getComputedStyle2(currentNode);if(css.transform!=="none"||css.perspective!=="none"||css.contain==="paint"||["transform","perspective"].indexOf(css.willChange)!==-1||isFirefox&&css.willChange==="filter"||isFirefox&&css.filter&&css.filter!=="none")return currentNode;currentNode=currentNode.parentNode}return null}function getOffsetParent(element){for(var window2=getWindow(element),offsetParent=getTrueOffsetParent(element);offsetParent&&isTableElement(offsetParent)&&getComputedStyle2(offsetParent).position==="static";)offsetParent=getTrueOffsetParent(offsetParent);return offsetParent&&(getNodeName(offsetParent)==="html"||getNodeName(offsetParent)==="body"&&getComputedStyle2(offsetParent).position==="static")?window2:offsetParent||getContainingBlock(element)||window2}function getMainAxisFromPlacement(placement){return["top","bottom"].indexOf(placement)>=0?"x":"y"}function within(min2,value,max2){return max(min2,min(value,max2))}function withinMaxClamp(min2,value,max2){var v=within(min2,value,max2);return v>max2?max2:v}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(paddingObject){return Object.assign({},getFreshSideObject(),paddingObject)}function expandToHashMap(value,keys2){return keys2.reduce(function(hashMap,key){return hashMap[key]=value,hashMap},{})}var toPaddingObject=function(padding,state){return padding=typeof padding=="function"?padding(Object.assign({},state.rects,{placement:state.placement})):padding,mergePaddingObject(typeof padding!="number"?padding:expandToHashMap(padding,basePlacements))};function arrow(_ref){var _state$modifiersData$,state=_ref.state,name=_ref.name,options=_ref.options,arrowElement=state.elements.arrow,popperOffsets2=state.modifiersData.popperOffsets,basePlacement=getBasePlacement(state.placement),axis=getMainAxisFromPlacement(basePlacement),isVertical=[left,right].indexOf(basePlacement)>=0,len=isVertical?"height":"width";if(!(!arrowElement||!popperOffsets2)){var paddingObject=toPaddingObject(options.padding,state),arrowRect=getLayoutRect(arrowElement),minProp=axis==="y"?top:left,maxProp=axis==="y"?bottom:right,endDiff=state.rects.reference[len]+state.rects.reference[axis]-popperOffsets2[axis]-state.rects.popper[len],startDiff=popperOffsets2[axis]-state.rects.reference[axis],arrowOffsetParent=getOffsetParent(arrowElement),clientSize=arrowOffsetParent?axis==="y"?arrowOffsetParent.clientHeight||0:arrowOffsetParent.clientWidth||0:0,centerToReference=endDiff/2-startDiff/2,min2=paddingObject[minProp],max2=clientSize-arrowRect[len]-paddingObject[maxProp],center=clientSize/2-arrowRect[len]/2+centerToReference,offset2=within(min2,center,max2),axisProp=axis;state.modifiersData[name]=(_state$modifiersData$={},_state$modifiersData$[axisProp]=offset2,_state$modifiersData$.centerOffset=offset2-center,_state$modifiersData$)}}function effect2(_ref2){var state=_ref2.state,options=_ref2.options,_options$element=options.element,arrowElement=_options$element===void 0?"[data-popper-arrow]":_options$element;arrowElement!=null&&(typeof arrowElement=="string"&&(arrowElement=state.elements.popper.querySelector(arrowElement),!arrowElement)||contains(state.elements.popper,arrowElement)&&(state.elements.arrow=arrowElement))}var arrow_default={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect2,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(placement){return placement.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(_ref,win){var x=_ref.x,y=_ref.y,dpr=win.devicePixelRatio||1;return{x:round(x*dpr)/dpr||0,y:round(y*dpr)/dpr||0}}function mapToStyles(_ref2){var _Object$assign2,popper2=_ref2.popper,popperRect=_ref2.popperRect,placement=_ref2.placement,variation=_ref2.variation,offsets=_ref2.offsets,position=_ref2.position,gpuAcceleration=_ref2.gpuAcceleration,adaptive=_ref2.adaptive,roundOffsets=_ref2.roundOffsets,isFixed=_ref2.isFixed,_offsets$x=offsets.x,x=_offsets$x===void 0?0:_offsets$x,_offsets$y=offsets.y,y=_offsets$y===void 0?0:_offsets$y,_ref3=typeof roundOffsets=="function"?roundOffsets({x,y}):{x,y};x=_ref3.x,y=_ref3.y;var hasX=offsets.hasOwnProperty("x"),hasY=offsets.hasOwnProperty("y"),sideX=left,sideY=top,win=window;if(adaptive){var offsetParent=getOffsetParent(popper2),heightProp="clientHeight",widthProp="clientWidth";if(offsetParent===getWindow(popper2)&&(offsetParent=getDocumentElement(popper2),getComputedStyle2(offsetParent).position!=="static"&&position==="absolute"&&(heightProp="scrollHeight",widthProp="scrollWidth")),offsetParent=offsetParent,placement===top||(placement===left||placement===right)&&variation===end){sideY=bottom;var offsetY=isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.height:offsetParent[heightProp];y-=offsetY-popperRect.height,y*=gpuAcceleration?1:-1}if(placement===left||(placement===top||placement===bottom)&&variation===end){sideX=right;var offsetX=isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.width:offsetParent[widthProp];x-=offsetX-popperRect.width,x*=gpuAcceleration?1:-1}}var commonStyles=Object.assign({position},adaptive&&unsetSides),_ref4=roundOffsets===!0?roundOffsetsByDPR({x,y},getWindow(popper2)):{x,y};if(x=_ref4.x,y=_ref4.y,gpuAcceleration){var _Object$assign;return Object.assign({},commonStyles,(_Object$assign={},_Object$assign[sideY]=hasY?"0":"",_Object$assign[sideX]=hasX?"0":"",_Object$assign.transform=(win.devicePixelRatio||1)<=1?"translate("+x+"px, "+y+"px)":"translate3d("+x+"px, "+y+"px, 0)",_Object$assign))}return Object.assign({},commonStyles,(_Object$assign2={},_Object$assign2[sideY]=hasY?y+"px":"",_Object$assign2[sideX]=hasX?x+"px":"",_Object$assign2.transform="",_Object$assign2))}function computeStyles(_ref5){var state=_ref5.state,options=_ref5.options,_options$gpuAccelerat=options.gpuAcceleration,gpuAcceleration=_options$gpuAccelerat===void 0?!0:_options$gpuAccelerat,_options$adaptive=options.adaptive,adaptive=_options$adaptive===void 0?!0:_options$adaptive,_options$roundOffsets=options.roundOffsets,roundOffsets=_options$roundOffsets===void 0?!0:_options$roundOffsets,commonStyles={placement:getBasePlacement(state.placement),variation:getVariation(state.placement),popper:state.elements.popper,popperRect:state.rects.popper,gpuAcceleration,isFixed:state.options.strategy==="fixed"};state.modifiersData.popperOffsets!=null&&(state.styles.popper=Object.assign({},state.styles.popper,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.popperOffsets,position:state.options.strategy,adaptive,roundOffsets})))),state.modifiersData.arrow!=null&&(state.styles.arrow=Object.assign({},state.styles.arrow,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets})))),state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-placement":state.placement})}var computeStyles_default={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect3(_ref){var state=_ref.state,instance=_ref.instance,options=_ref.options,_options$scroll=options.scroll,scroll=_options$scroll===void 0?!0:_options$scroll,_options$resize=options.resize,resize=_options$resize===void 0?!0:_options$resize,window2=getWindow(state.elements.popper),scrollParents=[].concat(state.scrollParents.reference,state.scrollParents.popper);return scroll&&scrollParents.forEach(function(scrollParent){scrollParent.addEventListener("scroll",instance.update,passive)}),resize&&window2.addEventListener("resize",instance.update,passive),function(){scroll&&scrollParents.forEach(function(scrollParent){scrollParent.removeEventListener("scroll",instance.update,passive)}),resize&&window2.removeEventListener("resize",instance.update,passive)}}var eventListeners_default={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:effect3,data:{}};var hash={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(placement){return placement.replace(/left|right|bottom|top/g,function(matched){return hash[matched]})}var hash2={start:"end",end:"start"};function getOppositeVariationPlacement(placement){return placement.replace(/start|end/g,function(matched){return hash2[matched]})}function getWindowScroll(node){var win=getWindow(node),scrollLeft=win.pageXOffset,scrollTop=win.pageYOffset;return{scrollLeft,scrollTop}}function getWindowScrollBarX(element){return getBoundingClientRect(getDocumentElement(element)).left+getWindowScroll(element).scrollLeft}function getViewportRect(element,strategy){var win=getWindow(element),html=getDocumentElement(element),visualViewport=win.visualViewport,width=html.clientWidth,height=html.clientHeight,x=0,y=0;if(visualViewport){width=visualViewport.width,height=visualViewport.height;var layoutViewport=isLayoutViewport();(layoutViewport||!layoutViewport&&strategy==="fixed")&&(x=visualViewport.offsetLeft,y=visualViewport.offsetTop)}return{width,height,x:x+getWindowScrollBarX(element),y}}function getDocumentRect(element){var _element$ownerDocumen,html=getDocumentElement(element),winScroll=getWindowScroll(element),body=(_element$ownerDocumen=element.ownerDocument)==null?void 0:_element$ownerDocumen.body,width=max(html.scrollWidth,html.clientWidth,body?body.scrollWidth:0,body?body.clientWidth:0),height=max(html.scrollHeight,html.clientHeight,body?body.scrollHeight:0,body?body.clientHeight:0),x=-winScroll.scrollLeft+getWindowScrollBarX(element),y=-winScroll.scrollTop;return getComputedStyle2(body||html).direction==="rtl"&&(x+=max(html.clientWidth,body?body.clientWidth:0)-width),{width,height,x,y}}function isScrollParent(element){var _getComputedStyle=getComputedStyle2(element),overflow=_getComputedStyle.overflow,overflowX=_getComputedStyle.overflowX,overflowY=_getComputedStyle.overflowY;return/auto|scroll|overlay|hidden/.test(overflow+overflowY+overflowX)}function getScrollParent(node){return["html","body","#document"].indexOf(getNodeName(node))>=0?node.ownerDocument.body:isHTMLElement(node)&&isScrollParent(node)?node:getScrollParent(getParentNode(node))}function listScrollParents(element,list){var _element$ownerDocumen;list===void 0&&(list=[]);var scrollParent=getScrollParent(element),isBody=scrollParent===((_element$ownerDocumen=element.ownerDocument)==null?void 0:_element$ownerDocumen.body),win=getWindow(scrollParent),target=isBody?[win].concat(win.visualViewport||[],isScrollParent(scrollParent)?scrollParent:[]):scrollParent,updatedList=list.concat(target);return isBody?updatedList:updatedList.concat(listScrollParents(getParentNode(target)))}function rectToClientRect(rect){return Object.assign({},rect,{left:rect.x,top:rect.y,right:rect.x+rect.width,bottom:rect.y+rect.height})}function getInnerBoundingClientRect(element,strategy){var rect=getBoundingClientRect(element,!1,strategy==="fixed");return rect.top=rect.top+element.clientTop,rect.left=rect.left+element.clientLeft,rect.bottom=rect.top+element.clientHeight,rect.right=rect.left+element.clientWidth,rect.width=element.clientWidth,rect.height=element.clientHeight,rect.x=rect.left,rect.y=rect.top,rect}function getClientRectFromMixedType(element,clippingParent,strategy){return clippingParent===viewport?rectToClientRect(getViewportRect(element,strategy)):isElement(clippingParent)?getInnerBoundingClientRect(clippingParent,strategy):rectToClientRect(getDocumentRect(getDocumentElement(element)))}function getClippingParents(element){var clippingParents2=listScrollParents(getParentNode(element)),canEscapeClipping=["absolute","fixed"].indexOf(getComputedStyle2(element).position)>=0,clipperElement=canEscapeClipping&&isHTMLElement(element)?getOffsetParent(element):element;return isElement(clipperElement)?clippingParents2.filter(function(clippingParent){return isElement(clippingParent)&&contains(clippingParent,clipperElement)&&getNodeName(clippingParent)!=="body"}):[]}function getClippingRect(element,boundary,rootBoundary,strategy){var mainClippingParents=boundary==="clippingParents"?getClippingParents(element):[].concat(boundary),clippingParents2=[].concat(mainClippingParents,[rootBoundary]),firstClippingParent=clippingParents2[0],clippingRect=clippingParents2.reduce(function(accRect,clippingParent){var rect=getClientRectFromMixedType(element,clippingParent,strategy);return accRect.top=max(rect.top,accRect.top),accRect.right=min(rect.right,accRect.right),accRect.bottom=min(rect.bottom,accRect.bottom),accRect.left=max(rect.left,accRect.left),accRect},getClientRectFromMixedType(element,firstClippingParent,strategy));return clippingRect.width=clippingRect.right-clippingRect.left,clippingRect.height=clippingRect.bottom-clippingRect.top,clippingRect.x=clippingRect.left,clippingRect.y=clippingRect.top,clippingRect}function computeOffsets(_ref){var reference2=_ref.reference,element=_ref.element,placement=_ref.placement,basePlacement=placement?getBasePlacement(placement):null,variation=placement?getVariation(placement):null,commonX=reference2.x+reference2.width/2-element.width/2,commonY=reference2.y+reference2.height/2-element.height/2,offsets;switch(basePlacement){case top:offsets={x:commonX,y:reference2.y-element.height};break;case bottom:offsets={x:commonX,y:reference2.y+reference2.height};break;case right:offsets={x:reference2.x+reference2.width,y:commonY};break;case left:offsets={x:reference2.x-element.width,y:commonY};break;default:offsets={x:reference2.x,y:reference2.y}}var mainAxis=basePlacement?getMainAxisFromPlacement(basePlacement):null;if(mainAxis!=null){var len=mainAxis==="y"?"height":"width";switch(variation){case start:offsets[mainAxis]=offsets[mainAxis]-(reference2[len]/2-element[len]/2);break;case end:offsets[mainAxis]=offsets[mainAxis]+(reference2[len]/2-element[len]/2);break;default:}}return offsets}function detectOverflow(state,options){options===void 0&&(options={});var _options=options,_options$placement=_options.placement,placement=_options$placement===void 0?state.placement:_options$placement,_options$strategy=_options.strategy,strategy=_options$strategy===void 0?state.strategy:_options$strategy,_options$boundary=_options.boundary,boundary=_options$boundary===void 0?clippingParents:_options$boundary,_options$rootBoundary=_options.rootBoundary,rootBoundary=_options$rootBoundary===void 0?viewport:_options$rootBoundary,_options$elementConte=_options.elementContext,elementContext=_options$elementConte===void 0?popper:_options$elementConte,_options$altBoundary=_options.altBoundary,altBoundary=_options$altBoundary===void 0?!1:_options$altBoundary,_options$padding=_options.padding,padding=_options$padding===void 0?0:_options$padding,paddingObject=mergePaddingObject(typeof padding!="number"?padding:expandToHashMap(padding,basePlacements)),altContext=elementContext===popper?reference:popper,popperRect=state.rects.popper,element=state.elements[altBoundary?altContext:elementContext],clippingClientRect=getClippingRect(isElement(element)?element:element.contextElement||getDocumentElement(state.elements.popper),boundary,rootBoundary,strategy),referenceClientRect=getBoundingClientRect(state.elements.reference),popperOffsets2=computeOffsets({reference:referenceClientRect,element:popperRect,strategy:"absolute",placement}),popperClientRect=rectToClientRect(Object.assign({},popperRect,popperOffsets2)),elementClientRect=elementContext===popper?popperClientRect:referenceClientRect,overflowOffsets={top:clippingClientRect.top-elementClientRect.top+paddingObject.top,bottom:elementClientRect.bottom-clippingClientRect.bottom+paddingObject.bottom,left:clippingClientRect.left-elementClientRect.left+paddingObject.left,right:elementClientRect.right-clippingClientRect.right+paddingObject.right},offsetData=state.modifiersData.offset;if(elementContext===popper&&offsetData){var offset2=offsetData[placement];Object.keys(overflowOffsets).forEach(function(key){var multiply=[right,bottom].indexOf(key)>=0?1:-1,axis=[top,bottom].indexOf(key)>=0?"y":"x";overflowOffsets[key]+=offset2[axis]*multiply})}return overflowOffsets}function computeAutoPlacement(state,options){options===void 0&&(options={});var _options=options,placement=_options.placement,boundary=_options.boundary,rootBoundary=_options.rootBoundary,padding=_options.padding,flipVariations=_options.flipVariations,_options$allowedAutoP=_options.allowedAutoPlacements,allowedAutoPlacements=_options$allowedAutoP===void 0?placements:_options$allowedAutoP,variation=getVariation(placement),placements2=variation?flipVariations?variationPlacements:variationPlacements.filter(function(placement2){return getVariation(placement2)===variation}):basePlacements,allowedPlacements=placements2.filter(function(placement2){return allowedAutoPlacements.indexOf(placement2)>=0});allowedPlacements.length===0&&(allowedPlacements=placements2);var overflows=allowedPlacements.reduce(function(acc,placement2){return acc[placement2]=detectOverflow(state,{placement:placement2,boundary,rootBoundary,padding})[getBasePlacement(placement2)],acc},{});return Object.keys(overflows).sort(function(a,b){return overflows[a]-overflows[b]})}function getExpandedFallbackPlacements(placement){if(getBasePlacement(placement)===auto)return[];var oppositePlacement=getOppositePlacement(placement);return[getOppositeVariationPlacement(placement),oppositePlacement,getOppositeVariationPlacement(oppositePlacement)]}function flip(_ref){var state=_ref.state,options=_ref.options,name=_ref.name;if(!state.modifiersData[name]._skip){for(var _options$mainAxis=options.mainAxis,checkMainAxis=_options$mainAxis===void 0?!0:_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=_options$altAxis===void 0?!0:_options$altAxis,specifiedFallbackPlacements=options.fallbackPlacements,padding=options.padding,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,_options$flipVariatio=options.flipVariations,flipVariations=_options$flipVariatio===void 0?!0:_options$flipVariatio,allowedAutoPlacements=options.allowedAutoPlacements,preferredPlacement=state.options.placement,basePlacement=getBasePlacement(preferredPlacement),isBasePlacement=basePlacement===preferredPlacement,fallbackPlacements=specifiedFallbackPlacements||(isBasePlacement||!flipVariations?[getOppositePlacement(preferredPlacement)]:getExpandedFallbackPlacements(preferredPlacement)),placements2=[preferredPlacement].concat(fallbackPlacements).reduce(function(acc,placement2){return acc.concat(getBasePlacement(placement2)===auto?computeAutoPlacement(state,{placement:placement2,boundary,rootBoundary,padding,flipVariations,allowedAutoPlacements}):placement2)},[]),referenceRect=state.rects.reference,popperRect=state.rects.popper,checksMap=new Map,makeFallbackChecks=!0,firstFittingPlacement=placements2[0],i=0;i<placements2.length;i++){var placement=placements2[i],_basePlacement=getBasePlacement(placement),isStartVariation=getVariation(placement)===start,isVertical=[top,bottom].indexOf(_basePlacement)>=0,len=isVertical?"width":"height",overflow=detectOverflow(state,{placement,boundary,rootBoundary,altBoundary,padding}),mainVariationSide=isVertical?isStartVariation?right:left:isStartVariation?bottom:top;referenceRect[len]>popperRect[len]&&(mainVariationSide=getOppositePlacement(mainVariationSide));var altVariationSide=getOppositePlacement(mainVariationSide),checks=[];if(checkMainAxis&&checks.push(overflow[_basePlacement]<=0),checkAltAxis&&checks.push(overflow[mainVariationSide]<=0,overflow[altVariationSide]<=0),checks.every(function(check){return check})){firstFittingPlacement=placement,makeFallbackChecks=!1;break}checksMap.set(placement,checks)}if(makeFallbackChecks)for(var numberOfChecks=flipVariations?3:1,_loop=function(_i2){var fittingPlacement=placements2.find(function(placement2){var checks2=checksMap.get(placement2);if(checks2)return checks2.slice(0,_i2).every(function(check){return check})});if(fittingPlacement)return firstFittingPlacement=fittingPlacement,"break"},_i=numberOfChecks;_i>0;_i--){var _ret=_loop(_i);if(_ret==="break")break}state.placement!==firstFittingPlacement&&(state.modifiersData[name]._skip=!0,state.placement=firstFittingPlacement,state.reset=!0)}}var flip_default={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(overflow,rect,preventedOffsets){return preventedOffsets===void 0&&(preventedOffsets={x:0,y:0}),{top:overflow.top-rect.height-preventedOffsets.y,right:overflow.right-rect.width+preventedOffsets.x,bottom:overflow.bottom-rect.height+preventedOffsets.y,left:overflow.left-rect.width-preventedOffsets.x}}function isAnySideFullyClipped(overflow){return[top,right,bottom,left].some(function(side){return overflow[side]>=0})}function hide(_ref){var state=_ref.state,name=_ref.name,referenceRect=state.rects.reference,popperRect=state.rects.popper,preventedOffsets=state.modifiersData.preventOverflow,referenceOverflow=detectOverflow(state,{elementContext:"reference"}),popperAltOverflow=detectOverflow(state,{altBoundary:!0}),referenceClippingOffsets=getSideOffsets(referenceOverflow,referenceRect),popperEscapeOffsets=getSideOffsets(popperAltOverflow,popperRect,preventedOffsets),isReferenceHidden=isAnySideFullyClipped(referenceClippingOffsets),hasPopperEscaped=isAnySideFullyClipped(popperEscapeOffsets);state.modifiersData[name]={referenceClippingOffsets,popperEscapeOffsets,isReferenceHidden,hasPopperEscaped},state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-reference-hidden":isReferenceHidden,"data-popper-escaped":hasPopperEscaped})}var hide_default={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(placement,rects,offset2){var basePlacement=getBasePlacement(placement),invertDistance=[left,top].indexOf(basePlacement)>=0?-1:1,_ref=typeof offset2=="function"?offset2(Object.assign({},rects,{placement})):offset2,skidding=_ref[0],distance=_ref[1];return skidding=skidding||0,distance=(distance||0)*invertDistance,[left,right].indexOf(basePlacement)>=0?{x:distance,y:skidding}:{x:skidding,y:distance}}function offset(_ref2){var state=_ref2.state,options=_ref2.options,name=_ref2.name,_options$offset=options.offset,offset2=_options$offset===void 0?[0,0]:_options$offset,data=placements.reduce(function(acc,placement){return acc[placement]=distanceAndSkiddingToXY(placement,state.rects,offset2),acc},{}),_data$state$placement=data[state.placement],x=_data$state$placement.x,y=_data$state$placement.y;state.modifiersData.popperOffsets!=null&&(state.modifiersData.popperOffsets.x+=x,state.modifiersData.popperOffsets.y+=y),state.modifiersData[name]=data}var offset_default={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(_ref){var state=_ref.state,name=_ref.name;state.modifiersData[name]=computeOffsets({reference:state.rects.reference,element:state.rects.popper,strategy:"absolute",placement:state.placement})}var popperOffsets_default={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(axis){return axis==="x"?"y":"x"}function preventOverflow(_ref){var state=_ref.state,options=_ref.options,name=_ref.name,_options$mainAxis=options.mainAxis,checkMainAxis=_options$mainAxis===void 0?!0:_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=_options$altAxis===void 0?!1:_options$altAxis,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,padding=options.padding,_options$tether=options.tether,tether=_options$tether===void 0?!0:_options$tether,_options$tetherOffset=options.tetherOffset,tetherOffset=_options$tetherOffset===void 0?0:_options$tetherOffset,overflow=detectOverflow(state,{boundary,rootBoundary,padding,altBoundary}),basePlacement=getBasePlacement(state.placement),variation=getVariation(state.placement),isBasePlacement=!variation,mainAxis=getMainAxisFromPlacement(basePlacement),altAxis=getAltAxis(mainAxis),popperOffsets2=state.modifiersData.popperOffsets,referenceRect=state.rects.reference,popperRect=state.rects.popper,tetherOffsetValue=typeof tetherOffset=="function"?tetherOffset(Object.assign({},state.rects,{placement:state.placement})):tetherOffset,normalizedTetherOffsetValue=typeof tetherOffsetValue=="number"?{mainAxis:tetherOffsetValue,altAxis:tetherOffsetValue}:Object.assign({mainAxis:0,altAxis:0},tetherOffsetValue),offsetModifierState=state.modifiersData.offset?state.modifiersData.offset[state.placement]:null,data={x:0,y:0};if(popperOffsets2){if(checkMainAxis){var _offsetModifierState$,mainSide=mainAxis==="y"?top:left,altSide=mainAxis==="y"?bottom:right,len=mainAxis==="y"?"height":"width",offset2=popperOffsets2[mainAxis],min2=offset2+overflow[mainSide],max2=offset2-overflow[altSide],additive=tether?-popperRect[len]/2:0,minLen=variation===start?referenceRect[len]:popperRect[len],maxLen=variation===start?-popperRect[len]:-referenceRect[len],arrowElement=state.elements.arrow,arrowRect=tether&&arrowElement?getLayoutRect(arrowElement):{width:0,height:0},arrowPaddingObject=state.modifiersData["arrow#persistent"]?state.modifiersData["arrow#persistent"].padding:getFreshSideObject(),arrowPaddingMin=arrowPaddingObject[mainSide],arrowPaddingMax=arrowPaddingObject[altSide],arrowLen=within(0,referenceRect[len],arrowRect[len]),minOffset=isBasePlacement?referenceRect[len]/2-additive-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis:minLen-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis,maxOffset=isBasePlacement?-referenceRect[len]/2+additive+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis:maxLen+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis,arrowOffsetParent=state.elements.arrow&&getOffsetParent(state.elements.arrow),clientOffset=arrowOffsetParent?mainAxis==="y"?arrowOffsetParent.clientTop||0:arrowOffsetParent.clientLeft||0:0,offsetModifierValue=(_offsetModifierState$=offsetModifierState?.[mainAxis])!=null?_offsetModifierState$:0,tetherMin=offset2+minOffset-offsetModifierValue-clientOffset,tetherMax=offset2+maxOffset-offsetModifierValue,preventedOffset=within(tether?min(min2,tetherMin):min2,offset2,tether?max(max2,tetherMax):max2);popperOffsets2[mainAxis]=preventedOffset,data[mainAxis]=preventedOffset-offset2}if(checkAltAxis){var _offsetModifierState$2,_mainSide=mainAxis==="x"?top:left,_altSide=mainAxis==="x"?bottom:right,_offset=popperOffsets2[altAxis],_len=altAxis==="y"?"height":"width",_min=_offset+overflow[_mainSide],_max=_offset-overflow[_altSide],isOriginSide=[top,left].indexOf(basePlacement)!==-1,_offsetModifierValue=(_offsetModifierState$2=offsetModifierState?.[altAxis])!=null?_offsetModifierState$2:0,_tetherMin=isOriginSide?_min:_offset-referenceRect[_len]-popperRect[_len]-_offsetModifierValue+normalizedTetherOffsetValue.altAxis,_tetherMax=isOriginSide?_offset+referenceRect[_len]+popperRect[_len]-_offsetModifierValue-normalizedTetherOffsetValue.altAxis:_max,_preventedOffset=tether&&isOriginSide?withinMaxClamp(_tetherMin,_offset,_tetherMax):within(tether?_tetherMin:_min,_offset,tether?_tetherMax:_max);popperOffsets2[altAxis]=_preventedOffset,data[altAxis]=_preventedOffset-_offset}state.modifiersData[name]=data}}var preventOverflow_default={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(element){return{scrollLeft:element.scrollLeft,scrollTop:element.scrollTop}}function getNodeScroll(node){return node===getWindow(node)||!isHTMLElement(node)?getWindowScroll(node):getHTMLElementScroll(node)}function isElementScaled(element){var rect=element.getBoundingClientRect(),scaleX=round(rect.width)/element.offsetWidth||1,scaleY=round(rect.height)/element.offsetHeight||1;return scaleX!==1||scaleY!==1}function getCompositeRect(elementOrVirtualElement,offsetParent,isFixed){isFixed===void 0&&(isFixed=!1);var isOffsetParentAnElement=isHTMLElement(offsetParent),offsetParentIsScaled=isHTMLElement(offsetParent)&&isElementScaled(offsetParent),documentElement=getDocumentElement(offsetParent),rect=getBoundingClientRect(elementOrVirtualElement,offsetParentIsScaled,isFixed),scroll={scrollLeft:0,scrollTop:0},offsets={x:0,y:0};return(isOffsetParentAnElement||!isOffsetParentAnElement&&!isFixed)&&((getNodeName(offsetParent)!=="body"||isScrollParent(documentElement))&&(scroll=getNodeScroll(offsetParent)),isHTMLElement(offsetParent)?(offsets=getBoundingClientRect(offsetParent,!0),offsets.x+=offsetParent.clientLeft,offsets.y+=offsetParent.clientTop):documentElement&&(offsets.x=getWindowScrollBarX(documentElement))),{x:rect.left+scroll.scrollLeft-offsets.x,y:rect.top+scroll.scrollTop-offsets.y,width:rect.width,height:rect.height}}function order(modifiers){var map=new Map,visited=new Set,result=[];modifiers.forEach(function(modifier){map.set(modifier.name,modifier)});function sort(modifier){visited.add(modifier.name);var requires=[].concat(modifier.requires||[],modifier.requiresIfExists||[]);requires.forEach(function(dep){if(!visited.has(dep)){var depModifier=map.get(dep);depModifier&&sort(depModifier)}}),result.push(modifier)}return modifiers.forEach(function(modifier){visited.has(modifier.name)||sort(modifier)}),result}function orderModifiers(modifiers){var orderedModifiers=order(modifiers);return modifierPhases.reduce(function(acc,phase){return acc.concat(orderedModifiers.filter(function(modifier){return modifier.phase===phase}))},[])}function debounce(fn2){var pending;return function(){return pending||(pending=new Promise(function(resolve){Promise.resolve().then(function(){pending=void 0,resolve(fn2())})})),pending}}function mergeByName(modifiers){var merged=modifiers.reduce(function(merged2,current){var existing=merged2[current.name];return merged2[current.name]=existing?Object.assign({},existing,current,{options:Object.assign({},existing.options,current.options),data:Object.assign({},existing.data,current.data)}):current,merged2},{});return Object.keys(merged).map(function(key){return merged[key]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return!args.some(function(element){return!(element&&typeof element.getBoundingClientRect=="function")})}function popperGenerator(generatorOptions){generatorOptions===void 0&&(generatorOptions={});var _generatorOptions=generatorOptions,_generatorOptions$def=_generatorOptions.defaultModifiers,defaultModifiers3=_generatorOptions$def===void 0?[]:_generatorOptions$def,_generatorOptions$def2=_generatorOptions.defaultOptions,defaultOptions=_generatorOptions$def2===void 0?DEFAULT_OPTIONS:_generatorOptions$def2;return function(reference2,popper2,options){options===void 0&&(options=defaultOptions);var state={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,defaultOptions),modifiersData:{},elements:{reference:reference2,popper:popper2},attributes:{},styles:{}},effectCleanupFns=[],isDestroyed=!1,instance={state,setOptions:function(setOptionsAction){var options2=typeof setOptionsAction=="function"?setOptionsAction(state.options):setOptionsAction;cleanupModifierEffects(),state.options=Object.assign({},defaultOptions,state.options,options2),state.scrollParents={reference:isElement(reference2)?listScrollParents(reference2):reference2.contextElement?listScrollParents(reference2.contextElement):[],popper:listScrollParents(popper2)};var orderedModifiers=orderModifiers(mergeByName([].concat(defaultModifiers3,state.options.modifiers)));return state.orderedModifiers=orderedModifiers.filter(function(m){return m.enabled}),runModifierEffects(),instance.update()},forceUpdate:function(){if(!isDestroyed){var _state$elements=state.elements,reference3=_state$elements.reference,popper3=_state$elements.popper;if(areValidElements(reference3,popper3)){state.rects={reference:getCompositeRect(reference3,getOffsetParent(popper3),state.options.strategy==="fixed"),popper:getLayoutRect(popper3)},state.reset=!1,state.placement=state.options.placement,state.orderedModifiers.forEach(function(modifier){return state.modifiersData[modifier.name]=Object.assign({},modifier.data)});for(var index=0;index<state.orderedModifiers.length;index++){if(state.reset===!0){state.reset=!1,index=-1;continue}var _state$orderedModifie=state.orderedModifiers[index],fn2=_state$orderedModifie.fn,_state$orderedModifie2=_state$orderedModifie.options,_options=_state$orderedModifie2===void 0?{}:_state$orderedModifie2,name=_state$orderedModifie.name;typeof fn2=="function"&&(state=fn2({state,options:_options,name,instance})||state)}}}},update:debounce(function(){return new Promise(function(resolve){instance.forceUpdate(),resolve(state)})}),destroy:function(){cleanupModifierEffects(),isDestroyed=!0}};if(!areValidElements(reference2,popper2))return instance;instance.setOptions(options).then(function(state2){!isDestroyed&&options.onFirstUpdate&&options.onFirstUpdate(state2)});function runModifierEffects(){state.orderedModifiers.forEach(function(_ref){var name=_ref.name,_ref$options=_ref.options,options2=_ref$options===void 0?{}:_ref$options,effect4=_ref.effect;if(typeof effect4=="function"){var cleanupFn=effect4({state,name,instance,options:options2}),noopFn=function(){};effectCleanupFns.push(cleanupFn||noopFn)}})}function cleanupModifierEffects(){effectCleanupFns.forEach(function(fn2){return fn2()}),effectCleanupFns=[]}return instance}}var createPopper=popperGenerator();var defaultModifiers=[eventListeners_default,popperOffsets_default,computeStyles_default,applyStyles_default],createPopper2=popperGenerator({defaultModifiers});var defaultModifiers2=[eventListeners_default,popperOffsets_default,computeStyles_default,applyStyles_default,offset_default,flip_default,preventOverflow_default,arrow_default,hide_default],createPopper3=popperGenerator({defaultModifiers:defaultModifiers2});var elementMap=new Map,Data={set(element,key,instance){elementMap.has(element)||elementMap.set(element,new Map);let instanceMap=elementMap.get(element);if(!instanceMap.has(key)&&instanceMap.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(instanceMap.keys())[0]}.`);return}instanceMap.set(key,instance)},get(element,key){return elementMap.has(element)&&elementMap.get(element).get(key)||null},remove(element,key){if(!elementMap.has(element))return;let instanceMap=elementMap.get(element);instanceMap.delete(key),instanceMap.size===0&&elementMap.delete(element)}},MAX_UID=1e6,MILLISECONDS_MULTIPLIER=1e3,TRANSITION_END="transitionend",parseSelector=selector=>(selector&&window.CSS&&window.CSS.escape&&(selector=selector.replace(/#([^\s"#']+)/g,(match,id)=>`#${CSS.escape(id)}`)),selector),toType=object=>object==null?`${object}`:Object.prototype.toString.call(object).match(/\s([a-z]+)/i)[1].toLowerCase(),getUID=prefix=>{do prefix+=Math.floor(Math.random()*MAX_UID);while(document.getElementById(prefix));return prefix},getTransitionDurationFromElement=element=>{if(!element)return 0;let{transitionDuration,transitionDelay}=window.getComputedStyle(element),floatTransitionDuration=Number.parseFloat(transitionDuration),floatTransitionDelay=Number.parseFloat(transitionDelay);return!floatTransitionDuration&&!floatTransitionDelay?0:(transitionDuration=transitionDuration.split(",")[0],transitionDelay=transitionDelay.split(",")[0],(Number.parseFloat(transitionDuration)+Number.parseFloat(transitionDelay))*MILLISECONDS_MULTIPLIER)},triggerTransitionEnd=element=>{element.dispatchEvent(new Event(TRANSITION_END))},isElement2=object=>!object||typeof object!="object"?!1:(typeof object.jquery<"u"&&(object=object[0]),typeof object.nodeType<"u"),getElement=object=>isElement2(object)?object.jquery?object[0]:object:typeof object=="string"&&object.length>0?document.querySelector(parseSelector(object)):null,isVisible=element=>{if(!isElement2(element)||element.getClientRects().length===0)return!1;let elementIsVisible=getComputedStyle(element).getPropertyValue("visibility")==="visible",closedDetails=element.closest("details:not([open])");if(!closedDetails)return elementIsVisible;if(closedDetails!==element){let summary=element.closest("summary");if(summary&&summary.parentNode!==closedDetails||summary===null)return!1}return elementIsVisible},isDisabled=element=>!element||element.nodeType!==Node.ELEMENT_NODE||element.classList.contains("disabled")?!0:typeof element.disabled<"u"?element.disabled:element.hasAttribute("disabled")&&element.getAttribute("disabled")!=="false",findShadowRoot=element=>{if(!document.documentElement.attachShadow)return null;if(typeof element.getRootNode=="function"){let root=element.getRootNode();return root instanceof ShadowRoot?root:null}return element instanceof ShadowRoot?element:element.parentNode?findShadowRoot(element.parentNode):null},noop=()=>{},reflow=element=>{element.offsetHeight},getjQuery=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,DOMContentLoadedCallbacks=[],onDOMContentLoaded=callback=>{document.readyState==="loading"?(DOMContentLoadedCallbacks.length||document.addEventListener("DOMContentLoaded",()=>{for(let callback2 of DOMContentLoadedCallbacks)callback2()}),DOMContentLoadedCallbacks.push(callback)):callback()},isRTL=()=>document.documentElement.dir==="rtl",defineJQueryPlugin=plugin=>{onDOMContentLoaded(()=>{let $2=getjQuery();if($2){let name=plugin.NAME,JQUERY_NO_CONFLICT=$2.fn[name];$2.fn[name]=plugin.jQueryInterface,$2.fn[name].Constructor=plugin,$2.fn[name].noConflict=()=>($2.fn[name]=JQUERY_NO_CONFLICT,plugin.jQueryInterface)}})},execute=(possibleCallback,args=[],defaultValue=possibleCallback)=>typeof possibleCallback=="function"?possibleCallback(...args):defaultValue,executeAfterTransition=(callback,transitionElement,waitForTransition=!0)=>{if(!waitForTransition){execute(callback);return}let emulatedDuration=getTransitionDurationFromElement(transitionElement)+5,called=!1,handler=({target})=>{target===transitionElement&&(called=!0,transitionElement.removeEventListener(TRANSITION_END,handler),execute(callback))};transitionElement.addEventListener(TRANSITION_END,handler),setTimeout(()=>{called||triggerTransitionEnd(transitionElement)},emulatedDuration)},getNextActiveElement=(list,activeElement,shouldGetNext,isCycleAllowed)=>{let listLength=list.length,index=list.indexOf(activeElement);return index===-1?!shouldGetNext&&isCycleAllowed?list[listLength-1]:list[0]:(index+=shouldGetNext?1:-1,isCycleAllowed&&(index=(index+listLength)%listLength),list[Math.max(0,Math.min(index,listLength-1))])},namespaceRegex=/[^.]*(?=\..*)\.|.*/,stripNameRegex=/\..*/,stripUidRegex=/::\d+$/,eventRegistry={},uidEvent=1,customEvents={mouseenter:"mouseover",mouseleave:"mouseout"},nativeEvents=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function makeEventUid(element,uid){return uid&&`${uid}::${uidEvent++}`||element.uidEvent||uidEvent++}function getElementEvents(element){let uid=makeEventUid(element);return element.uidEvent=uid,eventRegistry[uid]=eventRegistry[uid]||{},eventRegistry[uid]}function bootstrapHandler(element,fn2){return function handler(event){return hydrateObj(event,{delegateTarget:element}),handler.oneOff&&EventHandler.off(element,event.type,fn2),fn2.apply(element,[event])}}function bootstrapDelegationHandler(element,selector,fn2){return function handler(event){let domElements=element.querySelectorAll(selector);for(let{target}=event;target&&target!==this;target=target.parentNode)for(let domElement of domElements)if(domElement===target)return hydrateObj(event,{delegateTarget:target}),handler.oneOff&&EventHandler.off(element,event.type,selector,fn2),fn2.apply(target,[event])}}function findHandler(events,callable,delegationSelector=null){return Object.values(events).find(event=>event.callable===callable&&event.delegationSelector===delegationSelector)}function normalizeParameters(originalTypeEvent,handler,delegationFunction){let isDelegated=typeof handler=="string",callable=isDelegated?delegationFunction:handler||delegationFunction,typeEvent=getTypeEvent(originalTypeEvent);return nativeEvents.has(typeEvent)||(typeEvent=originalTypeEvent),[isDelegated,callable,typeEvent]}function addHandler(element,originalTypeEvent,handler,delegationFunction,oneOff){if(typeof originalTypeEvent!="string"||!element)return;let[isDelegated,callable,typeEvent]=normalizeParameters(originalTypeEvent,handler,delegationFunction);originalTypeEvent in customEvents&&(callable=(fn3=>function(event){if(!event.relatedTarget||event.relatedTarget!==event.delegateTarget&&!event.delegateTarget.contains(event.relatedTarget))return fn3.call(this,event)})(callable));let events=getElementEvents(element),handlers=events[typeEvent]||(events[typeEvent]={}),previousFunction=findHandler(handlers,callable,isDelegated?handler:null);if(previousFunction){previousFunction.oneOff=previousFunction.oneOff&&oneOff;return}let uid=makeEventUid(callable,originalTypeEvent.replace(namespaceRegex,"")),fn2=isDelegated?bootstrapDelegationHandler(element,handler,callable):bootstrapHandler(element,callable);fn2.delegationSelector=isDelegated?handler:null,fn2.callable=callable,fn2.oneOff=oneOff,fn2.uidEvent=uid,handlers[uid]=fn2,element.addEventListener(typeEvent,fn2,isDelegated)}function removeHandler(element,events,typeEvent,handler,delegationSelector){let fn2=findHandler(events[typeEvent],handler,delegationSelector);fn2&&(element.removeEventListener(typeEvent,fn2,!!delegationSelector),delete events[typeEvent][fn2.uidEvent])}function removeNamespacedHandlers(element,events,typeEvent,namespace){let storeElementEvent=events[typeEvent]||{};for(let[handlerKey,event]of Object.entries(storeElementEvent))handlerKey.includes(namespace)&&removeHandler(element,events,typeEvent,event.callable,event.delegationSelector)}function getTypeEvent(event){return event=event.replace(stripNameRegex,""),customEvents[event]||event}var EventHandler={on(element,event,handler,delegationFunction){addHandler(element,event,handler,delegationFunction,!1)},one(element,event,handler,delegationFunction){addHandler(element,event,handler,delegationFunction,!0)},off(element,originalTypeEvent,handler,delegationFunction){if(typeof originalTypeEvent!="string"||!element)return;let[isDelegated,callable,typeEvent]=normalizeParameters(originalTypeEvent,handler,delegationFunction),inNamespace=typeEvent!==originalTypeEvent,events=getElementEvents(element),storeElementEvent=events[typeEvent]||{},isNamespace=originalTypeEvent.startsWith(".");if(typeof callable<"u"){if(!Object.keys(storeElementEvent).length)return;removeHandler(element,events,typeEvent,callable,isDelegated?handler:null);return}if(isNamespace)for(let elementEvent of Object.keys(events))removeNamespacedHandlers(element,events,elementEvent,originalTypeEvent.slice(1));for(let[keyHandlers,event]of Object.entries(storeElementEvent)){let handlerKey=keyHandlers.replace(stripUidRegex,"");(!inNamespace||originalTypeEvent.includes(handlerKey))&&removeHandler(element,events,typeEvent,event.callable,event.delegationSelector)}},trigger(element,event,args){if(typeof event!="string"||!element)return null;let $2=getjQuery(),typeEvent=getTypeEvent(event),inNamespace=event!==typeEvent,jQueryEvent=null,bubbles=!0,nativeDispatch=!0,defaultPrevented=!1;inNamespace&&$2&&(jQueryEvent=$2.Event(event,args),$2(element).trigger(jQueryEvent),bubbles=!jQueryEvent.isPropagationStopped(),nativeDispatch=!jQueryEvent.isImmediatePropagationStopped(),defaultPrevented=jQueryEvent.isDefaultPrevented());let evt=hydrateObj(new Event(event,{bubbles,cancelable:!0}),args);return defaultPrevented&&evt.preventDefault(),nativeDispatch&&element.dispatchEvent(evt),evt.defaultPrevented&&jQueryEvent&&jQueryEvent.preventDefault(),evt}};function hydrateObj(obj,meta={}){for(let[key,value]of Object.entries(meta))try{obj[key]=value}catch{Object.defineProperty(obj,key,{configurable:!0,get(){return value}})}return obj}function normalizeData(value){if(value==="true")return!0;if(value==="false")return!1;if(value===Number(value).toString())return Number(value);if(value===""||value==="null")return null;if(typeof value!="string")return value;try{return JSON.parse(decodeURIComponent(value))}catch{return value}}function normalizeDataKey(key){return key.replace(/[A-Z]/g,chr=>`-${chr.toLowerCase()}`)}var Manipulator={setDataAttribute(element,key,value){element.setAttribute(`data-bs-${normalizeDataKey(key)}`,value)},removeDataAttribute(element,key){element.removeAttribute(`data-bs-${normalizeDataKey(key)}`)},getDataAttributes(element){if(!element)return{};let attributes={},bsKeys=Object.keys(element.dataset).filter(key=>key.startsWith("bs")&&!key.startsWith("bsConfig"));for(let key of bsKeys){let pureKey=key.replace(/^bs/,"");pureKey=pureKey.charAt(0).toLowerCase()+pureKey.slice(1,pureKey.length),attributes[pureKey]=normalizeData(element.dataset[key])}return attributes},getDataAttribute(element,key){return normalizeData(element.getAttribute(`data-bs-${normalizeDataKey(key)}`))}},Config=class{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(config){return config=this._mergeConfigObj(config),config=this._configAfterMerge(config),this._typeCheckConfig(config),config}_configAfterMerge(config){return config}_mergeConfigObj(config,element){let jsonConfig=isElement2(element)?Manipulator.getDataAttribute(element,"config"):{};return{...this.constructor.Default,...typeof jsonConfig=="object"?jsonConfig:{},...isElement2(element)?Manipulator.getDataAttributes(element):{},...typeof config=="object"?config:{}}}_typeCheckConfig(config,configTypes=this.constructor.DefaultType){for(let[property,expectedTypes]of Object.entries(configTypes)){let value=config[property],valueType=isElement2(value)?"element":toType(value);if(!new RegExp(expectedTypes).test(valueType))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${property}" provided type "${valueType}" but expected type "${expectedTypes}".`)}}},VERSION="5.3.3",BaseComponent=class extends Config{constructor(element,config){super(),element=getElement(element),element&&(this._element=element,this._config=this._getConfig(config),Data.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Data.remove(this._element,this.constructor.DATA_KEY),EventHandler.off(this._element,this.constructor.EVENT_KEY);for(let propertyName of Object.getOwnPropertyNames(this))this[propertyName]=null}_queueCallback(callback,element,isAnimated=!0){executeAfterTransition(callback,element,isAnimated)}_getConfig(config){return config=this._mergeConfigObj(config,this._element),config=this._configAfterMerge(config),this._typeCheckConfig(config),config}static getInstance(element){return Data.get(getElement(element),this.DATA_KEY)}static getOrCreateInstance(element,config={}){return this.getInstance(element)||new this(element,typeof config=="object"?config:null)}static get VERSION(){return VERSION}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(name){return`${name}${this.EVENT_KEY}`}},getSelector=element=>{let selector=element.getAttribute("data-bs-target");if(!selector||selector==="#"){let hrefAttribute=element.getAttribute("href");if(!hrefAttribute||!hrefAttribute.includes("#")&&!hrefAttribute.startsWith("."))return null;hrefAttribute.includes("#")&&!hrefAttribute.startsWith("#")&&(hrefAttribute=`#${hrefAttribute.split("#")[1]}`),selector=hrefAttribute&&hrefAttribute!=="#"?hrefAttribute.trim():null}return selector?selector.split(",").map(sel=>parseSelector(sel)).join(","):null},SelectorEngine={find(selector,element=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(element,selector))},findOne(selector,element=document.documentElement){return Element.prototype.querySelector.call(element,selector)},children(element,selector){return[].concat(...element.children).filter(child=>child.matches(selector))},parents(element,selector){let parents=[],ancestor=element.parentNode.closest(selector);for(;ancestor;)parents.push(ancestor),ancestor=ancestor.parentNode.closest(selector);return parents},prev(element,selector){let previous=element.previousElementSibling;for(;previous;){if(previous.matches(selector))return[previous];previous=previous.previousElementSibling}return[]},next(element,selector){let next=element.nextElementSibling;for(;next;){if(next.matches(selector))return[next];next=next.nextElementSibling}return[]},focusableChildren(element){let focusables=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(selector=>`${selector}:not([tabindex^="-"])`).join(",");return this.find(focusables,element).filter(el=>!isDisabled(el)&&isVisible(el))},getSelectorFromElement(element){let selector=getSelector(element);return selector&&SelectorEngine.findOne(selector)?selector:null},getElementFromSelector(element){let selector=getSelector(element);return selector?SelectorEngine.findOne(selector):null},getMultipleElementsFromSelector(element){let selector=getSelector(element);return selector?SelectorEngine.find(selector):[]}},enableDismissTrigger=(component,method="hide")=>{let clickEvent=`click.dismiss${component.EVENT_KEY}`,name=component.NAME;EventHandler.on(document,clickEvent,`[data-bs-dismiss="${name}"]`,function(event){if(["A","AREA"].includes(this.tagName)&&event.preventDefault(),isDisabled(this))return;let target=SelectorEngine.getElementFromSelector(this)||this.closest(`.${name}`);component.getOrCreateInstance(target)[method]()})},NAME$f="alert",DATA_KEY$a="bs.alert",EVENT_KEY$b=`.${DATA_KEY$a}`,EVENT_CLOSE=`close${EVENT_KEY$b}`,EVENT_CLOSED=`closed${EVENT_KEY$b}`,CLASS_NAME_FADE$5="fade",CLASS_NAME_SHOW$8="show",Alert=class _Alert extends BaseComponent{static get NAME(){return NAME$f}close(){if(EventHandler.trigger(this._element,EVENT_CLOSE).defaultPrevented)return;this._element.classList.remove(CLASS_NAME_SHOW$8);let isAnimated=this._element.classList.contains(CLASS_NAME_FADE$5);this._queueCallback(()=>this._destroyElement(),this._element,isAnimated)}_destroyElement(){this._element.remove(),EventHandler.trigger(this._element,EVENT_CLOSED),this.dispose()}static jQueryInterface(config){return this.each(function(){let data=_Alert.getOrCreateInstance(this);if(typeof config=="string"){if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config](this)}})}};enableDismissTrigger(Alert,"close");defineJQueryPlugin(Alert);var NAME$e="button",DATA_KEY$9="bs.button",EVENT_KEY$a=`.${DATA_KEY$9}`,DATA_API_KEY$6=".data-api",CLASS_NAME_ACTIVE$3="active",SELECTOR_DATA_TOGGLE$5='[data-bs-toggle="button"]',EVENT_CLICK_DATA_API$6=`click${EVENT_KEY$a}${DATA_API_KEY$6}`,Button=class _Button extends BaseComponent{static get NAME(){return NAME$e}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(CLASS_NAME_ACTIVE$3))}static jQueryInterface(config){return this.each(function(){let data=_Button.getOrCreateInstance(this);config==="toggle"&&data[config]()})}};EventHandler.on(document,EVENT_CLICK_DATA_API$6,SELECTOR_DATA_TOGGLE$5,event=>{event.preventDefault();let button=event.target.closest(SELECTOR_DATA_TOGGLE$5);Button.getOrCreateInstance(button).toggle()});defineJQueryPlugin(Button);var NAME$d="swipe",EVENT_KEY$9=".bs.swipe",EVENT_TOUCHSTART=`touchstart${EVENT_KEY$9}`,EVENT_TOUCHMOVE=`touchmove${EVENT_KEY$9}`,EVENT_TOUCHEND=`touchend${EVENT_KEY$9}`,EVENT_POINTERDOWN=`pointerdown${EVENT_KEY$9}`,EVENT_POINTERUP=`pointerup${EVENT_KEY$9}`,POINTER_TYPE_TOUCH="touch",POINTER_TYPE_PEN="pen",CLASS_NAME_POINTER_EVENT="pointer-event",SWIPE_THRESHOLD=40,Default$c={endCallback:null,leftCallback:null,rightCallback:null},DefaultType$c={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"},Swipe=class _Swipe extends Config{constructor(element,config){super(),this._element=element,!(!element||!_Swipe.isSupported())&&(this._config=this._getConfig(config),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Default$c}static get DefaultType(){return DefaultType$c}static get NAME(){return NAME$d}dispose(){EventHandler.off(this._element,EVENT_KEY$9)}_start(event){if(!this._supportPointerEvents){this._deltaX=event.touches[0].clientX;return}this._eventIsPointerPenTouch(event)&&(this._deltaX=event.clientX)}_end(event){this._eventIsPointerPenTouch(event)&&(this._deltaX=event.clientX-this._deltaX),this._handleSwipe(),execute(this._config.endCallback)}_move(event){this._deltaX=event.touches&&event.touches.length>1?0:event.touches[0].clientX-this._deltaX}_handleSwipe(){let absDeltaX=Math.abs(this._deltaX);if(absDeltaX<=SWIPE_THRESHOLD)return;let direction=absDeltaX/this._deltaX;this._deltaX=0,direction&&execute(direction>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(EventHandler.on(this._element,EVENT_POINTERDOWN,event=>this._start(event)),EventHandler.on(this._element,EVENT_POINTERUP,event=>this._end(event)),this._element.classList.add(CLASS_NAME_POINTER_EVENT)):(EventHandler.on(this._element,EVENT_TOUCHSTART,event=>this._start(event)),EventHandler.on(this._element,EVENT_TOUCHMOVE,event=>this._move(event)),EventHandler.on(this._element,EVENT_TOUCHEND,event=>this._end(event)))}_eventIsPointerPenTouch(event){return this._supportPointerEvents&&(event.pointerType===POINTER_TYPE_PEN||event.pointerType===POINTER_TYPE_TOUCH)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}},NAME$c="carousel",DATA_KEY$8="bs.carousel",EVENT_KEY$8=`.${DATA_KEY$8}`,DATA_API_KEY$5=".data-api",ARROW_LEFT_KEY$1="ArrowLeft",ARROW_RIGHT_KEY$1="ArrowRight",TOUCHEVENT_COMPAT_WAIT=500,ORDER_NEXT="next",ORDER_PREV="prev",DIRECTION_LEFT="left",DIRECTION_RIGHT="right",EVENT_SLIDE=`slide${EVENT_KEY$8}`,EVENT_SLID=`slid${EVENT_KEY$8}`,EVENT_KEYDOWN$1=`keydown${EVENT_KEY$8}`,EVENT_MOUSEENTER$1=`mouseenter${EVENT_KEY$8}`,EVENT_MOUSELEAVE$1=`mouseleave${EVENT_KEY$8}`,EVENT_DRAG_START=`dragstart${EVENT_KEY$8}`,EVENT_LOAD_DATA_API$3=`load${EVENT_KEY$8}${DATA_API_KEY$5}`,EVENT_CLICK_DATA_API$5=`click${EVENT_KEY$8}${DATA_API_KEY$5}`,CLASS_NAME_CAROUSEL="carousel",CLASS_NAME_ACTIVE$2="active",CLASS_NAME_SLIDE="slide",CLASS_NAME_END="carousel-item-end",CLASS_NAME_START="carousel-item-start",CLASS_NAME_NEXT="carousel-item-next",CLASS_NAME_PREV="carousel-item-prev",SELECTOR_ACTIVE=".active",SELECTOR_ITEM=".carousel-item",SELECTOR_ACTIVE_ITEM=SELECTOR_ACTIVE+SELECTOR_ITEM,SELECTOR_ITEM_IMG=".carousel-item img",SELECTOR_INDICATORS=".carousel-indicators",SELECTOR_DATA_SLIDE="[data-bs-slide], [data-bs-slide-to]",SELECTOR_DATA_RIDE='[data-bs-ride="carousel"]',KEY_TO_DIRECTION={[ARROW_LEFT_KEY$1]:DIRECTION_RIGHT,[ARROW_RIGHT_KEY$1]:DIRECTION_LEFT},Default$b={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},DefaultType$b={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"},Carousel=class _Carousel extends BaseComponent{constructor(element,config){super(element,config),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=SelectorEngine.findOne(SELECTOR_INDICATORS,this._element),this._addEventListeners(),this._config.ride===CLASS_NAME_CAROUSEL&&this.cycle()}static get Default(){return Default$b}static get DefaultType(){return DefaultType$b}static get NAME(){return NAME$c}next(){this._slide(ORDER_NEXT)}nextWhenVisible(){!document.hidden&&isVisible(this._element)&&this.next()}prev(){this._slide(ORDER_PREV)}pause(){this._isSliding&&triggerTransitionEnd(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){EventHandler.one(this._element,EVENT_SLID,()=>this.cycle());return}this.cycle()}}to(index){let items=this._getItems();if(index>items.length-1||index<0)return;if(this._isSliding){EventHandler.one(this._element,EVENT_SLID,()=>this.to(index));return}let activeIndex=this._getItemIndex(this._getActive());if(activeIndex===index)return;let order2=index>activeIndex?ORDER_NEXT:ORDER_PREV;this._slide(order2,items[index])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(config){return config.defaultInterval=config.interval,config}_addEventListeners(){this._config.keyboard&&EventHandler.on(this._element,EVENT_KEYDOWN$1,event=>this._keydown(event)),this._config.pause==="hover"&&(EventHandler.on(this._element,EVENT_MOUSEENTER$1,()=>this.pause()),EventHandler.on(this._element,EVENT_MOUSELEAVE$1,()=>this._maybeEnableCycle())),this._config.touch&&Swipe.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(let img of SelectorEngine.find(SELECTOR_ITEM_IMG,this._element))EventHandler.on(img,EVENT_DRAG_START,event=>event.preventDefault());let swipeConfig={leftCallback:()=>this._slide(this._directionToOrder(DIRECTION_LEFT)),rightCallback:()=>this._slide(this._directionToOrder(DIRECTION_RIGHT)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),TOUCHEVENT_COMPAT_WAIT+this._config.interval))}};this._swipeHelper=new Swipe(this._element,swipeConfig)}_keydown(event){if(/input|textarea/i.test(event.target.tagName))return;let direction=KEY_TO_DIRECTION[event.key];direction&&(event.preventDefault(),this._slide(this._directionToOrder(direction)))}_getItemIndex(element){return this._getItems().indexOf(element)}_setActiveIndicatorElement(index){if(!this._indicatorsElement)return;let activeIndicator=SelectorEngine.findOne(SELECTOR_ACTIVE,this._indicatorsElement);activeIndicator.classList.remove(CLASS_NAME_ACTIVE$2),activeIndicator.removeAttribute("aria-current");let newActiveIndicator=SelectorEngine.findOne(`[data-bs-slide-to="${index}"]`,this._indicatorsElement);newActiveIndicator&&(newActiveIndicator.classList.add(CLASS_NAME_ACTIVE$2),newActiveIndicator.setAttribute("aria-current","true"))}_updateInterval(){let element=this._activeElement||this._getActive();if(!element)return;let elementInterval=Number.parseInt(element.getAttribute("data-bs-interval"),10);this._config.interval=elementInterval||this._config.defaultInterval}_slide(order2,element=null){if(this._isSliding)return;let activeElement=this._getActive(),isNext=order2===ORDER_NEXT,nextElement=element||getNextActiveElement(this._getItems(),activeElement,isNext,this._config.wrap);if(nextElement===activeElement)return;let nextElementIndex=this._getItemIndex(nextElement),triggerEvent=eventName=>EventHandler.trigger(this._element,eventName,{relatedTarget:nextElement,direction:this._orderToDirection(order2),from:this._getItemIndex(activeElement),to:nextElementIndex});if(triggerEvent(EVENT_SLIDE).defaultPrevented||!activeElement||!nextElement)return;let isCycling=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(nextElementIndex),this._activeElement=nextElement;let directionalClassName=isNext?CLASS_NAME_START:CLASS_NAME_END,orderClassName=isNext?CLASS_NAME_NEXT:CLASS_NAME_PREV;nextElement.classList.add(orderClassName),reflow(nextElement),activeElement.classList.add(directionalClassName),nextElement.classList.add(directionalClassName);let completeCallBack=()=>{nextElement.classList.remove(directionalClassName,orderClassName),nextElement.classList.add(CLASS_NAME_ACTIVE$2),activeElement.classList.remove(CLASS_NAME_ACTIVE$2,orderClassName,directionalClassName),this._isSliding=!1,triggerEvent(EVENT_SLID)};this._queueCallback(completeCallBack,activeElement,this._isAnimated()),isCycling&&this.cycle()}_isAnimated(){return this._element.classList.contains(CLASS_NAME_SLIDE)}_getActive(){return SelectorEngine.findOne(SELECTOR_ACTIVE_ITEM,this._element)}_getItems(){return SelectorEngine.find(SELECTOR_ITEM,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(direction){return isRTL()?direction===DIRECTION_LEFT?ORDER_PREV:ORDER_NEXT:direction===DIRECTION_LEFT?ORDER_NEXT:ORDER_PREV}_orderToDirection(order2){return isRTL()?order2===ORDER_PREV?DIRECTION_LEFT:DIRECTION_RIGHT:order2===ORDER_PREV?DIRECTION_RIGHT:DIRECTION_LEFT}static jQueryInterface(config){return this.each(function(){let data=_Carousel.getOrCreateInstance(this,config);if(typeof config=="number"){data.to(config);return}if(typeof config=="string"){if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config]()}})}};EventHandler.on(document,EVENT_CLICK_DATA_API$5,SELECTOR_DATA_SLIDE,function(event){let target=SelectorEngine.getElementFromSelector(this);if(!target||!target.classList.contains(CLASS_NAME_CAROUSEL))return;event.preventDefault();let carousel=Carousel.getOrCreateInstance(target),slideIndex=this.getAttribute("data-bs-slide-to");if(slideIndex){carousel.to(slideIndex),carousel._maybeEnableCycle();return}if(Manipulator.getDataAttribute(this,"slide")==="next"){carousel.next(),carousel._maybeEnableCycle();return}carousel.prev(),carousel._maybeEnableCycle()});EventHandler.on(window,EVENT_LOAD_DATA_API$3,()=>{let carousels=SelectorEngine.find(SELECTOR_DATA_RIDE);for(let carousel of carousels)Carousel.getOrCreateInstance(carousel)});defineJQueryPlugin(Carousel);var NAME$b="collapse",DATA_KEY$7="bs.collapse",EVENT_KEY$7=`.${DATA_KEY$7}`,DATA_API_KEY$4=".data-api",EVENT_SHOW$6=`show${EVENT_KEY$7}`,EVENT_SHOWN$6=`shown${EVENT_KEY$7}`,EVENT_HIDE$6=`hide${EVENT_KEY$7}`,EVENT_HIDDEN$6=`hidden${EVENT_KEY$7}`,EVENT_CLICK_DATA_API$4=`click${EVENT_KEY$7}${DATA_API_KEY$4}`,CLASS_NAME_SHOW$7="show",CLASS_NAME_COLLAPSE="collapse",CLASS_NAME_COLLAPSING="collapsing",CLASS_NAME_COLLAPSED="collapsed",CLASS_NAME_DEEPER_CHILDREN=`:scope .${CLASS_NAME_COLLAPSE} .${CLASS_NAME_COLLAPSE}`,CLASS_NAME_HORIZONTAL="collapse-horizontal",WIDTH="width",HEIGHT="height",SELECTOR_ACTIVES=".collapse.show, .collapse.collapsing",SELECTOR_DATA_TOGGLE$4='[data-bs-toggle="collapse"]',Default$a={parent:null,toggle:!0},DefaultType$a={parent:"(null|element)",toggle:"boolean"},Collapse=class _Collapse extends BaseComponent{constructor(element,config){super(element,config),this._isTransitioning=!1,this._triggerArray=[];let toggleList=SelectorEngine.find(SELECTOR_DATA_TOGGLE$4);for(let elem of toggleList){let selector=SelectorEngine.getSelectorFromElement(elem),filterElement=SelectorEngine.find(selector).filter(foundElement=>foundElement===this._element);selector!==null&&filterElement.length&&this._triggerArray.push(elem)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Default$a}static get DefaultType(){return DefaultType$a}static get NAME(){return NAME$b}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let activeChildren=[];if(this._config.parent&&(activeChildren=this._getFirstLevelChildren(SELECTOR_ACTIVES).filter(element=>element!==this._element).map(element=>_Collapse.getOrCreateInstance(element,{toggle:!1}))),activeChildren.length&&activeChildren[0]._isTransitioning||EventHandler.trigger(this._element,EVENT_SHOW$6).defaultPrevented)return;for(let activeInstance of activeChildren)activeInstance.hide();let dimension=this._getDimension();this._element.classList.remove(CLASS_NAME_COLLAPSE),this._element.classList.add(CLASS_NAME_COLLAPSING),this._element.style[dimension]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;let complete=()=>{this._isTransitioning=!1,this._element.classList.remove(CLASS_NAME_COLLAPSING),this._element.classList.add(CLASS_NAME_COLLAPSE,CLASS_NAME_SHOW$7),this._element.style[dimension]="",EventHandler.trigger(this._element,EVENT_SHOWN$6)},scrollSize=`scroll${dimension[0].toUpperCase()+dimension.slice(1)}`;this._queueCallback(complete,this._element,!0),this._element.style[dimension]=`${this._element[scrollSize]}px`}hide(){if(this._isTransitioning||!this._isShown()||EventHandler.trigger(this._element,EVENT_HIDE$6).defaultPrevented)return;let dimension=this._getDimension();this._element.style[dimension]=`${this._element.getBoundingClientRect()[dimension]}px`,reflow(this._element),this._element.classList.add(CLASS_NAME_COLLAPSING),this._element.classList.remove(CLASS_NAME_COLLAPSE,CLASS_NAME_SHOW$7);for(let trigger of this._triggerArray){let element=SelectorEngine.getElementFromSelector(trigger);element&&!this._isShown(element)&&this._addAriaAndCollapsedClass([trigger],!1)}this._isTransitioning=!0;let complete=()=>{this._isTransitioning=!1,this._element.classList.remove(CLASS_NAME_COLLAPSING),this._element.classList.add(CLASS_NAME_COLLAPSE),EventHandler.trigger(this._element,EVENT_HIDDEN$6)};this._element.style[dimension]="",this._queueCallback(complete,this._element,!0)}_isShown(element=this._element){return element.classList.contains(CLASS_NAME_SHOW$7)}_configAfterMerge(config){return config.toggle=!!config.toggle,config.parent=getElement(config.parent),config}_getDimension(){return this._element.classList.contains(CLASS_NAME_HORIZONTAL)?WIDTH:HEIGHT}_initializeChildren(){if(!this._config.parent)return;let children=this._getFirstLevelChildren(SELECTOR_DATA_TOGGLE$4);for(let element of children){let selected=SelectorEngine.getElementFromSelector(element);selected&&this._addAriaAndCollapsedClass([element],this._isShown(selected))}}_getFirstLevelChildren(selector){let children=SelectorEngine.find(CLASS_NAME_DEEPER_CHILDREN,this._config.parent);return SelectorEngine.find(selector,this._config.parent).filter(element=>!children.includes(element))}_addAriaAndCollapsedClass(triggerArray,isOpen){if(triggerArray.length)for(let element of triggerArray)element.classList.toggle(CLASS_NAME_COLLAPSED,!isOpen),element.setAttribute("aria-expanded",isOpen)}static jQueryInterface(config){let _config={};return typeof config=="string"&&/show|hide/.test(config)&&(_config.toggle=!1),this.each(function(){let data=_Collapse.getOrCreateInstance(this,_config);if(typeof config=="string"){if(typeof data[config]>"u")throw new TypeError(`No method named "${config}"`);data[config]()}})}};EventHandler.on(document,EVENT_CLICK_DATA_API$4,SELECTOR_DATA_TOGGLE$4,function(event){(event.target.tagName==="A"||event.delegateTarget&&event.delegateTarget.tagName==="A")&&event.preventDefault();for(let element of SelectorEngine.getMultipleElementsFromSelector(this))Collapse.getOrCreateInstance(element,{toggle:!1}).toggle()});defineJQueryPlugin(Collapse);var NAME$a="dropdown",DATA_KEY$6="bs.dropdown",EVENT_KEY$6=`.${DATA_KEY$6}`,DATA_API_KEY$3=".data-api",ESCAPE_KEY$2="Escape",TAB_KEY$1="Tab",ARROW_UP_KEY$1="ArrowUp",ARROW_DOWN_KEY$1="ArrowDown",RIGHT_MOUSE_BUTTON=2,EVENT_HIDE$5=`hide${EVENT_KEY$6}`,EVENT_HIDDEN$5=`hidden${EVENT_KEY$6}`,EVENT_SHOW$5=`show${EVENT_KEY$6}`,EVENT_SHOWN$5=`shown${EVENT_KEY$6}`,EVENT_CLICK_DATA_API$3=`click${EVENT_KEY$6}${DATA_API_KEY$3}`,EVENT_KEYDOWN_DATA_API=`keydown${EVENT_KEY$6}${DATA_API_KEY$3}`,EVENT_KEYUP_DATA_API=`keyup${EVENT_KEY$6}${DATA_API_KEY$3}`,CLASS_NAME_SHOW$6="show",CLASS_NAME_DROPUP="dropup",CLASS_NAME_DROPEND="dropend",CLASS_NAME_DROPSTART="dropstart",CLASS_NAME_DROPUP_CENTER="dropup-center",CLASS_NAME_DROPDOWN_CENTER="dropdown-center",SELECTOR_DATA_TOGGLE$3='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',SELECTOR_DATA_TOGGLE_SHOWN=`${SELECTOR_DATA_TOGGLE$3}.${CLASS_NAME_SHOW$6}`,SELECTOR_MENU=".dropdown-menu",SELECTOR_NAVBAR=".navbar",SELECTOR_NAVBAR_NAV=".navbar-nav",SELECTOR_VISIBLE_ITEMS=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",PLACEMENT_TOP=isRTL()?"top-end":"top-start",PLACEMENT_TOPEND=isRTL()?"top-start":"top-end",PLACEMENT_BOTTOM=isRTL()?"bottom-end":"bottom-start",PLACEMENT_BOTTOMEND=isRTL()?"bottom-start":"bottom-end",PLACEMENT_RIGHT=isRTL()?"left-start":"right-start",PLACEMENT_LEFT=isRTL()?"right-start":"left-start",PLACEMENT_TOPCENTER="top",PLACEMENT_BOTTOMCENTER="bottom",Default$9={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},DefaultType$9={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"},Dropdown=class _Dropdown extends BaseComponent{constructor(element,config){super(element,config),this._popper=null,this._parent=this._element.parentNode,this._menu=SelectorEngine.next(this._element,SELECTOR_MENU)[0]||SelectorEngine.prev(this._element,SELECTOR_MENU)[0]||SelectorEngine.findOne(SELECTOR_MENU,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Default$9}static get DefaultType(){return DefaultType$9}static get NAME(){return NAME$a}toggle(){return this._isShown()?this.hide():this.show()}show(){if(isDisabled(this._element)||this._isShown())return;let relatedTarget={relatedTarget:this._element};if(!EventHandler.trigger(this._element,EVENT_SHOW$5,relatedTarget).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(SELECTOR_NAVBAR_NAV))for(let element of[].concat(...document.body.children))EventHandler.on(element,"mouseover",noop);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(CLASS_NAME_SHOW$6),this._element.classList.add(CLASS_NAME_SHOW$6),EventHandler.trigger(this._element,EVENT_SHOWN$5,relatedTarget)}}hide(){if(isDisabled(this._element)||!this._isShown())return;let relatedTarget={relatedTarget:this._element};this._completeHide(relatedTarget)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(relatedTarget){if(!EventHandler.trigger(this._element,EVENT_HIDE$5,relatedTarget).defaultPrevented){if("ontouchstart"in document.documentElement)for(let element of[].concat(...document.body.children))EventHandler.off(element,"mouseover",noop);this._popper&&this._popper.destroy(),this._menu.classList.remove(CLASS_NAME_SHOW$6),this._element.classList.remove(CLASS_NAME_SHOW$6),this._element.setAttribute("aria-expanded","false"),Manipulator.removeDataAttribute(this._menu,"popper"),EventHandler.trigger(this._element,EVENT_HIDDEN$5,relatedTarget)}}_getConfig(config){if(config=super._getConfig(config),typeof config.reference=="object"&&!isElement2(config.reference)&&typeof config.reference.getBoundingClientRect!="function")throw new TypeError(`${NAME$a.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return config}_createPopper(){if(typeof lib_exports>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let referenceElement=this._element;this._config.reference==="parent"?referenceElement=this._parent:isElement2(this._config.reference)?referenceElement=getElement(this._config.reference):typeof this._config.reference=="object"&&(referenceElement=this._config.reference);let popperConfig=this._getPopperConfig();this._popper=createPopper3(referenceElement,this._menu,popperConfig)}_isShown(){return this._menu.classList.contains(CLASS_NAME_SHOW$6)}_getPlacement(){let parentDropdown=this._parent;if(parentDropdown.classList.contains(CLASS_NAME_DROPEND))return PLACEMENT_RIGHT;if(parentDropdown.classList.contains(CLASS_NAME_DROPSTART))return PLACEMENT_LEFT;if(parentDropdown.classList.contains(CLASS_NAME_DROPUP_CENTER))return PLACEMENT_TOPCENTER;if(parentDropdown.classList.contains(CLASS_NAME_DROPDOWN_CENTER))return PLACEMENT_BOTTOMCENTER;let isEnd=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return parentDropdown.classList.contains(CLASS_NAME_DROPUP)?isEnd?PLACEMENT_TOPEND:PLACEMENT_TOP:isEnd?PLACEMENT_BOTTOMEND:PLACEMENT_BOTTOM}_detectNavbar(){return this._element.closest(SELECTOR_NAVBAR)!==null}_getOffset(){let{offset:offset2}=this._config;return typeof offset2=="string"?offset2.split(",").map(value=>Number.parseInt(value,10)):typeof offset2=="function"?popperData=>offset2(popperData,this._element):offset2}_getPopperConfig(){let defaultBsPopperConfig={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Manipulator.setDataAttribute(this._menu,"popper","static"),defaultBsPopperConfig.modifiers=[{name:"applyStyles",enabled:!1}]),{...defaultBsPopperConfig,...execute(this._config.popperConfig,[defaultBsPopperConfig])}}_selectMenuItem({key,target}){let items=SelectorEngine.find(SELECTOR_VISIBLE_ITEMS,this._menu).filter(element=>isVisible(element));items.length&&getNextActiveElement(items,target,key===ARROW_DOWN_KEY$1,!items.includes(target)).focus()}static jQueryInterface(config){return this.each(function(){let data=_Dropdown.getOrCreateInstance(this,config);if(typeof config=="string"){if(typeof data[config]>"u")throw new TypeError(`No method named "${config}"`);data[config]()}})}static clearMenus(event){if(event.button===RIGHT_MOUSE_BUTTON||event.type==="keyup"&&event.key!==TAB_KEY$1)return;let openToggles=SelectorEngine.find(SELECTOR_DATA_TOGGLE_SHOWN);for(let toggle of openToggles){let context=_Dropdown.getInstance(toggle);if(!context||context._config.autoClose===!1)continue;let composedPath=event.composedPath(),isMenuTarget=composedPath.includes(context._menu);if(composedPath.includes(context._element)||context._config.autoClose==="inside"&&!isMenuTarget||context._config.autoClose==="outside"&&isMenuTarget||context._menu.contains(event.target)&&(event.type==="keyup"&&event.key===TAB_KEY$1||/input|select|option|textarea|form/i.test(event.target.tagName)))continue;let relatedTarget={relatedTarget:context._element};event.type==="click"&&(relatedTarget.clickEvent=event),context._completeHide(relatedTarget)}}static dataApiKeydownHandler(event){let isInput=/input|textarea/i.test(event.target.tagName),isEscapeEvent=event.key===ESCAPE_KEY$2,isUpOrDownEvent=[ARROW_UP_KEY$1,ARROW_DOWN_KEY$1].includes(event.key);if(!isUpOrDownEvent&&!isEscapeEvent||isInput&&!isEscapeEvent)return;event.preventDefault();let getToggleButton=this.matches(SELECTOR_DATA_TOGGLE$3)?this:SelectorEngine.prev(this,SELECTOR_DATA_TOGGLE$3)[0]||SelectorEngine.next(this,SELECTOR_DATA_TOGGLE$3)[0]||SelectorEngine.findOne(SELECTOR_DATA_TOGGLE$3,event.delegateTarget.parentNode),instance=_Dropdown.getOrCreateInstance(getToggleButton);if(isUpOrDownEvent){event.stopPropagation(),instance.show(),instance._selectMenuItem(event);return}instance._isShown()&&(event.stopPropagation(),instance.hide(),getToggleButton.focus())}};EventHandler.on(document,EVENT_KEYDOWN_DATA_API,SELECTOR_DATA_TOGGLE$3,Dropdown.dataApiKeydownHandler);EventHandler.on(document,EVENT_KEYDOWN_DATA_API,SELECTOR_MENU,Dropdown.dataApiKeydownHandler);EventHandler.on(document,EVENT_CLICK_DATA_API$3,Dropdown.clearMenus);EventHandler.on(document,EVENT_KEYUP_DATA_API,Dropdown.clearMenus);EventHandler.on(document,EVENT_CLICK_DATA_API$3,SELECTOR_DATA_TOGGLE$3,function(event){event.preventDefault(),Dropdown.getOrCreateInstance(this).toggle()});defineJQueryPlugin(Dropdown);var NAME$9="backdrop",CLASS_NAME_FADE$4="fade",CLASS_NAME_SHOW$5="show",EVENT_MOUSEDOWN=`mousedown.bs.${NAME$9}`,Default$8={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},DefaultType$8={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"},Backdrop=class extends Config{constructor(config){super(),this._config=this._getConfig(config),this._isAppended=!1,this._element=null}static get Default(){return Default$8}static get DefaultType(){return DefaultType$8}static get NAME(){return NAME$9}show(callback){if(!this._config.isVisible){execute(callback);return}this._append();let element=this._getElement();this._config.isAnimated&&reflow(element),element.classList.add(CLASS_NAME_SHOW$5),this._emulateAnimation(()=>{execute(callback)})}hide(callback){if(!this._config.isVisible){execute(callback);return}this._getElement().classList.remove(CLASS_NAME_SHOW$5),this._emulateAnimation(()=>{this.dispose(),execute(callback)})}dispose(){this._isAppended&&(EventHandler.off(this._element,EVENT_MOUSEDOWN),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){let backdrop=document.createElement("div");backdrop.className=this._config.className,this._config.isAnimated&&backdrop.classList.add(CLASS_NAME_FADE$4),this._element=backdrop}return this._element}_configAfterMerge(config){return config.rootElement=getElement(config.rootElement),config}_append(){if(this._isAppended)return;let element=this._getElement();this._config.rootElement.append(element),EventHandler.on(element,EVENT_MOUSEDOWN,()=>{execute(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(callback){executeAfterTransition(callback,this._getElement(),this._config.isAnimated)}},NAME$8="focustrap",DATA_KEY$5="bs.focustrap",EVENT_KEY$5=`.${DATA_KEY$5}`,EVENT_FOCUSIN$2=`focusin${EVENT_KEY$5}`,EVENT_KEYDOWN_TAB=`keydown.tab${EVENT_KEY$5}`,TAB_KEY="Tab",TAB_NAV_FORWARD="forward",TAB_NAV_BACKWARD="backward",Default$7={autofocus:!0,trapElement:null},DefaultType$7={autofocus:"boolean",trapElement:"element"},FocusTrap=class extends Config{constructor(config){super(),this._config=this._getConfig(config),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Default$7}static get DefaultType(){return DefaultType$7}static get NAME(){return NAME$8}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),EventHandler.off(document,EVENT_KEY$5),EventHandler.on(document,EVENT_FOCUSIN$2,event=>this._handleFocusin(event)),EventHandler.on(document,EVENT_KEYDOWN_TAB,event=>this._handleKeydown(event)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,EventHandler.off(document,EVENT_KEY$5))}_handleFocusin(event){let{trapElement}=this._config;if(event.target===document||event.target===trapElement||trapElement.contains(event.target))return;let elements=SelectorEngine.focusableChildren(trapElement);elements.length===0?trapElement.focus():this._lastTabNavDirection===TAB_NAV_BACKWARD?elements[elements.length-1].focus():elements[0].focus()}_handleKeydown(event){event.key===TAB_KEY&&(this._lastTabNavDirection=event.shiftKey?TAB_NAV_BACKWARD:TAB_NAV_FORWARD)}},SELECTOR_FIXED_CONTENT=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",SELECTOR_STICKY_CONTENT=".sticky-top",PROPERTY_PADDING="padding-right",PROPERTY_MARGIN="margin-right",ScrollBarHelper=class{constructor(){this._element=document.body}getWidth(){let documentWidth=document.documentElement.clientWidth;return Math.abs(window.innerWidth-documentWidth)}hide(){let width=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,PROPERTY_PADDING,calculatedValue=>calculatedValue+width),this._setElementAttributes(SELECTOR_FIXED_CONTENT,PROPERTY_PADDING,calculatedValue=>calculatedValue+width),this._setElementAttributes(SELECTOR_STICKY_CONTENT,PROPERTY_MARGIN,calculatedValue=>calculatedValue-width)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,PROPERTY_PADDING),this._resetElementAttributes(SELECTOR_FIXED_CONTENT,PROPERTY_PADDING),this._resetElementAttributes(SELECTOR_STICKY_CONTENT,PROPERTY_MARGIN)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(selector,styleProperty,callback){let scrollbarWidth=this.getWidth(),manipulationCallBack=element=>{if(element!==this._element&&window.innerWidth>element.clientWidth+scrollbarWidth)return;this._saveInitialAttribute(element,styleProperty);let calculatedValue=window.getComputedStyle(element).getPropertyValue(styleProperty);element.style.setProperty(styleProperty,`${callback(Number.parseFloat(calculatedValue))}px`)};this._applyManipulationCallback(selector,manipulationCallBack)}_saveInitialAttribute(element,styleProperty){let actualValue=element.style.getPropertyValue(styleProperty);actualValue&&Manipulator.setDataAttribute(element,styleProperty,actualValue)}_resetElementAttributes(selector,styleProperty){let manipulationCallBack=element=>{let value=Manipulator.getDataAttribute(element,styleProperty);if(value===null){element.style.removeProperty(styleProperty);return}Manipulator.removeDataAttribute(element,styleProperty),element.style.setProperty(styleProperty,value)};this._applyManipulationCallback(selector,manipulationCallBack)}_applyManipulationCallback(selector,callBack){if(isElement2(selector)){callBack(selector);return}for(let sel of SelectorEngine.find(selector,this._element))callBack(sel)}},NAME$7="modal",DATA_KEY$4="bs.modal",EVENT_KEY$4=`.${DATA_KEY$4}`,DATA_API_KEY$2=".data-api",ESCAPE_KEY$1="Escape",EVENT_HIDE$4=`hide${EVENT_KEY$4}`,EVENT_HIDE_PREVENTED$1=`hidePrevented${EVENT_KEY$4}`,EVENT_HIDDEN$4=`hidden${EVENT_KEY$4}`,EVENT_SHOW$4=`show${EVENT_KEY$4}`,EVENT_SHOWN$4=`shown${EVENT_KEY$4}`,EVENT_RESIZE$1=`resize${EVENT_KEY$4}`,EVENT_CLICK_DISMISS=`click.dismiss${EVENT_KEY$4}`,EVENT_MOUSEDOWN_DISMISS=`mousedown.dismiss${EVENT_KEY$4}`,EVENT_KEYDOWN_DISMISS$1=`keydown.dismiss${EVENT_KEY$4}`,EVENT_CLICK_DATA_API$2=`click${EVENT_KEY$4}${DATA_API_KEY$2}`,CLASS_NAME_OPEN="modal-open",CLASS_NAME_FADE$3="fade",CLASS_NAME_SHOW$4="show",CLASS_NAME_STATIC="modal-static",OPEN_SELECTOR$1=".modal.show",SELECTOR_DIALOG=".modal-dialog",SELECTOR_MODAL_BODY=".modal-body",SELECTOR_DATA_TOGGLE$2='[data-bs-toggle="modal"]',Default$6={backdrop:!0,focus:!0,keyboard:!0},DefaultType$6={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"},Modal=class _Modal extends BaseComponent{constructor(element,config){super(element,config),this._dialog=SelectorEngine.findOne(SELECTOR_DIALOG,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new ScrollBarHelper,this._addEventListeners()}static get Default(){return Default$6}static get DefaultType(){return DefaultType$6}static get NAME(){return NAME$7}toggle(relatedTarget){return this._isShown?this.hide():this.show(relatedTarget)}show(relatedTarget){this._isShown||this._isTransitioning||EventHandler.trigger(this._element,EVENT_SHOW$4,{relatedTarget}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(CLASS_NAME_OPEN),this._adjustDialog(),this._backdrop.show(()=>this._showElement(relatedTarget)))}hide(){!this._isShown||this._isTransitioning||EventHandler.trigger(this._element,EVENT_HIDE$4).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(CLASS_NAME_SHOW$4),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){EventHandler.off(window,EVENT_KEY$4),EventHandler.off(this._dialog,EVENT_KEY$4),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Backdrop({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new FocusTrap({trapElement:this._element})}_showElement(relatedTarget){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;let modalBody=SelectorEngine.findOne(SELECTOR_MODAL_BODY,this._dialog);modalBody&&(modalBody.scrollTop=0),reflow(this._element),this._element.classList.add(CLASS_NAME_SHOW$4);let transitionComplete=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,EventHandler.trigger(this._element,EVENT_SHOWN$4,{relatedTarget})};this._queueCallback(transitionComplete,this._dialog,this._isAnimated())}_addEventListeners(){EventHandler.on(this._element,EVENT_KEYDOWN_DISMISS$1,event=>{if(event.key===ESCAPE_KEY$1){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),EventHandler.on(window,EVENT_RESIZE$1,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),EventHandler.on(this._element,EVENT_MOUSEDOWN_DISMISS,event=>{EventHandler.one(this._element,EVENT_CLICK_DISMISS,event2=>{if(!(this._element!==event.target||this._element!==event2.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(CLASS_NAME_OPEN),this._resetAdjustments(),this._scrollBar.reset(),EventHandler.trigger(this._element,EVENT_HIDDEN$4)})}_isAnimated(){return this._element.classList.contains(CLASS_NAME_FADE$3)}_triggerBackdropTransition(){if(EventHandler.trigger(this._element,EVENT_HIDE_PREVENTED$1).defaultPrevented)return;let isModalOverflowing=this._element.scrollHeight>document.documentElement.clientHeight,initialOverflowY=this._element.style.overflowY;initialOverflowY==="hidden"||this._element.classList.contains(CLASS_NAME_STATIC)||(isModalOverflowing||(this._element.style.overflowY="hidden"),this._element.classList.add(CLASS_NAME_STATIC),this._queueCallback(()=>{this._element.classList.remove(CLASS_NAME_STATIC),this._queueCallback(()=>{this._element.style.overflowY=initialOverflowY},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){let isModalOverflowing=this._element.scrollHeight>document.documentElement.clientHeight,scrollbarWidth=this._scrollBar.getWidth(),isBodyOverflowing=scrollbarWidth>0;if(isBodyOverflowing&&!isModalOverflowing){let property=isRTL()?"paddingLeft":"paddingRight";this._element.style[property]=`${scrollbarWidth}px`}if(!isBodyOverflowing&&isModalOverflowing){let property=isRTL()?"paddingRight":"paddingLeft";this._element.style[property]=`${scrollbarWidth}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(config,relatedTarget){return this.each(function(){let data=_Modal.getOrCreateInstance(this,config);if(typeof config=="string"){if(typeof data[config]>"u")throw new TypeError(`No method named "${config}"`);data[config](relatedTarget)}})}};EventHandler.on(document,EVENT_CLICK_DATA_API$2,SELECTOR_DATA_TOGGLE$2,function(event){let target=SelectorEngine.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&event.preventDefault(),EventHandler.one(target,EVENT_SHOW$4,showEvent=>{showEvent.defaultPrevented||EventHandler.one(target,EVENT_HIDDEN$4,()=>{isVisible(this)&&this.focus()})});let alreadyOpen=SelectorEngine.findOne(OPEN_SELECTOR$1);alreadyOpen&&Modal.getInstance(alreadyOpen).hide(),Modal.getOrCreateInstance(target).toggle(this)});enableDismissTrigger(Modal);defineJQueryPlugin(Modal);var NAME$6="offcanvas",DATA_KEY$3="bs.offcanvas",EVENT_KEY$3=`.${DATA_KEY$3}`,DATA_API_KEY$1=".data-api",EVENT_LOAD_DATA_API$2=`load${EVENT_KEY$3}${DATA_API_KEY$1}`,ESCAPE_KEY="Escape",CLASS_NAME_SHOW$3="show",CLASS_NAME_SHOWING$1="showing",CLASS_NAME_HIDING="hiding",CLASS_NAME_BACKDROP="offcanvas-backdrop",OPEN_SELECTOR=".offcanvas.show",EVENT_SHOW$3=`show${EVENT_KEY$3}`,EVENT_SHOWN$3=`shown${EVENT_KEY$3}`,EVENT_HIDE$3=`hide${EVENT_KEY$3}`,EVENT_HIDE_PREVENTED=`hidePrevented${EVENT_KEY$3}`,EVENT_HIDDEN$3=`hidden${EVENT_KEY$3}`,EVENT_RESIZE=`resize${EVENT_KEY$3}`,EVENT_CLICK_DATA_API$1=`click${EVENT_KEY$3}${DATA_API_KEY$1}`,EVENT_KEYDOWN_DISMISS=`keydown.dismiss${EVENT_KEY$3}`,SELECTOR_DATA_TOGGLE$1='[data-bs-toggle="offcanvas"]',Default$5={backdrop:!0,keyboard:!0,scroll:!1},DefaultType$5={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"},Offcanvas=class _Offcanvas extends BaseComponent{constructor(element,config){super(element,config),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Default$5}static get DefaultType(){return DefaultType$5}static get NAME(){return NAME$6}toggle(relatedTarget){return this._isShown?this.hide():this.show(relatedTarget)}show(relatedTarget){if(this._isShown||EventHandler.trigger(this._element,EVENT_SHOW$3,{relatedTarget}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new ScrollBarHelper().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(CLASS_NAME_SHOWING$1);let completeCallBack=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(CLASS_NAME_SHOW$3),this._element.classList.remove(CLASS_NAME_SHOWING$1),EventHandler.trigger(this._element,EVENT_SHOWN$3,{relatedTarget})};this._queueCallback(completeCallBack,this._element,!0)}hide(){if(!this._isShown||EventHandler.trigger(this._element,EVENT_HIDE$3).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(CLASS_NAME_HIDING),this._backdrop.hide();let completeCallback=()=>{this._element.classList.remove(CLASS_NAME_SHOW$3,CLASS_NAME_HIDING),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new ScrollBarHelper().reset(),EventHandler.trigger(this._element,EVENT_HIDDEN$3)};this._queueCallback(completeCallback,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){let clickCallback=()=>{if(this._config.backdrop==="static"){EventHandler.trigger(this._element,EVENT_HIDE_PREVENTED);return}this.hide()},isVisible2=!!this._config.backdrop;return new Backdrop({className:CLASS_NAME_BACKDROP,isVisible:isVisible2,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:isVisible2?clickCallback:null})}_initializeFocusTrap(){return new FocusTrap({trapElement:this._element})}_addEventListeners(){EventHandler.on(this._element,EVENT_KEYDOWN_DISMISS,event=>{if(event.key===ESCAPE_KEY){if(this._config.keyboard){this.hide();return}EventHandler.trigger(this._element,EVENT_HIDE_PREVENTED)}})}static jQueryInterface(config){return this.each(function(){let data=_Offcanvas.getOrCreateInstance(this,config);if(typeof config=="string"){if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config](this)}})}};EventHandler.on(document,EVENT_CLICK_DATA_API$1,SELECTOR_DATA_TOGGLE$1,function(event){let target=SelectorEngine.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&event.preventDefault(),isDisabled(this))return;EventHandler.one(target,EVENT_HIDDEN$3,()=>{isVisible(this)&&this.focus()});let alreadyOpen=SelectorEngine.findOne(OPEN_SELECTOR);alreadyOpen&&alreadyOpen!==target&&Offcanvas.getInstance(alreadyOpen).hide(),Offcanvas.getOrCreateInstance(target).toggle(this)});EventHandler.on(window,EVENT_LOAD_DATA_API$2,()=>{for(let selector of SelectorEngine.find(OPEN_SELECTOR))Offcanvas.getOrCreateInstance(selector).show()});EventHandler.on(window,EVENT_RESIZE,()=>{for(let element of SelectorEngine.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(element).position!=="fixed"&&Offcanvas.getOrCreateInstance(element).hide()});enableDismissTrigger(Offcanvas);defineJQueryPlugin(Offcanvas);var ARIA_ATTRIBUTE_PATTERN=/^aria-[\w-]*$/i,DefaultAllowlist={"*":["class","dir","id","lang","role",ARIA_ATTRIBUTE_PATTERN],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},uriAttributes=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),SAFE_URL_PATTERN=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,allowedAttribute=(attribute,allowedAttributeList)=>{let attributeName=attribute.nodeName.toLowerCase();return allowedAttributeList.includes(attributeName)?uriAttributes.has(attributeName)?!!SAFE_URL_PATTERN.test(attribute.nodeValue):!0:allowedAttributeList.filter(attributeRegex=>attributeRegex instanceof RegExp).some(regex=>regex.test(attributeName))};function sanitizeHtml(unsafeHtml,allowList,sanitizeFunction){if(!unsafeHtml.length)return unsafeHtml;if(sanitizeFunction&&typeof sanitizeFunction=="function")return sanitizeFunction(unsafeHtml);let createdDocument=new window.DOMParser().parseFromString(unsafeHtml,"text/html"),elements=[].concat(...createdDocument.body.querySelectorAll("*"));for(let element of elements){let elementName=element.nodeName.toLowerCase();if(!Object.keys(allowList).includes(elementName)){element.remove();continue}let attributeList=[].concat(...element.attributes),allowedAttributes=[].concat(allowList["*"]||[],allowList[elementName]||[]);for(let attribute of attributeList)allowedAttribute(attribute,allowedAttributes)||element.removeAttribute(attribute.nodeName)}return createdDocument.body.innerHTML}var NAME$5="TemplateFactory",Default$4={allowList:DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},DefaultType$4={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},DefaultContentType={entry:"(string|element|function|null)",selector:"(string|element)"},TemplateFactory=class extends Config{constructor(config){super(),this._config=this._getConfig(config)}static get Default(){return Default$4}static get DefaultType(){return DefaultType$4}static get NAME(){return NAME$5}getContent(){return Object.values(this._config.content).map(config=>this._resolvePossibleFunction(config)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(content){return this._checkContent(content),this._config.content={...this._config.content,...content},this}toHtml(){let templateWrapper=document.createElement("div");templateWrapper.innerHTML=this._maybeSanitize(this._config.template);for(let[selector,text]of Object.entries(this._config.content))this._setContent(templateWrapper,text,selector);let template=templateWrapper.children[0],extraClass=this._resolvePossibleFunction(this._config.extraClass);return extraClass&&template.classList.add(...extraClass.split(" ")),template}_typeCheckConfig(config){super._typeCheckConfig(config),this._checkContent(config.content)}_checkContent(arg){for(let[selector,content]of Object.entries(arg))super._typeCheckConfig({selector,entry:content},DefaultContentType)}_setContent(template,content,selector){let templateElement=SelectorEngine.findOne(selector,template);if(templateElement){if(content=this._resolvePossibleFunction(content),!content){templateElement.remove();return}if(isElement2(content)){this._putElementInTemplate(getElement(content),templateElement);return}if(this._config.html){templateElement.innerHTML=this._maybeSanitize(content);return}templateElement.textContent=content}}_maybeSanitize(arg){return this._config.sanitize?sanitizeHtml(arg,this._config.allowList,this._config.sanitizeFn):arg}_resolvePossibleFunction(arg){return execute(arg,[this])}_putElementInTemplate(element,templateElement){if(this._config.html){templateElement.innerHTML="",templateElement.append(element);return}templateElement.textContent=element.textContent}},NAME$4="tooltip",DISALLOWED_ATTRIBUTES=new Set(["sanitize","allowList","sanitizeFn"]),CLASS_NAME_FADE$2="fade",CLASS_NAME_MODAL="modal",CLASS_NAME_SHOW$2="show",SELECTOR_TOOLTIP_INNER=".tooltip-inner",SELECTOR_MODAL=`.${CLASS_NAME_MODAL}`,EVENT_MODAL_HIDE="hide.bs.modal",TRIGGER_HOVER="hover",TRIGGER_FOCUS="focus",TRIGGER_CLICK="click",TRIGGER_MANUAL="manual",EVENT_HIDE$2="hide",EVENT_HIDDEN$2="hidden",EVENT_SHOW$2="show",EVENT_SHOWN$2="shown",EVENT_INSERTED="inserted",EVENT_CLICK$1="click",EVENT_FOCUSIN$1="focusin",EVENT_FOCUSOUT$1="focusout",EVENT_MOUSEENTER="mouseenter",EVENT_MOUSELEAVE="mouseleave",AttachmentMap={AUTO:"auto",TOP:"top",RIGHT:isRTL()?"left":"right",BOTTOM:"bottom",LEFT:isRTL()?"right":"left"},Default$3={allowList:DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},DefaultType$3={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"},Tooltip=class _Tooltip extends BaseComponent{constructor(element,config){if(typeof lib_exports>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(element,config),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Default$3}static get DefaultType(){return DefaultType$3}static get NAME(){return NAME$4}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),EventHandler.off(this._element.closest(SELECTOR_MODAL),EVENT_MODAL_HIDE,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;let showEvent=EventHandler.trigger(this._element,this.constructor.eventName(EVENT_SHOW$2)),isInTheDom=(findShadowRoot(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(showEvent.defaultPrevented||!isInTheDom)return;this._disposePopper();let tip=this._getTipElement();this._element.setAttribute("aria-describedby",tip.getAttribute("id"));let{container}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(container.append(tip),EventHandler.trigger(this._element,this.constructor.eventName(EVENT_INSERTED))),this._popper=this._createPopper(tip),tip.classList.add(CLASS_NAME_SHOW$2),"ontouchstart"in document.documentElement)for(let element of[].concat(...document.body.children))EventHandler.on(element,"mouseover",noop);let complete=()=>{EventHandler.trigger(this._element,this.constructor.eventName(EVENT_SHOWN$2)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(complete,this.tip,this._isAnimated())}hide(){if(!this._isShown()||EventHandler.trigger(this._element,this.constructor.eventName(EVENT_HIDE$2)).defaultPrevented)return;if(this._getTipElement().classList.remove(CLASS_NAME_SHOW$2),"ontouchstart"in document.documentElement)for(let element of[].concat(...document.body.children))EventHandler.off(element,"mouseover",noop);this._activeTrigger[TRIGGER_CLICK]=!1,this._activeTrigger[TRIGGER_FOCUS]=!1,this._activeTrigger[TRIGGER_HOVER]=!1,this._isHovered=null;let complete=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),EventHandler.trigger(this._element,this.constructor.eventName(EVENT_HIDDEN$2)))};this._queueCallback(complete,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(content){let tip=this._getTemplateFactory(content).toHtml();if(!tip)return null;tip.classList.remove(CLASS_NAME_FADE$2,CLASS_NAME_SHOW$2),tip.classList.add(`bs-${this.constructor.NAME}-auto`);let tipId=getUID(this.constructor.NAME).toString();return tip.setAttribute("id",tipId),this._isAnimated()&&tip.classList.add(CLASS_NAME_FADE$2),tip}setContent(content){this._newContent=content,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(content){return this._templateFactory?this._templateFactory.changeContent(content):this._templateFactory=new TemplateFactory({...this._config,content,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[SELECTOR_TOOLTIP_INNER]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(event){return this.constructor.getOrCreateInstance(event.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(CLASS_NAME_FADE$2)}_isShown(){return this.tip&&this.tip.classList.contains(CLASS_NAME_SHOW$2)}_createPopper(tip){let placement=execute(this._config.placement,[this,tip,this._element]),attachment=AttachmentMap[placement.toUpperCase()];return createPopper3(this._element,tip,this._getPopperConfig(attachment))}_getOffset(){let{offset:offset2}=this._config;return typeof offset2=="string"?offset2.split(",").map(value=>Number.parseInt(value,10)):typeof offset2=="function"?popperData=>offset2(popperData,this._element):offset2}_resolvePossibleFunction(arg){return execute(arg,[this._element])}_getPopperConfig(attachment){let defaultBsPopperConfig={placement:attachment,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:data=>{this._getTipElement().setAttribute("data-popper-placement",data.state.placement)}}]};return{...defaultBsPopperConfig,...execute(this._config.popperConfig,[defaultBsPopperConfig])}}_setListeners(){let triggers=this._config.trigger.split(" ");for(let trigger of triggers)if(trigger==="click")EventHandler.on(this._element,this.constructor.eventName(EVENT_CLICK$1),this._config.selector,event=>{this._initializeOnDelegatedTarget(event).toggle()});else if(trigger!==TRIGGER_MANUAL){let eventIn=trigger===TRIGGER_HOVER?this.constructor.eventName(EVENT_MOUSEENTER):this.constructor.eventName(EVENT_FOCUSIN$1),eventOut=trigger===TRIGGER_HOVER?this.constructor.eventName(EVENT_MOUSELEAVE):this.constructor.eventName(EVENT_FOCUSOUT$1);EventHandler.on(this._element,eventIn,this._config.selector,event=>{let context=this._initializeOnDelegatedTarget(event);context._activeTrigger[event.type==="focusin"?TRIGGER_FOCUS:TRIGGER_HOVER]=!0,context._enter()}),EventHandler.on(this._element,eventOut,this._config.selector,event=>{let context=this._initializeOnDelegatedTarget(event);context._activeTrigger[event.type==="focusout"?TRIGGER_FOCUS:TRIGGER_HOVER]=context._element.contains(event.relatedTarget),context._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},EventHandler.on(this._element.closest(SELECTOR_MODAL),EVENT_MODAL_HIDE,this._hideModalHandler)}_fixTitle(){let title=this._element.getAttribute("title");title&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",title),this._element.setAttribute("data-bs-original-title",title),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(handler,timeout){clearTimeout(this._timeout),this._timeout=setTimeout(handler,timeout)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(config){let dataAttributes=Manipulator.getDataAttributes(this._element);for(let dataAttribute of Object.keys(dataAttributes))DISALLOWED_ATTRIBUTES.has(dataAttribute)&&delete dataAttributes[dataAttribute];return config={...dataAttributes,...typeof config=="object"&&config?config:{}},config=this._mergeConfigObj(config),config=this._configAfterMerge(config),this._typeCheckConfig(config),config}_configAfterMerge(config){return config.container=config.container===!1?document.body:getElement(config.container),typeof config.delay=="number"&&(config.delay={show:config.delay,hide:config.delay}),typeof config.title=="number"&&(config.title=config.title.toString()),typeof config.content=="number"&&(config.content=config.content.toString()),config}_getDelegateConfig(){let config={};for(let[key,value]of Object.entries(this._config))this.constructor.Default[key]!==value&&(config[key]=value);return config.selector=!1,config.trigger="manual",config}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(config){return this.each(function(){let data=_Tooltip.getOrCreateInstance(this,config);if(typeof config=="string"){if(typeof data[config]>"u")throw new TypeError(`No method named "${config}"`);data[config]()}})}};defineJQueryPlugin(Tooltip);var NAME$3="popover",SELECTOR_TITLE=".popover-header",SELECTOR_CONTENT=".popover-body",Default$2={...Tooltip.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},DefaultType$2={...Tooltip.DefaultType,content:"(null|string|element|function)"},Popover=class _Popover extends Tooltip{static get Default(){return Default$2}static get DefaultType(){return DefaultType$2}static get NAME(){return NAME$3}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[SELECTOR_TITLE]:this._getTitle(),[SELECTOR_CONTENT]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(config){return this.each(function(){let data=_Popover.getOrCreateInstance(this,config);if(typeof config=="string"){if(typeof data[config]>"u")throw new TypeError(`No method named "${config}"`);data[config]()}})}};defineJQueryPlugin(Popover);var NAME$2="scrollspy",DATA_KEY$2="bs.scrollspy",EVENT_KEY$2=`.${DATA_KEY$2}`,DATA_API_KEY=".data-api",EVENT_ACTIVATE=`activate${EVENT_KEY$2}`,EVENT_CLICK=`click${EVENT_KEY$2}`,EVENT_LOAD_DATA_API$1=`load${EVENT_KEY$2}${DATA_API_KEY}`,CLASS_NAME_DROPDOWN_ITEM="dropdown-item",CLASS_NAME_ACTIVE$1="active",SELECTOR_DATA_SPY='[data-bs-spy="scroll"]',SELECTOR_TARGET_LINKS="[href]",SELECTOR_NAV_LIST_GROUP=".nav, .list-group",SELECTOR_NAV_LINKS=".nav-link",SELECTOR_NAV_ITEMS=".nav-item",SELECTOR_LIST_ITEMS=".list-group-item",SELECTOR_LINK_ITEMS=`${SELECTOR_NAV_LINKS}, ${SELECTOR_NAV_ITEMS} > ${SELECTOR_NAV_LINKS}, ${SELECTOR_LIST_ITEMS}`,SELECTOR_DROPDOWN=".dropdown",SELECTOR_DROPDOWN_TOGGLE$1=".dropdown-toggle",Default$1={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},DefaultType$1={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"},ScrollSpy=class _ScrollSpy extends BaseComponent{constructor(element,config){super(element,config),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Default$1}static get DefaultType(){return DefaultType$1}static get NAME(){return NAME$2}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(let section of this._observableSections.values())this._observer.observe(section)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(config){return config.target=getElement(config.target)||document.body,config.rootMargin=config.offset?`${config.offset}px 0px -30%`:config.rootMargin,typeof config.threshold=="string"&&(config.threshold=config.threshold.split(",").map(value=>Number.parseFloat(value))),config}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(EventHandler.off(this._config.target,EVENT_CLICK),EventHandler.on(this._config.target,EVENT_CLICK,SELECTOR_TARGET_LINKS,event=>{let observableSection=this._observableSections.get(event.target.hash);if(observableSection){event.preventDefault();let root=this._rootElement||window,height=observableSection.offsetTop-this._element.offsetTop;if(root.scrollTo){root.scrollTo({top:height,behavior:"smooth"});return}root.scrollTop=height}}))}_getNewObserver(){let options={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(entries=>this._observerCallback(entries),options)}_observerCallback(entries){let targetElement=entry=>this._targetLinks.get(`#${entry.target.id}`),activate=entry=>{this._previousScrollData.visibleEntryTop=entry.target.offsetTop,this._process(targetElement(entry))},parentScrollTop=(this._rootElement||document.documentElement).scrollTop,userScrollsDown=parentScrollTop>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=parentScrollTop;for(let entry of entries){if(!entry.isIntersecting){this._activeTarget=null,this._clearActiveClass(targetElement(entry));continue}let entryIsLowerThanPrevious=entry.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(userScrollsDown&&entryIsLowerThanPrevious){if(activate(entry),!parentScrollTop)return;continue}!userScrollsDown&&!entryIsLowerThanPrevious&&activate(entry)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;let targetLinks=SelectorEngine.find(SELECTOR_TARGET_LINKS,this._config.target);for(let anchor of targetLinks){if(!anchor.hash||isDisabled(anchor))continue;let observableSection=SelectorEngine.findOne(decodeURI(anchor.hash),this._element);isVisible(observableSection)&&(this._targetLinks.set(decodeURI(anchor.hash),anchor),this._observableSections.set(anchor.hash,observableSection))}}_process(target){this._activeTarget!==target&&(this._clearActiveClass(this._config.target),this._activeTarget=target,target.classList.add(CLASS_NAME_ACTIVE$1),this._activateParents(target),EventHandler.trigger(this._element,EVENT_ACTIVATE,{relatedTarget:target}))}_activateParents(target){if(target.classList.contains(CLASS_NAME_DROPDOWN_ITEM)){SelectorEngine.findOne(SELECTOR_DROPDOWN_TOGGLE$1,target.closest(SELECTOR_DROPDOWN)).classList.add(CLASS_NAME_ACTIVE$1);return}for(let listGroup of SelectorEngine.parents(target,SELECTOR_NAV_LIST_GROUP))for(let item of SelectorEngine.prev(listGroup,SELECTOR_LINK_ITEMS))item.classList.add(CLASS_NAME_ACTIVE$1)}_clearActiveClass(parent){parent.classList.remove(CLASS_NAME_ACTIVE$1);let activeNodes=SelectorEngine.find(`${SELECTOR_TARGET_LINKS}.${CLASS_NAME_ACTIVE$1}`,parent);for(let node of activeNodes)node.classList.remove(CLASS_NAME_ACTIVE$1)}static jQueryInterface(config){return this.each(function(){let data=_ScrollSpy.getOrCreateInstance(this,config);if(typeof config=="string"){if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config]()}})}};EventHandler.on(window,EVENT_LOAD_DATA_API$1,()=>{for(let spy of SelectorEngine.find(SELECTOR_DATA_SPY))ScrollSpy.getOrCreateInstance(spy)});defineJQueryPlugin(ScrollSpy);var NAME$1="tab",DATA_KEY$1="bs.tab",EVENT_KEY$1=`.${DATA_KEY$1}`,EVENT_HIDE$1=`hide${EVENT_KEY$1}`,EVENT_HIDDEN$1=`hidden${EVENT_KEY$1}`,EVENT_SHOW$1=`show${EVENT_KEY$1}`,EVENT_SHOWN$1=`shown${EVENT_KEY$1}`,EVENT_CLICK_DATA_API=`click${EVENT_KEY$1}`,EVENT_KEYDOWN=`keydown${EVENT_KEY$1}`,EVENT_LOAD_DATA_API=`load${EVENT_KEY$1}`,ARROW_LEFT_KEY="ArrowLeft",ARROW_RIGHT_KEY="ArrowRight",ARROW_UP_KEY="ArrowUp",ARROW_DOWN_KEY="ArrowDown",HOME_KEY="Home",END_KEY="End",CLASS_NAME_ACTIVE="active",CLASS_NAME_FADE$1="fade",CLASS_NAME_SHOW$1="show",CLASS_DROPDOWN="dropdown",SELECTOR_DROPDOWN_TOGGLE=".dropdown-toggle",SELECTOR_DROPDOWN_MENU=".dropdown-menu",NOT_SELECTOR_DROPDOWN_TOGGLE=`:not(${SELECTOR_DROPDOWN_TOGGLE})`,SELECTOR_TAB_PANEL='.list-group, .nav, [role="tablist"]',SELECTOR_OUTER=".nav-item, .list-group-item",SELECTOR_INNER=`.nav-link${NOT_SELECTOR_DROPDOWN_TOGGLE}, .list-group-item${NOT_SELECTOR_DROPDOWN_TOGGLE}, [role="tab"]${NOT_SELECTOR_DROPDOWN_TOGGLE}`,SELECTOR_DATA_TOGGLE='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',SELECTOR_INNER_ELEM=`${SELECTOR_INNER}, ${SELECTOR_DATA_TOGGLE}`,SELECTOR_DATA_TOGGLE_ACTIVE=`.${CLASS_NAME_ACTIVE}[data-bs-toggle="tab"], .${CLASS_NAME_ACTIVE}[data-bs-toggle="pill"], .${CLASS_NAME_ACTIVE}[data-bs-toggle="list"]`,Tab=class _Tab extends BaseComponent{constructor(element){super(element),this._parent=this._element.closest(SELECTOR_TAB_PANEL),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),EventHandler.on(this._element,EVENT_KEYDOWN,event=>this._keydown(event)))}static get NAME(){return NAME$1}show(){let innerElem=this._element;if(this._elemIsActive(innerElem))return;let active=this._getActiveElem(),hideEvent=active?EventHandler.trigger(active,EVENT_HIDE$1,{relatedTarget:innerElem}):null;EventHandler.trigger(innerElem,EVENT_SHOW$1,{relatedTarget:active}).defaultPrevented||hideEvent&&hideEvent.defaultPrevented||(this._deactivate(active,innerElem),this._activate(innerElem,active))}_activate(element,relatedElem){if(!element)return;element.classList.add(CLASS_NAME_ACTIVE),this._activate(SelectorEngine.getElementFromSelector(element));let complete=()=>{if(element.getAttribute("role")!=="tab"){element.classList.add(CLASS_NAME_SHOW$1);return}element.removeAttribute("tabindex"),element.setAttribute("aria-selected",!0),this._toggleDropDown(element,!0),EventHandler.trigger(element,EVENT_SHOWN$1,{relatedTarget:relatedElem})};this._queueCallback(complete,element,element.classList.contains(CLASS_NAME_FADE$1))}_deactivate(element,relatedElem){if(!element)return;element.classList.remove(CLASS_NAME_ACTIVE),element.blur(),this._deactivate(SelectorEngine.getElementFromSelector(element));let complete=()=>{if(element.getAttribute("role")!=="tab"){element.classList.remove(CLASS_NAME_SHOW$1);return}element.setAttribute("aria-selected",!1),element.setAttribute("tabindex","-1"),this._toggleDropDown(element,!1),EventHandler.trigger(element,EVENT_HIDDEN$1,{relatedTarget:relatedElem})};this._queueCallback(complete,element,element.classList.contains(CLASS_NAME_FADE$1))}_keydown(event){if(![ARROW_LEFT_KEY,ARROW_RIGHT_KEY,ARROW_UP_KEY,ARROW_DOWN_KEY,HOME_KEY,END_KEY].includes(event.key))return;event.stopPropagation(),event.preventDefault();let children=this._getChildren().filter(element=>!isDisabled(element)),nextActiveElement;if([HOME_KEY,END_KEY].includes(event.key))nextActiveElement=children[event.key===HOME_KEY?0:children.length-1];else{let isNext=[ARROW_RIGHT_KEY,ARROW_DOWN_KEY].includes(event.key);nextActiveElement=getNextActiveElement(children,event.target,isNext,!0)}nextActiveElement&&(nextActiveElement.focus({preventScroll:!0}),_Tab.getOrCreateInstance(nextActiveElement).show())}_getChildren(){return SelectorEngine.find(SELECTOR_INNER_ELEM,this._parent)}_getActiveElem(){return this._getChildren().find(child=>this._elemIsActive(child))||null}_setInitialAttributes(parent,children){this._setAttributeIfNotExists(parent,"role","tablist");for(let child of children)this._setInitialAttributesOnChild(child)}_setInitialAttributesOnChild(child){child=this._getInnerElement(child);let isActive=this._elemIsActive(child),outerElem=this._getOuterElement(child);child.setAttribute("aria-selected",isActive),outerElem!==child&&this._setAttributeIfNotExists(outerElem,"role","presentation"),isActive||child.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(child,"role","tab"),this._setInitialAttributesOnTargetPanel(child)}_setInitialAttributesOnTargetPanel(child){let target=SelectorEngine.getElementFromSelector(child);target&&(this._setAttributeIfNotExists(target,"role","tabpanel"),child.id&&this._setAttributeIfNotExists(target,"aria-labelledby",`${child.id}`))}_toggleDropDown(element,open2){let outerElem=this._getOuterElement(element);if(!outerElem.classList.contains(CLASS_DROPDOWN))return;let toggle=(selector,className)=>{let element2=SelectorEngine.findOne(selector,outerElem);element2&&element2.classList.toggle(className,open2)};toggle(SELECTOR_DROPDOWN_TOGGLE,CLASS_NAME_ACTIVE),toggle(SELECTOR_DROPDOWN_MENU,CLASS_NAME_SHOW$1),outerElem.setAttribute("aria-expanded",open2)}_setAttributeIfNotExists(element,attribute,value){element.hasAttribute(attribute)||element.setAttribute(attribute,value)}_elemIsActive(elem){return elem.classList.contains(CLASS_NAME_ACTIVE)}_getInnerElement(elem){return elem.matches(SELECTOR_INNER_ELEM)?elem:SelectorEngine.findOne(SELECTOR_INNER_ELEM,elem)}_getOuterElement(elem){return elem.closest(SELECTOR_OUTER)||elem}static jQueryInterface(config){return this.each(function(){let data=_Tab.getOrCreateInstance(this);if(typeof config=="string"){if(data[config]===void 0||config.startsWith("_")||config==="constructor")throw new TypeError(`No method named "${config}"`);data[config]()}})}};EventHandler.on(document,EVENT_CLICK_DATA_API,SELECTOR_DATA_TOGGLE,function(event){["A","AREA"].includes(this.tagName)&&event.preventDefault(),!isDisabled(this)&&Tab.getOrCreateInstance(this).show()});EventHandler.on(window,EVENT_LOAD_DATA_API,()=>{for(let element of SelectorEngine.find(SELECTOR_DATA_TOGGLE_ACTIVE))Tab.getOrCreateInstance(element)});defineJQueryPlugin(Tab);var NAME="toast",DATA_KEY="bs.toast",EVENT_KEY=`.${DATA_KEY}`,EVENT_MOUSEOVER=`mouseover${EVENT_KEY}`,EVENT_MOUSEOUT=`mouseout${EVENT_KEY}`,EVENT_FOCUSIN=`focusin${EVENT_KEY}`,EVENT_FOCUSOUT=`focusout${EVENT_KEY}`,EVENT_HIDE=`hide${EVENT_KEY}`,EVENT_HIDDEN=`hidden${EVENT_KEY}`,EVENT_SHOW=`show${EVENT_KEY}`,EVENT_SHOWN=`shown${EVENT_KEY}`,CLASS_NAME_FADE="fade",CLASS_NAME_HIDE="hide",CLASS_NAME_SHOW="show",CLASS_NAME_SHOWING="showing",DefaultType={animation:"boolean",autohide:"boolean",delay:"number"},Default={animation:!0,autohide:!0,delay:5e3},Toast=class _Toast extends BaseComponent{constructor(element,config){super(element,config),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Default}static get DefaultType(){return DefaultType}static get NAME(){return NAME}show(){if(EventHandler.trigger(this._element,EVENT_SHOW).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(CLASS_NAME_FADE);let complete=()=>{this._element.classList.remove(CLASS_NAME_SHOWING),EventHandler.trigger(this._element,EVENT_SHOWN),this._maybeScheduleHide()};this._element.classList.remove(CLASS_NAME_HIDE),reflow(this._element),this._element.classList.add(CLASS_NAME_SHOW,CLASS_NAME_SHOWING),this._queueCallback(complete,this._element,this._config.animation)}hide(){if(!this.isShown()||EventHandler.trigger(this._element,EVENT_HIDE).defaultPrevented)return;let complete=()=>{this._element.classList.add(CLASS_NAME_HIDE),this._element.classList.remove(CLASS_NAME_SHOWING,CLASS_NAME_SHOW),EventHandler.trigger(this._element,EVENT_HIDDEN)};this._element.classList.add(CLASS_NAME_SHOWING),this._queueCallback(complete,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(CLASS_NAME_SHOW),super.dispose()}isShown(){return this._element.classList.contains(CLASS_NAME_SHOW)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(event,isInteracting){switch(event.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=isInteracting;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=isInteracting;break}}if(isInteracting){this._clearTimeout();return}let nextElement=event.relatedTarget;this._element===nextElement||this._element.contains(nextElement)||this._maybeScheduleHide()}_setListeners(){EventHandler.on(this._element,EVENT_MOUSEOVER,event=>this._onInteraction(event,!0)),EventHandler.on(this._element,EVENT_MOUSEOUT,event=>this._onInteraction(event,!1)),EventHandler.on(this._element,EVENT_FOCUSIN,event=>this._onInteraction(event,!0)),EventHandler.on(this._element,EVENT_FOCUSOUT,event=>this._onInteraction(event,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(config){return this.each(function(){let data=_Toast.getOrCreateInstance(this,config);if(typeof config=="string"){if(typeof data[config]>"u")throw new TypeError(`No method named "${config}"`);data[config](this)}})}};enableDismissTrigger(Toast);defineJQueryPlugin(Toast);var BigSyncStorage=class{storageApi_;maxItems_;constructor(storageApi){this.storageApi_=storageApi,this.maxItems_=this.storageApi_.getMaxItems()}getWorlds(defaultVals,worldKeys){return defaultVals=defaultVals||{},worldKeys=worldKeys||[],worldKeys.forEach(worldKey=>defaultVals[worldKey]=""),this.storageApi_.getP(null).then(items=>{if(hasRuntimeError())throw getRuntimeError();let vals={...defaultVals,...items},worlds=[];return worldKeys.forEach(worldKey=>{let world="";for(var i=0;i<this.maxItems_;i++){let key=`${worldKey}_${i}`;if(items[key])world+=items[key];else break}world&&worlds.push(JSON.parse(world))}),worlds.forEach(worldObj=>{vals={...vals,...worldObj}}),{...defaultVals,...vals}})}deleteWorld(worldKey){return this.getWorlds({},[worldKey]).then(vals=>Promise.all(Object.keys(vals).filter(key=>key.includes(worldKey)).map(key=>this.storageApi_.removeP(key))))}setWorld(worldKey,vals){let i=0,cache={},stringVal=JSON.stringify(vals);for(;stringVal.length>0;){let cacheKey=`${worldKey}_${i}`,segment=null,endIndex=this.storageApi_.getItemByteQuota()-cacheKey.length-2;for(;;){if(endIndex<500)return Promise.reject(new Error("BigSyncStorage: World segmentation error (< 500/key)"));segment=stringVal.substr(0,endIndex);let keyLength=16,jsonStringifiedSegment=JSON.stringify(segment);if(lengthInUtf8Bytes(jsonStringifiedSegment)>this.storageApi_.getItemByteQuota()-2-keyLength)endIndex-=500;else break}cache[cacheKey]=segment,stringVal=stringVal.substr(endIndex),i++}return this.storageApi_.setP(cache).then(()=>this.storageApi_.removeP(`${worldKey}_${i}`))}};function lengthInUtf8Bytes(str){var m=encodeURIComponent(str).match(/%[89ABab]/g);return str.length+(m?m.length:0)}function getWorlds(worldKeys,defaultVals){return new BigSyncStorage(getSyncStorageApi()).getWorlds(defaultVals,worldKeys)}function getCurrentExtensionPageUrl(){return typeof window<"u"&&"location"in window&&window.location&&window.location.href?window.location.href:null}function getExtensionUserConfig(ignorePageUrl=!1){return getWorlds(["_recipe_world"],UserConfigDefaults).then(values=>{Object.keys(values).forEach(key=>{AllConfigKeys.includes(key)||delete values[key]});let config={...values};if(DEV_PRETEND_PRO&&(config.paidPro=!0),DEV_PRETEND_CLOUD&&(config.paidCloud=!0),config.paidProOrMore=!!config.paidPro||!!config.paidCloud,!ignorePageUrl&&!config.paidProOrMore){let pageUrl=getCurrentExtensionPageUrl();pageUrl!==null&&(config.paidPro=isPageOnboardingPage(pageUrl))}return config})}function createAlertPane(message,alertLevel="warning",dismissable=!1){let pane=document.createElement("div");return pane.innerText=message,pane.className=`alert alert-${alertLevel}`,dismissable&&pane.addEventListener("click",()=>pane.remove()),pane}function bindBootstrapTooltips(){Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(tooltipTriggerEl=>new Tooltip(tooltipTriggerEl))}function initializeWithUserConfig(callback){try{document.addEventListener("DOMContentLoaded",()=>{getExtensionUserConfig(!0).then(userConfig=>callback(userConfig)).catch(err=>swallowError(err,"initializeWithUserConfig - catch"))})}catch(error){swallowError(error,"initializeWithUserConfig")}}var FavoritesManager=class{api_;userConfig_;constructor(userConfig){this.api_=new GMikeAPI,this.userConfig_=userConfig}initialize(){getExtensionActivityLogData().then(logData=>this.renderActivity_(logData)).catch(err=>this.handleError_(err)),document.querySelector(".btn-clear-activity").addEventListener("click",this.clearHistory_.bind(this))}hasLogData_(logData){return!logData||Object.keys(logData).length==0?!1:Object.values(logData).some(entry=>entry.elements&&Object.keys(entry.elements).length>0)}clearHistory_(){getLocalStorageApi().removeP(LogKey),window.location.reload()}renderNoActivityMode_(){document.querySelector(".activity-wrapper ul").innerHTML="",document.querySelector(".activity-wrapper").classList.add("no-data-recorded")}renderActivity_(logData){if(!logData||!this.hasLogData_(logData))return this.renderNoActivityMode_();let renderableLogData=Object.values(logData).filter(entry=>entry.url&&!entry.url.includes("file://")&&entry.actionCount>0&&entry.elements&&Object.values(entry.elements).length>0);if(!renderableLogData.length)return this.renderNoActivityMode_();let activityList=document.querySelector(".activity-wrapper ul");activityList.innerHTML="",renderableLogData.forEach(entry=>{activityList.appendChild(this.renderEntrySummary_(entry))})}renderPageElement_(logItem,pageEntry){let{name,starred,domainWide}=pageEntry,lastActionSummary=pageEntry.repros&&pageEntry.repros.length?`<span class="last-action-summary">${summarizeLatestRepro(pageEntry.repros)}</span>`:"",starTitle=starred?"Remove from favorites":"Add to favorites",starIcon=starred?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16"><path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star" viewBox="0 0 16 16"><path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"/></svg>',domainOnClassname=domainWide?"icon-on":"",domainTitle=domainWide?"Only show on this page":"Make available for entire domain",globeIcon='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-globe" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m7.5-6.923c-.67.204-1.335.82-1.887 1.855A8 8 0 0 0 5.145 4H7.5zM4.09 4a9.3 9.3 0 0 1 .64-1.539 7 7 0 0 1 .597-.933A7.03 7.03 0 0 0 2.255 4zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a7 7 0 0 0-.656 2.5zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5zM8.5 5v2.5h2.99a12.5 12.5 0 0 0-.337-2.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5zM5.145 12q.208.58.468 1.068c.552 1.035 1.218 1.65 1.887 1.855V12zm.182 2.472a7 7 0 0 1-.597-.933A9.3 9.3 0 0 1 4.09 12H2.255a7 7 0 0 0 3.072 2.472M3.82 11a13.7 13.7 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5zm6.853 3.472A7 7 0 0 0 13.745 12H11.91a9.3 9.3 0 0 1-.64 1.539 7 7 0 0 1-.597.933M8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855q.26-.487.468-1.068zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.7 13.7 0 0 1-.312 2.5m2.802-3.5a7 7 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7 7 0 0 0-3.072-2.472c.218.284.418.598.597.933M10.855 4a8 8 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4z"/></svg>',pageElement=document.createElement("div");pageElement.classList.add("page-element"),pageElement.innerHTML=`
      <div class="header">
        <div class="left-side">
          <span title="${starTitle}" class="icon-toggle-btn fave-toggle-btn">${starIcon}</span>
          <span title="${domainTitle}" class="icon-toggle-btn domain-toggle-btn ${domainOnClassname}">${globeIcon}</span>
          <span class="page-element-name">${name}</span>
          ${lastActionSummary}
        </div>
        <div class="actions">
          <button class="btn btn-outline-primary btn-image cloud-btn" title="Table Capture + Cloud">
            <img src="/src/assets/icon.cloud.128.png" />
          </button>
          <button class="btn btn-primary fetch-btn">Get data</button>
          <button class="btn btn-danger delete-entry-btn">Delete</button>
        </div>
      </div>
    `,pageElement.querySelector(".fetch-btn").addEventListener("click",()=>{this.fetchData_(logItem,pageEntry)}),pageElement.querySelector(".delete-entry-btn").addEventListener("click",()=>{this.deleteEntry_(logItem,pageEntry)}),pageElement.querySelector(".fave-toggle-btn").addEventListener("click",()=>{this.toggleFave_(logItem,pageEntry)}),pageElement.querySelector(".domain-toggle-btn").addEventListener("click",()=>{this.toggleDomainWide_(logItem,pageEntry)});let cloudButton=pageElement.querySelector(".cloud-btn");return SUPPORTS_CLOUD?cloudButton.addEventListener("click",()=>{this.cloudOperate_(logItem,pageEntry)}):cloudButton.classList.add("hidden"),pageEntry.element=pageElement,pageElement}renderEntrySummary_(logItem){let titleElement=document.createElement("div");titleElement.classList.add("title"),titleElement.innerText=logItem.title??logItem.url??"";let viewCount=document.createElement("span");viewCount.innerText=`Actions: ${logItem.actionCount}`;let link=document.createElement("a");link.href=logItem.url??"",link.innerText=i8n("visitPage"),link.target="_blank";let meta=document.createElement("div");meta.appendChild(link),meta.appendChild(createSeparator()),meta.appendChild(viewCount);let alertsElement=document.createElement("div");alertsElement.className="error-wrapper local-error-wrapper";let pageElementsWrapper=document.createElement("div");pageElementsWrapper.classList.add("page-elements"),Object.values(logItem.elements).sort((a,b)=>b.actionCount-a.actionCount).forEach(pageElementEntry=>{pageElementsWrapper.appendChild(this.renderPageElement_(logItem,pageElementEntry))});let element=document.createElement("li");return element.appendChild(titleElement),element.appendChild(meta),element.appendChild(pageElementsWrapper),element.appendChild(alertsElement),element}deleteEntry_(logItem,pageEntry){getExtensionActivityLogData().then(logData=>{if(!logData)throw new Error("No log data found");return delete logData[logItem.url].elements[pageEntry.key],getLocalStorageApi().setP({[LogKey]:logData}).then(()=>this.renderActivity_(logData))}).catch(err=>this.handleErrorForPageEntry_(pageEntry,err))}toggleDomainWide_(logItem,pageEntry){getExtensionActivityLogData().then(logData=>{if(!logData)throw new Error("No log data found");let entry=logData[logItem.url].elements[pageEntry.key];return entry.domainWide=!entry.domainWide,entry.domain||(entry.domain=getDomainFromUrl(logItem.url)??void 0),getLocalStorageApi().setP({[LogKey]:logData}).then(()=>this.renderActivity_(logData))}).catch(err=>this.handleErrorForPageEntry_(pageEntry,err))}toggleFave_(logItem,pageEntry){getExtensionActivityLogData().then(logData=>{if(!logData)throw new Error("No log data found");let entry=logData[logItem.url].elements[pageEntry.key];return entry.starred=!entry.starred,getLocalStorageApi().setP({[LogKey]:logData}).then(()=>this.renderActivity_(logData))}).catch(err=>this.handleErrorForPageEntry_(pageEntry,err))}cloudOperate_(logItem,pageEntry){let{repros}=pageEntry;return!repros||repros.length===0?this.handleErrorForPageEntry_(pageEntry,new Error("Unable to save item to Table Capture Cloud")):this.userConfig_.googleAuthToken&&this.userConfig_.paidCloud?this.saveTableForCloud_(logItem,pageEntry).catch(err=>this.handleErrorForPageEntry_(pageEntry,err)):sendRuntimeMessage({action:"CLOUD_CTA_FOR_REPRO",repro:repros[repros.length-1]}).catch(err=>{this.handleErrorForPageEntry_(pageEntry,err)})}saveTableForCloud_(logItem,pageEntry){let token=this.userConfig_.googleAuthToken,captureDefinition={id:null};return this.api_.saveCloudCaptureDefinition(token,captureDefinition).then(cloudEntry=>{window.open(cloudEntry.url,"_blank")})}fetchData_(logItem,pageEntry){if(pageEntry.paged)return this.handleErrorForPageEntry_(pageEntry,new Error("Multi-page tables cannot be extracted at this time."));let button=pageEntry.element.querySelector(".fetch-btn");button.disabled=!0,fetch(logItem.url).then(response=>{if(response.status>=400&&response.status<600)throw new Error(`Unable to fetch data: ${logItem.url}`);return response.text()}).then(data=>this.extractTableFromRequestData(data,pageEntry)).then(tableNode=>{let tableWrapper=new TableWrapper(tableNode,logItem.url,"",this.userConfig_);pageEntry.tableWrapper=tableWrapper;let params={action:"EDIT_TABLE",publicTable:{title:logItem.title,pageTitle:logItem.title,sourceUrl:logItem.url,pages:0,dynamic:!1,paged:!1,tableDef:tableWrapper.toJSON(),tableDataArray:tableWrapper.getAsArrays()}};return sendRuntimeMessage(params)}).catch(err=>this.handleErrorForPageEntry_(pageEntry,err)).finally(()=>{button.disabled=!1})}getErrorWrapperFromPageElement_(pageElement){return pageElement?pageElement.parentElement.parentElement.querySelector(".error-wrapper"):null}extractTableFromRequestData(htmlContent,{index,pathTo}){let doc=new DOMParser().parseFromString(htmlContent,"text/html");if(pathTo)return this.extractTableFromDocViaPath_(doc,pathTo);if(index!==void 0)return this.extractTableFromDocViaIndex_(doc,index);throw new Error("Unable to fetch data: Unable to locate element in response.")}extractTableFromDocViaIndex_(doc,index){let table=doc.querySelector("body").querySelectorAll("table")[index];if(!table)throw new Error("Unable to fetch data: Unable to locate table in response.");return Promise.resolve(table)}extractTableFromDocViaPath_(doc,pathTo){let element=_tcGetElementByXpath(pathTo,doc);if(!element)throw new Error("Unable to fetch data: Unable to locate table in response.");return Promise.resolve(element)}handleErrorForPageEntry_(pageEntry,err){let errorWrapper=this.getErrorWrapperFromPageElement_(pageEntry.element);return this.handleError_(err,errorWrapper)}handleError_(err,errorWrapper=null){console.log("FavoritesManager - error caught during fetchData_",err),errorWrapper=errorWrapper??document.querySelector(".global-errors"),errorWrapper.appendChild(createAlertPane(err+"","danger",!0))}};var OptionsChrome=class{constructor(activeElement=null){this.updateFooterLinks_(),this.updateOtherLinks_(),activeElement&&window.setTimeout(()=>{document.querySelector(`header li#${activeElement}`).classList.add("active")},500),DEV_DEBUG&&document.querySelector(".nav li#debug").classList.remove("hidden"),bindBootstrapTooltips()}updateOtherLinks_(){Array.from(document.querySelectorAll(".link-recipes-doc")).forEach(link=>link.href=RecipesDocUrl)}updateFooterLinks_(){Array.from(document.querySelectorAll(".link-review")).forEach(link=>link.href=ReviewLink),Array.from(document.querySelectorAll(".link-email")).forEach(link=>link.href=SupportMailTo),Array.from(document.querySelectorAll(".link-discord")).forEach(link=>link.href=DiscordInvite),Array.from(document.querySelectorAll(".link-newsletter")).forEach(link=>link.href=NewsletterUrl),Array.from(document.querySelectorAll(".link-roadmap")).forEach(link=>link.href=RoadmapUrl),Array.from(document.querySelectorAll(".text-tc-version")).forEach(link=>link.innerText=`${CurrentVersion} - ${ReleaseName}`)}};initializeWithUserConfig(userConfig=>{new OptionsChrome("activity"),new FavoritesManager(userConfig).initialize()});})();
/*! Bundled license information:

html2canvas/dist/html2canvas.js:
  (*!
   * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
   * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
   * Released under MIT License
   *)
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

xlsx/xlsx.mjs:
  (*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com *)

xlsx/xlsx.mjs:
  (*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com *)

bootstrap/dist/js/bootstrap.esm.js:
  (*!
    * Bootstrap v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)
*/
