var background=function(e){"use strict";function t(){let e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}function n(){return crypto.randomUUID()}function r(){const e=new Uint32Array(28);return crypto.getRandomValues(e),Array.from(e,(e=>("0"+e.toString(16)).slice(-2))).join("")}function o(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(e){return null}}const s=[{langCode:"AR",langCodeForSpeech:"ar-AR",langCodeForIta:"ar"},{langCode:"BG",langCodeForSpeech:"bg-BG",langCodeForIta:"bg"},{langCode:"CS",langCodeForSpeech:"cs-CZ",langCodeForIta:"cs"},{langCode:"DA",langCodeForSpeech:"da-DK",langCodeForIta:"da"},{langCode:"DE",langCodeForSpeech:"de-DE",supportsFormality:!0,langCodeForIta:"de"},{langCode:"EL",langCodeForSpeech:"el-GR",langCodeForIta:"el"},{langCode:"EN-GB",langCodeForSpeech:"en",voice:"Google UK English Male",langCodeForIta:"en-GB"},{langCode:"EN-US",langCodeForSpeech:"en",voice:"Google UK English Male",langCodeForIta:"en-US"},{langCode:"ES",langCodeForSpeech:"es-ES",voice:"Google espa√±ol",label:"ES",supportsFormality:!0,langCodeForIta:"es"},{langCode:"ET",langCodeForSpeech:"et",langCodeForIta:"et"},{langCode:"FI",langCodeForSpeech:"fi-FI",voice:"Satu",langCodeForIta:"fi"},{langCode:"FR",langCodeForSpeech:"fr-FR",voice:"Thomas",supportsFormality:!0,langCodeForIta:"fr"},{langCode:"HU",langCodeForSpeech:"hu-HU",langCodeForIta:"hu"},{langCode:"ID",langCodeForSpeech:"id-ID",langCodeForIta:"id"},{langCode:"IT",langCodeForSpeech:"it-IT",supportsFormality:!0,langCodeForIta:"it"},{langCode:"JA",langCodeForSpeech:"ja-JP",supportsFormality:!0,langCodeForIta:"ja"},{langCode:"KO",langCodeForSpeech:"ko-KR",langCodeForIta:"ko"},{langCode:"LT",langCodeForSpeech:"lt",langCodeForIta:"lt"},{langCode:"LV",langCodeForSpeech:"lv",langCodeForIta:"lv"},{langCode:"NB",langCodeForSpeech:"nb-NO",langCodeForIta:"nb"},{langCode:"NL",langCodeForSpeech:"nl-NL",voice:"Google Nederlands",label:"NL",supportsFormality:!0,langCodeForIta:"nl"},{langCode:"PL",langCodeForSpeech:"pl-PL",supportsFormality:!0,langCodeForIta:"pl"},{langCode:"PT-BR",langCodeForSpeech:"pt-PT",supportsFormality:!0,langCodeForIta:"pt-BR"},{langCode:"PT-PT",langCodeForSpeech:"pt-PT",supportsFormality:!0,langCodeForIta:"pt-PT"},{langCode:"RO",langCodeForSpeech:"ro-RO",langCodeForIta:"ro"},{langCode:"RU",langCodeForSpeech:"ru-RU",supportsFormality:!0,langCodeForIta:"ru"},{langCode:"SK",langCodeForSpeech:"sk-SK",langCodeForIta:"sk"},{langCode:"SL",langCodeForSpeech:"sl",langCodeForIta:"sl"},{langCode:"SV",langCodeForSpeech:"sv-SE",langCodeForIta:"sv"},{langCode:"TR",langCodeForSpeech:"tr-TR",langCodeForIta:"tr"},{langCode:"UK",langCodeForSpeech:"uk-UA",langCodeForIta:"uk"},{langCode:"ZH",langCodeForSpeech:"zh-CN",langCodeForIta:"zh-Hans"},{langCode:"ZH-HANT",langCodeForSpeech:"zh-HANT",langCodeForIta:"zh-Hant"}],a=["EN-GB","EN-US","EN","DE","FR","ES","PT-PT","PT-BR","PT","IT"],i=["ES","FR","IT","PT","PT-BR","PT-PT"],c=0,l={inline:"inline",automatic:"automatic",manual:"manual",input:"input",input_alternatives:"input_alternatives"},u={notLoggedIn:1,loggedInPro:2,loggedInFree:3},d={notLoggedIn:1500,loggedInFree:5e3},p={notLoggedIn:2e3,loggedInFree:2e3},h={defaultPopup:1,fptInjectedPopup:2,inlineTooltipPopup:3,itaReviewPopup:4},f={extensionIcon:1,fptAutoInject:2},g={defaultPopup:1,injectedFptPopup:2,inlinePopup:3},m={hintKeyboardShortcut:"HINT_KEYBOARD_SHORTCUT",inputTranslation:"INPUT_TRANSLATION",inlineTranslation:"INLINE_TRANSLATION",fullPageTranslation:"FULL_PAGE_TRANSLATION",accountSuccessfullyCreated:"ACCOUNT_SUCCESSFULLY_CREATED",successfullyLoggedIn:"SUCCESSFULLY_LOGGED_IN",glidesPreventAssetLoss:"GSLIDES_WARNING_TO_AVOID_ASSET_LOSS",showAdsForMSAddins:"SHOW_ADS_FOR_MS_ADDINS"},_={inlineTranslationTriggerIcon:"INLINE_TRANSLATION_TRIGGER_ICON",inlineTranslationSettingsIcon:"INLINE_TRANSLATION_SETTINGS_ICON",inlineTranslationSettingPopup:"INLINE_TRANSLATION_SETTING_POPUP",inputTranslationTriggerIcon:"INPUT_TRANSLATION_TRIGGER_ICON",inputImproveTriggerIcon:"INPUT_IMPROVE_TRIGGER_ICON",inputTranslationSettingsIcon:"INPUT_TRANSLATION_SETTINGS_ICON",inputTranslationSettingPopup:"INPUT_TRANSLATION_SETTING_POPUP",settingsPageFPT:"SETTINGS_PAGE_FPT",settingsPageReading:"SETTINGS_PAGE_READING",settingsPageWriting:"SETTINGS_PAGE_WRITING",settingsPageIntegrations:"SETTINGS_PAGE_INTEGRATIONS",fptHideModal:"FPT_HIDE_MODAL",inputTranslationReadMoreLink:"INPUT_TRANSLATION_READ_MORE_LINK",inlineTranslationReadMoreLink:"INLINE_TRANSLATION_READ_MORE_LINK",fptTranslationReadMoreLink:"FPT_TRANSLATION_READ_MORE_LINK",extensionHubToggleSwitch:"EXTENSION_HUB_TOGGLE_SWITCH",hubCustomizeShortcut:"HUB_CUSTOMIZE_SHORTCUT",hubLoginButton:"HUB_LOGIN_BUTTON",hubUpgradeToProLink:"HUB_UPGRADE_TO_PRO_LINK",hubTryProLink:"HUB_TRY_PRO_LINK",hubTryWriteProLink:"HUB_TRY_WRITE_PRO_LINK",settingsPageCustomizeShortcutButton:"SETTINGS_PAGE_CUSTOMIZE_SHORTCUT_BUTTON",hubFPTEnableCheckbox:"HUB_FPT_ENABLE_CHECKBOX",hubFPTDisableCheckbox:"HUB_FPT_DISABLE_CHECKBOX",deeplWriteIcon:"DEEPL_WRITE_ICON",gmailOnboardingPopup:"gmailOnboardingPopup",gmailOnboardingIcon:"gmailOnboardingIcon",gmailCharLimitLogin:"gmailCharLimitLogin",gmailFeedbackSurvey:"gmailFeedbackSurvey",hubViewIntegrations:"HUB_VIEW_INTEGRATIONS",hubCloseCustomizationsWidget:"HUB_CLOSE_CUSTOMIZATIONS_WIDGET",gslidesFeedbackSurvey:"GSLIDES_FEEDBACK_SURVEY",gslidesCharLimitLogin:"GSLIDES_CHAR_LIMIT_LOGIN",zendeskTryProLink:"ZENDESK_TRY_PRO_LINK",onboardingSignUp:"ONBOARDING_SIGN_UP",onboardingSkipSignUp:"ONBOARDING_SKIP_SIGN_UP",onboardingLoginLink:"ONBOARDING_LOGIN_LINK",onboardingSeeAllIntegrations:"ONBOARDING_SEE_ALL_INTEGRATIONS",iconToggleInHubTranslator:"ICON_TOGGLE_IN_HUB_TRANSLATOR",iconToggleInHubWrite:"ICON_TOGGLE_IN_HUB_WRITE",manageIconSettings:"MANAGE_ICON_SETTINGS",writeLanguageSwitchedInHub:"WRITE_LANGUAGE_SWITCHED_IN_HUB",writeLanguageSwitchedInSettings:"WRITE_LANGUAGE_SWITCHED_IN_SETTINGS"},y={triggerTranslation:"trigger-translation",changeLanguage:"change-language"},v={clickOnShortcutNotifiction:"CLICK_ON_SHORTCUT_NOTIFICATION",clickOnInlineTranslationShowAlternatives:"CLICK_ON_INLINE_TRANSLATION_SHOW_ALTERNATIVES",clickOnInlineTranslationCloseIcon:"CLICK_ON_INLINE_TRANSLATION_CLOSE_ICON",clickOnLogoutMenuEntry:"CLICK_ON_LOGOUT_MENU_ENTRY",clickOnReviewWindowCloseAction:"CLICK_ON_REVIEW_WINDOW_CLOSE_ACTION"},T={disablePerSite:"DISABLE_PER_SITE",disableEverywhere:"DISABLE_EVERYWHERE",enableEverywhere:"ENABLE_EVERYWHERE",enablePerSite:"ENABLE_PER_SITE"},S={inputTranslation:"INPUT_TRANSLATION",inlineTranslation:"INLINE_TRANSLATION",fullPageTranslation:"FULL_PAGE_TRANSLATION",gdocs:"GDOCS"},b={top:1,right:2,bottom:3,left:4},E={openPage:"OPEN_PAGE",backButton:"BACK_BUTTON",nextButton:"NEXT_BUTTON",navigation:"NAVIGATION"},w={unspecified:0,chrome:1,edge:2,local:3,firefox:4},A={chrome:"cofdbpoegempjloogbagkncekinflcnj",edge:"fancfknaplihpclbhbpclnmmjcjanbaf",local:"ocpdpnakdghopjcifldjidbdmfobmmoi",firefox:"firefox-extension@deepl.com"},I={deepl:1,linguee:2,google_translate:3,word_365:4,power_point_365:5,jira:6,confluence:7,gmail:8},R=5,k={default:"DEFAULT",gdocs:"GDOCS",zendesk:"ZENDESK",whatsappWeb:"WHATSAPP_WEB",twitter:"TWITTER",gmail:"GMAIL",gslides:"GSLIDES",linkedIn:"LINKEDIN",youtube:"YOUTUBE"},C={source:"source",target:"target"},O={translate:"translate",write:"write"},x={user:"USER",extension:"EXTENSION"},L={OPEN_TICKET:"OPEN_TICKET",DETECT_TICKET_LANGUAGE:"DETECT_TICKET_LANGUAGE",SWITCH_TICKET_LANGUAGE:"SWITCH_TICKET_LANGUAGE",ENABLE_AUTOTRANSLATE:"ENABLE_AUTOTRANSLATE",DISABLE_AUTOTRANSLATE:"DISABLE_AUTOTRANSLATE",TRANSLATE_MESSAGE:"TRANSLATE_MESSAGE",TRANSLATE_INPUT:"TRANSLATE_INPUT",ERROR:"ERROR"},N={translation:"TRANSLATION",login:"LOGIN"},P={chat:"CHAT",message:"MESSAGE"},D={TRANSLATOR:"TRANSLATOR",WRITE:"WRITE",API:"API",DOC_TRANSLATOR:"DOC_TRANSLATOR"},M={free:"free",pro:"pro",none:"none"},U={TEXT_REFINEMENT_REQUEST:"TEXT_REFINEMENT_REQUEST",GDOCS_INSERT_COPY:"GDOCS_INSERT_COPY",GDOCS_DISCARD_COPY:"GDOCS_DISCARD_COPY",GDOCS_CHAR_LIMIT_REACHED:"GDOCS_CHAR_LIMIT_REACHED",RESULT_ACCEPTED:"RESULT_ACCEPTED",RESULT_REVERTED:"RESULT_REVERTED",GET_ALTERNATIVES_FOR_INPUT:"GET_ALTERNATIVES_FOR_INPUT",ERROR:"ERROR"},$={RESULT_ACCEPTED:"RESULT_ACCEPTED",RESULT_REVERTED:"RESULT_REVERTED",ERROR:"ERROR"},F={ALTERNATIVES_OPENED:"ALTERNATIVES_OPENED",SEGMENTATION_SELECTED:"SEGMENTATION_SELECTED",ALTERNATIVE_SELECTED:"ALTERNATIVE_SELECTED"},G={READING_VIEW_TRANSLATE:"READING_VIEW_TRANSLATE",COMPOSE_VIEW_TRANSLATE:"COMPOSE_VIEW_TRANSLATE",COMPOSE_VIEW_IMPROVE:"COMPOSE_VIEW_IMPROVE"},j={ANONYMOUS_USER_LIMIT_EXCEEDED:"ANONYMOUS_USER_LIMIT_EXCEEDED",FREE_ACCOUNT_LIMIT_EXCEEDED:"FREE_ACCOUNT_LIMIT_EXCEEDED",WRITE_ANONYMOUS_USER_LIMIT_EXCEEDED:"WRITE_ANONYMOUS_USER_LIMIT_EXCEEDED",WRITE_FREE_ACCOUNT_LIMIT_EXCEEDED:"WRITE_FREE_ACCOUNT_LIMIT_EXCEEDED"},V={PRO_TRIAL:"PRO_TRIAL",LOGIN:"LOGIN",SIGNUP:"SIGNUP"},W={WORD:"word",SENTENCE:"sentence"},q={none:"None",pro:"Pro",free:"Free"},B={simple:"simple",business:"business",academic:"academic",casual:"casual",enthusiastic:"enthusiastic",friendly:"friendly",confident:"confident",diplomatic:"diplomatic"},H={auto:"auto",formal:"formal",informal:"informal",undefined:"undefined"},J={chrome:"Chrome",edge:"Edge",brave:"Brave",firefox:"Firefox",opera:"Opera",safari:"Safari"};function z(e,t){let n;try{switch(e){case J.chrome:case J.brave:n=t.split("Chrome/")[1].split(" ")[0];break;case J.edge:n=t.split("Edg/")[1].split(" ")[0];break;case J.firefox:n=t.split("Firefox/")[1].split(" ")[0];break;case J.opera:n=t.split("OPR/")[1].split(" ")[0];break;case J.safari:n=t.split("Version/")[1].split(" ")[0]}}catch(t){console.error(`Could not get the browsers (${e}) version from user agent`,t)}try{!n&&navigator?.userAgentData&&function(e){return e===J.chrome||e===J.edge||e===J.brave||e===J.opera}(e)&&(n=Y(e).version)}catch(t){console.error(`Could not get the chromium browsers (${e}) version`,t)}return n&&"string"==typeof n?n:"unknown_browser_version"}function Y(e){if(!navigator.userAgentData||!e)return;const t=new RegExp(`${e}`,"i");return navigator.userAgentData.brands.filter((e=>t.test(e.brand)))[0]}function X(){const e=navigator?.userAgent||"unknown_user_agent",t=navigator?.userAgentData?.platform||navigator?.platform||"unknown_platform";let n="unknown_browser",r="unknown_browser_version";const o=navigator?.language||"unknown_browser_language";try{const t=e.match(/chrome|chromium|crios/i),o=e.match(/edg/i)||Y(J.edge),s=e.match(/firefox|fxios/i),a=e.match(/opr\//i)||Y(J.opera),i=e.match(/safari/i),c=Y(J.brave);t?(n=J.chrome,o&&(n=J.edge),a&&(n=J.opera),c&&(n=J.brave)):o?n=J.edge:s?n=J.firefox:a?n=J.opera:i&&(n=J.safari),r=z(n,e)}catch(e){console.error("Could not get the name of the brower",e)}return{userAgent:e,platform:t,browser:n,browserVersion:r,browserLang:o}}function K(){if({IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.30.0",interactiveTextApiFree:"https://ita-free.www.deepl.com/v1",interactiveTextApiPro:"https://ita-pro.www.deepl.com/v1",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplDomain:"https://www.deepl.com",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.30.0",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!0}}.browserBuild)return{IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.30.0",interactiveTextApiFree:"https://ita-free.www.deepl.com/v1",interactiveTextApiPro:"https://ita-pro.www.deepl.com/v1",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplDomain:"https://www.deepl.com",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.30.0",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!0}}.browserBuild.toLowerCase()===J.firefox.toLowerCase();const e=chrome.runtime.getURL("");return X().browser===J.firefox||/moz-extension:\/\//gm.test(e)}const Q={share_feedback_survey:"DOCS_GOOGLE_COM_FEEDBACK_FORM",new_share_feedback_survey:"NEW_FEEDBACK_FORM",try_DeepL_Pro:"DEEPL_COM_PRO",try_DeepL_Pro_Write:"DEEPL_COM_PRO_WRITE",show_more_translation:"DEEPL_COM_TRANSLATOR",deepl_translator_home:"DEEPL_COM_HOMEPAGE",deepl_write_home:"DEEPL_COM_WRITE",deepl_terms_of_service_free:"DEEPL_COM_TERMS_OF_SERVICE_FREE",deepl_create_account:"DEEPL_CREATE_ACCOUNT",deepl_translator_docs:"DEEPL_COM_DOCTRANS",shortcut_settings:"SHORTCUT_SETTINGS",support_article:"SUPPORT_ARTICLE",chrome_write_a_review:"CHROME_WRITE_A_REVIEW",edge_write_a_review:"EDGE_WRITE_A_REVIEW",gmail_feedback_survey:"GMAIL_FEEDBACK_SURVEY",gslides_feedback_survey:"GSLIDES_FEEDBACK_SURVEY",firefox_write_a_review:"FIREFOX_WRITE_A_REVIEW",external:{whatsapp:"EXTERNAL_WHATSAPP",twitter:"EXTERNAL_TWITTER",youtube:"EXTERNAL_YOUTUBE",facebook:"EXTERNAL_FACEBOOK",github:"EXTERNAL_GITHUB",discord:"EXTERNAL_DISCORD",telegram:"EXTERNAL_TELEGRAM",reddit:"EXTERNAL_REDDIT",gmail:"EXTERNAL_GMAIL",gdocs:"EXTERNAL_GDOCS",gslides:"EXTERNAL_GSLIDES",linkedIn:"EXTERNAL_LINKEDIN",msOffice:"EXTERNAL_MS_OFFICE"},deepl_support:"DEEPL_SUPPORT",firefox_feedback_survey:"FIREFOX_FEEDBACK_SURVEY",firefox_shortcut_docs:"FIREFOX_SHORTCUT_DOCS",firefox_privacy_policy:"FIREFOX_PRIVACY_POLICY",customer_segmentation_survey_free:"CUSTOMER_SEGMENTATION_SURVEY_FREE",customer_segmentation_survey_pro:"CUSTOMER_SEGMENTATION_SURVEY_PRO",arabic_survey:"ARABIC_SURVEY",ms_office_addins_ads:"ADDINS_ADS"},Z={DOCS_GOOGLE_COM_FEEDBACK_FORM:"https://deepl.typeform.com/to/MkMfP2Y6",NEW_FEEDBACK_FORM:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",DEEPL_COM_PRO:"https://www.deepl.com/pro",DEEPL_COM_PRO_WRITE:"https://www.deepl.com/pro-write",DEEPL_COM_TRANSLATOR:"https://www.deepl.com/translator",DEEPL_COM_WRITE:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.30.0",interactiveTextApiFree:"https://ita-free.www.deepl.com/v1",interactiveTextApiPro:"https://ita-pro.www.deepl.com/v1",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplDomain:"https://www.deepl.com",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"}.deeplWrite,DEEPL_COM_DOCTRANS:"https://www.deepl.com/translator/files",DEEPL_COM_TERMS_OF_SERVICE_FREE:"https://www.deepl.com/en/pro-license?tab=free",DEEPL_CREATE_ACCOUNT:"https://www.deepl.com/signup",SHORTCUT_SETTINGS:"chrome://extensions/shortcuts",SUPPORT_ARTICLE:"https://support.deepl.com/hc/articles/4407580229522",CHROME_WEBSTORE:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",FIREFOX_WEBSTORE:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",EDGE_WEBSTORE:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",GMAIL_FEEDBACK_SURVEY:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",GSLIDES_FEEDBACK_SURVEY:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",EXTERNAL:{WHATSAPP:"https://web.whatsapp.com",TWITTER:"https://www.twitter.com",YOUTUBE:"https://www.youtube.com",FACEBOOK:"https://www.facebook.com",GITHUB:"https://www.github.com",DISCORD:"https://www.discord.com",TELEGRAM:"https://web.telegram.org",REDDIT:"https://www.reddit.com",GMAIL:"https://www.gmail.com",GDOCS:"https://docs.google.com",GSLIDES:"https://slides.google.com",LINKEDIN:"https://www.linkedin.com/",MSOFFICE:"https://www.office.com/"},DEEPL_SUPPORT:"https://support.deepl.com/hc",FIREFOX_FEEDBACK:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",FIREFOX_SHORTCUT_DOCS:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",FIREFOX_PRIVACY_POLICY:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",CUSTOMER_SEGMENTATION_SURVEY_FREE:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",CUSTOMER_SEGMENTATION_SURVEY_PRO:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",ARABIC_SURVEY:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",MSOFFICE_ADDINS_ADS:"https://www.deepl.com/en/microsoft-365"};function ee(e){const{destination:t,...n}=e;if(void 0!==t)switch(t){case Q.share_feedback_survey:return Z.DOCS_GOOGLE_COM_FEEDBACK_FORM;case Q.new_share_feedback_survey:return Z.NEW_FEEDBACK_FORM;case Q.try_DeepL_Pro:return n?.utmContent?ne(Z.DEEPL_COM_PRO,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):Z.DEEPL_COM_PRO;case Q.try_DeepL_Pro_Write:return n?.utmContent?ne(Z.DEEPL_COM_PRO_WRITE,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):Z.DEEPL_COM_PRO_WRITE;case Q.show_more_translation:return n?function({sourceLang:e,targetLang:t,textToShare:n}){if(!e||!t||!n)return"";const r=new URL(Z.DEEPL_COM_TRANSLATOR);let o=`${e.toLowerCase()}/${t.toLowerCase()}/${encodeURIComponent(n)}`;return r.hash=o,r.href}(n):void console.error("Invalid action.");case Q.deepl_translator_home:return n?.utmContent?ne(Z.DEEPL_COM_TRANSLATOR,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):Z.DEEPL_COM_TRANSLATOR;case Q.deepl_write_home:return n?.utmContent?ne(Z.DEEPL_COM_WRITE,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):Z.DEEPL_COM_WRITE;case Q.deepl_translator_docs:return n?.utmContent?ne(Z.DEEPL_COM_DOCTRANS,[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n?.utmContent]]):Z.DEEPL_COM_DOCTRANS;case Q.deepl_terms_of_service_free:return Z.DEEPL_COM_TERMS_OF_SERVICE_FREE;case Q.shortcut_settings:return Z.SHORTCUT_SETTINGS;case Q.support_article:return Z.SUPPORT_ARTICLE;case Q.external.whatsapp:return Z.EXTERNAL.WHATSAPP;case Q.external.twitter:return Z.EXTERNAL.TWITTER;case Q.external.youtube:return Z.EXTERNAL.YOUTUBE;case Q.external.facebook:return Z.EXTERNAL.FACEBOOK;case Q.external.github:return Z.EXTERNAL.GITHUB;case Q.external.discord:return Z.EXTERNAL.DISCORD;case Q.external.telegram:return Z.EXTERNAL.TELEGRAM;case Q.external.reddit:return Z.EXTERNAL.REDDIT;case Q.external.gmail:return Z.EXTERNAL.GMAIL;case Q.external.gdocs:return Z.EXTERNAL.GDOCS;case Q.external.gslides:return Z.EXTERNAL.GSLIDES;case Q.external.linkedIn:return Z.EXTERNAL.LINKEDIN;case Q.external.msOffice:return Z.EXTERNAL.MSOFFICE;case Q.deepl_support:return Z.DEEPL_SUPPORT;case Q.chrome_write_a_review:return Z.CHROME_WEBSTORE;case Q.edge_write_a_review:return Z.EDGE_WEBSTORE;case Q.gmail_feedback_survey:return Z.GMAIL_FEEDBACK_SURVEY;case Q.gslides_feedback_survey:return Z.GSLIDES_FEEDBACK_SURVEY;case Q.firefox_write_a_review:return Z.FIREFOX_WEBSTORE;case Q.firefox_privacy_policy:return Z.FIREFOX_PRIVACY_POLICY;case Q.firefox_feedback_survey:return Z.FIREFOX_FEEDBACK;case Q.firefox_shortcut_docs:return Z.FIREFOX_SHORTCUT_DOCS;case Q.deepl_create_account:if(n){let e=[];if(n.utmContent){e=[...[["utm_source","browser_extension"],["utm_medium","chrome"],["utm_content",n.utmContent]]]}if(n.redirectToOnboarding&&!K()){const t=`${chrome.runtime.getURL("")}onboarding.html`;e.push(["redirectUri",t])}return ne(Z.DEEPL_CREATE_ACCOUNT,e)}return Z.DEEPL_CREATE_ACCOUNT;case Q.customer_segmentation_survey_free:return Z.CUSTOMER_SEGMENTATION_SURVEY_FREE;case Q.customer_segmentation_survey_pro:return Z.CUSTOMER_SEGMENTATION_SURVEY_PRO;case Q.arabic_survey:return Z.ARABIC_SURVEY;case Q.ms_office_addins_ads:return Z.MSOFFICE_ADDINS_ADS;default:return}}function te(e){const t=ee(e),{openInSameTab:n}=e;if(!t)return;const r=new URL(t).href;n?chrome.tabs.query({active:!0,currentWindow:!0},(function(e){const t=e[0];chrome.tabs.update(t.id,{url:r})})):chrome.tabs.create({url:r,active:!0})}function ne(e,t){if(0===t.length||!e)return;const n=new URL(e);return t.forEach((e=>{2===e.length&&n.searchParams.append(e[0],e[1])})),n.href}const re=Object.prototype.toString;function oe(e){switch(re.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return me(e,Error)}}function se(e,t){return re.call(e)===`[object ${t}]`}function ae(e){return se(e,"ErrorEvent")}function ie(e){return se(e,"DOMError")}function ce(e){return se(e,"String")}function le(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function ue(e){return null===e||le(e)||"object"!=typeof e&&"function"!=typeof e}function de(e){return se(e,"Object")}function pe(e){return"undefined"!=typeof Event&&me(e,Event)}function he(e){return se(e,"RegExp")}function fe(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function ge(e){return"number"==typeof e&&e!=e}function me(e,t){try{return e instanceof t}catch(e){return!1}}function _e(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}function ye(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function ve(e,t){let n=e;const r=n.length;if(r<=150)return n;t>r&&(t=r);let o=Math.max(t-60,0);o<5&&(o=0);let s=Math.min(o+140,r);return s>r-5&&(s=r),s===r&&(o=Math.max(s-140,0)),n=n.slice(o,s),o>0&&(n=`'{snip} ${n}`),s<r&&(n+=" {snip}"),n}function Te(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{_e(r)?n.push("[VueViewModel]"):n.push(String(r))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function Se(e,t=[],n=!1){return t.some((t=>function(e,t,n=!1){return!!ce(e)&&(he(t)?t.test(e):!!ce(t)&&(n?e===t:e.includes(t)))}(e,t,n)))}function be(e,t,n=250,r,o,s,a){if(!(s.exception&&s.exception.values&&a&&me(a.originalException,Error)))return;const i=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var c,l;i&&(s.exception.values=(c=Ee(e,t,o,a.originalException,r,s.exception.values,i,0),l=n,c.map((e=>(e.value&&(e.value=ye(e.value,l)),e)))))}function Ee(e,t,n,r,o,s,a,i){if(s.length>=n+1)return s;let c=[...s];if(me(r[o],Error)){we(a,i);const s=e(t,r[o]),l=c.length;Ae(s,o,l,i),c=Ee(e,t,n,r[o],o,[s,...c],s,l)}return Array.isArray(r.errors)&&r.errors.forEach(((r,s)=>{if(me(r,Error)){we(a,i);const l=e(t,r),u=c.length;Ae(l,`errors[${s}]`,u,i),c=Ee(e,t,n,r,o,[l,...c],l,u)}})),c}function we(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function Ae(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}function Ie(e){return e&&e.Math==Math?e:void 0}const Re="object"==typeof globalThis&&Ie(globalThis)||"object"==typeof window&&Ie(window)||"object"==typeof self&&Ie(self)||"object"==typeof global&&Ie(global)||function(){return this}()||{};function ke(){return Re}function Ce(e,t,n){const r=n||Re,o=r.__SENTRY__=r.__SENTRY__||{};return o[e]||(o[e]=t())}const Oe=ke(),xe=80;function Le(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,o=[];let s=0,a=0;const i=" > ",c=i.length;let l;const u=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||xe;for(;n&&s++<r&&(l=Ne(n,u),!("html"===l||s>1&&a+o.length*c+l.length>=d));)o.push(l),a+=l.length,n=n.parentNode;return o.reverse().join(i)}catch(e){return"<unknown>"}}function Ne(e,t){const n=e,r=[];let o,s,a,i,c;if(!n||!n.tagName)return"";if(Oe.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const l=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(l&&l.length)l.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else if(n.id&&r.push(`#${n.id}`),o=n.className,o&&ce(o))for(s=o.split(/\s+/),c=0;c<s.length;c++)r.push(`.${s[c]}`);const u=["aria-label","type","name","title","alt"];for(c=0;c<u.length;c++)a=u[c],i=n.getAttribute(a),i&&r.push(`[${a}="${i}"]`);return r.join("")}function Pe(){try{return Oe.document.location.href}catch(e){return""}}function De(e){return Oe.document&&Oe.document.querySelector?Oe.document.querySelector(e):null}function Me(e){if(!Oe.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement&&t.dataset.sentryComponent)return t.dataset.sentryComponent;t=t.parentNode}return null}const Ue="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,$e=["debug","info","warn","error","log","assert","trace"],Fe={};function Ge(e){if(!("console"in Re))return e();const t=Re.console,n={},r=Object.keys(Fe);r.forEach((e=>{const r=Fe[e];n[e]=t[e],t[e]=r}));try{return e()}finally{r.forEach((e=>{t[e]=n[e]}))}}const je=function(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return Ue?$e.forEach((n=>{t[n]=(...t)=>{e&&Ge((()=>{Re.console[n](`Sentry Logger [${n}]:`,...t)}))}})):$e.forEach((e=>{t[e]=()=>{}})),t}(),Ve=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function We(e,t=!1){const{host:n,path:r,pass:o,port:s,projectId:a,protocol:i,publicKey:c}=e;return`${i}://${c}${t&&o?`:${o}`:""}@${n}${s?`:${s}`:""}/${r?`${r}/`:r}${a}`}function qe(e){const t=Ve.exec(e);if(!t)return void Ge((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,o="",s,a="",i]=t.slice(1);let c="",l=i;const u=l.split("/");if(u.length>1&&(c=u.slice(0,-1).join("/"),l=u.pop()),l){const e=l.match(/^\d+/);e&&(l=e[0])}return Be({host:s,pass:o,path:c,projectId:l,port:a,protocol:n,publicKey:r})}function Be(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function He(e){const t="string"==typeof e?qe(e):Be(e);if(t&&function(e){if(!Ue)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(je.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(je.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(je.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(je.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}class Je extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}function ze(e,t,n){if(!(t in e))return;const r=e[t],o=n(r);"function"==typeof o&&Xe(o,r),e[t]=o}function Ye(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){Ue&&je.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function Xe(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Ye(e,"__sentry_original__",t)}catch(e){}}function Ke(e){return e.__sentry_original__}function Qe(e){if(oe(e))return{message:e.message,name:e.name,stack:e.stack,...et(e)};if(pe(e)){const t={type:e.type,target:Ze(e.target),currentTarget:Ze(e.currentTarget),...et(e)};return"undefined"!=typeof CustomEvent&&me(e,CustomEvent)&&(t.detail=e.detail),t}return e}function Ze(e){try{return t=e,"undefined"!=typeof Element&&me(t,Element)?Le(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}var t}function et(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function tt(e){return nt(e,new Map)}function nt(e,t){if(function(e){if(!de(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(e)){const n=t.get(e);if(void 0!==n)return n;const r={};t.set(e,r);for(const n of Object.keys(e))void 0!==e[n]&&(r[n]=nt(e[n],t));return r}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const r=[];return t.set(e,r),e.forEach((e=>{r.push(nt(e,t))})),r}return e}const rt=50,ot=/\(error: (.*)\)/,st=/captureMessage|captureException/;function at(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0)=>{const r=[],o=e.split("\n");for(let e=n;e<o.length;e++){const n=o[e];if(n.length>1024)continue;const s=ot.test(n)?n.replace(ot,"$1"):n;if(!s.match(/\S*Error: /)){for(const e of t){const t=e(s);if(t){r.push(t);break}}if(r.length>=rt)break}}return function(e){if(!e.length)return[];const t=Array.from(e);/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop();t.reverse(),st.test(t[t.length-1].function||"")&&(t.pop(),st.test(t[t.length-1].function||"")&&t.pop());return t.slice(0,rt).map((e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"})))}(r)}}const it="<anonymous>";function ct(e){try{return e&&"function"==typeof e&&e.name||it}catch(e){return it}}const lt={},ut={};function dt(e,t){lt[e]=lt[e]||[],lt[e].push(t)}function pt(e,t){ut[e]||(t(),ut[e]=!0)}function ht(e,t){const n=e&&lt[e];if(n)for(const r of n)try{r(t)}catch(t){Ue&&je.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${ct(r)}\nError:`,t)}}function ft(e){const t="console";dt(t,e),pt(t,gt)}function gt(){"console"in Re&&$e.forEach((function(e){e in Re.console&&ze(Re.console,e,(function(t){return Fe[e]=t,function(...t){ht("console",{args:t,level:e});const n=Fe[e];n&&n.apply(Re.console,t)}}))}))}function mt(){const e=Re,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function _t(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function yt(e){const{message:t,event_id:n}=e;if(t)return t;const r=_t(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function vt(e,t,n){const r=e.exception=e.exception||{},o=r.values=r.values||[],s=o[0]=o[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function Tt(e,t){const n=_t(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r&&r.data,...t.data};n.mechanism.data=e}}function St(e){if(e&&e.__sentry_captured__)return!0;try{Ye(e,"__sentry_captured__",!0)}catch(e){}return!1}function bt(e){return Array.isArray(e)?e:[e]}const Et=Re,wt=1e3;let At,It,Rt;function kt(e){dt("dom",e),pt("dom",Ct)}function Ct(){if(!Et.document)return;const e=ht.bind(null,"dom"),t=Ot(e,!0);Et.document.addEventListener("click",t,!1),Et.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=Et[t]&&Et[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(ze(n,"addEventListener",(function(t){return function(n,r,o){if("click"===n||"keypress"==n)try{const r=this,s=r.__sentry_instrumentation_handlers__=r.__sentry_instrumentation_handlers__||{},a=s[n]=s[n]||{refCount:0};if(!a.handler){const r=Ot(e);a.handler=r,t.call(this,n,r,o)}a.refCount++}catch(e){}return t.call(this,n,r,o)}})),ze(n,"removeEventListener",(function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this,o=n.__sentry_instrumentation_handlers__||{},s=o[t];s&&(s.refCount--,s.refCount<=0&&(e.call(this,t,s.handler,r),s.handler=void 0,delete o[t]),0===Object.keys(o).length&&delete n.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,n,r)}})))}))}function Ot(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch(e){return null}}(n);if(function(e,t){return"keypress"===e&&(!t||!t.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;Ye(n,"_sentryCaptured",!0),r&&!r._sentryId&&Ye(r,"_sentryId",mt());const o="keypress"===n.type?"input":n.type;if(!function(e){if(e.type!==It)return!1;try{if(!e.target||e.target._sentryId!==Rt)return!1}catch(e){}return!0}(n)){e({event:n,name:o,global:t}),It=n.type,Rt=r?r._sentryId:void 0}clearTimeout(At),At=Et.setTimeout((()=>{Rt=void 0,It=void 0}),wt)}}const xt=ke();function Lt(){if(!("fetch"in xt))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function Nt(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function Pt(){if("string"==typeof EdgeRuntime)return!0;if(!Lt())return!1;if(Nt(xt.fetch))return!0;let e=!1;const t=xt.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=Nt(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){Ue&&je.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}function Dt(e){const t="fetch";dt(t,e),pt(t,Mt)}function Mt(){Pt()&&ze(Re,"fetch",(function(e){return function(...t){const{method:n,url:r}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:$t(t),method:Ut(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:$t(t),method:Ut(t,"method")?String(t.method).toUpperCase():"GET"}}(t),o={args:t,fetchData:{method:n,url:r},startTimestamp:Date.now()};return ht("fetch",{...o}),e.apply(Re,t).then((e=>(ht("fetch",{...o,endTimestamp:Date.now(),response:e}),e)),(e=>{throw ht("fetch",{...o,endTimestamp:Date.now(),error:e}),e}))}}))}function Ut(e,t){return!!e&&"object"==typeof e&&!!e[t]}function $t(e){return"string"==typeof e?e:e?Ut(e,"url")?e.url:e.toString?e.toString():"":""}let Ft=null;function Gt(e){const t="error";dt(t,e),pt(t,jt)}function jt(){Ft=Re.onerror,Re.onerror=function(e,t,n,r,o){return ht("error",{column:r,error:o,line:n,msg:e,url:t}),!(!Ft||Ft.__SENTRY_LOADER__)&&Ft.apply(this,arguments)},Re.onerror.__SENTRY_INSTRUMENTED__=!0}let Vt=null;function Wt(e){const t="unhandledrejection";dt(t,e),pt(t,qt)}function qt(){Vt=Re.onunhandledrejection,Re.onunhandledrejection=function(e){return ht("unhandledrejection",e),!(Vt&&!Vt.__SENTRY_LOADER__)||Vt.apply(this,arguments)},Re.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Bt=ke();const Ht=Re;let Jt;function zt(e){const t="history";dt(t,e),pt(t,Yt)}function Yt(){if(!function(){const e=Bt.chrome,t=e&&e.app&&e.app.runtime,n="history"in Bt&&!!Bt.history.pushState&&!!Bt.history.replaceState;return!t&&n}())return;const e=Ht.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=Jt,t=String(n);Jt=t;ht("history",{from:e,to:t})}return e.apply(this,t)}}Ht.onpopstate=function(...t){const n=Ht.location.href,r=Jt;Jt=n;if(ht("history",{from:r,to:n}),e)try{return e.apply(this,t)}catch(e){}},ze(Ht.history,"pushState",t),ze(Ht.history,"replaceState",t)}const Xt=Re,Kt="__sentry_xhr_v3__";function Qt(e){dt("xhr",e),pt("xhr",Zt)}function Zt(){if(!Xt.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;ze(e,"open",(function(e){return function(...t){const n=Date.now(),r=ce(t[0])?t[0].toUpperCase():void 0,o=function(e){if(ce(e))return e;try{return e.toString()}catch(e){}return}(t[1]);if(!r||!o)return e.apply(this,t);this[Kt]={method:r,url:o,request_headers:{}},"POST"===r&&o.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const s=()=>{const e=this[Kt];if(e&&4===this.readyState){try{e.status_code=this.status}catch(e){}ht("xhr",{args:[r,o],endTimestamp:Date.now(),startTimestamp:n,xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?ze(this,"onreadystatechange",(function(e){return function(...t){return s(),e.apply(this,t)}})):this.addEventListener("readystatechange",s),ze(this,"setRequestHeader",(function(e){return function(...t){const[n,r]=t,o=this[Kt];return o&&ce(n)&&ce(r)&&(o.request_headers[n.toLowerCase()]=r),e.apply(this,t)}})),e.apply(this,t)}})),ze(e,"send",(function(e){return function(...t){const n=this[Kt];if(!n)return e.apply(this,t);void 0!==t[0]&&(n.body=t[0]);return ht("xhr",{args:[n.method,n.url],startTimestamp:Date.now(),xhr:this}),e.apply(this,t)}}))}function en(){return!("undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function tn(e,t){return e.require(t)}function nn(e){let t;try{t=tn(module,e)}catch(e){}try{const{cwd:n}=tn(module,"process");t=tn(module,`${n()}/node_modules/${e}`)}catch(e){}return t}function rn(){return"undefined"!=typeof window&&(!en()||void 0!==Re.process&&"renderer"===Re.process.type)}function on(e,t=100,n=1/0){try{return an("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function sn(e,t=3,n=102400){const r=on(e,t);return o=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(o))>n?sn(e,t-1,n):r;var o}function an(e,t,n=1/0,r=1/0,o=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[s,a]=o;if(null==t||["number","boolean","string"].includes(typeof t)&&!ge(t))return t;const i=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(_e(t))return"[VueViewModel]";if(de(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${ct(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!i.startsWith("[object "))return i;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return i.replace("object ","");if(s(t))return"[Circular ~]";const l=t;if(l&&"function"==typeof l.toJSON)try{return an("",l.toJSON(),c-1,r,o)}catch(e){}const u=Array.isArray(t)?[]:{};let d=0;const p=Qe(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(d>=r){u[e]="[MaxProperties ~]";break}const t=p[e];u[e]=an(e,t,c-1,r,o),d++}return a(t),u}const cn=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function ln(...e){let t="",n=!1;for(let r=e.length-1;r>=-1&&!n;r--){const o=r>=0?e[r]:"/";o&&(t=`${o}/${t}`,n="/"===o.charAt(0))}return t=function(e,t){let n=0;for(let t=e.length-1;t>=0;t--){const r=e[t];"."===r?e.splice(t,1):".."===r?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}(t.split("/").filter((e=>!!e)),!n).join("/"),(n?"/":"")+t||"."}function un(e){let t=0;for(;t<e.length&&""===e[t];t++);let n=e.length-1;for(;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}function dn(e,t){let n=function(e){const t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=cn.exec(t);return n?n.slice(1):[]}(e)[2];return t&&n.slice(-1*t.length)===t&&(n=n.slice(0,n.length-t.length)),n}var pn;function hn(e){return new gn((t=>{t(e)}))}function fn(e){return new gn(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"}(pn||(pn={}));class gn{constructor(e){gn.prototype.__init.call(this),gn.prototype.__init2.call(this),gn.prototype.__init3.call(this),gn.prototype.__init4.call(this),this._state=pn.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new gn(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new gn(((t,n)=>{let r,o;return this.then((t=>{o=!1,r=t,e&&e()}),(t=>{o=!0,r=t,e&&e()})).then((()=>{o?n(r):t(r)}))}))}__init(){this._resolve=e=>{this._setResult(pn.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(pn.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===pn.PENDING&&(fe(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===pn.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===pn.RESOLVED&&e[1](this._value),this._state===pn.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function mn(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return fn(new Je("Not adding Promise because buffer limit was reached."));const o=r();return-1===t.indexOf(o)&&t.push(o),o.then((()=>n(o))).then(null,(()=>n(o).then(null,(()=>{})))),o},drain:function(e){return new gn(((n,r)=>{let o=t.length;if(!o)return n(!0);const s=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{hn(e).then((()=>{--o||(clearTimeout(s),n(!0))}),r)}))}))}}}function _n(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}function yn(e){return e.split(/[\?#]/,1)[0]}function vn(e){return e.split(/\\?\//).filter((e=>e.length>0&&","!==e)).length}const Tn={ip:!1,request:!0,transaction:!0,user:!0},Sn=["cookies","data","headers","method","query_string","url"],bn=["id","username","email"];function En(e,t={}){const n=e.method&&e.method.toUpperCase();let r="",o="url";t.customRoute||e.route?(r=t.customRoute||`${e.baseUrl||""}${e.route&&e.route.path}`,o="route"):(e.originalUrl||e.url)&&(r=yn(e.originalUrl||e.url||""));let s="";return t.method&&n&&(s+=n),t.method&&t.path&&(s+=" "),t.path&&r&&(s+=r),[s,o]}function wn(e,t){const{include:n=Sn,deps:r}=t||{},o={},s=e.headers||{},a=e.method,i=s.host||e.hostname||e.host||"<no host>",c="https"===e.protocol||e.socket&&e.socket.encrypted?"https":"http",l=e.originalUrl||e.url||"",u=l.startsWith(c)?l:`${c}://${i}${l}`;return n.forEach((t=>{switch(t){case"headers":o.headers=s,n.includes("cookies")||delete o.headers.cookie;break;case"method":o.method=a;break;case"url":o.url=u;break;case"cookies":o.cookies=e.cookies||s.cookie&&function(e){const t={};let n=0;for(;n<e.length;){const r=e.indexOf("=",n);if(-1===r)break;let o=e.indexOf(";",n);if(-1===o)o=e.length;else if(o<r){n=e.lastIndexOf(";",r-1)+1;continue}const s=e.slice(n,r).trim();if(void 0===t[s]){let n=e.slice(r+1,o).trim();34===n.charCodeAt(0)&&(n=n.slice(1,-1));try{t[s]=-1!==n.indexOf("%")?decodeURIComponent(n):n}catch(e){t[s]=n}}n=o+1}return t}(s.cookie)||{};break;case"query_string":o.query_string=function(e,t){let n=e.originalUrl||e.url||"";if(!n)return;n.startsWith("/")&&(n=`http://dogs.are.great${n}`);try{return e.query||"undefined"!=typeof URL&&new URL(n).search.slice(1)||t&&t.url&&t.url.parse(n).query||void 0}catch(e){return}}(e,r);break;case"data":if("GET"===a||"HEAD"===a)break;void 0!==e.body&&(o.data=ce(e.body)?e.body:JSON.stringify(on(e.body)));break;default:({}).hasOwnProperty.call(e,t)&&(o[t]=e[t])}})),o}function An(e,t,n){const r={...Tn,...n&&n.include};if(r.request){const o=Array.isArray(r.request)?wn(t,{include:r.request,deps:n&&n.deps}):wn(t,{deps:n&&n.deps});e.request={...e.request,...o}}if(r.user){const n=t.user&&de(t.user)?function(e,t){const n={};return(Array.isArray(t)?t:bn).forEach((t=>{e&&t in e&&(n[t]=e[t])})),n}(t.user,r.user):{};Object.keys(n).length&&(e.user={...e.user,...n})}if(r.ip){const n=t.ip||t.socket&&t.socket.remoteAddress;n&&(e.user={...e.user,ip_address:n})}return r.transaction&&!e.transaction&&(e.transaction=function(e,t){switch(t){case"path":return En(e,{path:!0})[0];case"handler":return e.route&&e.route.stack&&e.route.stack[0]&&e.route.stack[0].name||"<anonymous>";default:return En(e,{path:!0,method:!0,customRoute:e._reconstructedRoute?e._reconstructedRoute:void 0})[0]}}(t,r.transaction)),e}const In=["fatal","error","warning","log","info","debug"];function Rn(e){return"warn"===e?"warning":In.includes(e)?e:"log"}const kn=1e3;function Cn(){return Date.now()/kn}const On=function(){const{performance:e}=Re;if(!e||!e.now)return Cn;const t=Date.now()-e.now(),n=null==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/kn}(),xn=(()=>{const{performance:e}=Re;if(!e||!e.now)return;const t=36e5,n=e.now(),r=Date.now(),o=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,s=o<t,a=e.timing&&e.timing.navigationStart,i="number"==typeof a?Math.abs(a+n-r):t;return s||i<t?o<=i?e.timeOrigin:a:r})(),Ln="baggage",Nn="sentry-",Pn=/^sentry-/,Dn=8192;function Mn(e){if(!ce(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce(((e,t)=>{const n=$n(t);for(const t of Object.keys(n))e[t]=n[t];return e}),{});else{if(!e)return;t=$n(e)}const n=Object.entries(t).reduce(((e,[t,n])=>{if(t.match(Pn)){e[t.slice(Nn.length)]=n}return e}),{});return Object.keys(n).length>0?n:void 0}function Un(e){if(!e)return;return function(e){if(0===Object.keys(e).length)return;return Object.entries(e).reduce(((e,[t,n],r)=>{const o=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,s=0===r?o:`${e},${o}`;return s.length>Dn?(Ue&&je.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):s}),"")}(Object.entries(e).reduce(((e,[t,n])=>(n&&(e[`${Nn}${t}`]=n),e)),{}))}function $n(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(e[t]=n,e)),{})}const Fn=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Gn(e){if(!e)return;const t=e.match(Fn);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}function jn(e,t){const n=Gn(e),r=Mn(t),{traceId:o,parentSpanId:s,parentSampled:a}=n||{};return n?{traceId:o||mt(),parentSpanId:s||mt().substring(16),spanId:mt().substring(16),sampled:a,dsc:r||{}}:{traceId:o||mt(),spanId:mt().substring(16)}}function Vn(e=mt(),t=mt().substring(16),n){let r="";return void 0!==n&&(r=n?"-1":"-0"),`${e}-${t}${r}`}function Wn(e,t=[]){return[e,t]}function qn(e,t){const[n,r]=e;return[n,[...r,t]]}function Bn(e,t){const n=e[1];for(const e of n){if(t(e,e[0].type))return!0}return!1}function Hn(e,t){return(t||new TextEncoder).encode(e)}function Jn(e,t){const[n,r]=e;let o=JSON.stringify(n);function s(e){"string"==typeof o?o="string"==typeof e?o+e:[Hn(o,t),e]:o.push("string"==typeof e?Hn(e,t):e)}for(const e of r){const[t,n]=e;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(on(n))}s(e)}}return"string"==typeof o?o:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(o)}function zn(e,t){const n="string"==typeof e.data?Hn(e.data,t):e.data;return[tt({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}const Yn={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function Xn(e){return Yn[e]}function Kn(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function Qn(e,t,n,r){const o=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:We(r)},...o&&{trace:tt({...o})}}}const Zn=6e4;function er(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?Zn:r-t}function tr(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}function nr(e,{statusCode:t,headers:n},r=Date.now()){const o={...e},s=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(s)for(const e of s.trim().split(",")){const[t,n,,,s]=e.split(":",5),a=parseInt(t,10),i=1e3*(isNaN(a)?60:a);if(n)for(const e of n.split(";"))"metric_bucket"===e&&s&&!s.split(";").includes("custom")||(o[e]=r+i);else o.all=r+i}else a?o.all=r+er(a,r):429===t&&(o.all=r+6e4);return o}function rr(e,t){const n={type:t.name||t.constructor.name,value:t.message},r=function(e,t){return e(t.stack||"",1)}(e,t);return r.length&&(n.stacktrace={frames:r}),n}function or(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}const sr="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,ar="production";function ir(){return Ce("globalEventProcessors",(()=>[]))}function cr(e){ir().push(e)}function lr(e,t,n,r=0){return new gn(((o,s)=>{const a=e[r];if(null===t||"function"!=typeof a)o(t);else{const i=a({...t},n);sr&&a.id&&null===i&&je.log(`Event processor "${a.id}" dropped event`),fe(i)?i.then((t=>lr(e,t,n,r+1).then(o))).then(null,s):lr(e,i,n,r+1).then(o).then(null,s)}}))}function ur(e){const t=On(),n={sid:mt(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return tt({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(n)};return e&&dr(n,e),n}function dr(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||On(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:mt()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function pr(e,t){let n={};t?n={status:t}:"ok"===e.status&&(n={status:"exited"}),dr(e,n)}const hr=1;function fr(e){const{spanId:t,traceId:n}=e.spanContext(),{data:r,op:o,parent_span_id:s,status:a,tags:i,origin:c}=yr(e);return tt({data:r,op:o,parent_span_id:s,span_id:t,status:a,tags:i,trace_id:n,origin:c})}function gr(e){const{traceId:t,spanId:n}=e.spanContext();return Vn(t,n,vr(e))}function mr(e){return"number"==typeof e?_r(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?_r(e.getTime()):On()}function _r(e){return e>9999999999?e/1e3:e}function yr(e){return function(e){return"function"==typeof e.getSpanJSON}(e)?e.getSpanJSON():"function"==typeof e.toJSON?e.toJSON():{}}function vr(e){const{traceFlags:t}=e.spanContext();return Boolean(t&hr)}function Tr(e,t,n,r,o,s){const{normalizeDepth:a=3,normalizeMaxBreadth:i=1e3}=e,c={...t,event_id:t.event_id||n.event_id||mt(),timestamp:t.timestamp||Cn()},l=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:o,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:ar);void 0===e.release&&void 0!==r&&(e.release=r);void 0===e.dist&&void 0!==o&&(e.dist=o);e.message&&(e.message=ye(e.message,s));const a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=ye(a.value,s));const i=e.request;i&&i.url&&(i.url=ye(i.url,s))}(c,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(c,l),void 0===t.type&&function(e,t){const n=Re._sentryDebugIds;if(!n)return;let r;const o=Sr.get(t);o?r=o:(r=new Map,Sr.set(t,r));const s=Object.keys(n).reduce(((e,o)=>{let s;const a=r.get(o);a?s=a:(s=t(o),r.set(o,s));for(let t=s.length-1;t>=0;t--){const r=s[t];if(r.filename){e[r.filename]=n[o];break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=s[e.filename])}))}))}catch(e){}}(c,e.stackParser);const u=function(e,t){if(!t)return e;const n=e?e.clone():new Wr;return n.update(t),n}(r,n.captureContext);n.mechanism&&Tt(c,n.mechanism);const d=o&&o.getEventProcessors?o.getEventProcessors():[],p=function(){Vr||(Vr=new Wr);return Vr}().getScopeData();if(s){Gr(p,s.getScopeData())}if(u){Gr(p,u.getScopeData())}const h=[...n.attachments||[],...p.attachments];h.length&&(n.attachments=h),Fr(c,p);return lr([...d,...ir(),...p.eventProcessors],c,n).then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach((e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})}))}(e),"number"==typeof a&&a>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:on(e.data,t,n)}})))},...e.user&&{user:on(e.user,t,n)},...e.contexts&&{contexts:on(e.contexts,t,n)},...e.extra&&{extra:on(e.extra,t,n)}};e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=on(e.contexts.trace.data,t,n)));e.spans&&(r.spans=e.spans.map((e=>{const r=yr(e).data;return r&&(e.data=on(r,t,n)),e})));return r}(e,a,i):e)))}const Sr=new WeakMap;function br(e){if(e)return function(e){return e instanceof Wr||"function"==typeof e}(e)||function(e){return Object.keys(e).some((e=>Er.includes(e)))}(e)?{captureContext:e}:e}const Er=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function wr(e,t){return Kr().captureException(e,br(t))}function Ar(e,t){const n="string"==typeof t?t:void 0,r="string"!=typeof t?{captureContext:t}:void 0;return Kr().captureMessage(e,n,r)}function Ir(e,t){return Kr().captureEvent(e,t)}function Rr(e,t){Kr().addBreadcrumb(e,t)}function kr(e,t){Kr().setContext(e,t)}function Cr(...e){const t=Kr();if(2===e.length){const[n,r]=e;return n?t.withScope((()=>(t.getStackTop().scope=n,r(n)))):t.withScope(r)}return t.withScope(e[0])}function Or(){return Kr().getClient()}function xr(){return Kr().getScope()}function Lr(e){const t=Or(),n=Qr(),r=xr(),{release:o,environment:s=ar}=t&&t.getOptions()||{},{userAgent:a}=Re.navigator||{},i=ur({release:o,environment:s,user:r.getUser()||n.getUser(),...a&&{userAgent:a},...e}),c=n.getSession();return c&&"ok"===c.status&&dr(c,{status:"exited"}),Nr(),n.setSession(i),r.setSession(i),i}function Nr(){const e=Qr(),t=xr(),n=t.getSession()||e.getSession();n&&pr(n),Pr(),e.setSession(),t.setSession()}function Pr(){const e=Qr(),t=xr(),n=Or(),r=t.getSession()||e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}function Dr(e=!1){e?Nr():Pr()}function Mr(e){return e.transaction}function Ur(e,t,n){const r=t.getOptions(),{publicKey:o}=t.getDsn()||{},{segment:s}=n&&n.getUser()||{},a=tt({environment:r.environment||ar,release:r.release,user_segment:s,public_key:o,trace_id:e});return t.emit&&t.emit("createDsc",a),a}function $r(e){const t=Or();if(!t)return{};const n=Ur(yr(e).trace_id||"",t,xr()),r=Mr(e);if(!r)return n;const o=r&&r._frozenDynamicSamplingContext;if(o)return o;const{sampleRate:s,source:a}=r.metadata;null!=s&&(n.sample_rate=`${s}`);const i=yr(r);return a&&"url"!==a&&(n.transaction=i.description),n.sampled=String(vr(r)),t.emit&&t.emit("createDsc",n),n}function Fr(e,t){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:s}=t;!function(e,t){const{extra:n,tags:r,user:o,contexts:s,level:a,transactionName:i}=t,c=tt(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const l=tt(r);l&&Object.keys(l).length&&(e.tags={...l,...e.tags});const u=tt(o);u&&Object.keys(u).length&&(e.user={...u,...e.user});const d=tt(s);d&&Object.keys(d).length&&(e.contexts={...d,...e.contexts});a&&(e.level=a);i&&(e.transaction=i)}(e,t),r&&function(e,t){e.contexts={trace:fr(t),...e.contexts};const n=Mr(t);if(n){e.sdkProcessingMetadata={dynamicSamplingContext:$r(t),...e.sdkProcessingMetadata};const r=yr(n).description;r&&(e.tags={transaction:r,...e.tags})}}(e,r),function(e,t){e.fingerprint=e.fingerprint?bt(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t));e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,o),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,s)}function Gr(e,t){const{extra:n,tags:r,user:o,contexts:s,level:a,sdkProcessingMetadata:i,breadcrumbs:c,fingerprint:l,eventProcessors:u,attachments:d,propagationContext:p,transactionName:h,span:f}=t;jr(e,"extra",n),jr(e,"tags",r),jr(e,"user",o),jr(e,"contexts",s),jr(e,"sdkProcessingMetadata",i),a&&(e.level=a),h&&(e.transactionName=h),f&&(e.span=f),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),l.length&&(e.fingerprint=[...e.fingerprint,...l]),u.length&&(e.eventProcessors=[...e.eventProcessors,...u]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...p}}function jr(e,t,n){if(n&&Object.keys(n).length){e[t]={...e[t]};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[t][r]=n[r])}}let Vr;class Wr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=qr()}static clone(e){return e?e.clone():new Wr}clone(){const e=new Wr;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&dr(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e;if(t instanceof Wr){const e=t.getScopeData();this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&Object.keys(e.user).length&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint.length&&(this._fingerprint=e.fingerprint),t.getRequestSession()&&(this._requestSession=t.getRequestSession()),e.propagationContext&&(this._propagationContext=e.propagationContext)}else if(de(t)){const t=e;this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession),t.propagationContext&&(this._propagationContext=t.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=qr(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:Cn(),...e},o=this._breadcrumbs;return o.push(r),this._breadcrumbs=o.length>n?o.slice(-n):o,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:t,_contexts:n,_tags:r,_extra:o,_user:s,_level:a,_fingerprint:i,_eventProcessors:c,_propagationContext:l,_sdkProcessingMetadata:u,_transactionName:d,_span:p}=this;return{breadcrumbs:e,attachments:t,contexts:n,tags:r,extra:o,user:s,level:a,fingerprint:i||[],eventProcessors:c,propagationContext:l,sdkProcessingMetadata:u,transactionName:d,span:p}}applyToEvent(e,t={},n=[]){Fr(e,this.getScopeData());return lr([...n,...ir(),...this._eventProcessors],e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:mt();if(!this._client)return je.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n&&n.event_id?n.event_id:mt();if(!this._client)return je.warn("No client configured on scope - will not capture message!"),r;const o=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:r},this),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:mt();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(je.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}function qr(){return{traceId:mt(),spanId:mt().substring(16)}}const Br="7.116.0",Hr=parseFloat(Br),Jr=100;class zr{constructor(e,t,n,r=Hr){let o,s;this._version=r,t?o=t:(o=new Wr,o.setClient(e)),n?s=n:(s=new Wr,s.setClient(e)),this._stack=[{scope:o}],e&&this.bindClient(e),this._isolationScope=s}isOlderThan(e){return this._version<e}bindClient(e){const t=this.getStackTop();t.client=e,t.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}withScope(e){const t=this.pushScope();let n;try{n=e(t)}catch(e){throw this.popScope(),e}return fe(n)?n.then((e=>(this.popScope(),e)),(e=>{throw this.popScope(),e})):(this.popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){const n=this._lastEventId=t&&t.event_id?t.event_id:mt(),r=new Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:r,...t,event_id:n}),n}captureMessage(e,t,n){const r=this._lastEventId=n&&n.event_id?n.event_id:mt(),o=new Error(e);return this.getScope().captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:r}),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:mt();return e.type||(this._lastEventId=n),this.getScope().captureEvent(e,{...t,event_id:n}),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){const{scope:n,client:r}=this.getStackTop();if(!r)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:s=Jr}=r.getOptions&&r.getOptions()||{};if(s<=0)return;const a={timestamp:Cn(),...e},i=o?Ge((()=>o(a,t))):a;null!==i&&(r.emit&&r.emit("beforeAddBreadcrumb",i,t),n.addBreadcrumb(i,s))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t),this.getIsolationScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t),this.getIsolationScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t),this.getIsolationScope().setContext(e,t)}configureScope(e){const{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){const t=Xr(this);try{e(this)}finally{Xr(t)}}getIntegration(e){const t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return sr&&je.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){const n=this._callExtensionMethod("startTransaction",e,t);if(sr&&!n){this.getClient()?je.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"):je.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")}return n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,t=e.getSession();t&&pr(t),this._sendSessionUpdate(),e.setSession()}startSession(e){const{scope:t,client:n}=this.getStackTop(),{release:r,environment:o=ar}=n&&n.getOptions()||{},{userAgent:s}=Re.navigator||{},a=ur({release:r,environment:o,user:t.getUser(),...s&&{userAgent:s},...e}),i=t.getSession&&t.getSession();return i&&"ok"===i.status&&dr(i,{status:"exited"}),this.endSession(),t.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_callExtensionMethod(e,...t){const n=Yr().__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);sr&&je.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function Yr(){return Re.__SENTRY__=Re.__SENTRY__||{extensions:{},hub:void 0},Re}function Xr(e){const t=Yr(),n=eo(t);return to(t,e),n}function Kr(){const e=Yr();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return function(e=Yr()){t=e,t&&t.__SENTRY__&&t.__SENTRY__.hub&&!eo(e).isOlderThan(Hr)||to(e,new zr);var t;return eo(e)}(e)}function Qr(){return Kr().getIsolationScope()}function Zr(e,t={}){const n=Yr();return n.__SENTRY__&&n.__SENTRY__.acs?n.__SENTRY__.acs.runWithAsyncContext(e,t):e()}function eo(e){return Ce("hub",(()=>new zr),e)}function to(e,t){if(!e)return!1;return(e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0}function no(e){return(e||Kr()).getScope().getTransaction()}const ro=Gn;let oo=!1;function so(){const e=no();if(e){const t="internal_error";sr&&je.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}var ao;function io(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}so.tag="sentry_tracingErrorCallback",function(e){e.Ok="ok";e.DeadlineExceeded="deadline_exceeded";e.Unauthenticated="unauthenticated";e.PermissionDenied="permission_denied";e.NotFound="not_found";e.ResourceExhausted="resource_exhausted";e.InvalidArgument="invalid_argument";e.Unimplemented="unimplemented";e.Unavailable="unavailable";e.InternalError="internal_error";e.UnknownError="unknown_error";e.Cancelled="cancelled";e.AlreadyExists="already_exists";e.FailedPrecondition="failed_precondition";e.Aborted="aborted";e.OutOfRange="out_of_range";e.DataLoss="data_loss"}(ao||(ao={}));const co=io;function lo(e,t){e.setTag("http.status_code",String(t)),e.setData("http.response.status_code",t);const n=io(t);"unknown_error"!==n&&e.setStatus(n)}function uo(e,t,n=(()=>{})){let r;try{r=e()}catch(e){throw t(e),n(),e}return function(e,t,n){if(fe(e))return e.then((e=>(n(),e)),(e=>{throw t(e),n(),e}));return n(),e}(r,t,n)}function po(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=Or(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function ho(e,t){const n=_o(e);return Zr((()=>Cr(e.scope,(r=>{const o=Kr(),s=r.getSpan(),a=e.onlyIfParent&&!s?void 0:mo(o,{parentSpan:s,spanContext:n,forceTransaction:e.forceTransaction,scope:r});return uo((()=>t(a)),(()=>{if(a){const{status:e}=yr(a);e&&"ok"!==e||a.setStatus("internal_error")}}),(()=>a&&a.end()))}))))}function fo(e){if(!po())return;const t=_o(e),n=Kr(),r=e.scope?e.scope.getSpan():go();if(e.onlyIfParent&&!r)return;const o=(e.scope||xr()).clone();return mo(n,{parentSpan:r,spanContext:t,forceTransaction:e.forceTransaction,scope:o})}function go(){return xr().getSpan()}function mo(e,{parentSpan:t,spanContext:n,forceTransaction:r,scope:o}){if(!po())return;const s=Qr();let a;if(t&&!r)a=t.startChild(n);else if(t){const r=$r(t),{traceId:o,spanId:s}=t.spanContext(),i=vr(t);a=e.startTransaction({traceId:o,parentSpanId:s,parentSampled:i,...n,metadata:{dynamicSamplingContext:r,...n.metadata}})}else{const{traceId:t,dsc:r,parentSpanId:i,sampled:c}={...s.getPropagationContext(),...o.getPropagationContext()};a=e.startTransaction({traceId:t,parentSpanId:i,parentSampled:c,...n,metadata:{dynamicSamplingContext:r,...n.metadata}})}return o.setSpan(a),function(e,t,n){e&&(Ye(e,vo,n),Ye(e,yo,t))}(a,o,s),a}function _o(e){if(e.startTime){const t={...e};return t.startTimestamp=mr(e.startTime),delete t.startTime,t}return e}const yo="_sentryScope",vo="_sentryIsolationScope";let To;function So(e){return To?To.get(e):void 0}function bo(e){const t=So(e);if(!t)return;const n={};for(const[,[e,r]]of t)n[e]||(n[e]=[]),n[e].push(tt(r));return n}const Eo="sentry.source",wo="sentry.sample_rate",Ao="sentry.op",Io="sentry.origin";class Ro{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class ko{constructor(e={}){this._traceId=e.traceId||mt(),this._spanId=e.spanId||mt().substring(16),this._startTime=e.startTimestamp||On(),this.tags=e.tags?{...e.tags}:{},this.data=e.data?{...e.data}:{},this.instrumenter=e.instrumenter||"sentry",this._attributes={},this.setAttributes({[Io]:e.origin||"manual",[Ao]:e.op,...e.attributes}),this._name=e.name||e.description,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.status&&(this._status=e.status),e.endTimestamp&&(this._endTime=e.endTimestamp),void 0!==e.exclusiveTime&&(this._exclusiveTime=e.exclusiveTime),this._measurements=e.measurements?{...e.measurements}:{}}get name(){return this._name||""}set name(e){this.updateName(e)}get description(){return this._name}set description(e){this._name=e}get traceId(){return this._traceId}set traceId(e){this._traceId=e}get spanId(){return this._spanId}set spanId(e){this._spanId=e}set parentSpanId(e){this._parentSpanId=e}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(e){this._sampled=e}get attributes(){return this._attributes}set attributes(e){this._attributes=e}get startTimestamp(){return this._startTime}set startTimestamp(e){this._startTime=e}get endTimestamp(){return this._endTime}set endTimestamp(e){this._endTime=e}get status(){return this._status}set status(e){this._status=e}get op(){return this._attributes[Ao]}set op(e){this.setAttribute(Ao,e)}get origin(){return this._attributes[Io]}set origin(e){this.setAttribute(Io,e)}spanContext(){const{_spanId:e,_traceId:t,_sampled:n}=this;return{spanId:e,traceId:t,traceFlags:n?hr:0}}startChild(e){const t=new ko({...e,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t);const n=Mr(this);if(t.transaction=n,sr&&n){const r=`[Tracing] Starting '${e&&e.op||"< unknown op >"}' span on transaction '${yr(t).description||"< unknown name >"}' (${n.spanContext().spanId}).`;je.log(r),this._logMessage=r}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setAttribute(e,t){void 0===t?delete this._attributes[e]:this._attributes[e]=t}setAttributes(e){Object.keys(e).forEach((t=>this.setAttribute(t,e[t])))}setStatus(e){return this._status=e,this}setHttpStatus(e){return lo(this,e),this}setName(e){this.updateName(e)}updateName(e){return this._name=e,this}isSuccess(){return"ok"===this._status}finish(e){return this.end(e)}end(e){if(this._endTime)return;const t=Mr(this);if(sr&&t&&t.spanContext().spanId!==this._spanId){const e=this._logMessage;e&&je.log(e.replace("Starting","Finishing"))}this._endTime=mr(e)}toTraceparent(){return gr(this)}toContext(){return tt({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(e){return this.data=e.data||{},this._name=e.name||e.description,this._endTime=e.endTimestamp,this.op=e.op,this._parentSpanId=e.parentSpanId,this._sampled=e.sampled,this._spanId=e.spanId||this._spanId,this._startTime=e.startTimestamp||this._startTime,this._status=e.status,this.tags=e.tags||{},this._traceId=e.traceId||this._traceId,this}getTraceContext(){return fr(this)}getSpanJSON(){return tt({data:this._getData(),description:this._name,op:this._attributes[Ao],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Io],_metrics_summary:bo(this),profile_id:this._attributes.profile_id,exclusive_time:this._exclusiveTime,measurements:Object.keys(this._measurements).length>0?this._measurements:void 0})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){const{data:e,_attributes:t}=this,n=Object.keys(e).length>0,r=Object.keys(t).length>0;if(n||r)return n&&r?{...e,...t}:n?e:t}}class Co extends ko{constructor(e,t){super(e),this._contexts={},this._hub=t||Kr(),this._name=e.name||"",this._metadata={...e.metadata},this._trimEnd=e.trimEnd,this.transaction=this;const n=this._metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[Eo]&&{source:this._attributes[Eo]},...this._attributes[wo]&&{sampleRate:this._attributes[wo]}}}set metadata(e){this._metadata=e}setName(e,t="custom"){this._name=e,this.setAttribute(Eo,t)}updateName(e){return this._name=e,this}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new Ro(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this._metadata={...this._metadata,...e}}end(e){const t=mr(e),n=this._finishTransaction(t);if(n)return this._hub.captureEvent(n)}toContext(){return tt({...super.toContext(),name:this._name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this._name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){return $r(this)}setHub(e){this._hub=e}getProfileId(){if(void 0!==this._contexts&&void 0!==this._contexts.profile)return this._contexts.profile.profile_id}_finishTransaction(e){if(void 0!==this._endTime)return;this._name||(sr&&je.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(e);const t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this._sampled)return sr&&je.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(t&&t.recordDroppedEvent("sample_rate","transaction"));const n=this.spanRecorder?this.spanRecorder.spans.filter((e=>e!==this&&yr(e).timestamp)):[];if(this._trimEnd&&n.length>0){const e=n.map((e=>yr(e).timestamp)).filter(Boolean);this._endTime=e.reduce(((e,t)=>e>t?e:t))}const{scope:r,isolationScope:o}={scope:(s=this)[yo],isolationScope:s[vo]};var s;const{metadata:a}=this,{source:i}=a,c={contexts:{...this._contexts,trace:fr(this)},spans:n,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...a,capturedSpanScope:r,capturedSpanIsolationScope:o,...tt({dynamicSamplingContext:$r(this)})},_metrics_summary:bo(this),...i&&{transaction_info:{source:i}}};return Object.keys(this._measurements).length>0&&(sr&&je.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),c.measurements=this._measurements),sr&&je.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),c}}const Oo={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},xo=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class Lo extends Ro{constructor(e,t,n,r){super(r),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=n}add(e){if(e.spanContext().spanId!==this.transactionSpanId){const t=e.end;e.end=(...n)=>(this._popActivity(e.spanContext().spanId),t.apply(e,n)),void 0===yr(e).timestamp&&this._pushActivity(e.spanContext().spanId)}super.add(e)}}class No extends Co{constructor(e,t,n=Oo.idleTimeout,r=Oo.finalTimeout,o=Oo.heartbeatInterval,s=!1,a=!1){super(e,t),this._idleHub=t,this._idleTimeout=n,this._finalTimeout=r,this._heartbeatInterval=o,this._onScope=s,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=xo[4],this._autoFinishAllowed=!a,s&&(sr&&je.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),t.getScope().setSpan(this)),a||this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=xo[3],this.end())}),this._finalTimeout)}end(e){const t=mr(e);if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setAttribute("finishReason",this._finishReason),this.spanRecorder){sr&&je.log("[Tracing] finishing IdleTransaction",new Date(1e3*t).toISOString(),this.op);for(const e of this._beforeFinishCallbacks)e(this,t);this.spanRecorder.spans=this.spanRecorder.spans.filter((e=>{if(e.spanContext().spanId===this.spanContext().spanId)return!0;yr(e).timestamp||(e.setStatus("cancelled"),e.end(t),sr&&je.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(e,void 0,2)));const{start_timestamp:n,timestamp:r}=yr(e),o=n&&n<t,s=(this._finalTimeout+this._idleTimeout)/1e3,a=r&&n&&r-n<s;if(sr){const t=JSON.stringify(e,void 0,2);o?a||je.log("[Tracing] discarding Span since it finished after Transaction final timeout",t):je.log("[Tracing] discarding Span since it happened after Transaction was finished",t)}return o&&a})),sr&&je.log("[Tracing] flushing IdleTransaction")}else sr&&je.log("[Tracing] No active IdleTransaction");if(this._onScope){const e=this._idleHub.getScope();e.getTransaction()===this&&e.setSpan(void 0)}return super.end(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const t=e=>{this._finished||this._pushActivity(e)},n=e=>{this._finished||this._popActivity(e)};this.spanRecorder=new Lo(t,n,this.spanContext().spanId,e),sr&&je.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===t,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=xo[5],this.end(e)))}setFinishReason(e){this._finishReason=e}sendAutoFinishSignal(){this._autoFinishAllowed||(sr&&je.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=xo[1],this.end(e))}),this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),sr&&je.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,sr&&je.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(sr&&je.log(`[Tracing] popActivity ${e}`),delete this.activities[e],sr&&je.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const e=On();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason=xo[5],this.end(e)):this._restartIdleTimeout(e+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?this._autoFinishAllowed&&(sr&&je.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=xo[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){sr&&je.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}function Po(e,t,n){if(!po(t))return e.sampled=!1,e;if(void 0!==e.sampled)return e.setAttribute(wo,Number(e.sampled)),e;let r;return"function"==typeof t.tracesSampler?(r=t.tracesSampler(n),e.setAttribute(wo,Number(r))):void 0!==n.parentSampled?r=n.parentSampled:void 0!==t.tracesSampleRate?(r=t.tracesSampleRate,e.setAttribute(wo,Number(r))):(r=1,e.setAttribute(wo,r)),Do(r)?r?(e.sampled=Math.random()<r,e.sampled?(sr&&je.log(`[Tracing] starting ${e.op} transaction - ${yr(e).description}`),e):(sr&&je.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),e)):(sr&&je.log("[Tracing] Discarding transaction because "+("function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),e.sampled=!1,e):(sr&&je.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function Do(e){return ge(e)||"number"!=typeof e&&"boolean"!=typeof e?(sr&&je.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):!(e<0||e>1)||(sr&&je.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1)}function Mo(){const e=this.getScope().getSpan();return e?{"sentry-trace":gr(e)}:{}}function Uo(e,t){const n=this.getClient(),r=n&&n.getOptions()||{},o=r.instrumenter||"sentry",s=e.instrumenter||"sentry";o!==s&&(sr&&je.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${o}\` instrumenter.\nThe transaction will not be sampled. Please use the ${o} instrumentation to start transactions.`),e.sampled=!1);let a=new Co(e,this);return a=Po(a,r,{name:e.name,parentSampled:e.parentSampled,transactionContext:e,attributes:{...e.data,...e.attributes},...t}),a.isRecording()&&a.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",a),a}function $o(e,t,n,r,o,s,a,i=!1){const c=e.getClient(),l=c&&c.getOptions()||{};let u=new No(t,e,n,r,a,o,i);return u=Po(u,l,{name:t.name,parentSampled:t.parentSampled,transactionContext:t,attributes:{...t.data,...t.attributes},...s}),u.isRecording()&&u.initSpanRecorder(l._experiments&&l._experiments.maxSpans),c&&c.emit&&c.emit("startTransaction",u),u}function Fo(){const e=Yr();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=Uo),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=Mo),oo||(oo=!0,Gt(so),Wt(so)))}function Go(e,t,n){const r=no();r&&r.setMeasurement(e,t,n)}function jo(e,t,n,r){const o=Kn(n),s=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const a=Qn(e,o,r,t);delete e.sdkProcessingMetadata;return Wn(a,[[{type:s},e]])}const Vo="7";function Wo(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function qo(e,t){return n={sentry_key:e.publicKey,sentry_version:Vo,...t&&{sentry_client:`${t.name}/${t.version}`}},Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&");var n}function Bo(e,t={}){const n="string"==typeof t?t:t.tunnel,r="string"!=typeof t&&t._metadata?t._metadata.sdk:void 0;return n||`${function(e){return`${Wo(e)}${e.projectId}/envelope/`}(e)}?${qo(e,r)}`}const Ho=[];function Jo(e){const t=e.defaultIntegrations||[],n=e.integrations;let r;t.forEach((e=>{e.isDefaultInstance=!0})),r=Array.isArray(n)?[...t,...n]:"function"==typeof n?bt(n(t)):t;const o=function(e){const t={};return e.forEach((e=>{const{name:n}=e,r=t[n];r&&!r.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)})),Object.keys(t).map((e=>t[e]))}(r),s=function(e,t){for(let n=0;n<e.length;n++)if(!0===t(e[n]))return n;return-1}(o,(e=>"Debug"===e.name));if(-1!==s){const[e]=o.splice(s,1);o.push(e)}return o}function zo(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function Yo(e,t,n){if(n[t.name])sr&&je.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===Ho.indexOf(t.name)&&(t.setupOnce(cr,Kr),Ho.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),e.on&&"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if(e.addEventProcessor&&"function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}sr&&je.log(`Integration installed: ${t.name}`)}}function Xo(e,t){return Object.assign((function(...e){return t(...e)}),{id:e})}function Ko(e){return e.replace(/[^\w\-./]+/gi,"")}const Qo=[["\n","\\n"],["\r","\\r"],["\t","\\t"],["\\","\\\\"],["|","\\u{7c}"],[",","\\u{2c}"]];function Zo(e){return[...e].reduce(((e,t)=>e+function(e){for(const[t,n]of Qo)if(e===t)return n;return e}(t)),"")}function es(e,t,n,r){const o={sent_at:(new Date).toISOString()};n&&n.sdk&&(o.sdk={name:n.sdk.name,version:n.sdk.version}),r&&t&&(o.dsn=We(t));const s=function(e){const t=function(e){let t="";for(const n of e){const e=Object.entries(n.tags),r=e.length>0?`|#${e.map((([e,t])=>`${e}:${t}`)).join(",")}`:"";t+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${r}|T${n.timestamp}\n`}return t}(e);return[{type:"statsd",length:t.length},t]}(e);return Wn(o,[s])}const ts="Not capturing exception because it's already been captured.";class ns{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=He(e.dsn):sr&&je.warn("No DSN provided, client will not send events."),this._dsn){const t=Bo(this._dsn,e);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){if(St(e))return void(sr&&je.log(ts));let r=t&&t.event_id;return this._process(this.eventFromException(e,t).then((e=>this._captureEvent(e,t,n))).then((e=>{r=e}))),r}captureMessage(e,t,n,r){let o=n&&n.event_id;const s=le(e)?e:String(e),a=ue(e)?this.eventFromMessage(s,t,n):this.eventFromException(e,n);return this._process(a.then((e=>this._captureEvent(e,n,r))).then((e=>{o=e}))),o}captureEvent(e,t,n){if(t&&t.originalException&&St(t.originalException))return void(sr&&je.log(ts));let r=t&&t.event_id;const o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,t,o||n).then((e=>{r=e}))),r}captureSession(e){"string"!=typeof e.release?sr&&je.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),dr(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):hn(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(e){return this.getIntegrationByName(e)}getIntegrationByName(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return sr&&je.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){const t=this._integrations[e.name];Yo(this,e,this._integrations),t||zo(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=jo(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=qn(n,zn(e,this._options.transportOptions&&this._options.transportOptions.textEncoder));const r=this._sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=function(e,t,n,r){const o=Kn(n);return Wn({sent_at:(new Date).toISOString(),...o&&{sdk:o},...!!r&&t&&{dsn:We(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const n=`${e}:${t}`;sr&&je.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}captureAggregateMetrics(e){sr&&je.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const t=es(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach((e=>e(...t)))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&Yo(e,t,n)})),n}(this,e),zo(this,e),this._integrationsInitialized=!0}_updateSessionFromEvent(e,t){let n=!1,r=!1;const o=t.exception&&t.exception.values;if(o){r=!0;for(const e of o){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const s="ok"===e.status;(s&&0===e.errors||s&&n)&&(dr(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new gn((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r=Qr()){const o=this.getOptions(),s=Object.keys(this._integrations);return!t.integrations&&s.length>0&&(t.integrations=s),this.emit("preprocessEvent",e,t),Tr(o,e,t,n,this,r).then((e=>{if(null===e)return e;const t={...r.getPropagationContext(),...n?n.getPropagationContext():void 0};if(!(e.contexts&&e.contexts.trace)&&t){const{traceId:r,spanId:o,parentSpanId:s,dsc:a}=t;e.contexts={trace:{trace_id:r,span_id:o,parent_span_id:s},...e.contexts};const i=a||Ur(r,this,n);e.sdkProcessingMetadata={dynamicSamplingContext:i,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if(sr){const t=e;"log"===t.logLevel?je.log(t.message):je.warn(t)}}))}_processEvent(e,t,n){const r=this.getOptions(),{sampleRate:o}=r,s=os(e),a=rs(e),i=e.type||"error",c=`before send for type \`${i}\``;if(a&&"number"==typeof o&&Math.random()>o)return this.recordDroppedEvent("sample_rate","error",e),fn(new Je(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const l="replay_event"===i?"replay":i,u=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,u).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new Je("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const o=function(e,t,n){const{beforeSend:r,beforeSendTransaction:o}=e;if(rs(t)&&r)return r(t,n);if(os(t)&&o)return o(t,n);return t}(r,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(fe(e))return e.then((e=>{if(!de(e)&&null!==e)throw new Je(n);return e}),(e=>{throw new Je(`${t} rejected with ${e}`)}));if(!de(e)&&null!==e)throw new Je(n);return e}(o,c)})).then((r=>{if(null===r)throw this.recordDroppedEvent("before_send",l,e),new Je(`${c} returned \`null\`, will not send event.`,"log");const o=n&&n.getSession();!s&&o&&this._updateSessionFromEvent(o,r);const a=r.transaction_info;if(s&&a&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...a,source:e}}return this.sendEvent(r,t),r})).then(null,(e=>{if(e instanceof Je)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new Je(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,(e=>{sr&&je.error("Error while sending event:",e)}));sr&&je.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map((t=>{const[n,r]=t.split(":");return{reason:n,category:r,quantity:e[t]}}))}}function rs(e){return void 0===e.type}function os(e){return"transaction"===e.type}function ss(e){const t=Or();t&&t.addEventProcessor&&t.addEventProcessor(e)}const as={c:class{constructor(e){this._value=e}get weight(){return 1}add(e){this._value+=e}toString(){return`${this._value}`}},g:class{constructor(e){this._last=e,this._min=e,this._max=e,this._sum=e,this._count=1}get weight(){return 5}add(e){this._last=e,e<this._min&&(this._min=e),e>this._max&&(this._max=e),this._sum+=e,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}},d:class{constructor(e){this._value=[e]}get weight(){return this._value.length}add(e){this._value.push(e)}toString(){return this._value.join(":")}},s:class{constructor(e){this.first=e,this._value=new Set([e])}get weight(){return this._value.size}add(e){this._value.add(e)}toString(){return Array.from(this._value).map((e=>"string"==typeof e?function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t>>>0}(e):e)).join(":")}}};function is(e){const t=Kr().getStackTop();t.client=e,t.scope.setClient(e)}const cs=30;function ls(e,t,n=mn(e.bufferSize||cs)){let r={};function o(o){const s=[];if(Bn(o,((t,n)=>{const o=Xn(n);if(tr(r,o)){const r=us(t,n);e.recordDroppedEvent("ratelimit_backoff",o,r)}else s.push(t)})),0===s.length)return hn();const a=Wn(o[0],s),i=t=>{Bn(a,((n,r)=>{const o=us(n,r);e.recordDroppedEvent(t,Xn(r),o)}))};return n.add((()=>t({body:Jn(a,e.textEncoder)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&sr&&je.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=nr(r,e),e)),(e=>{throw i("network_error"),e})))).then((e=>e),(e=>{if(e instanceof Je)return sr&&je.error("Skipped sending event because buffer is full."),i("queue_overflow"),hn();throw e}))}return o.__sentry__baseTransport__=!0,{send:o,flush:e=>n.drain(e)}}function us(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}const ds=100,ps=5e3,hs=36e5;function fs(e,t){sr&&je.info(`[Offline]: ${e}`,t)}function gs(e){return t=>{const n=e(t),r=t.createStore?t.createStore(t):void 0;let o,s=ps;function a(e,n,r){return o=["replay_event","replay_recording","client_report"],!Bn(e,((e,t)=>o.includes(t)))&&(!t.shouldStore||t.shouldStore(e,n,r));var o}function i(e){r&&(o&&clearTimeout(o),o=setTimeout((async()=>{o=void 0;const e=await r.pop();e&&(fs("Attempting to send previously queued event"),l(e).catch((e=>{fs("Failed to retry sending",e)})))}),e),"number"!=typeof o&&o.unref&&o.unref())}function c(){o||(i(s),s=Math.min(2*s,hs))}async function l(e){try{const t=await n.send(e);let r=ds;if(t)if(t.headers&&t.headers["retry-after"])r=er(t.headers["retry-after"]);else if((t.statusCode||0)>=400)return t;return i(r),s=ps,t}catch(t){if(r&&await a(e,t,s))return await r.insert(e),c(),fs("Error sending. Event queued",t),{};throw t}}return t.flushAtStartup&&c(),{send:l,flush:e=>n.flush(e)}}}function ms(e,t){let n;return Bn(e,((e,r)=>(t.includes(r)&&(n=Array.isArray(e)?e[1]:void 0),!!n))),n}function _s(e){return[{type:"span"},e]}function ys(e,t){const n=t&&function(e){return void 0!==e.getClient}(t)?t.getClient():t,r=n&&n.getDsn(),o=n&&n.getOptions().tunnel;return function(e,t){return!!t&&e.includes(t.host)}(e,r)||function(e,t){if(!t)return!1;return vs(e)===vs(t)}(e,o)}function vs(e){return"/"===e[e.length-1]?e.slice(0,-1):e}const Ts=new Map,Ss=new Set;function bs(e,t){return function(e){if(Re._sentryModuleMetadata)for(const t of Object.keys(Re._sentryModuleMetadata)){const n=Re._sentryModuleMetadata[t];if(Ss.has(t))continue;Ss.add(t);const r=e(t);for(const e of r.reverse())if(e.filename){Ts.set(e.filename,n);break}}}(e),Ts.get(t)}const Es="ModuleMetadata",ws=()=>({name:Es,setupOnce(){},setup(e){"function"==typeof e.on&&e.on("beforeEnvelope",(e=>{Bn(e,((e,t)=>{if("event"===t){const t=Array.isArray(e)?e[1]:void 0;t&&(!function(e){try{e.exception.values.forEach((e=>{if(e.stacktrace)for(const t of e.stacktrace.frames||[])delete t.module_metadata}))}catch(e){}}(t),e[1]=t)}}))}))},processEvent:(e,t,n)=>(function(e,t){try{t.exception.values.forEach((t=>{if(t.stacktrace)for(const n of t.stacktrace.frames||[]){if(!n.filename)continue;const t=bs(e,n.filename);t&&(n.module_metadata=t)}}))}catch(e){}}(n.getOptions().stackParser,e),e)}),As=Xo(Es,ws),Is={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},Rs="RequestData";Xo(Rs,((e={})=>{const t=An,n={...Is,...e,include:{method:!0,...Is.include,...e.include,user:e.include&&"boolean"==typeof e.include.user?e.include.user:{...Is.include.user,...(e.include||{}).user}}};return{name:Rs,setupOnce(){},processEvent(e,r,o){const{transactionNamingScheme:s}=n,{sdkProcessingMetadata:a={}}=e,i=a.request;if(!i)return e;const c=a.requestDataOptionsFromExpressHandler||a.requestDataOptionsFromGCPWrapper||function(e){const{transactionNamingScheme:t,include:{ip:n,user:r,...o}}=e,s=[];for(const[e,t]of Object.entries(o))t&&s.push(e);let a;if(void 0===r)a=!0;else if("boolean"==typeof r)a=r;else{const e=[];for(const[t,n]of Object.entries(r))n&&e.push(t);a=e}return{include:{ip:n,user:a,request:0!==s.length?s:void 0,transaction:t}}}(n),l=t(e,i,c);if("transaction"===e.type||"handler"===s)return l;const u=i._sentryTransaction;if(u){const e=yr(u).description||"",t="sentry.javascript.nextjs"===function(e){try{return e.getOptions()._metadata.sdk.name}catch(e){return}}(o)?e.startsWith("/api"):"path"!==s,[n]=En(i,{path:!0,method:t,customRoute:e});l.transaction=n}return l}}}));const ks=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/],Cs=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],Os="InboundFilters",xs=(e={})=>({name:Os,setupOnce(){},processEvent(t,n,r){const o=r.getOptions(),s=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:ks],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:Cs],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,o);return function(e,t){if(t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e))return sr&&je.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${yt(e)}`),!0;if(function(e,t){if(e.type||!t||!t.length)return!1;return function(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch(e){}n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`));sr&&0===t.length&&je.error(`Could not extract message for event ${yt(e)}`);return t}(e).some((e=>Se(e,t)))}(e,t.ignoreErrors))return sr&&je.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${yt(e)}`),!0;if(function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&Se(n,t)}(e,t.ignoreTransactions))return sr&&je.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${yt(e)}`),!0;if(function(e,t){if(!t||!t.length)return!1;const n=Ns(e);return!!n&&Se(n,t)}(e,t.denyUrls))return sr&&je.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${yt(e)}.\nUrl: ${Ns(e)}`),!0;if(!function(e,t){if(!t||!t.length)return!0;const n=Ns(e);return!n||Se(n,t)}(e,t.allowUrls))return sr&&je.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${yt(e)}.\nUrl: ${Ns(e)}`),!0;return!1}(t,s)?null:t}}),Ls=Xo(Os,xs);function Ns(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return sr&&je.error(`Cannot extract url for event ${yt(e)}`),null}}let Ps;const Ds="FunctionToString",Ms=new WeakMap,Us=()=>({name:Ds,setupOnce(){Ps=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=Ke(this),n=Ms.has(Or())&&void 0!==t?t:this;return Ps.apply(n,e)}}catch(e){}},setup(e){Ms.set(e,!0)}}),$s=Xo(Ds,Us),Fs="LinkedErrors",Gs=Xo(Fs,((e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:Fs,setupOnce(){},preprocessEvent(e,r,o){const s=o.getOptions();be(rr,s.stackParser,s.maxValueLength,n,t,e,r)}}}));var js=Object.freeze({__proto__:null,FunctionToString:$s,InboundFilters:Ls,LinkedErrors:Gs});class Vs{constructor(e){this._client=e,this._buckets=new Map,this._interval=setInterval((()=>this.flush()),5e3)}add(e,t,n,r="none",o={},s=On()){const a=Math.floor(s),i=t.replace(/[^\w\-.]+/gi,"_");const c=function(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[Ko(n)]=Zo(String(e[n])));return t}(o),l=function(e){return e.replace(/[^\w]+/gi,"_")}(r),u=function(e,t,n,r){return`${e}${t}${n}${Object.entries(tt(r)).sort(((e,t)=>e[0].localeCompare(t[0])))}`}(e,i,l,c);let d=this._buckets.get(u);const p=d&&"s"===e?d.metric.weight:0;d?(d.metric.add(n),d.timestamp<a&&(d.timestamp=a)):(d={metric:new as[e](n),timestamp:a,metricType:e,name:i,unit:l,tags:c},this._buckets.set(u,d));!function(e,t,n,r,o,s){const a=go();if(a){const i=So(a)||new Map,c=`${e}:${t}@${r}`,l=i.get(s);if(l){const[,e]=l;i.set(s,[c,{min:Math.min(e.min,n),max:Math.max(e.max,n),count:e.count+=1,sum:e.sum+=n,tags:e.tags}])}else i.set(s,[c,{min:n,max:n,count:1,sum:n,tags:o}]);To||(To=new WeakMap),To.set(a,i)}}(e,i,"string"==typeof n?d.metric.weight-p:n,l,o,u)}flush(){if(0!==this._buckets.size){if(this._client.captureAggregateMetrics){const e=Array.from(this._buckets).map((([,e])=>e));this._client.captureAggregateMetrics(e)}this._buckets.clear()}}close(){clearInterval(this._interval),this.flush()}}const Ws="MetricsAggregator",qs=()=>({name:Ws,setupOnce(){},setup(e){e.metricsAggregator=new Vs(e)}});function Bs(e,t,n,r={}){const o=Or(),s=xr();if(o){if(!o.metricsAggregator)return void(sr&&je.warn("No metrics aggregator enabled. Please add the MetricsAggregator integration to use metrics APIs"));const{unit:a,tags:i,timestamp:c}=r,{release:l,environment:u}=o.getOptions(),d=s.getTransaction(),p={};l&&(p.release=l),u&&(p.environment=u),d&&(p.transaction=yr(d).description||""),sr&&je.log(`Adding value of ${n} to ${e} metric ${t}`),o.metricsAggregator.add(e,t,n,a,{...p,...i},c)}}const Hs={increment:function(e,t=1,n){Bs("c",e,t,n)},distribution:function(e,t,n){Bs("d",e,t,n)},set:function(e,t,n){Bs("s",e,t,n)},gauge:function(e,t,n){Bs("g",e,t,n)},MetricsAggregator:Xo(Ws,qs),metricsAggregatorIntegration:qs},Js=js,zs="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Ys(e){const t=or([e,"call",e=>e(),"access",e=>e.getClient,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]);return"sentry"!==(or([t,"optionalAccess",e=>e.instrumenter])||"sentry")}class Xs{static __initStatic(){this.id="Express"}constructor(e={}){this.name=Xs.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}setupOnce(e,t){this._router?Ys(t)?zs&&je.log("Express Integration is skipped because of instrumenter configuration."):(function(e,t=[]){t.forEach((t=>function(e,t){const n=e[t];return e[t]=function(...e){return n.call(this,...function(e,t){return e.map((e=>"function"==typeof e?Ks(e,t):Array.isArray(e)?e.map((e=>"function"==typeof e?Ks(e,t):e)):e))}(e,t))},e}(e,t)))}(this._router,this._methods),function(e){const t="settings"in e;t&&void 0===e._router&&e.lazyrouter&&e.lazyrouter();const n=t?e._router:e;if(!n)return zs&&je.debug("Cannot instrument router for URL Parameterization (did not find a valid router)."),void(zs&&je.debug("Routing instrumentation is currently only supported in Express 4."));const r=Object.getPrototypeOf(n),o=r.process_params;r.process_params=function(e,t,n,r,s){n._reconstructedRoute||(n._reconstructedRoute="");const{layerRoutePath:a,isRegex:i,isArray:c,numExtraSegments:l}=function(e){let t=or([e,"access",e=>e.route,"optionalAccess",e=>e.path]);const n=he(t),r=Array.isArray(t);if(!t){const[n]=Re.process.versions.node.split(".").map(Number);n>=16&&(t=Qs(e.path,e.regexp,e.keys))}if(!t)return{isRegex:n,isArray:r,numExtraSegments:0};const o=r?Math.max((a=t,a.reduce(((e,t)=>e+vn(t.toString())),0)-vn(e.path||"")),0):0,s=function(e,t){if(e)return t.map((e=>e.toString())).join(",");return t&&t.toString()}(r,t);var a;return{layerRoutePath:s,isRegex:n,isArray:r,numExtraSegments:o}}(e);let u;(a||i||c)&&(n._hasParameters=!0),u=a||(function(e,t,n){const r=or([yn(e||""),"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>!!e))]);let o=0;const s=or([t,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>!!e)),"access",e=>e.length])||0;return or([n,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>or([r,"optionalAccess",e=>e[s+o]])===e&&(o+=1,!0))),"access",e=>e.join,"call",e=>e("/")])}(n.originalUrl,n._reconstructedRoute,e.path)||"");const d=u.split("/").filter((e=>e.length>0&&(i||c||!e.includes("*")))).join("/");d&&d.length>0&&(n._reconstructedRoute+=`/${d}${i?"/":""}`);if(vn(yn(n.originalUrl||""))+l===vn(n._reconstructedRoute)){n._hasParameters||n._reconstructedRoute!==n.originalUrl&&(n._reconstructedRoute=n.originalUrl?yn(n.originalUrl):n.originalUrl);const e=r.__sentry_transaction,t=e&&yr(e).data||{};if(e&&"custom"!==t[Eo]){const t=n._reconstructedRoute||"/",[r,o]=En(n,{path:!0,method:!0,customRoute:t});e.updateName(r),e.setAttribute(Eo,o)}}return o.call(this,e,t,n,r,s)}}(this._router)):zs&&je.error("ExpressIntegration is missing an Express instance")}}function Ks(e,t){const n=e.length;switch(n){case 2:return function(n,r){const o=r.__sentry_transaction;if(o){const n=o.startChild({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"});r.once("finish",(()=>{n.end()}))}return e.call(this,n,r)};case 3:return function(n,r,o){const s=or([r.__sentry_transaction,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,r,(function(...e){or([s,"optionalAccess",e=>e.end,"call",e=>e()]),o.call(this,...e)}))};case 4:return function(n,r,o,s){const a=or([o.__sentry_transaction,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,r,o,(function(...e){or([a,"optionalAccess",e=>e.end,"call",e=>e()]),s.call(this,...e)}))};default:throw new Error(`Express middleware takes 2-4 arguments. Got: ${n}`)}}Xs.__initStatic();const Qs=(e,t,n)=>{if(!(e&&t&&n&&0!==Object.keys(n).length&&or([n,"access",e=>e[0],"optionalAccess",e=>e.offset])))return;const r=n.sort(((e,t)=>e.offset-t.offset)),o=new RegExp(t,`${t.flags}d`).exec(e);if(!o||!o.indices)return;const[,...s]=o.indices;if(s.length!==r.length)return;let a=e,i=0;return s.forEach(((e,t)=>{if(e){const[n,o]=e,s=a.substring(0,n-i),c=`:${r[t].name}`,l=a.substring(o-i);a=s+c+l,i+=o-n-c.length}})),a};class Zs{static __initStatic(){this.id="Postgres"}constructor(e={}){this.name=Zs.id,this._usePgNative=!!e.usePgNative,this._module=e.module}loadDependency(){return this._module=this._module||nn("pg")}setupOnce(e,t){if(Ys(t))return void(zs&&je.log("Postgres Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(!n)return void(zs&&je.error("Postgres Integration was unable to require `pg` package."));const r=this._usePgNative?or([n,"access",e=>e.native,"optionalAccess",e=>e.Client]):n.Client;r?ze(r.prototype,"query",(function(e){return function(n,r,o){const s=t().getScope().getSpan(),a={"db.system":"postgresql"};try{this.database&&(a["db.name"]=this.database),this.host&&(a["server.address"]=this.host),this.port&&(a["server.port"]=this.port),this.user&&(a["db.user"]=this.user)}catch(e){}const i=or([s,"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.text,op:"db",origin:"auto.db.postgres",data:a})]);if("function"==typeof o)return e.call(this,n,r,(function(e,t){or([i,"optionalAccess",e=>e.end,"call",e=>e()]),o(e,t)}));if("function"==typeof r)return e.call(this,n,(function(e,t){or([i,"optionalAccess",e=>e.end,"call",e=>e()]),r(e,t)}));const c=void 0!==r?e.call(this,n,r):e.call(this,n);return fe(c)?c.then((e=>(or([i,"optionalAccess",e=>e.end,"call",e=>e()]),e))):(or([i,"optionalAccess",e=>e.end,"call",e=>e()]),c)}})):zs&&je.error("Postgres Integration was unable to access 'pg-native' bindings.")}}Zs.__initStatic();class ea{static __initStatic(){this.id="Mysql"}constructor(){this.name=ea.id}loadDependency(){return this._module=this._module||nn("mysql/lib/Connection.js")}setupOnce(e,t){if(Ys(t))return void(zs&&je.log("Mysql Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(!n)return void(zs&&je.error("Mysql Integration was unable to require `mysql` package."));let r;try{n.prototype.connect=new Proxy(n.prototype.connect,{apply:(e,t,n)=>(r||(r=t.config),e.apply(t,n))})}catch(e){zs&&je.error("Mysql Integration was unable to instrument `mysql` config.")}function o(e){if(!e)return;const t=r?{"server.address":r.host,"server.port":r.port,"db.user":r.user}:{};Object.keys(t).forEach((n=>{e.setAttribute(n,t[n])})),e.end()}ze(n,"createQuery",(function(e){return function(n,r,s){const a=or([t().getScope().getSpan(),"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.sql,op:"db",origin:"auto.db.mysql",data:{"db.system":"mysql"}})]);if("function"==typeof s)return e.call(this,n,r,(function(e,t,n){o(a),s(e,t,n)}));if("function"==typeof r)return e.call(this,n,(function(e,t,n){o(a),r(e,t,n)}));const i=e.call(this,n,r);return i.on("end",(()=>{o(a)})),i}}))}}ea.__initStatic();const ta=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],na={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};class ra{static __initStatic(){this.id="Mongo"}constructor(e={}){this.name=ra.id,this._operations=Array.isArray(e.operations)?e.operations:ta,this._describeOperations=!("describeOperations"in e)||e.describeOperations,this._useMongoose=!!e.useMongoose}loadDependency(){const e=this._useMongoose?"mongoose":"mongodb";return this._module=this._module||nn(e)}setupOnce(e,t){if(Ys(t))return void(zs&&je.log("Mongo Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(n)this._instrumentOperations(n.Collection,this._operations,t);else{const e=this._useMongoose?"mongoose":"mongodb";zs&&je.error(`Mongo Integration was unable to require \`${e}\` package.`)}}_instrumentOperations(e,t,n){t.forEach((t=>this._patchOperation(e,t,n)))}_patchOperation(e,t,n){if(!(t in e.prototype))return;const r=this._getSpanContextFromOperationArguments.bind(this);ze(e.prototype,t,(function(e){return function(...o){const s=o[o.length-1],a=n(),i=a.getScope(),c=a.getClient(),l=i.getSpan(),u=or([c,"optionalAccess",e=>e.getOptions,"call",e=>e(),"access",e=>e.sendDefaultPii]);if("function"!=typeof s||"mapReduce"===t&&2===o.length){const n=or([l,"optionalAccess",e=>e.startChild,"call",e=>e(r(this,t,o,u))]),s=e.call(this,...o);if(fe(s))return s.then((e=>(or([n,"optionalAccess",e=>e.end,"call",e=>e()]),e)));if((d=s)&&"object"==typeof d&&d.once&&"function"==typeof d.once){const e=s;try{e.once("close",(()=>{or([n,"optionalAccess",e=>e.end,"call",e=>e()])}))}catch(e){or([n,"optionalAccess",e=>e.end,"call",e=>e()])}return e}return or([n,"optionalAccess",e=>e.end,"call",e=>e()]),s}var d;const p=or([l,"optionalAccess",e=>e.startChild,"call",e=>e(r(this,t,o.slice(0,-1)))]);return e.call(this,...o.slice(0,-1),(function(e,t){or([p,"optionalAccess",e=>e.end,"call",e=>e()]),s(e,t)}))}}))}_getSpanContextFromOperationArguments(e,t,n,r=!1){const o={"db.system":"mongodb","db.name":e.dbName,"db.operation":t,"db.mongodb.collection":e.collectionName},s={op:"db",origin:"auto.db.mongo",description:t,data:o},a=na[t],i=Array.isArray(this._describeOperations)?this._describeOperations.includes(t):this._describeOperations;if(!a||!i||!r)return s;try{if("mapReduce"===t){const[e,t]=n;o[a[0]]="string"==typeof e?e:e.name||"<anonymous>",o[a[1]]="string"==typeof t?t:t.name||"<anonymous>"}else for(let e=0;e<a.length;e++)o[`db.mongodb.${a[e]}`]=JSON.stringify(n[e])}catch(e){}return s}}ra.__initStatic();class oa{static __initStatic(){this.id="Prisma"}constructor(e={}){if(this.name=oa.id,(t=e.client)&&t.$use&&!e.client._sentryInstrumented){Ye(e.client,"_sentryInstrumented",!0);const t={};try{const n=e.client._engineConfig;if(n){const{activeProvider:e,clientVersion:r}=n;e&&(t["db.system"]=e),r&&(t["db.prisma.version"]=r)}}catch(e){}e.client.$use(((e,n)=>{if(Ys(Kr))return n(e);const r=e.action,o=e.model;return ho({name:o?`${o} ${r}`:r,onlyIfParent:!0,op:"db.prisma",attributes:{[Io]:"auto.db.prisma"},data:{...t,"db.operation":r}},(()=>n(e)))}))}else zs&&je.warn("Unsupported Prisma client provided to PrismaIntegration. Provided client:",e.client);var t}setupOnce(){}}oa.__initStatic();class sa{static __initStatic(){this.id="GraphQL"}constructor(){this.name=sa.id}loadDependency(){return this._module=this._module||nn("graphql/execution/execute.js")}setupOnce(e,t){if(Ys(t))return void(zs&&je.log("GraphQL Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();n?ze(n,"execute",(function(e){return function(...n){const r=t().getScope(),o=r.getSpan(),s=or([o,"optionalAccess",e=>e.startChild,"call",e=>e({description:"execute",op:"graphql.execute",origin:"auto.graphql.graphql"})]);or([r,"optionalAccess",e=>e.setSpan,"call",e=>e(s)]);const a=e.call(this,...n);return fe(a)?a.then((e=>(or([s,"optionalAccess",e=>e.end,"call",e=>e()]),or([r,"optionalAccess",e=>e.setSpan,"call",e=>e(o)]),e))):(or([s,"optionalAccess",e=>e.end,"call",e=>e()]),or([r,"optionalAccess",e=>e.setSpan,"call",e=>e(o)]),a)}})):zs&&je.error("GraphQL Integration was unable to require graphql/execution package.")}}sa.__initStatic();class aa{static __initStatic(){this.id="Apollo"}constructor(e={useNestjs:!1}){this.name=aa.id,this._useNest=!!e.useNestjs}loadDependency(){return this._useNest?this._module=this._module||nn("@nestjs/graphql"):this._module=this._module||nn("apollo-server-core"),this._module}setupOnce(e,t){if(Ys(t))zs&&je.log("Apollo Integration is skipped because of instrumenter configuration.");else if(this._useNest){const e=this.loadDependency();if(!e)return void(zs&&je.error("Apollo-NestJS Integration was unable to require @nestjs/graphql package."));ze(e.GraphQLFactory.prototype,"mergeWithSchema",(function(e){return function(...n){return ze(this.resolversExplorerService,"explore",(function(e){return function(){return ia(bt(e.call(this)),t)}})),e.call(this,...n)}}))}else{const e=this.loadDependency();if(!e)return void(zs&&je.error("Apollo Integration was unable to require apollo-server-core package."));ze(e.ApolloServerBase.prototype,"constructSchema",(function(e){return function(){if(!this.config.resolvers)return zs&&(this.config.schema?(je.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `schema` property.If you are using NestJS with Apollo, please use `Sentry.Integrations.Apollo({ useNestjs: true })` instead."),je.warn()):this.config.modules&&je.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `modules` property."),je.error("Skipping tracing as no resolvers found on the `ApolloServer` instance.")),e.call(this);const n=bt(this.config.resolvers);return this.config.resolvers=ia(n,t),e.call(this)}}))}}}function ia(e,t){return e.map((e=>(Object.keys(e).forEach((n=>{Object.keys(e[n]).forEach((r=>{"function"==typeof e[n][r]&&function(e,t,n,r){ze(e[t],n,(function(e){return function(...o){const s=or([r().getScope().getSpan(),"optionalAccess",e=>e.startChild,"call",e=>e({description:`${t}.${n}`,op:"graphql.resolve",origin:"auto.graphql.apollo"})]),a=e.call(this,...o);return fe(a)?a.then((e=>(or([s,"optionalAccess",e=>e.end,"call",e=>e()]),e))):(or([s,"optionalAccess",e=>e.end,"call",e=>e()]),a)}}))}(e,n,r,t)}))})),e)))}aa.__initStatic();const ca=Re;function la(){ca.document?ca.document.addEventListener("visibilitychange",(()=>{const e=no();if(ca.document.hidden&&e){const t="cancelled",{op:n,status:r}=yr(e);zs&&je.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${n}`),r||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.end()}})):zs&&je.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const ua=(e,t,n)=>{let r,o;return s=>{t.value>=0&&(s||n)&&(o=t.value-(r||0),(o||void 0===r)&&(r=t.value,t.delta=o,e(t)))}},da=()=>ca.__WEB_VITALS_POLYFILL__?ca.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const e=ca.performance.timing,t=ca.performance.navigation.type,n={entryType:"navigation",startTime:0,type:2==t?"back_forward":1===t?"reload":"navigate"};for(const t in e)"navigationStart"!==t&&"toJSON"!==t&&(n[t]=Math.max(e[t]-e.navigationStart,0));return n})()):ca.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],pa=()=>{const e=da();return e&&e.activationStart||0},ha=(e,t)=>{const n=da();let r="navigate";return n&&(r=ca.document&&ca.document.prerendering||pa()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},fa=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver((e=>{t(e.getEntries())}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},ga=(e,t)=>{const n=r=>{"pagehide"!==r.type&&"hidden"!==ca.document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};ca.document&&(addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0))},ma=(e,t={})=>{const n=ha("CLS",0);let r,o=0,s=[];const a=e=>{e.forEach((e=>{if(!e.hadRecentInput){const t=s[0],a=s[s.length-1];o&&0!==s.length&&e.startTime-a.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,s.push(e)):(o=e.value,s=[e]),o>n.value&&(n.value=o,n.entries=s,r&&r())}}))},i=fa("layout-shift",a);if(i){r=ua(e,n,t.reportAllChanges);const o=()=>{a(i.takeRecords()),r(!0)};return ga(o),o}};let _a=-1;const ya=()=>(_a<0&&(ca.document&&ca.document.visibilityState&&(_a="hidden"!==ca.document.visibilityState||ca.document.prerendering?1/0:0),ga((({timeStamp:e})=>{_a=e}),!0)),{get firstHiddenTime(){return _a}}),va=e=>{const t=ya(),n=ha("FID");let r;const o=e=>{e.startTime<t.firstHiddenTime&&(n.value=e.processingStart-e.startTime,n.entries.push(e),r(!0))},s=e=>{e.forEach(o)},a=fa("first-input",s);r=ua(e,n),a&&ga((()=>{s(a.takeRecords()),a.disconnect()}),!0)};let Ta=0,Sa=1/0,ba=0;const Ea=e=>{e.forEach((e=>{e.interactionId&&(Sa=Math.min(Sa,e.interactionId),ba=Math.max(ba,e.interactionId),Ta=ba?(ba-Sa)/7+1:0)}))};let wa;const Aa=()=>{"interactionCount"in performance||wa||(wa=fa("event",Ea,{type:"event",buffered:!0,durationThreshold:0}))},Ia=()=>wa?Ta:performance.interactionCount||0,Ra=[],ka={},Ca=e=>{const t=Ra[Ra.length-1],n=ka[e.interactionId];if(n||Ra.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{const t={id:e.interactionId,latency:e.duration,entries:[e]};ka[t.id]=t,Ra.push(t)}Ra.sort(((e,t)=>t.latency-e.latency)),Ra.splice(10).forEach((e=>{delete ka[e.id]}))}},Oa=(e,t)=>{t=t||{},Aa();const n=ha("INP");let r;const o=e=>{e.forEach((e=>{if(e.interactionId&&Ca(e),"first-input"===e.entryType){!Ra.some((t=>t.entries.some((t=>e.duration===t.duration&&e.startTime===t.startTime))))&&Ca(e)}}));const t=(()=>{const e=Math.min(Ra.length-1,Math.floor(Ia()/50));return Ra[e]})();t&&t.latency!==n.value&&(n.value=t.latency,n.entries=t.entries,r())},s=fa("event",o,{durationThreshold:t.durationThreshold||40});r=ua(e,n,t.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),ga((()=>{o(s.takeRecords()),n.value<0&&Ia()>0&&(n.value=0,n.entries=[]),r(!0)})))},xa={},La=e=>{const t=ya(),n=ha("LCP");let r;const o=e=>{const o=e[e.length-1];if(o){const e=Math.max(o.startTime-pa(),0);e<t.firstHiddenTime&&(n.value=e,n.entries=[o],r())}},s=fa("largest-contentful-paint",o);if(s){r=ua(e,n);const t=()=>{xa[n.id]||(o(s.takeRecords()),s.disconnect(),xa[n.id]=!0,r(!0))};return["keydown","click"].forEach((e=>{ca.document&&addEventListener(e,t,{once:!0,capture:!0})})),ga(t,!0),t}},Na=e=>{ca.document&&(ca.document.prerendering?addEventListener("prerenderingchange",(()=>Na(e)),!0):"complete"!==ca.document.readyState?addEventListener("load",(()=>Na(e)),!0):setTimeout(e,0))},Pa=(e,t)=>{t=t||{};const n=ha("TTFB"),r=ua(e,n,t.reportAllChanges);Na((()=>{const e=da();if(e){if(n.value=Math.max(e.responseStart-pa(),0),n.value<0||n.value>performance.now())return;n.entries=[e],r(!0)}}))},Da={},Ma={};let Ua,$a,Fa,Ga,ja;function Va(e,t=!1){return Xa("lcp",e,Ja,Fa,t)}function Wa(e,t){return Ka(e,t),Ma[e]||(!function(e){const t={};"event"===e&&(t.durationThreshold=0);fa(e,(t=>{qa(e,{entries:t})}),t)}(e),Ma[e]=!0),Qa(e,t)}function qa(e,t){const n=Da[e];if(n&&n.length)for(const r of n)try{r(t)}catch(t){zs&&je.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${ct(r)}\nError:`,t)}}function Ba(){return ma((e=>{qa("cls",{metric:e}),Ua=e}),{reportAllChanges:!0})}function Ha(){return va((e=>{qa("fid",{metric:e}),$a=e}))}function Ja(){return La((e=>{qa("lcp",{metric:e}),Fa=e}))}function za(){return Pa((e=>{qa("ttfb",{metric:e}),Ga=e}))}function Ya(){return Oa((e=>{qa("inp",{metric:e}),ja=e}))}function Xa(e,t,n,r,o=!1){let s;return Ka(e,t),Ma[e]||(s=n(),Ma[e]=!0),r&&t({metric:r}),Qa(e,t,o?s:void 0)}function Ka(e,t){Da[e]=Da[e]||[],Da[e].push(t)}function Qa(e,t,n){return()=>{n&&n();const r=Da[e];if(!r)return;const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}function Za(e){return"number"==typeof e&&isFinite(e)}function ei(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}const ti=2147483647;function ni(e){return e/1e3}function ri(){return ca&&ca.addEventListener&&ca.performance}let oi,si,ai=0,ii={};function ci(){const e=ri();if(e&&xn){e.mark&&ca.performance.mark("sentry-tracing-init");const t=Xa("fid",(({metric:e})=>{const t=e.entries[e.entries.length-1];if(!t)return;const n=ni(xn),r=ni(t.startTime);zs&&je.log("[Measurements] Adding FID"),ii.fid={value:e.value,unit:"millisecond"},ii["mark.fid"]={value:n+r,unit:"second"}}),Ha,$a),n=function(e,t=!1){return Xa("cls",e,Ba,Ua,t)}((({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(zs&&je.log("[Measurements] Adding CLS"),ii.cls={value:e.value,unit:""},si=t)}),!0),r=Va((({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(zs&&je.log("[Measurements] Adding LCP"),ii.lcp={value:e.value,unit:"millisecond"},oi=t)}),!0),o=function(e){return Xa("ttfb",e,za,Ga)}((({metric:e})=>{e.entries[e.entries.length-1]&&(zs&&je.log("[Measurements] Adding TTFB"),ii.ttfb={value:e.value,unit:"millisecond"})}));return()=>{t(),n(),r(),o()}}return()=>{}}function li(){Wa("longtask",(({entries:e})=>{for(const t of e){const e=no();if(!e)return;const n=ni(xn+t.startTime),r=ni(t.duration);e.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+r})}}))}function ui(){Wa("event",(({entries:e})=>{for(const t of e){const e=no();if(!e)return;if("click"===t.name){const n=ni(xn+t.startTime),r=ni(t.duration),o={description:Le(t.target),op:`ui.interaction.${t.name}`,origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+r},s=Me(t.target);s&&(o.attributes={"ui.component_name":s}),e.startChild(o)}}}))}function di(e,t){if(ri()&&xn){const n=function(e,t){return n=({metric:n})=>{if(void 0===n.value)return;const r=n.entries.find((e=>e.duration===n.value&&void 0!==pi[e.name])),o=Or();if(!r||!o)return;const s=pi[r.name],a=o.getOptions(),i=ni(xn+r.startTime),c=ni(n.value),l=void 0!==r.interactionId?e[r.interactionId]:void 0;if(void 0===l)return;const{routeName:u,parentContext:d,activeTransaction:p,user:h,replayId:f}=l,g=void 0!==h?h.email||h.id||h.ip_address:void 0,m=void 0!==p?p.getProfileId():void 0,_=new ko({startTimestamp:i,endTimestamp:i+c,op:`ui.interaction.${s}`,name:Le(r.target),attributes:{release:a.release,environment:a.environment,transaction:u,...void 0!==g&&""!==g?{user:g}:{},...void 0!==m?{profile_id:m}:{},...void 0!==f?{replay_id:f}:{}},exclusiveTime:n.value,measurements:{inp:{value:n.value,unit:"millisecond"}}}),y=function(e,t,n){if(!po(t))return!1;let r;return r=void 0!==e&&"function"==typeof t.tracesSampler?t.tracesSampler({transactionContext:e,name:e.name,parentSampled:e.parentSampled,attributes:{...e.data,...e.attributes},location:ca.location}):void 0!==e&&void 0!==e.sampled?e.sampled:void 0!==t.tracesSampleRate?t.tracesSampleRate:1,Do(r)?!0===r?n:!1===r?0:r*n:(zs&&je.warn("[Tracing] Discarding interaction span because of invalid sample rate."),!1)}(d,a,t);if(y&&Math.random()<y){const e=_?function(e,t){const n={sent_at:(new Date).toISOString()};return t&&(n.dsn=We(t)),Wn(n,e.map(_s))}([_],o.getDsn()):void 0,t=o&&o.getTransport();t&&e&&t.send(e).then(null,(e=>{zs&&je.error("Error while sending interaction:",e)}))}},Xa("inp",n,Ya,ja);var n}(e,t);return()=>{n()}}return()=>{}}const pi={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function hi(e){const t=ri();if(!t||!ca.performance.getEntries||!xn)return;zs&&je.log("[Tracing] Adding & adjusting spans using Performance API");const n=ni(xn),r=t.getEntries(),{op:o,start_timestamp:s}=yr(e);if(r.slice(ai).forEach((t=>{const r=ni(t.startTime),o=ni(t.duration);if(!("navigation"===e.op&&s&&n+r<s))switch(t.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((r=>{fi(e,t,r,n)})),fi(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),fi(e,t,"fetch",n,"cache","domainLookupStart"),fi(e,t,"domainLookup",n,"DNS"),function(e,t,n){t.responseEnd&&(ei(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+ni(t.requestStart),endTimestamp:n+ni(t.responseEnd)}),ei(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+ni(t.responseStart),endTimestamp:n+ni(t.responseEnd)}))}(e,t,n)}(e,t,n);break;case"mark":case"paint":case"measure":{!function(e,t,n,r,o){const s=o+n,a=s+r;ei(e,{description:t.name,endTimestamp:a,op:t.entryType,origin:"auto.resource.browser.metrics",startTimestamp:s})}(e,t,r,o,n);const s=ya(),a=t.startTime<s.firstHiddenTime;"first-paint"===t.name&&a&&(zs&&je.log("[Measurements] Adding FP"),ii.fp={value:t.startTime,unit:"millisecond"}),"first-contentful-paint"===t.name&&a&&(zs&&je.log("[Measurements] Adding FCP"),ii.fcp={value:t.startTime,unit:"millisecond"});break}case"resource":!function(e,t,n,r,o,s){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const a=_n(n),i={};gi(i,t,"transferSize","http.response_transfer_size"),gi(i,t,"encodedBodySize","http.response_content_length"),gi(i,t,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in t&&(i["resource.render_blocking_status"]=t.renderBlockingStatus);a.protocol&&(i["url.scheme"]=a.protocol.split(":").pop());a.host&&(i["server.address"]=a.host);i["url.same_origin"]=n.includes(ca.location.origin);const c=s+r,l=c+o;ei(e,{description:n.replace(ca.location.origin,""),endTimestamp:l,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:c,data:i})}(e,t,t.name,r,o,n)}})),ai=Math.max(r.length-1,0),function(e){const t=ca.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),Za(n.rtt)&&(ii["connection.rtt"]={value:n.rtt,unit:"millisecond"}));Za(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`);Za(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===o){!function(e){const t=da();if(!t)return;const{responseStart:n,requestStart:r}=t;r<=n&&(zs&&je.log("[Measurements] Adding TTFB Request Time"),e["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}(ii),["fcp","fp","lcp"].forEach((e=>{if(!ii[e]||!s||n>=s)return;const t=ii[e].value,r=n+ni(t),o=Math.abs(1e3*(r-s)),a=o-t;zs&&je.log(`[Measurements] Normalized ${e} from ${t} to ${o} (${a})`),ii[e].value=o}));const t=ii["mark.fid"];t&&ii.fid&&(ei(e,{description:"first input delay",endTimestamp:t.value+ni(ii.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:t.value}),delete ii["mark.fid"]),"fcp"in ii||delete ii.cls,Object.keys(ii).forEach((e=>{Go(e,ii[e].value,ii[e].unit)})),function(e){oi&&(zs&&je.log("[Measurements] Adding LCP Data"),oi.element&&e.setTag("lcp.element",Le(oi.element)),oi.id&&e.setTag("lcp.id",oi.id),oi.url&&e.setTag("lcp.url",oi.url.trim().slice(0,200)),e.setTag("lcp.size",oi.size));si&&si.sources&&(zs&&je.log("[Measurements] Adding CLS Data"),si.sources.forEach(((t,n)=>e.setTag(`cls.source.${n+1}`,Le(t.node)))))}(e)}oi=void 0,si=void 0,ii={}}function fi(e,t,n,r,o,s){const a=s?t[s]:t[`${n}End`],i=t[`${n}Start`];i&&a&&ei(e,{op:"browser",origin:"auto.browser.browser.metrics",description:o||n,startTimestamp:r+ni(i),endTimestamp:r+ni(a)})}function gi(e,t,n,r){const o=t[n];null!=o&&o<ti&&(e[r]=o)}function mi(e,t,n,r,o="auto.http.browser"){if(!po()||!e.fetchData)return;const s=t(e.fetchData.url);if(e.endTimestamp&&s){const t=e.fetchData.__span;if(!t)return;const n=r[t];return void(n&&(!function(e,t){if(t.response){lo(e,t.response.status);const n=t.response&&t.response.headers&&t.response.headers.get("content-length");if(n){const t=parseInt(n);t>0&&e.setAttribute("http.response_content_length",t)}}else t.error&&e.setStatus("internal_error");e.end()}(n,e),delete r[t]))}const a=xr(),i=Or(),{method:c,url:l}=e.fetchData,u=function(e){try{return new URL(e).href}catch(e){return}}(l),d=u?_n(u).host:void 0,p=s?fo({name:`${c} ${l}`,onlyIfParent:!0,attributes:{url:l,type:"fetch","http.method":c,"http.url":u,"server.address":d,[Io]:o},op:"http.client"}):void 0;if(p&&(e.fetchData.__span=p.spanContext().spanId,r[p.spanContext().spanId]=p),n(e.fetchData.url)&&i){const t=e.args[0];e.args[1]=e.args[1]||{};const n=e.args[1];n.headers=function(e,t,n,r,o){const s=o||n.getSpan(),a=Qr(),{traceId:i,spanId:c,sampled:l,dsc:u}={...a.getPropagationContext(),...n.getPropagationContext()},d=s?gr(s):Vn(i,c,l),p=Un(u||(s?$r(s):Ur(i,t,n))),h=r.headers||("undefined"!=typeof Request&&me(e,Request)?e.headers:void 0);if(h){if("undefined"!=typeof Headers&&me(h,Headers)){const e=new Headers(h);return e.append("sentry-trace",d),p&&e.append(Ln,p),e}if(Array.isArray(h)){const e=[...h,["sentry-trace",d]];return p&&e.push([Ln,p]),e}{const e="baggage"in h?h.baggage:void 0,t=[];return Array.isArray(e)?t.push(...e):e&&t.push(e),p&&t.push(p),{...h,"sentry-trace":d,baggage:t.length>0?t.join(","):void 0}}}return{"sentry-trace":d,baggage:p}}(t,i,a,n,p)}return p}const _i=["localhost",/^\/(?!\/)/],yi={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:_i,tracePropagationTargets:_i};function vi(e){const{traceFetch:t,traceXHR:n,tracePropagationTargets:r,tracingOrigins:o,shouldCreateSpanForRequest:s,enableHTTPTimings:a}={traceFetch:yi.traceFetch,traceXHR:yi.traceXHR,...e},i="function"==typeof s?s:e=>!0,c=e=>function(e,t){return Se(e,t||_i)}(e,r||o),l={};t&&Dt((e=>{const t=mi(e,i,c,l);if(t){const n=bi(e.fetchData.url),r=n?_n(n).host:void 0;t.setAttributes({"http.url":n,"server.address":r})}a&&t&&Ti(t)})),n&&Qt((e=>{const t=function(e,t,n,r){const o=e.xhr,s=o&&o[Kt];if(!po()||!o||o.__sentry_own_request__||!s)return;const a=t(s.url);if(e.endTimestamp&&a){const e=o.__sentry_xhr_span_id__;if(!e)return;const t=r[e];return void(t&&void 0!==s.status_code&&(lo(t,s.status_code),t.end(),delete r[e]))}const i=xr(),c=Qr(),l=bi(s.url),u=l?_n(l).host:void 0,d=a?fo({name:`${s.method} ${s.url}`,onlyIfParent:!0,attributes:{type:"xhr","http.method":s.method,"http.url":l,url:s.url,"server.address":u,[Io]:"auto.http.browser"},op:"http.client"}):void 0;d&&(o.__sentry_xhr_span_id__=d.spanContext().spanId,r[o.__sentry_xhr_span_id__]=d);const p=Or();if(o.setRequestHeader&&n(s.url)&&p){const{traceId:e,spanId:t,sampled:n,dsc:r}={...c.getPropagationContext(),...i.getPropagationContext()};!function(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader(Ln,n)}catch(e){}}(o,d?gr(d):Vn(e,t,n),Un(r||(d?$r(d):Ur(e,p,i))))}return d}(e,i,c,l);a&&t&&Ti(t)}))}function Ti(e){const{url:t}=yr(e).data||{};if(!t||"string"!=typeof t)return;const n=Wa("resource",(({entries:r})=>{r.forEach((r=>{if(function(e){return"resource"===e.entryType&&"initiatorType"in e&&"string"==typeof e.nextHopProtocol&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)}(r)&&r.name.endsWith(t)){(function(e){const{name:t,version:n}=function(e){let t="unknown",n="unknown",r="";for(const o of e){if("/"===o){[t,n]=e.split("/");break}if(!isNaN(Number(o))){t="h"===r?"http":r,n=e.split(r)[1];break}r+=o}r===e&&(t=r);return{name:t,version:n}}(e.nextHopProtocol),r=[];if(r.push(["network.protocol.version",n],["network.protocol.name",t]),!xn)return r;return[...r,["http.request.redirect_start",Si(e.redirectStart)],["http.request.fetch_start",Si(e.fetchStart)],["http.request.domain_lookup_start",Si(e.domainLookupStart)],["http.request.domain_lookup_end",Si(e.domainLookupEnd)],["http.request.connect_start",Si(e.connectStart)],["http.request.secure_connection_start",Si(e.secureConnectionStart)],["http.request.connection_end",Si(e.connectEnd)],["http.request.request_start",Si(e.requestStart)],["http.request.response_start",Si(e.responseStart)],["http.request.response_end",Si(e.responseEnd)]]})(r).forEach((t=>e.setAttribute(...t))),setTimeout(n)}}))}))}function Si(e=0){return((xn||performance.timeOrigin)+e)/1e3}function bi(e){try{return new URL(e,ca.location.origin).href}catch(e){return}}const Ei={...Oo,markBackgroundTransactions:!0,routingInstrumentation:function(e,t=!0,n=!0){if(!ca||!ca.location)return void(zs&&je.warn("Could not initialize routing instrumentation due to invalid location"));let r,o=ca.location.href;t&&(r=e({name:ca.location.pathname,startTimestamp:xn?xn/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&zt((({to:t,from:n})=>{void 0===n&&o&&-1!==o.indexOf(t)?o=void 0:n!==t&&(o=void 0,r&&(zs&&je.log(`[Tracing] Finishing current transaction with op: ${r.op}`),r.end()),r=e({name:ca.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))}))},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...yi};function wi(e){const t=De(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}function Ai(e){const t=e.attributes&&e.attributes[Eo],n=e.data&&e.data[Eo],r=e.metadata&&e.metadata.source;return t||n||r}const Ii={...Oo,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...yi};function Ri(e,t){if(!e.emit)return;e.emit("startPageLoadSpan",t);const n=go();return"pageload"===(n&&yr(n).op)?n:void 0}function ki(e,t){if(!e.emit)return;e.emit("startNavigationSpan",t);const n=go();return"navigation"===(n&&yr(n).op)?n:void 0}function Ci(e){const t=De(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}const Oi=10;function xi(e){const t=e.attributes&&e.attributes[Eo],n=e.data&&e.data[Eo],r=e.metadata&&e.metadata.source;return t||n||r}const Li=Re;let Ni=0;function Pi(){return Ni>0}function Di(e,t={},n){if("function"!=typeof e)return e;try{const t=e.__sentry_wrapped__;if(t)return t;if(Ke(e))return e}catch(t){return e}const r=function(){const r=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);const o=r.map((e=>Di(e,t)));return e.apply(this,o)}catch(e){throw Ni++,setTimeout((()=>{Ni--})),Cr((n=>{n.addEventProcessor((e=>(t.mechanism&&(vt(e,void 0,void 0),Tt(e,t.mechanism)),e.extra={...e.extra,arguments:r},e))),wr(e)})),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}catch(e){}Xe(r,e),Ye(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:()=>e.name})}catch(e){}return r}const Mi="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Ui(e,t){const n=Fi(e,t),r={type:t&&t.name,value:ji(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function $i(e,t){return{exception:{values:[Ui(e,t)]}}}function Fi(e,t){const n=t.stacktrace||t.stack||"",r=function(e){if(e){if("number"==typeof e.framesToPop)return e.framesToPop;if(Gi.test(e.message))return 1}return 0}(t);try{return e(n,r)}catch(e){}return[]}const Gi=/Minified React error #\d+;/i;function ji(e){const t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Vi(e,t,n,r){const o=qi(e,t,n&&n.syntheticException||void 0,r);return Tt(o),o.level="error",n&&n.event_id&&(o.event_id=n.event_id),hn(o)}function Wi(e,t,n="info",r,o){const s=Bi(e,t,r&&r.syntheticException||void 0,o);return s.level=n,r&&r.event_id&&(s.event_id=r.event_id),hn(s)}function qi(e,t,n,r,o){let s;if(ae(t)&&t.error){return $i(e,t.error)}if(ie(t)||se(t,"DOMException")){const o=t;if("stack"in t)s=$i(e,t);else{const t=o.name||(ie(o)?"DOMError":"DOMException"),a=o.message?`${t}: ${o.message}`:t;s=Bi(e,a,n,r),vt(s,a)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}if(oe(t))return $i(e,t);if(de(t)||pe(t)){return s=function(e,t,n,r){const o=Or(),s=o&&o.getOptions().normalizeDepth,a={exception:{values:[{type:pe(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:Hi(t,{isUnhandledRejection:r})}]},extra:{__serialized__:sn(t,s)}};if(n){const t=Fi(e,n);t.length&&(a.exception.values[0].stacktrace={frames:t})}return a}(e,t,n,o),Tt(s,{synthetic:!0}),s}return s=Bi(e,t,n,r),vt(s,`${t}`,void 0),Tt(s,{synthetic:!0}),s}function Bi(e,t,n,r){const o={};if(r&&n){const r=Fi(e,n);r.length&&(o.exception={values:[{value:t,stacktrace:{frames:r}}]})}if(le(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return o.logentry={message:e,params:n},o}return o.message=t,o}function Hi(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(Qe(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return ye(n[0],t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:ye(r,t)}return""}(e),r=t?"promise rejection":"exception";if(ae(e))return`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``;if(pe(e)){return`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${r}`}return`Object captured as ${r} with keys: ${n}`}function Ji(e,{metadata:t,tunnel:n,dsn:r}){const o={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:We(r)}},s=function(e){return[{type:"user_report"},e]}(e);return Wn(o,[s])}class zi extends ns{constructor(e){!function(e,t,n=[t],r="npm"){const o=e._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${t}`,packages:n.map((e=>({name:`${r}:@sentry/${e}`,version:Br}))),version:Br}),e._metadata=o}(e,"browser",["browser"],Li.SENTRY_SDK_SOURCE||"npm"),super(e),e.sendClientReports&&Li.document&&Li.document.addEventListener("visibilitychange",(()=>{"hidden"===Li.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return Vi(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return Wi(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(Mi&&je.warn("SDK not enabled, will not capture user feedback."));const t=Ji(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}_flushOutcomes(){const e=this._clearOutcomes();if(0===e.length)return void(Mi&&je.log("No outcomes to send"));if(!this._dsn)return void(Mi&&je.log("No dsn provided, will not send outcomes"));Mi&&je.log("Sending outcomes:",e);const t=(n=e,Wn((r=this._options.tunnel&&We(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:o||Cn(),discarded_events:n}]]));var n,r,o;this._sendEnvelope(t)}}let Yi;function Xi(e,t=function(){if(Yi)return Yi;if(Nt(Li.fetch))return Yi=Li.fetch.bind(Li);const e=Li.document;let t=Li.fetch;if(e&&"function"==typeof e.createElement)try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(t=r.fetch),e.head.removeChild(n)}catch(e){Mi&&je.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return Yi=t.bind(Li)}()){let n=0,r=0;return ls(e,(function(o){const s=o.body.length;n+=s,r++;const a={body:o.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};try{return t(e.url,a).then((e=>(n-=s,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return Yi=void 0,n-=s,r--,fn(e)}}))}const Ki=4;function Qi(e){return ls(e,(function(t){return new gn(((n,r)=>{const o=new XMLHttpRequest;o.onerror=r,o.onreadystatechange=()=>{o.readyState===Ki&&n({statusCode:o.status,headers:{"x-sentry-rate-limits":o.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":o.getResponseHeader("Retry-After")}})},o.open("POST",e.url);for(const t in e.headers)Object.prototype.hasOwnProperty.call(e.headers,t)&&o.setRequestHeader(t,e.headers[t]);o.send(t.body)}))}))}const Zi="?";function ec(e,t,n,r){const o={filename:e,function:t,in_app:!0};return void 0!==n&&(o.lineno=n),void 0!==r&&(o.colno=r),o}const tc=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,nc=/\((\S*)(?::(\d+))(?::(\d+))\)/,rc=[30,e=>{const t=tc.exec(e);if(t){if(t[2]&&0===t[2].indexOf("eval")){const e=nc.exec(t[2]);e&&(t[2]=e[1],t[3]=e[2],t[4]=e[3])}const[e,n]=gc(t[1]||Zi,t[2]);return ec(n,e,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],oc=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,sc=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,ac=[50,e=>{const t=oc.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=sc.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||Zi;return[n,e]=gc(n,e),ec(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}],ic=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,cc=[40,e=>{const t=ic.exec(e);return t?ec(t[2],t[1]||Zi,+t[3],t[4]?+t[4]:void 0):void 0}],lc=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,uc=[10,e=>{const t=lc.exec(e);return t?ec(t[2],t[3]||Zi,+t[1]):void 0}],dc=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,pc=[20,e=>{const t=dc.exec(e);return t?ec(t[5],t[3]||t[4]||Zi,+t[1],+t[2]):void 0}],hc=[rc,ac,cc],fc=at(...hc),gc=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:Zi,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},mc=1024,_c="Breadcrumbs",yc=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:_c,setupOnce(){},setup(e){t.console&&ft(function(e){return function(t){if(Or()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:Rn(t.level),message:Te(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${Te(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}Rr(n,{input:t.args,level:t.level})}}(e)),t.dom&&kt(function(e,t){return function(n){if(Or()!==e)return;let r,o,s="object"==typeof t?t.serializeAttribute:void 0,a="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;a&&a>mc&&(Mi&&je.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${a} was configured. Sentry will use 1024 instead.`),a=mc),"string"==typeof s&&(s=[s]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;r=Le(t,{keyAttrs:s,maxStringLength:a}),o=Me(t)}catch(e){r="<unknown>"}if(0===r.length)return;const i={category:`ui.${n.name}`,message:r};o&&(i.data={"ui.component_name":o}),Rr(i,{event:n.event,name:n.name,global:n.global})}}(e,t.dom)),t.xhr&&Qt(function(e){return function(t){if(Or()!==e)return;const{startTimestamp:n,endTimestamp:r}=t,o=t.xhr[Kt];if(!n||!r||!o)return;const{method:s,url:a,status_code:i,body:c}=o;Rr({category:"xhr",data:{method:s,url:a,status_code:i},type:"http"},{xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:r})}}(e)),t.fetch&&Dt(function(e){return function(t){if(Or()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error){Rr({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args,startTimestamp:n,endTimestamp:r})}else{const e=t.response;Rr({category:"fetch",data:{...t.fetchData,status_code:e&&e.status},type:"http"},{input:t.args,response:e,startTimestamp:n,endTimestamp:r})}}}(e)),t.history&&zt(function(e){return function(t){if(Or()!==e)return;let n=t.from,r=t.to;const o=_n(Li.location.href);let s=n?_n(n):void 0;const a=_n(r);s&&s.path||(s=o),o.protocol===a.protocol&&o.host===a.host&&(r=a.relative),o.protocol===s.protocol&&o.host===s.host&&(n=s.relative),Rr({category:"navigation",data:{from:n,to:r}})}}(e)),t.sentry&&e.on&&e.on("beforeSendEvent",function(e){return function(t){Or()===e&&Rr({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:yt(t)},{event:t})}}(e))}}},vc=Xo(_c,yc);const Tc="Dedupe",Sc=()=>{let e;return{name:Tc,setupOnce(){},processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!wc(e,t))return!1;if(!Ec(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=Ac(t),r=Ac(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!wc(e,t))return!1;if(!Ec(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return Mi&&je.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}},bc=Xo(Tc,Sc);function Ec(e,t){let n=Ic(e),r=Ic(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],o=n[e];if(t.filename!==o.filename||t.lineno!==o.lineno||t.colno!==o.colno||t.function!==o.function)return!1}return!0}function wc(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function Ac(e){return e.exception&&e.exception.values&&e.exception.values[0]}function Ic(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}}const Rc="GlobalHandlers",kc=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:Rc,setupOnce(){Error.stackTraceLimit=50},setup(e){t.onerror&&(!function(e){Gt((t=>{const{stackParser:n,attachStacktrace:r}=Lc();if(Or()!==e||Pi())return;const{msg:o,url:s,line:a,column:i,error:c}=t,l=void 0===c&&ce(o)?function(e,t,n,r){const o=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=ae(e)?e.message:e,a="Error";const i=s.match(o);i&&(a=i[1],s=i[2]);const c={exception:{values:[{type:a,value:s}]}};return Oc(c,t,n,r)}(o,s,a,i):Oc(qi(n,c||o,void 0,r,!1),s,a,i);l.level="error",Ir(l,{originalException:c,mechanism:{handled:!1,type:"onerror"}})}))}(e),xc("onerror")),t.onunhandledrejection&&(!function(e){Wt((t=>{const{stackParser:n,attachStacktrace:r}=Lc();if(Or()!==e||Pi())return;const o=function(e){if(ue(e))return e;const t=e;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch(e){}return e}(t),s=ue(o)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(o)}`}]}}:qi(n,o,void 0,r,!0);s.level="error",Ir(s,{originalException:o,mechanism:{handled:!1,type:"onunhandledrejection"}})}))}(e),xc("onunhandledrejection"))}}},Cc=Xo(Rc,kc);function Oc(e,t,n,r){const o=e.exception=e.exception||{},s=o.values=o.values||[],a=s[0]=s[0]||{},i=a.stacktrace=a.stacktrace||{},c=i.frames=i.frames||[],l=isNaN(parseInt(r,10))?void 0:r,u=isNaN(parseInt(n,10))?void 0:n,d=ce(t)&&t.length>0?t:Pe();return 0===c.length&&c.push({colno:l,filename:d,function:"?",in_app:!0,lineno:u}),e}function xc(e){Mi&&je.log(`Global Handler attached: ${e}`)}function Lc(){const e=Or();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Nc="HttpContext",Pc=()=>({name:Nc,setupOnce(){},preprocessEvent(e){if(!Li.navigator&&!Li.location&&!Li.document)return;const t=e.request&&e.request.url||Li.location&&Li.location.href,{referrer:n}=Li.document||{},{userAgent:r}=Li.navigator||{},o={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...e.request,...t&&{url:t},headers:o};e.request=s}}),Dc=Xo(Nc,Pc),Mc="LinkedErrors",Uc=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:Mc,setupOnce(){},preprocessEvent(e,r,o){const s=o.getOptions();be(Ui,s.stackParser,s.maxValueLength,n,t,e,r)}}},$c=Xo(Mc,Uc),Fc=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Gc="TryCatch",jc=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:Gc,setupOnce(){t.setTimeout&&ze(Li,"setTimeout",Wc),t.setInterval&&ze(Li,"setInterval",Wc),t.requestAnimationFrame&&ze(Li,"requestAnimationFrame",qc),t.XMLHttpRequest&&"XMLHttpRequest"in Li&&ze(XMLHttpRequest.prototype,"send",Bc);const e=t.eventTarget;if(e){(Array.isArray(e)?e:Fc).forEach(Hc)}}}},Vc=Xo(Gc,jc);function Wc(e){return function(...t){const n=t[0];return t[0]=Di(n,{mechanism:{data:{function:ct(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function qc(e){return function(t){return e.apply(this,[Di(t,{mechanism:{data:{function:"requestAnimationFrame",handler:ct(e)},handled:!1,type:"instrument"}})])}}function Bc(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"==typeof n[e]&&ze(n,e,(function(t){const n={mechanism:{data:{function:e,handler:ct(t)},handled:!1,type:"instrument"}},r=Ke(t);return r&&(n.mechanism.data.handler=ct(r)),Di(t,n)}))})),e.apply(this,t)}}function Hc(e){const t=Li,n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(ze(n,"addEventListener",(function(t){return function(n,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=Di(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:ct(r),target:e},handled:!1,type:"instrument"}}))}catch(e){}return t.apply(this,[n,Di(r,{mechanism:{data:{function:"addEventListener",handler:ct(r),target:e},handled:!1,type:"instrument"}}),o])}})),ze(n,"removeEventListener",(function(e){return function(t,n,r){const o=n;try{const n=o&&o.__sentry_wrapped__;n&&e.call(this,t,n,r)}catch(e){}return e.call(this,t,o,r)}})))}const Jc=[xs(),Us(),jc(),yc(),kc(),Uc(),Sc(),Pc()];function zc(e){return[...Jc]}function Yc(e={}){void 0===e.defaultIntegrations&&(e.defaultIntegrations=zc()),void 0===e.release&&("string"==typeof __SENTRY_RELEASE__&&(e.release=__SENTRY_RELEASE__),Li.SENTRY_RELEASE&&Li.SENTRY_RELEASE.id&&(e.release=Li.SENTRY_RELEASE.id)),void 0===e.autoSessionTracking&&(e.autoSessionTracking=!0),void 0===e.sendClientReports&&(e.sendClientReports=!0);const t={...e,stackParser:(n=e.stackParser||fc,Array.isArray(n)?at(...n):n),integrations:Jo(e),transport:e.transport||(Lt()?Xi:Qi)};var n;!function(e,t){!0===t.debug&&(sr?je.enable():Ge((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}))),xr().update(t.initialScope);const n=new e(t);is(n),function(e){e.init?e.init():e.setupIntegrations&&e.setupIntegrations()}(n)}(zi,t),e.autoSessionTracking&&function(){if(void 0===Li.document)return void(Mi&&je.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));Lr({ignoreDuration:!0}),Dr(),zt((({from:e,to:t})=>{void 0!==e&&e!==t&&(Lr({ignoreDuration:!0}),Dr())}))}()}var Xc=Object.freeze({__proto__:null,GlobalHandlers:Cc,TryCatch:Vc,Breadcrumbs:vc,LinkedErrors:$c,HttpContext:Dc,Dedupe:bc});const Kc=Re,Qc="sentryReplaySession",Zc="replay_event",el="Unable to send Replay",tl=15e4,nl=5e3,rl=2e7,ol=36e5;function sl(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}var al;function il(e){const t=sl([e,"optionalAccess",e=>e.host]);return Boolean(sl([t,"optionalAccess",e=>e.shadowRoot])===e)}function cl(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function ll(e){try{const n=e.rules||e.cssRules;return n?((t=Array.from(n,ul).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}var t}function ul(e){let t;if(function(e){return"styleSheet"in e}(e))try{t=ll(e.styleSheet)||function(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if(function(e){return"selectorText"in e}(e)&&e.selectorText.includes(":"))return function(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}(e.cssText);return t||e.cssText}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(al||(al={}));class dl{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){if(!e)return-1;const t=sl([this,"access",e=>e.getMeta,"call",t=>t(e),"optionalAccess",e=>e.id]);return r=()=>-1,null!=(n=t)?n:r();var n,r}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach((e=>this.removeNodeFromMap(e)))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){const n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){const n=this.getNode(e);if(n){const e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function pl({maskInputOptions:e,tagName:t,type:n}){return"OPTION"===t&&(t="SELECT"),Boolean(e[t.toLowerCase()]||n&&e[n]||"password"===n||"INPUT"===t&&!n&&e.text)}function hl({isMasked:e,element:t,value:n,maskInputFn:r}){let o=n||"";return e?(r&&(o=r(o,t)),"*".repeat(o.length)):o}function fl(e){return e.toLowerCase()}function gl(e){return e.toUpperCase()}const ml="__rrweb_original__";function _l(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?fl(t):null}function yl(e,t,n){return"INPUT"!==t||"radio"!==n&&"checkbox"!==n?e.value:e.getAttribute("value")||""}let vl=1;const Tl=new RegExp("[^a-z0-9-_:]"),Sl=-2;function bl(){return vl++}let El,wl;const Al=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Il=/^(?:[a-z+]+:)?\/\//i,Rl=/^www\..*/i,kl=/^(data:)([^,]*),(.*)/i;function Cl(e,t){return(e||"").replace(Al,((e,n,r,o,s,a)=>{const i=r||s||a,c=n||o||"";if(!i)return e;if(Il.test(i)||Rl.test(i))return`url(${c}${i}${c})`;if(kl.test(i))return`url(${c}${i}${c})`;if("/"===i[0])return`url(${c}${function(e){let t="";return t=e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0],t=t.split("?")[0],t}(t)+i}${c})`;const l=t.split("/"),u=i.split("/");l.pop();for(const e of u)"."!==e&&(".."===e?l.pop():l.push(e));return`url(${c}${l.join("/")}${c})`}))}const Ol=/^[^ \t\n\r\u000c]+/,xl=/^[, \t\n\r\u000c]+/;function Ll(e,t){if(!t||""===t.trim())return t;const n=e.createElement("a");return n.href=t,n.href}function Nl(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function Pl(){const e=document.createElement("a");return e.href="",e.href}function Dl(e,t,n,r,o,s){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?Ll(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;const o=e.exec(t.substring(n));return o?(r=o[0],n+=r.length,r):""}const o=[];for(;r(xl),!(n>=t.length);){let s=r(Ol);if(","===s.slice(-1))s=Ll(e,s.substring(0,s.length-1)),o.push(s);else{let r="";s=Ll(e,s);let a=!1;for(;;){const e=t.charAt(n);if(""===e){o.push((s+r).trim());break}if(a)")"===e&&(a=!1);else{if(","===e){n+=1,o.push((s+r).trim());break}"("===e&&(a=!0)}r+=e,n+=1}}}return o.join(", ")}(e,r):"style"===n?Cl(r,Pl()):"object"===t&&"data"===n?Ll(e,r):"function"==typeof s?s(n,r,o):r:Ll(e,r):r}function Ml(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function Ul(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:Ul(e.parentNode,t,n,r+1):-1}function $l(e,t){return n=>{const r=n;if(null===r)return!1;try{if(e)if("string"==typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}catch(e){return!1}}}function Fl(e,t,n,r,o,s){try{const a=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===a)return!1;if("INPUT"===a.tagName){const e=a.getAttribute("autocomplete");if(["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"].includes(e))return!0}let i=-1,c=-1;if(s){if(c=Ul(a,$l(r,o)),c<0)return!0;i=Ul(a,$l(t,n),c>=0?c:1/0)}else{if(i=Ul(a,$l(t,n)),i<0)return!1;c=Ul(a,$l(r,o),i>=0?i:1/0)}return i>=0?!(c>=0)||i<=c:!(c>=0)&&!!s}catch(e){}return!!s}function Gl(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:s,unblockSelector:a,maskAllText:i,maskAttributeFn:c,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p,inlineStylesheet:h,maskInputOptions:f={},maskTextFn:g,maskInputFn:m,dataURLOptions:_={},inlineImages:y,recordCanvas:v,keepIframeSrcFn:T,newlyAddedElement:S=!1}=t,b=function(e,t){if(!t.hasNode(e))return;const n=t.getId(e);return 1===n?void 0:n}(n,r);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:al.Document,childNodes:[],compatMode:e.compatMode}:{type:al.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:al.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:b};case e.ELEMENT_NODE:return function(e,t){const{doc:n,blockClass:r,blockSelector:o,unblockSelector:s,inlineStylesheet:a,maskInputOptions:i={},maskAttributeFn:c,maskInputFn:l,dataURLOptions:u={},inlineImages:d,recordCanvas:p,keepIframeSrcFn:h,newlyAddedElement:f=!1,rootId:g,maskAllText:m,maskTextClass:_,unmaskTextClass:y,maskTextSelector:v,unmaskTextSelector:T}=t,S=function(e,t,n,r){try{if(r&&e.matches(r))return!1;if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,r,o,s),b=function(e){if(e instanceof HTMLFormElement)return"form";const t=fl(e.tagName);return Tl.test(t)?"div":t}(e);let E={};const w=e.attributes.length;for(let t=0;t<w;t++){const r=e.attributes[t];r.name&&!Ml(b,r.name,r.value)&&(E[r.name]=Dl(n,b,fl(r.name),r.value,e,c))}if("link"===b&&a){const t=Array.from(n.styleSheets).find((t=>t.href===e.href));let r=null;t&&(r=ll(t)),r&&(delete E.rel,delete E.href,E._cssText=Cl(r,t.href))}if("style"===b&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const t=ll(e.sheet);t&&(E._cssText=Cl(t,Pl()))}if("input"===b||"textarea"===b||"select"===b||"option"===b){const t=e,n=_l(t),r=yl(t,gl(b),n),o=t.checked;if("submit"!==n&&"button"!==n&&r){const e=Fl(t,_,v,y,T,pl({type:n,tagName:gl(b),maskInputOptions:i}));E.value=hl({isMasked:e,element:t,value:r,maskInputFn:l})}o&&(E.checked=o)}"option"===b&&(e.selected&&!i.select?E.selected=!0:delete E.selected);if("canvas"===b&&p)if("2d"===e.__context)(function(e){const t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){const o=t.getImageData,s=ml in o?o[ml]:o;if(new Uint32Array(s.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((e=>0!==e)))return!1}return!0})(e)||(E.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){const t=e.toDataURL(u.type,u.quality),n=document.createElement("canvas");n.width=e.width,n.height=e.height;t!==n.toDataURL(u.type,u.quality)&&(E.rr_dataURL=t)}if("img"===b&&d){El||(El=n.createElement("canvas"),wl=El.getContext("2d"));const t=e,r=t.crossOrigin;t.crossOrigin="anonymous";const o=()=>{t.removeEventListener("load",o);try{El.width=t.naturalWidth,El.height=t.naturalHeight,wl.drawImage(t,0,0),E.rr_dataURL=El.toDataURL(u.type,u.quality)}catch(e){console.warn(`Cannot inline img src=${t.currentSrc}! Error: ${e}`)}r?E.crossOrigin=r:t.removeAttribute("crossorigin")};t.complete&&0!==t.naturalWidth?o():t.addEventListener("load",o)}"audio"!==b&&"video"!==b||(E.rr_mediaState=e.paused?"paused":"played",E.rr_mediaCurrentTime=e.currentTime);f||(e.scrollLeft&&(E.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(E.rr_scrollTop=e.scrollTop));if(S){const{width:t,height:n}=e.getBoundingClientRect();E={class:E.class,rr_width:`${t}px`,rr_height:`${n}px`}}"iframe"!==b||h(E.src)||(e.contentDocument||(E.rr_src=E.src),delete E.src);let A;try{customElements.get(b)&&(A=!0)}catch(e){}return{type:al.Element,tagName:b,attributes:E,childNodes:[],isSVG:Nl(e)||void 0,needBlock:S,rootId:g,isCustom:A}}(e,{doc:n,blockClass:o,blockSelector:s,unblockSelector:a,inlineStylesheet:h,maskAttributeFn:c,maskInputOptions:f,maskInputFn:m,dataURLOptions:_,inlineImages:y,recordCanvas:v,keepIframeSrcFn:T,newlyAddedElement:S,rootId:b,maskAllText:i,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p});case e.TEXT_NODE:return function(e,t){const{maskAllText:n,maskTextClass:r,unmaskTextClass:o,maskTextSelector:s,unmaskTextSelector:a,maskTextFn:i,maskInputOptions:c,maskInputFn:l,rootId:u}=t,d=e.parentNode&&e.parentNode.tagName;let p=e.textContent;const h="STYLE"===d||void 0,f="SCRIPT"===d||void 0,g="TEXTAREA"===d||void 0;if(h&&p){try{e.nextSibling||e.previousSibling||sl([e,"access",e=>e.parentNode,"access",e=>e.sheet,"optionalAccess",e=>e.cssRules])&&(p=ll(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}p=Cl(p,Pl())}f&&(p="SCRIPT_PLACEHOLDER");const m=Fl(e,r,s,o,a,n);h||f||g||!p||!m||(p=i?i(p,e.parentElement):p.replace(/[\S]/g,"*"));g&&p&&(c.textarea||m)&&(p=l?l(p,e.parentNode):p.replace(/[\S]/g,"*"));if("OPTION"===d&&p){p=hl({isMasked:Fl(e,r,s,o,a,pl({type:null,tagName:d,maskInputOptions:c})),element:e,value:p,maskInputFn:l})}return{type:al.Text,textContent:p||"",isStyle:h,rootId:u}}(e,{maskAllText:i,maskTextClass:l,unmaskTextClass:u,maskTextSelector:d,unmaskTextSelector:p,maskTextFn:g,maskInputOptions:f,maskInputFn:m,rootId:b});case e.CDATA_SECTION_NODE:return{type:al.CDATA,textContent:"",rootId:b};case e.COMMENT_NODE:return{type:al.Comment,textContent:e.textContent||"",rootId:b};default:return!1}}function jl(e){return null==e?"":e.toLowerCase()}function Vl(e,t){const{doc:n,mirror:r,blockClass:o,blockSelector:s,unblockSelector:a,maskAllText:i,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:p=!1,inlineStylesheet:h=!0,maskInputOptions:f={},maskAttributeFn:g,maskTextFn:m,maskInputFn:_,slimDOMOptions:y,dataURLOptions:v={},inlineImages:T=!1,recordCanvas:S=!1,onSerialize:b,onIframeLoad:E,iframeLoadTimeout:w=5e3,onStylesheetLoad:A,stylesheetLoadTimeout:I=5e3,keepIframeSrcFn:R=(()=>!1),newlyAddedElement:k=!1}=t;let{preserveWhiteSpace:C=!0}=t;const O=Gl(e,{doc:n,mirror:r,blockClass:o,blockSelector:s,maskAllText:i,unblockSelector:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:_,dataURLOptions:v,inlineImages:T,recordCanvas:S,keepIframeSrcFn:R,newlyAddedElement:k});if(!O)return console.warn(e,"not serialized"),null;let x;x=r.hasNode(e)?r.getId(e):!function(e,t){if(t.comment&&e.type===al.Comment)return!0;if(e.type===al.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(jl(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===jl(e.attributes.name)||"icon"===jl(e.attributes.rel)||"apple-touch-icon"===jl(e.attributes.rel)||"shortcut icon"===jl(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&jl(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(jl(e.attributes.property).match(/^(og|twitter|fb):/)||jl(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===jl(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===jl(e.attributes.name)||"googlebot"===jl(e.attributes.name)||"bingbot"===jl(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===jl(e.attributes.name)||"generator"===jl(e.attributes.name)||"framework"===jl(e.attributes.name)||"publisher"===jl(e.attributes.name)||"progid"===jl(e.attributes.name)||jl(e.attributes.property).match(/^article:/)||jl(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===jl(e.attributes.name)||"yandex-verification"===jl(e.attributes.name)||"csrf-token"===jl(e.attributes.name)||"p:domain_verify"===jl(e.attributes.name)||"verify-v1"===jl(e.attributes.name)||"verification"===jl(e.attributes.name)||"shopify-checkout-api-token"===jl(e.attributes.name)))return!0}}return!1}(O,y)&&(C||O.type!==al.Text||O.isStyle||O.textContent.replace(/^\s+|\s+$/gm,"").length)?bl():Sl;const L=Object.assign(O,{id:x});if(r.add(e,L),x===Sl)return null;b&&b(e);let N=!p;if(L.type===al.Element){N=N&&!L.needBlock,delete L.needBlock;const t=e.shadowRoot;t&&cl(t)&&(L.isShadowHost=!0)}if((L.type===al.Document||L.type===al.Element)&&N){y.headWhitespace&&L.type===al.Element&&"head"===L.tagName&&(C=!1);const t={doc:n,mirror:r,blockClass:o,blockSelector:s,maskAllText:i,unblockSelector:a,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:p,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:_,slimDOMOptions:y,dataURLOptions:v,inlineImages:T,recordCanvas:S,preserveWhiteSpace:C,onSerialize:b,onIframeLoad:E,iframeLoadTimeout:w,onStylesheetLoad:A,stylesheetLoadTimeout:I,keepIframeSrcFn:R};for(const n of Array.from(e.childNodes)){const e=Vl(n,t);e&&L.childNodes.push(e)}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(const n of Array.from(e.shadowRoot.childNodes)){const r=Vl(n,t);r&&(cl(e.shadowRoot)&&(r.isShadow=!0),L.childNodes.push(r))}}return e.parentNode&&il(e.parentNode)&&cl(e.parentNode)&&(L.isShadow=!0),L.type===al.Element&&"iframe"===L.tagName&&function(e,t,n){const r=e.contentWindow;if(!r)return;let o,s=!1;try{o=r.document.readyState}catch(e){return}if("complete"!==o){const r=setTimeout((()=>{s||(t(),s=!0)}),n);return void e.addEventListener("load",(()=>{clearTimeout(r),s=!0,t()}))}const a="about:blank";if(r.location.href!==a||e.src===a||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,(()=>{const t=e.contentDocument;if(t&&E){const n=Vl(t,{doc:t,mirror:r,blockClass:o,blockSelector:s,unblockSelector:a,maskAllText:i,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:_,slimDOMOptions:y,dataURLOptions:v,inlineImages:T,recordCanvas:S,preserveWhiteSpace:C,onSerialize:b,onIframeLoad:E,iframeLoadTimeout:w,onStylesheetLoad:A,stylesheetLoadTimeout:I,keepIframeSrcFn:R});n&&E(e,n)}}),w),L.type===al.Element&&"link"===L.tagName&&"stylesheet"===L.attributes.rel&&function(e,t,n){let r,o=!1;try{r=e.sheet}catch(e){return}if(r)return;const s=setTimeout((()=>{o||(t(),o=!0)}),n);e.addEventListener("load",(()=>{clearTimeout(s),o=!0,t()}))}(e,(()=>{if(A){const t=Vl(e,{doc:n,mirror:r,blockClass:o,blockSelector:s,unblockSelector:a,maskAllText:i,maskTextClass:c,unmaskTextClass:l,maskTextSelector:u,unmaskTextSelector:d,skipChild:!1,inlineStylesheet:h,maskInputOptions:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:_,slimDOMOptions:y,dataURLOptions:v,inlineImages:T,recordCanvas:S,preserveWhiteSpace:C,onSerialize:b,onIframeLoad:E,iframeLoadTimeout:w,onStylesheetLoad:A,stylesheetLoadTimeout:I,keepIframeSrcFn:R});t&&A(e,t)}}),I),L}function Wl(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}function ql(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const Bl="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Hl={map:{},getId:()=>(console.error(Bl),-1),getNode:()=>(console.error(Bl),null),removeNodeFromMap(){console.error(Bl)},has:()=>(console.error(Bl),!1),reset(){console.error(Bl)}};function Jl(e,t,n={}){let r=null,o=0;return function(...s){const a=Date.now();o||!1!==n.leading||(o=a);const i=t-(a-o),c=this;i<=0||i>t?(r&&(!function(...e){hu("clearTimeout")(...e)}(r),r=null),o=a,e.apply(c,s)):r||!1===n.trailing||(r=fu((()=>{o=!1===n.leading?0:Date.now(),r=null,e.apply(c,s)}),i))}}function zl(e,t,n,r,o=window){const s=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(e){fu((()=>{n.set.call(this,e)}),0),s&&s.set&&s.set.call(this,e)}}),()=>zl(e,t,s||{},!0)}function Yl(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch(e){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Hl=new Proxy(Hl,{get:(e,t,n)=>("map"===t&&console.error(Bl),Reflect.get(e,t,n))}));let Xl=Date.now;function Kl(e){const t=e.document;return{left:t.scrollingElement?t.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:Wl([t,"optionalAccess",e=>e.documentElement,"access",e=>e.scrollLeft])||Wl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.parentElement,"optionalAccess",e=>e.scrollLeft])||Wl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.scrollLeft])||0,top:t.scrollingElement?t.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:Wl([t,"optionalAccess",e=>e.documentElement,"access",e=>e.scrollTop])||Wl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.parentElement,"optionalAccess",e=>e.scrollTop])||Wl([t,"optionalAccess",e=>e.body,"optionalAccess",e=>e.scrollTop])||0}}function Ql(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Zl(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function eu(e){if(!e)return null;return e.nodeType===e.ELEMENT_NODE?e:e.parentElement}function tu(e,t,n,r,o){if(!e)return!1;const s=eu(e);if(!s)return!1;const a=$l(t,n);if(!o){const e=r&&s.matches(r);return a(s)&&!e}const i=Ul(s,a);let c=-1;return!(i<0)&&(r&&(c=Ul(s,$l(null,r))),i>-1&&c<0||i<c)}function nu(e,t){return t.getId(e)===Sl}function ru(e,t){if(il(e))return!1;const n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||ru(e.parentNode,t))}function ou(e){return Boolean(e.changedTouches)}function su(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function au(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function iu(e){return Boolean(Wl([e,"optionalAccess",e=>e.shadowRoot]))}/[1-9][0-9]{12}/.test(Date.now().toString())||(Xl=()=>(new Date).getTime());class cu{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return t=this.styleIDMap.get(e),n=()=>-1,null!=t?t:n();var t,n}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let n;return n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function lu(e){let t=null;return Wl([e,"access",e=>e.getRootNode,"optionalCall",e=>e(),"optionalAccess",e=>e.nodeType])===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(t=e.getRootNode().host),t}function uu(e){const t=e.ownerDocument;if(!t)return!1;const n=function(e){let t,n=e;for(;t=lu(n);)n=t;return n}(e);return t.contains(n)}function du(e){const t=e.ownerDocument;return!!t&&(t.contains(e)||uu(e))}const pu={};function hu(e){const t=pu[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const o=t.contentWindow;o&&o[e]&&(r=o[e]),n.head.removeChild(t)}catch(e){}return pu[e]=r.bind(window)}function fu(...e){return hu("setTimeout")(...e)}var gu=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(gu||{}),mu=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(mu||{}),_u=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(_u||{}),yu=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(yu||{});function vu(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}function Tu(e){return"__ln"in e}class Su{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=vu([t,"optionalAccess",e=>e.next])||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Tu(e.previousSibling)){const n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&Tu(e.nextSibling)&&e.nextSibling.__ln.previous){const n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const bu=(e,t)=>`${e}@${t}`;class Eu{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new Set,n=new Su,r=e=>{let t=e,n=Sl;for(;n===Sl;)t=t&&t.nextSibling,n=t&&this.mirror.getId(t);return n},o=o=>{if(!o.parentNode||!du(o))return;const s=il(o.parentNode)?this.mirror.getId(lu(o)):this.mirror.getId(o.parentNode),a=r(o);if(-1===s||-1===a)return n.addNode(o);const i=Vl(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{su(e,this.mirror)&&this.iframeManager.addIframe(e),au(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),iu(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});i&&(e.push({parentId:s,nextId:a,node:i}),t.add(i.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of this.movedSet)Au(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||o(e);for(const e of this.addedSet)Ru(this.droppedSet,e)||Au(this.removes,e,this.mirror)?Ru(this.movedSet,e)?o(e):this.droppedSet.add(e):o(e);let s=null;for(;n.length;){let e=null;if(s){const t=this.mirror.getId(s.value.parentNode),n=r(s.value);-1!==t&&-1!==n&&(e=s)}if(!e){let t=n.tail;for(;t;){const n=t;if(t=t.previous,n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}s=e.previous,n.removeNode(e.value),o(e.value)}const a={texts:this.texts.map((e=>({id:this.mirror.getId(e.node),value:e.value}))).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>{const{attributes:t}=e;if("string"==typeof t.style){const n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}})).filter((e=>!t.has(e.id))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(a.texts.length||a.attributes.length||a.removes.length||a.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(a))},this.processMutation=e=>{if(!nu(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;tu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||t===e.oldValue||this.texts.push({value:Fl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&t?this.maskTextFn?this.maskTextFn(t,eu(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let n=e.attributeName,r=e.target.getAttribute(n);if("value"===n){const n=_l(t),o=t.tagName;r=yl(t,o,n);const s=pl({maskInputOptions:this.maskInputOptions,tagName:o,type:n});r=hl({isMasked:Fl(e.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,s),element:t,value:r,maskInputFn:this.maskInputFn})}if(tu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||r===e.oldValue)return;let o=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(t.contentDocument)return;n="rr_src"}if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o),this.attributeMap.set(e.target,o)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!Ml(t.tagName,n)&&(o.attributes[n]=Dl(this.doc,fl(t.tagName),fl(n),r,t,this.maskAttributeFn),"style"===n)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}const n=this.unattachedDoc.createElement("span");e.oldValue&&n.setAttribute("style",e.oldValue);for(const e of Array.from(t.style)){const r=t.style.getPropertyValue(e),s=t.style.getPropertyPriority(e);r!==n.style.getPropertyValue(e)||s!==n.style.getPropertyPriority(e)?o.styleDiff[e]=""===s?r:[r,s]:o._unchangedStyles[e]=[r,s]}for(const e of Array.from(n.style))""===t.style.getPropertyValue(e)&&(o.styleDiff[e]=!1)}break}case"childList":if(tu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!0))return;e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const n=this.mirror.getId(t),r=il(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);tu(e.target,this.blockClass,this.blockSelector,this.unblockSelector,!1)||nu(t,this.mirror)||!function(e,t){return-1!==t.getId(e)}(t,this.mirror)||(this.addedSet.has(t)?(wu(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||ru(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[bu(n,r)]?wu(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!(!il(e.target)||!cl(e.target))||void 0})),this.mapRemoves.push(t))}))}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!this.addedSet.has(e)&&!this.movedSet.has(e)){if(this.mirror.hasNode(e)){if(nu(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[bu(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);tu(e,this.blockClass,this.blockSelector,this.unblockSelector,!1)||(e.childNodes.forEach((e=>this.genAdds(e))),iu(e)&&e.shadowRoot.childNodes.forEach((t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)})))}}}init(e){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function wu(e,t){e.delete(t),t.childNodes.forEach((t=>wu(e,t)))}function Au(e,t,n){return 0!==e.length&&Iu(e,t,n)}function Iu(e,t,n){const{parentNode:r}=t;if(!r)return!1;const o=n.getId(r);return!!e.some((e=>e.id===o))||Iu(e,r,n)}function Ru(e,t){return 0!==e.size&&ku(e,t)}function ku(e,t){const{parentNode:n}=t;return!!n&&(!!e.has(n)||ku(e,n))}let Cu;const Ou=e=>{if(!Cu)return e;return(...t)=>{try{return e(...t)}catch(e){if(Cu&&!0===Cu(e))return()=>{};throw e}}};function xu(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}const Lu=[];function Nu(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(e){}return e&&e.target}function Pu(e,t){const n=new Eu;Lu.push(n),n.init(e);let r=window.MutationObserver||window.__rrMutationObserver;const o=xu([window,"optionalAccess",e=>e.Zone,"optionalAccess",e=>e.__symbol__,"optionalCall",e=>e("MutationObserver")]);o&&window[o]&&(r=window[o]);const s=new r(Ou((t=>{e.onMutation&&!1===e.onMutation(t)||n.processMutations.bind(n)(t)})));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function Du({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,sampling:a}){if(!1===a.mouseInteraction)return()=>{};const i=!0===a.mouseInteraction||void 0===a.mouseInteraction?{}:a.mouseInteraction,c=[];let l=null;return Object.keys(_u).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==i[e])).forEach((a=>{let i=fl(a);const u=(t=>a=>{const i=Nu(a);if(tu(i,r,o,s,!0))return;let c=null,u=t;if("pointerType"in a){switch(a.pointerType){case"mouse":c=yu.Mouse;break;case"touch":c=yu.Touch;break;case"pen":c=yu.Pen}c===yu.Touch?_u[t]===_u.MouseDown?u="TouchStart":_u[t]===_u.MouseUp&&(u="TouchEnd"):yu.Pen}else ou(a)&&(c=yu.Touch);null!==c?(l=c,(u.startsWith("Touch")&&c===yu.Touch||u.startsWith("Mouse")&&c===yu.Mouse)&&(c=null)):_u[t]===_u.Click&&(c=l,l=null);const d=ou(a)?a.changedTouches[0]:a;if(!d)return;const p=n.getId(i),{clientX:h,clientY:f}=d;Ou(e)({type:_u[u],id:p,x:h,y:f,...null!==c&&{pointerType:c}})})(a);if(window.PointerEvent)switch(_u[a]){case _u.MouseDown:case _u.MouseUp:i=i.replace("mouse","pointer");break;case _u.TouchStart:case _u.TouchEnd:return}c.push(ql(i,u,t))})),Ou((()=>{c.forEach((e=>e()))}))}function Mu({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,sampling:a}){return ql("scroll",Ou(Jl(Ou((a=>{const i=Nu(a);if(!i||tu(i,r,o,s,!0))return;const c=n.getId(i);if(i===t&&t.defaultView){const n=Kl(t.defaultView);e({id:c,x:n.left,y:n.top})}else e({id:c,x:i.scrollLeft,y:i.scrollTop})})),a.scroll||100)),t)}const Uu=["INPUT","TEXTAREA","SELECT"],$u=new WeakMap;function Fu({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,ignoreClass:a,ignoreSelector:i,maskInputOptions:c,maskInputFn:l,sampling:u,userTriggeredOnInput:d,maskTextClass:p,unmaskTextClass:h,maskTextSelector:f,unmaskTextSelector:g}){function m(e){let n=Nu(e);const u=e.isTrusted,m=n&&gl(n.tagName);if("OPTION"===m&&(n=n.parentElement),!n||!m||Uu.indexOf(m)<0||tu(n,r,o,s,!0))return;const y=n;if(y.classList.contains(a)||i&&y.matches(i))return;const v=_l(n);let T=yl(y,m,v),S=!1;const b=pl({maskInputOptions:c,tagName:m,type:v}),E=Fl(n,p,f,h,g,b);"radio"!==v&&"checkbox"!==v||(S=n.checked),T=hl({isMasked:E,element:n,value:T,maskInputFn:l}),_(n,d?{text:T,isChecked:S,userTriggered:u}:{text:T,isChecked:S});const w=n.name;"radio"===v&&w&&S&&t.querySelectorAll(`input[type="radio"][name="${w}"]`).forEach((e=>{if(e!==n){const t=hl({isMasked:E,element:e,value:yl(e,m,v),maskInputFn:l});_(e,d?{text:t,isChecked:!S,userTriggered:!1}:{text:t,isChecked:!S})}}))}function _(t,r){const o=$u.get(t);if(!o||o.text!==r.text||o.isChecked!==r.isChecked){$u.set(t,r);const o=n.getId(t);Ou(e)({...r,id:o})}}const y=("last"===u.input?["change"]:["input","change"]).map((e=>ql(e,Ou(m),t))),v=t.defaultView;if(!v)return()=>{y.forEach((e=>e()))};const T=v.Object.getOwnPropertyDescriptor(v.HTMLInputElement.prototype,"value"),S=[[v.HTMLInputElement.prototype,"value"],[v.HTMLInputElement.prototype,"checked"],[v.HTMLSelectElement.prototype,"value"],[v.HTMLTextAreaElement.prototype,"value"],[v.HTMLSelectElement.prototype,"selectedIndex"],[v.HTMLOptionElement.prototype,"selected"]];return T&&T.set&&y.push(...S.map((e=>zl(e[0],e[1],{set(){Ou(m)({target:this,isTrusted:!1})}},!1,v)))),Ou((()=>{y.forEach((e=>e()))}))}function Gu(e){return function(e,t){if(qu("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||qu("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||qu("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||qu("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){const n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){const n=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(n)}return t}(e,[])}function ju(e,t,n){let r,o;return e?(e.ownerNode?r=t.getId(e.ownerNode):o=n.getId(e),{styleId:o,id:r}):{}}function Vu({mirror:e,stylesheetManager:t},n){let r=null;r="#document"===n.nodeName?e.getId(n):e.getId(n.host);const o="#document"===n.nodeName?xu([n,"access",e=>e.defaultView,"optionalAccess",e=>e.Document]):xu([n,"access",e=>e.ownerDocument,"optionalAccess",e=>e.defaultView,"optionalAccess",e=>e.ShadowRoot]),s=xu([o,"optionalAccess",e=>e.prototype])?Object.getOwnPropertyDescriptor(xu([o,"optionalAccess",e=>e.prototype]),"adoptedStyleSheets"):void 0;return null!==r&&-1!==r&&o&&s?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get(){return xu([s,"access",e=>e.get,"optionalAccess",e=>e.call,"call",e=>e(this)])},set(e){const n=xu([s,"access",e=>e.set,"optionalAccess",e=>e.call,"call",t=>t(this,e)]);if(null!==r&&-1!==r)try{t.adoptStyleSheets(e,r)}catch(e){}return n}}),Ou((()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get:s.get,set:s.set})}))):()=>{}}function Wu(e,t={}){const n=e.doc.defaultView;if(!n)return()=>{};const r=Pu(e,e.doc),o=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){if(!1===t.mousemove)return()=>{};const o="number"==typeof t.mousemove?t.mousemove:50,s="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let a,i=[];const c=Jl(Ou((t=>{const n=Date.now()-a;e(i.map((e=>(e.timeOffset-=n,e))),t),i=[],a=null})),s),l=Ou(Jl(Ou((e=>{const t=Nu(e),{clientX:n,clientY:o}=ou(e)?e.changedTouches[0]:e;a||(a=Xl()),i.push({x:n,y:o,id:r.getId(t),timeOffset:Xl()-a}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?mu.Drag:e instanceof MouseEvent?mu.MouseMove:mu.TouchMove)})),o,{trailing:!1})),u=[ql("mousemove",l,n),ql("touchmove",l,n),ql("drag",l,n)];return Ou((()=>{u.forEach((e=>e()))}))}(e),s=Du(e),a=Mu(e),i=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return ql("resize",Ou(Jl(Ou((()=>{const t=Ql(),o=Zl();n===t&&r===o||(e({width:Number(o),height:Number(t)}),n=t,r=o)})),200)),t)}(e,{win:n}),c=Fu(e),l=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,unblockSelector:r,mirror:o,sampling:s,doc:a}){const i=Ou((a=>Jl(Ou((s=>{const i=Nu(s);if(!i||tu(i,t,n,r,!0))return;const{currentTime:c,volume:l,muted:u,playbackRate:d}=i;e({type:a,id:o.getId(i),currentTime:c,volume:l,muted:u,playbackRate:d})})),s.media||500))),c=[ql("play",i(0),a),ql("pause",i(1),a),ql("seeked",i(2),a),ql("volumechange",i(3),a),ql("ratechange",i(4),a)];return Ou((()=>{c.forEach((e=>e()))}))}(e),u=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const o=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:Ou(((r,o,s)=>{const[a,i]=s,{id:c,styleId:l}=ju(o,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:a,index:i}]}),r.apply(o,s)}))});const s=r.CSSStyleSheet.prototype.deleteRule;let a,i;r.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:Ou(((r,o,s)=>{const[a]=s,{id:i,styleId:c}=ju(o,t,n.styleMirror);return(i&&-1!==i||c&&-1!==c)&&e({id:i,styleId:c,removes:[{index:a}]}),r.apply(o,s)}))}),r.CSSStyleSheet.prototype.replace&&(a=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(a,{apply:Ou(((r,o,s)=>{const[a]=s,{id:i,styleId:c}=ju(o,t,n.styleMirror);return(i&&-1!==i||c&&-1!==c)&&e({id:i,styleId:c,replace:a}),r.apply(o,s)}))})),r.CSSStyleSheet.prototype.replaceSync&&(i=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(i,{apply:Ou(((r,o,s)=>{const[a]=s,{id:i,styleId:c}=ju(o,t,n.styleMirror);return(i&&-1!==i||c&&-1!==c)&&e({id:i,styleId:c,replaceSync:a}),r.apply(o,s)}))}));const c={};Bu("CSSGroupingRule")?c.CSSGroupingRule=r.CSSGroupingRule:(Bu("CSSMediaRule")&&(c.CSSMediaRule=r.CSSMediaRule),Bu("CSSConditionRule")&&(c.CSSConditionRule=r.CSSConditionRule),Bu("CSSSupportsRule")&&(c.CSSSupportsRule=r.CSSSupportsRule));const l={};return Object.entries(c).forEach((([r,o])=>{l[r]={insertRule:o.prototype.insertRule,deleteRule:o.prototype.deleteRule},o.prototype.insertRule=new Proxy(l[r].insertRule,{apply:Ou(((r,o,s)=>{const[a,i]=s,{id:c,styleId:l}=ju(o.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||l&&-1!==l)&&e({id:c,styleId:l,adds:[{rule:a,index:[...Gu(o),i||0]}]}),r.apply(o,s)}))}),o.prototype.deleteRule=new Proxy(l[r].deleteRule,{apply:Ou(((r,o,s)=>{const[a]=s,{id:i,styleId:c}=ju(o.parentStyleSheet,t,n.styleMirror);return(i&&-1!==i||c&&-1!==c)&&e({id:i,styleId:c,removes:[{index:[...Gu(o),a]}]}),r.apply(o,s)}))})})),Ou((()=>{r.CSSStyleSheet.prototype.insertRule=o,r.CSSStyleSheet.prototype.deleteRule=s,a&&(r.CSSStyleSheet.prototype.replace=a),i&&(r.CSSStyleSheet.prototype.replaceSync=i),Object.entries(c).forEach((([e,t])=>{t.prototype.insertRule=l[e].insertRule,t.prototype.deleteRule=l[e].deleteRule}))}))}(e,{win:n}),d=Vu(e,e.doc),p=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:o}){const s=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:Ou(((o,a,i)=>{const[c,l,u]=i;if(n.has(c))return s.apply(a,[c,l,u]);const{id:d,styleId:p}=ju(xu([a,"access",e=>e.parentRule,"optionalAccess",e=>e.parentStyleSheet]),t,r.styleMirror);return(d&&-1!==d||p&&-1!==p)&&e({id:d,styleId:p,set:{property:c,value:l,priority:u},index:Gu(a.parentRule)}),o.apply(a,i)}))});const a=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(a,{apply:Ou(((o,s,i)=>{const[c]=i;if(n.has(c))return a.apply(s,[c]);const{id:l,styleId:u}=ju(xu([s,"access",e=>e.parentRule,"optionalAccess",e=>e.parentStyleSheet]),t,r.styleMirror);return(l&&-1!==l||u&&-1!==u)&&e({id:l,styleId:u,remove:{property:c},index:Gu(s.parentRule)}),o.apply(s,i)}))}),Ou((()=>{o.CSSStyleDeclaration.prototype.setProperty=s,o.CSSStyleDeclaration.prototype.removeProperty=a}))}(e,{win:n}),h=e.collectFonts?function({fontCb:e,doc:t}){const n=t.defaultView;if(!n)return()=>{};const r=[],o=new WeakMap,s=n.FontFace;n.FontFace=function(e,t,n){const r=new s(e,t,n);return o.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};const a=Yl(t.fonts,"add",(function(t){return function(n){return fu(Ou((()=>{const t=o.get(n);t&&(e(t),o.delete(n))})),0),t.apply(this,[n])}}));return r.push((()=>{n.FontFace=s})),r.push(a),Ou((()=>{r.forEach((e=>e()))}))}(e):()=>{},f=function(e){const{doc:t,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,selectionCb:a}=e;let i=!0;const c=Ou((()=>{const e=t.getSelection();if(!e||i&&xu([e,"optionalAccess",e=>e.isCollapsed]))return;i=e.isCollapsed||!1;const c=[],l=e.rangeCount||0;for(let t=0;t<l;t++){const a=e.getRangeAt(t),{startContainer:i,startOffset:l,endContainer:u,endOffset:d}=a;tu(i,r,o,s,!0)||tu(u,r,o,s,!0)||c.push({start:n.getId(i),startOffset:l,end:n.getId(u),endOffset:d})}a({ranges:c})}));return c(),ql("selectionchange",c)}(e),g=function({doc:e,customElementCb:t}){const n=e.defaultView;return n&&n.customElements?Yl(n.customElements,"define",(function(e){return function(n,r,o){try{t({define:{name:n}})}catch(e){}return e.apply(this,[n,r,o])}})):()=>{}}(e),m=[];for(const t of e.plugins)m.push(t.observer(t.callback,n,t.options));return Ou((()=>{Lu.forEach((e=>e.reset())),r.disconnect(),o(),s(),a(),i(),c(),l(),u(),d(),p(),h(),f(),g(),m.forEach((e=>e()))}))}function qu(e){return void 0!==window[e]}function Bu(e){return Boolean(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class Hu{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){const o=n||this.getIdToRemoteIdMap(e),s=r||this.getRemoteIdToIdMap(e);let a=o.get(t);return a||(a=this.generateIdFn(),o.set(t,a),s.set(a,t)),a}getIds(e,t){const n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,n,r)))}getRemoteId(e,t,n){const r=n||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const o=r.get(t);return o||-1}getRemoteIds(e,t){const n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,n)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}function Ju(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],s=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=s(n)):"call"!==o&&"optionalCall"!==o||(n=s(((...e)=>n.call(t,...e))),t=void 0)}return n}class zu{constructor(){this.crossOriginIframeMirror=new Hu(bl),this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class Yu{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Hu(bl),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Hu(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),Ju([this,"access",e=>e.loadListener,"optionalCall",t=>t(e)]),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const n=this.crossOriginIframeMap.get(e.source);if(!n)return;const r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}transformCrossOriginEvent(e,t){switch(t.type){case gu.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:gu.IncrementalSnapshot,data:{source:mu.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case gu.Meta:case gu.Load:case gu.DomContentLoaded:return!1;case gu.Plugin:return t;case gu.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case gu.IncrementalSnapshot:switch(t.data.source){case mu.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case mu.Drag:case mu.TouchMove:case mu.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case mu.ViewportResize:return!1;case mu.MediaInteraction:case mu.MouseInteraction:case mu.Scroll:case mu.CanvasMutation:case mu.Input:return this.replaceIds(t.data,e,["id"]),t;case mu.StyleSheetRule:case mu.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case mu.Font:return t;case mu.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case mu.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),Ju([t,"access",e=>e.data,"access",e=>e.styles,"optionalAccess",e=>e.forEach,"call",t=>t((t=>{this.replaceStyleIds(t,e,["styleId"])}))]),t}}return!1}replace(e,t,n,r){for(const o of r)(Array.isArray(t[o])||"number"==typeof t[o])&&(Array.isArray(t[o])?t[o]=e.getIds(n,t[o]):t[o]=e.getId(n,t[o]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===al.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}}class Xu{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class Ku{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!cl(e))return;if(this.shadowDoms.has(e))return;this.shadowDoms.add(e);const n=Pu({...this.bypassOptions,doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push((()=>n.disconnect())),this.restoreHandlers.push(Mu({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),fu((()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(Vu({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))}),0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){const n=this;this.restoreHandlers.push(Yl(e.prototype,"attachShadow",(function(e){return function(r){const o=e.call(this,r);return this.shadowRoot&&du(this)&&n.addShadowRoot(this.shadowRoot,t),o}})))}reset(){this.restoreHandlers.forEach((e=>{try{e()}catch(e){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class Qu{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}}class Zu{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new cu,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const n={id:t,styleIds:[]},r=[];for(const t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),r.push({styleId:e,rules:Array.from(t.rules||CSSRule,((e,t)=>({rule:ul(e),index:t})))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class ed{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){!function(...e){hu("requestAnimationFrame")(...e)}((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(e,t){const n=this.nodeMap.get(e);return n&&Array.from(n).some((e=>e!==t))}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}let td,nd;const rd=new dl;function od(e={}){const{emit:t,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:o="rr-block",blockSelector:s=null,unblockSelector:a=null,ignoreClass:i="rr-ignore",ignoreSelector:c=null,maskAllText:l=!1,maskTextClass:u="rr-mask",unmaskTextClass:d=null,maskTextSelector:p=null,unmaskTextSelector:h=null,inlineStylesheet:f=!0,maskAllInputs:g,maskInputOptions:m,slimDOMOptions:_,maskAttributeFn:y,maskInputFn:v,maskTextFn:T,maxCanvasSize:S=null,packFn:b,sampling:E={},dataURLOptions:w={},mousemoveWait:A,recordCanvas:I=!1,recordCrossOriginIframes:R=!1,recordAfter:k=("DOMContentLoaded"===e.recordAfter?e.recordAfter:"load"),userTriggeredOnInput:C=!1,collectFonts:O=!1,inlineImages:x=!1,plugins:L,keepIframeSrcFn:N=(()=>!1),ignoreCSSAttributes:P=new Set([]),errorHandler:D,onMutation:M,getCanvasManager:U}=e;Cu=D;const $=!R||window.parent===window;let F=!1;if(!$)try{window.parent.document&&(F=!1)}catch(e){F=!0}if($&&!t)throw new Error("emit function is required");void 0!==A&&void 0===E.mousemove&&(E.mousemove=A),rd.reset();const G=!0===g?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==m?m:{},j=!0===_||"all"===_?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===_,headMetaDescKeywords:"all"===_}:_||{};let V;!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let W=0;const q=e=>{for(const t of L||[])t.eventProcessor&&(e=t.eventProcessor(e));return b&&!F&&(e=b(e)),e};td=(e,o)=>{const s=e;if(s.timestamp=Xl(),!or([Lu,"access",e=>e[0],"optionalAccess",e=>e.isFrozen,"call",e=>e()])||s.type===gu.FullSnapshot||s.type===gu.IncrementalSnapshot&&s.data.source===mu.Mutation||Lu.forEach((e=>e.unfreeze())),$)or([t,"optionalCall",e=>e(q(s),o)]);else if(F){const e={type:"rrweb",event:q(s),origin:window.location.origin,isCheckout:o};window.parent.postMessage(e,"*")}if(s.type===gu.FullSnapshot)V=s,W=0;else if(s.type===gu.IncrementalSnapshot){if(s.data.source===mu.Mutation&&s.data.isAttachIframe)return;W++;const e=r&&W>=r,t=n&&V&&s.timestamp-V.timestamp>n;(e||t)&&Z(!0)}};const B=e=>{td({type:gu.IncrementalSnapshot,data:{source:mu.Mutation,...e}})},H=e=>td({type:gu.IncrementalSnapshot,data:{source:mu.Scroll,...e}}),J=e=>td({type:gu.IncrementalSnapshot,data:{source:mu.CanvasMutation,...e}}),z=new Zu({mutationCb:B,adoptedStyleSheetCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.AdoptedStyleSheet,...e}})}),Y="boolean"==typeof __RRWEB_EXCLUDE_IFRAME__&&__RRWEB_EXCLUDE_IFRAME__?new zu:new Yu({mirror:rd,mutationCb:B,stylesheetManager:z,recordCrossOriginIframes:R,wrappedEmit:td});for(const e of L||[])e.getMirror&&e.getMirror({nodeMirror:rd,crossOriginIframeMirror:Y.crossOriginIframeMirror,crossOriginIframeStyleMirror:Y.crossOriginIframeStyleMirror});const X=new ed,K=function(e,t){try{return e?e(t):new Qu}catch(e){return console.warn("Unable to initialize CanvasManager"),new Qu}}(U,{mirror:rd,win:window,mutationCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.CanvasMutation,...e}}),recordCanvas:I,blockClass:o,blockSelector:s,unblockSelector:a,maxCanvasSize:S,sampling:E.canvas,dataURLOptions:w,errorHandler:D}),Q="boolean"==typeof __RRWEB_EXCLUDE_SHADOW_DOM__&&__RRWEB_EXCLUDE_SHADOW_DOM__?new Xu:new Ku({mutationCb:B,scrollCb:H,bypassOptions:{onMutation:M,blockClass:o,blockSelector:s,unblockSelector:a,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskInputOptions:G,dataURLOptions:w,maskAttributeFn:y,maskTextFn:T,maskInputFn:v,recordCanvas:I,inlineImages:x,sampling:E,slimDOMOptions:j,iframeManager:Y,stylesheetManager:z,canvasManager:K,keepIframeSrcFn:N,processedNodeManager:X},mirror:rd}),Z=(e=!1)=>{td({type:gu.Meta,data:{href:window.location.href,width:Zl(),height:Ql()}},e),z.reset(),Q.init(),Lu.forEach((e=>e.lock()));const t=function(e,t){const{mirror:n=new dl,blockClass:r="rr-block",blockSelector:o=null,unblockSelector:s=null,maskAllText:a=!1,maskTextClass:i="rr-mask",unmaskTextClass:c=null,maskTextSelector:l=null,unmaskTextSelector:u=null,inlineStylesheet:d=!0,inlineImages:p=!1,recordCanvas:h=!1,maskAllInputs:f=!1,maskAttributeFn:g,maskTextFn:m,maskInputFn:_,slimDOM:y=!1,dataURLOptions:v,preserveWhiteSpace:T,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:E,onStylesheetLoad:w,stylesheetLoadTimeout:A,keepIframeSrcFn:I=(()=>!1)}=t||{};return Vl(e,{doc:e,mirror:n,blockClass:r,blockSelector:o,unblockSelector:s,maskAllText:a,maskTextClass:i,unmaskTextClass:c,maskTextSelector:l,unmaskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:!0===f?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===f?{}:f,maskAttributeFn:g,maskTextFn:m,maskInputFn:_,slimDOMOptions:!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===y,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===y?{}:y,dataURLOptions:v,inlineImages:p,recordCanvas:h,preserveWhiteSpace:T,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:E,onStylesheetLoad:w,stylesheetLoadTimeout:A,keepIframeSrcFn:I,newlyAddedElement:!1})}(document,{mirror:rd,blockClass:o,blockSelector:s,unblockSelector:a,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,inlineStylesheet:f,maskAllInputs:G,maskAttributeFn:y,maskInputFn:v,maskTextFn:T,slimDOM:j,dataURLOptions:w,recordCanvas:I,inlineImages:x,onSerialize:e=>{su(e,rd)&&Y.addIframe(e),au(e,rd)&&z.trackLinkElement(e),iu(e)&&Q.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{Y.attachIframe(e,t),Q.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{z.attachLinkElement(e,t)},keepIframeSrcFn:N});if(!t)return console.warn("Failed to snapshot the document");td({type:gu.FullSnapshot,data:{node:t,initialOffset:Kl(window)}}),Lu.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&z.adoptStyleSheets(document.adoptedStyleSheets,rd.getId(document))};nd=Z;try{const e=[],t=e=>Ou(Wu)({onMutation:M,mutationCb:B,mousemoveCb:(e,t)=>td({type:gu.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.MouseInteraction,...e}}),scrollCb:H,viewportResizeCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.ViewportResize,...e}}),inputCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.Input,...e}}),mediaInteractionCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.MediaInteraction,...e}}),styleSheetRuleCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.StyleSheetRule,...e}}),styleDeclarationCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.StyleDeclaration,...e}}),canvasMutationCb:J,fontCb:e=>td({type:gu.IncrementalSnapshot,data:{source:mu.Font,...e}}),selectionCb:e=>{td({type:gu.IncrementalSnapshot,data:{source:mu.Selection,...e}})},customElementCb:e=>{td({type:gu.IncrementalSnapshot,data:{source:mu.CustomElement,...e}})},blockClass:o,ignoreClass:i,ignoreSelector:c,maskAllText:l,maskTextClass:u,unmaskTextClass:d,maskTextSelector:p,unmaskTextSelector:h,maskInputOptions:G,inlineStylesheet:f,sampling:E,recordCanvas:I,inlineImages:x,userTriggeredOnInput:C,collectFonts:O,doc:e,maskAttributeFn:y,maskInputFn:v,maskTextFn:T,keepIframeSrcFn:N,blockSelector:s,unblockSelector:a,slimDOMOptions:j,dataURLOptions:w,mirror:rd,iframeManager:Y,stylesheetManager:z,shadowDomManager:Q,processedNodeManager:X,canvasManager:K,ignoreCSSAttributes:P,plugins:or([L,"optionalAccess",e=>e.filter,"call",e=>e((e=>e.observer)),"optionalAccess",e=>e.map,"call",e=>e((e=>({observer:e.observer,options:e.options,callback:t=>td({type:gu.Plugin,data:{plugin:e.name,payload:t}})})))])||[]},{});Y.addLoadListener((n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}}));const n=()=>{Z(),e.push(t(document))};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(ql("DOMContentLoaded",(()=>{td({type:gu.DomContentLoaded,data:{}}),"DOMContentLoaded"===k&&n()}))),e.push(ql("load",(()=>{td({type:gu.Load,data:{}}),"load"===k&&n()}),window))),()=>{e.forEach((e=>e())),X.destroy(),nd=void 0,Cu=void 0}}catch(e){console.warn(e)}}od.mirror=rd,od.takeFullSnapshot=function(e){if(!nd)throw new Error("please take full snapshot after start recording");nd(e)};const sd=3;function ad(e){return e>9999999999?e:1e3*e}function id(e){return e>9999999999?e/1e3:e}function cd(e,t){"sentry.transaction"!==t.category&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate((()=>(e.throttledAddEvent({type:gu.Custom,timestamp:1e3*(t.timestamp||0),data:{tag:"breadcrumb",payload:on(t,10,1e3)}}),"console"===t.category))))}const ld="button,a";function ud(e){return e.closest(ld)||e}function dd(e){const t=pd(e);return t&&t instanceof Element?ud(t):t}function pd(e){return function(e){return"object"==typeof e&&!!e&&"target"in e}(e)?e.target:e}let hd;function fd(e){return hd||(hd=[],ze(Kc,"open",(function(e){return function(...t){if(hd)try{hd.forEach((e=>e()))}catch(e){}return e.apply(Kc,t)}}))),hd.push(e),()=>{const t=hd?hd.indexOf(e):-1;t>-1&&hd.splice(t,1)}}class gd{constructor(e,t,n=cd){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=t.timeout/1e3,this._threshold=t.threshold/1e3,this._scollTimeout=t.scrollTimeout/1e3,this._replay=e,this._ignoreSelector=t.ignoreSelector,this._addBreadcrumbEvent=n}addListeners(){const e=fd((()=>{this._lastMutation=_d()}));this._teardown=()=>{e(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(e,t){if(function(e,t){if(!md.includes(e.tagName))return!0;if("INPUT"===e.tagName&&!["submit","button"].includes(e.getAttribute("type")||""))return!0;if("A"===e.tagName&&(e.hasAttribute("download")||e.hasAttribute("target")&&"_self"!==e.getAttribute("target")))return!0;if(t&&e.matches(t))return!0;return!1}(t,this._ignoreSelector)||!function(e){return!(!e.data||"number"!=typeof e.data.nodeId||!e.timestamp)}(e))return;const n={timestamp:id(e.timestamp),clickBreadcrumb:e,clickCount:0,node:t};this._clicks.some((e=>e.node===n.node&&Math.abs(e.timestamp-n.timestamp)<1))||(this._clicks.push(n),1===this._clicks.length&&this._scheduleCheckClicks())}registerMutation(e=Date.now()){this._lastMutation=id(e)}registerScroll(e=Date.now()){this._lastScroll=id(e)}registerClick(e){const t=ud(e);this._handleMultiClick(t)}_handleMultiClick(e){this._getClicks(e).forEach((e=>{e.clickCount++}))}_getClicks(e){return this._clicks.filter((t=>t.node===e))}_checkClicks(){const e=[],t=_d();this._clicks.forEach((n=>{!n.mutationAfter&&this._lastMutation&&(n.mutationAfter=n.timestamp<=this._lastMutation?this._lastMutation-n.timestamp:void 0),!n.scrollAfter&&this._lastScroll&&(n.scrollAfter=n.timestamp<=this._lastScroll?this._lastScroll-n.timestamp:void 0),n.timestamp+this._timeout<=t&&e.push(n)}));for(const t of e){const e=this._clicks.indexOf(t);e>-1&&(this._generateBreadcrumbs(t),this._clicks.splice(e,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(e){const t=this._replay,n=e.scrollAfter&&e.scrollAfter<=this._scollTimeout,r=e.mutationAfter&&e.mutationAfter<=this._threshold,o=!n&&!r,{clickCount:s,clickBreadcrumb:a}=e;if(o){const n=1e3*Math.min(e.mutationAfter||this._timeout,this._timeout),r=n<1e3*this._timeout?"mutation":"timeout",o={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.slowClickDetected",data:{...a.data,url:Kc.location.href,route:t.getCurrentRoute(),timeAfterClickMs:n,endReason:r,clickCount:s||1}};this._addBreadcrumbEvent(t,o)}else if(s>1){const e={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.multiClick",data:{...a.data,url:Kc.location.href,route:t.getCurrentRoute(),clickCount:s,metric:!0}};this._addBreadcrumbEvent(t,e)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout((()=>this._checkClicks()),1e3)}}const md=["A","BUTTON","INPUT"];function _d(){return Date.now()/1e3}function yd(e,t){try{if(!function(e){return e.type===sd}(t))return;const{source:n}=t.data;if(n===mu.Mutation&&e.registerMutation(t.timestamp),n===mu.Scroll&&e.registerScroll(t.timestamp),function(e){return e.data.source===mu.MouseInteraction}(t)){const{type:n,id:r}=t.data,o=od.mirror.getNode(r);o instanceof HTMLElement&&n===_u.Click&&e.registerClick(o)}}catch(e){}}function vd(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var Td;!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Td||(Td={}));const Sd=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function bd(e){const t={};for(const n in e)if(Sd.has(n)){let r=n;"data-testid"!==n&&"data-test-id"!==n||(r="testId"),t[r]=e[n]}return t}const Ed=e=>t=>{if(!e.isEnabled())return;const n=function(e){const{target:t,message:n}=function(e){const t="click"===e.name;let n,r=null;try{r=t?dd(e.event):pd(e.event),n=Le(r,{maxStringLength:200})||"<unknown>"}catch(e){n="<unknown>"}return{target:r,message:n}}(e);return vd({category:`ui.${e.name}`,...wd(t,n)})}(t);if(!n)return;const r="click"===t.name,o=r?t.event:void 0;var s,a,i;!(r&&e.clickDetector&&o&&o.target)||o.altKey||o.metaKey||o.ctrlKey||o.shiftKey||(s=e.clickDetector,a=n,i=dd(t.event),s.handleClick(a,i)),cd(e,n)};function wd(e,t){const n=od.mirror.getId(e),r=n&&od.mirror.getNode(n),o=r&&od.mirror.getMeta(r),s=o&&function(e){return e.type===Td.Element}(o)?o:null;return{message:t,data:s?{nodeId:n,node:{id:n,tagName:s.tagName,textContent:Array.from(s.childNodes).map((e=>e.type===Td.Text&&e.textContent)).filter(Boolean).map((e=>e.trim())).join(""),attributes:bd(s.attributes)}}:{}}}function Ad(e,t){if(!e.isEnabled())return;e.updateUserActivity();const n=function(e){const{metaKey:t,shiftKey:n,ctrlKey:r,altKey:o,key:s,target:a}=e;if(!a||function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable}(a)||!s)return null;const i=t||r||o,c=1===s.length;if(!i&&c)return null;const l=Le(a,{maxStringLength:200})||"<unknown>",u=wd(a,l);return vd({category:"ui.keyDown",message:l,data:{...u.data,metaKey:t,shiftKey:n,ctrlKey:r,altKey:o,key:s}})}(t);n&&cd(e,n)}const Id={resource:function(e){const{entryType:t,initiatorType:n,name:r,responseEnd:o,startTime:s,decodedBodySize:a,encodedBodySize:i,responseStatus:c,transferSize:l}=e;if(["fetch","xmlhttprequest"].includes(n))return null;return{type:`${t}.${n}`,start:kd(s),end:kd(o),name:r,data:{size:l,statusCode:c,decodedBodySize:a,encodedBodySize:i}}},paint:function(e){const{duration:t,entryType:n,name:r,startTime:o}=e,s=kd(o);return{type:n,name:r,start:s,end:s+t,data:void 0}},navigation:function(e){const{entryType:t,name:n,decodedBodySize:r,duration:o,domComplete:s,encodedBodySize:a,domContentLoadedEventStart:i,domContentLoadedEventEnd:c,domInteractive:l,loadEventStart:u,loadEventEnd:d,redirectCount:p,startTime:h,transferSize:f,type:g}=e;if(0===o)return null;return{type:`${t}.${g}`,start:kd(h),end:kd(s),name:n,data:{size:f,decodedBodySize:r,encodedBodySize:a,duration:o,domInteractive:l,domContentLoadedEventStart:i,domContentLoadedEventEnd:c,loadEventStart:u,loadEventEnd:d,domComplete:s,redirectCount:p}}}};function Rd(e){return Id[e.entryType]?Id[e.entryType](e):null}function kd(e){return((xn||Kc.performance.timeOrigin)+e)/1e3}function Cd(e){function t(t){e.performanceEntries.includes(t)||e.performanceEntries.push(t)}function n({entries:e}){e.forEach(t)}const r=[];return["navigation","paint","resource"].forEach((e=>{r.push(Wa(e,n))})),r.push(Va((({metric:t})=>{e.replayPerformanceEntries.push(function(e){const t=e.entries,n=t[t.length-1],r=n?n.element:void 0,o=e.value,s=kd(o);return{type:"largest-contentful-paint",name:"largest-contentful-paint",start:s,end:s,data:{value:o,size:o,nodeId:r?od.mirror.getId(r):void 0}}}(t))}))),()=>{r.forEach((e=>e()))}}const Od="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,xd='var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==r||r<0)&&(r=0),(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},A=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},_=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=x(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},x=function(t,n,r){return-1==t.s?Math.max(x(t.l,n,r+1),x(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},C=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=_(f,15),M=b.t,E=b.l,x=_(h,15),C=x.t,U=x.l,F=D(M),I=F.c,S=F.n,L=D(C),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=_(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,C)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(C,U,0),R=C;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){A(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;A(r,m,Q[et]),m+=R[et],et>3&&(A(r,m,rt>>5&8191),m+=i[et])}else A(r,m,N[rt]),m+=P[rt]}return A(r,m,N[256]),m+P[256]},U=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},L=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=U[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,A=c.p||new n(32768),_=c.h||new n(z+1),x=Math.ceil(o/3),D=2*x,T=function(t){return(a[t]^a[t+1]<<x^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=_[H];if(A[J]=K,_[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=C(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-A[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=A[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=C(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=_,c.p=A,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},O=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},j=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(L(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();function q(t,n){n||(n={});var r=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}}(),e=t.length;r.p(t);var i,a=L(t,n,10+((i=n).filename?i.filename.length+1:0),8),s=a.length;return function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&O(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}}(a,n),O(a,s-8,r.d()),O(a,s-4,e),a}var B=function(){function t(t,n){this.c=S(),this.v=1,j.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),j.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=L(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=S();i.p(n.dictionary),O(t,2,i.d())}}(r,this.o),this.v=0),n&&O(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),G="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}var J=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(K(t),this.d=n||!1)},t}();function K(n,r){if(r){for(var e=new t(n.length),i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}if(G)return G.encode(n);var a=n.length,s=new t(n.length+(n.length>>1)),o=0,f=function(t){s[o++]=t};for(i=0;i<a;++i){if(o+5>s.length){var h=new t(o+8+(a-i<<1));h.set(s),s=h}var l=n.charCodeAt(i);l<128||r?f(l):l<2048?(f(192|l>>6),f(128|63&l)):l>55295&&l<57344?(f(240|(l=65536+(1047552&l)|1023&n.charCodeAt(++i))>>18),f(128|l>>12&63),f(128|l>>6&63),f(128|63&l)):(f(224|l>>12),f(128|l>>6&63),f(128|63&l))}return b(s,0,o)}const N=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(let r=0,e=t.length;r<e;r++)n+=t[r].length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new B,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new J(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},P={clear:()=>{N.clear()},addEvent:t=>N.addEvent(t),finish:()=>N.finish(),compress:t=>function(t){return q(K(t))}(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in P&&"function"==typeof P[n])try{const t=P[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});';function Ld(e,t){Od&&(je.info(e),t&&Pd(e))}function Nd(e,t){Od&&(je.info(e),t&&setTimeout((()=>{Pd(e)}),0))}function Pd(e){Rr({category:"console",data:{logger:"replay"},level:"info",message:e},{level:"info"})}class Dd extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}class Md{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(e){const t=JSON.stringify(e).length;if(this._totalSize+=t,this._totalSize>rl)throw new Dd;this.events.push(e)}finish(){return new Promise((e=>{const t=this.events;this.clear(),e(JSON.stringify(t))}))}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const e=this.events.map((e=>e.timestamp)).sort()[0];return e?ad(e):null}}class Ud{constructor(e){this._worker=e,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise(((e,t)=>{this._worker.addEventListener("message",(({data:n})=>{n.success?e():t()}),{once:!0}),this._worker.addEventListener("error",(e=>{t(e)}),{once:!0})}))),this._ensureReadyPromise}destroy(){Ld("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(e,t){const n=this._getAndIncrementId();return new Promise(((r,o)=>{const s=({data:t})=>{const a=t;if(a.method===e&&a.id===n){if(this._worker.removeEventListener("message",s),!a.success)return Od&&je.error("[Replay]",a.response),void o(new Error("Error in compression worker"));r(a.response)}};this._worker.addEventListener("message",s),this._worker.postMessage({id:n,method:e,arg:t})}))}_getAndIncrementId(){return this._id++}}class $d{constructor(e){this._worker=new Ud(e),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(e){const t=ad(e.timestamp);(!this._earliestTimestamp||t<this._earliestTimestamp)&&(this._earliestTimestamp=t);const n=JSON.stringify(e);return this._totalSize+=n.length,this._totalSize>rl?Promise.reject(new Dd):this._sendEventToWorker(n)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear").then(null,(e=>{Od&&je.warn('[Replay] Sending "clear" message to worker failed',e)}))}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(e){return this._worker.postMessage("addEvent",e)}async _finishRequest(){const e=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,e}}class Fd{constructor(e){this._fallback=new Md,this._compression=new $d(e),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(e){this._used.hasCheckout=e}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(e){return this._used.addEvent(e)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(e){return void Ld("[Replay] Failed to load the compression worker, falling back to simple buffer")}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:e,hasCheckout:t}=this._fallback,n=[];for(const t of e)n.push(this._compression.addEvent(t));this._compression.hasCheckout=t,this._used=this._compression;try{await Promise.all(n)}catch(e){Od&&je.warn("[Replay] Failed to add events when switching buffers.",e)}}}function Gd({useCompression:e,workerUrl:t}){if(e&&window.Worker){const e=function(e){try{const t=e||function(){if("undefined"==typeof __SENTRY_EXCLUDE_REPLAY_WORKER__||!__SENTRY_EXCLUDE_REPLAY_WORKER__)return function(){const e=new Blob([xd]);return URL.createObjectURL(e)}();return""}();if(!t)return;Ld("[Replay] Using compression worker"+(e?` from ${e}`:""));const n=new Worker(t);return new Fd(n)}catch(e){Ld("[Replay] Failed to create compression worker")}}(t);if(e)return e}return Ld("[Replay] Using simple buffer"),new Md}function jd(){try{return"sessionStorage"in Kc&&!!Kc.sessionStorage}catch(e){return!1}}function Vd(e){!function(){if(!jd())return;try{Kc.sessionStorage.removeItem(Qc)}catch(e){}}(),e.session=void 0}function Wd(e){return void 0!==e&&Math.random()<e}function qd(e){const t=Date.now();return{id:e.id||mt(),started:e.started||t,lastActivity:e.lastActivity||t,segmentId:e.segmentId||0,sampled:e.sampled,previousSessionId:e.previousSessionId}}function Bd(e){if(jd())try{Kc.sessionStorage.setItem(Qc,JSON.stringify(e))}catch(e){}}function Hd({sessionSampleRate:e,allowBuffering:t,stickySession:n=!1},{previousSessionId:r}={}){const o=function(e,t){return Wd(e)?"session":!!t&&"buffer"}(e,t),s=qd({sampled:o,previousSessionId:r});return n&&Bd(s),s}function Jd(e,t,n=+new Date){return null===e||void 0===t||t<0||0!==t&&e+t<=n}function zd(e,{maxReplayDuration:t,sessionIdleExpire:n,targetTime:r=Date.now()}){return Jd(e.started,t,r)||Jd(e.lastActivity,n,r)}function Yd(e,{sessionIdleExpire:t,maxReplayDuration:n}){return!!zd(e,{sessionIdleExpire:t,maxReplayDuration:n})&&("buffer"!==e.sampled||0!==e.segmentId)}function Xd({traceInternals:e,sessionIdleExpire:t,maxReplayDuration:n,previousSessionId:r},o){const s=o.stickySession&&function(e){if(!jd())return null;try{const t=Kc.sessionStorage.getItem(Qc);if(!t)return null;const n=JSON.parse(t);return Nd("[Replay] Loading existing session",e),qd(n)}catch(e){return null}}(e);return s?Yd(s,{sessionIdleExpire:t,maxReplayDuration:n})?(Nd("[Replay] Session in sessionStorage is expired, creating new one..."),Hd(o,{previousSessionId:s.id})):s:(Nd("[Replay] Creating new session",e),Hd(o,{previousSessionId:r}))}function Kd(e,t,n){return!!Zd(e,t)&&(Qd(e,t,n),!0)}async function Qd(e,t,n){if(!e.eventBuffer)return null;try{n&&"buffer"===e.recordingMode&&e.eventBuffer.clear(),n&&(e.eventBuffer.hasCheckout=!0);const r=function(e,t){try{if("function"==typeof t&&function(e){return e.type===gu.Custom}(e))return t(e)}catch(e){return Od&&je.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",e),null}return e}(t,e.getOptions().beforeAddRecordingEvent);if(!r)return;return await e.eventBuffer.addEvent(r)}catch(t){const n=t&&t instanceof Dd?"addEventSizeExceeded":"addEvent";Od&&je.error(t),await e.stop({reason:n});const r=Or();r&&r.recordDroppedEvent("internal_sdk_error","replay")}}function Zd(e,t){if(!e.eventBuffer||e.isPaused()||!e.isEnabled())return!1;const n=ad(t.timestamp);return!(n+e.timeouts.sessionIdlePause<Date.now())&&(!(n>e.getContext().initialTimestamp+e.getOptions().maxReplayDuration)||(Ld(`[Replay] Skipping event with timestamp ${n} because it is after maxReplayDuration`,e.getOptions()._experiments.traceInternals),!1))}function ep(e){return!e.type}function tp(e){return"transaction"===e.type}function np(e){return"feedback"===e.type}function rp(e){const t=function(){const e=Or();if(!e)return!1;const t=e.getTransport();if(!t)return!1;return t.send.__sentry__baseTransport__||!1}();return(n,r)=>{if(!e.isEnabled()||!ep(n)&&!tp(n))return;const o=r&&r.statusCode;t&&(!o||o<200||o>=300)||(tp(n)?function(e,t){const n=e.getContext();t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id&&n.traceIds.size<100&&n.traceIds.add(t.contexts.trace.trace_id)}(e,n):function(e,t){const n=e.getContext();t.event_id&&n.errorIds.size<100&&n.errorIds.add(t.event_id);if("buffer"!==e.recordingMode||!t.tags||!t.tags.replayId)return;const{beforeErrorSampling:r}=e.getOptions();if("function"==typeof r&&!r(t))return;setTimeout((()=>{e.sendBufferedReplayOrFlush()}))}(e,n))}}function op(e){return t=>{e.isEnabled()&&ep(t)&&function(e,t){const n=t.exception&&t.exception.values&&t.exception.values[0].value;if("string"!=typeof n)return;if(n.match(/reactjs\.org\/docs\/error-decoder\.html\?invariant=(418|419|422|423|425)/)||n.match(/(does not match server-rendered HTML|Hydration failed because)/i)){cd(e,vd({category:"replay.hydrate-error"}))}}(e,t)}}function sp(e,t=!1){const n=t?rp(e):void 0;return Object.assign(((t,r)=>{if(!e.isEnabled())return t;if(function(e){return"replay_event"===e.type}(t))return delete t.breadcrumbs,t;if(!ep(t)&&!tp(t)&&!np(t))return t;if(!e.checkAndHandleExpiredSession())return t;if(np(t))return e.flush(),t.contexts.feedback.replay_id=e.getSessionId(),function(e,t){e.triggerUserActivity(),e.addUpdate((()=>!t.timestamp||(e.throttledAddEvent({type:gu.Custom,timestamp:1e3*t.timestamp,data:{tag:"breadcrumb",payload:{timestamp:t.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:t.event_id}}}}),!1)))}(e,t),t;if(function(e,t){return!(e.type||!e.exception||!e.exception.values||!e.exception.values.length||!t.originalException||!t.originalException.__rrweb__)}(t,r)&&!e.getOptions()._experiments.captureExceptions)return Od&&je.log("[Replay] Ignoring error from rrweb internals",t),null;const o=function(e,t){return"buffer"===e.recordingMode&&t.message!==el&&!(!t.exception||t.type)&&Wd(e.getOptions().errorSampleRate)}(e,t);return(o||"session"===e.recordingMode)&&(t.tags={...t.tags,replayId:e.getSessionId()}),n&&n(t,{statusCode:200}),t}),{id:"Replay"})}function ap(e,t){return t.map((({type:t,start:n,end:r,name:o,data:s})=>{const a=e.throttledAddEvent({type:gu.Custom,timestamp:n,data:{tag:"performanceSpan",payload:{op:t,description:o,startTimestamp:n,endTimestamp:r,data:s}}});return"string"==typeof a?Promise.resolve(null):a}))}function ip(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{from:t,to:n}=e,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:n,data:{previous:t}}}(t);null!==n&&(e.getContext().urls.push(n.name),e.triggerUserActivity(),e.addUpdate((()=>(ap(e,[n]),!1))))}}function cp(e,t){e.isEnabled()&&null!==t&&(function(e,t){return(!Od||!e.getOptions()._experiments.traceInternals)&&ys(t,Or())}(e,t.name)||e.addUpdate((()=>(ap(e,[t]),!0))))}function lp(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{startTimestamp:t,endTimestamp:n,xhr:r}=e,o=r[Kt];if(!t||!n||!o)return null;const{method:s,url:a,status_code:i}=o;return void 0===a?null:{type:"resource.xhr",name:a,start:t/1e3,end:n/1e3,data:{method:s,statusCode:i}}}(t);cp(e,n)}}function up(e,t){if(e)try{if("string"==typeof e)return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const n=yp(e);return t.encode(n).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch(e){}}function dp(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function pp(e){try{if("string"==typeof e)return[e];if(e instanceof URLSearchParams)return[e.toString()];if(e instanceof FormData)return[yp(e)];if(!e)return[void 0]}catch(t){return Od&&je.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return Od&&je.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}function hp(e,t){if(!e)return{headers:{},size:void 0,_meta:{warnings:[t]}};const n={...e._meta},r=n.warnings||[];return n.warnings=[...r,t],e._meta=n,e}function fp(e,t){if(!t)return null;const{startTimestamp:n,endTimestamp:r,url:o,method:s,statusCode:a,request:i,response:c}=t;return{type:e,start:n/1e3,end:r/1e3,name:o,data:tt({method:s,statusCode:a,request:i,response:c})}}function gp(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function mp(e,t,n){if(!t&&0===Object.keys(e).length)return;if(!t)return{headers:e};if(!n)return{headers:e,size:t};const r={headers:e,size:t},{body:o,warnings:s}=function(e){if(!e||"string"!=typeof e)return{body:e};const t=e.length>tl,n=function(e){const t=e[0],n=e[e.length-1];return"["===t&&"]"===n||"{"===t&&"}"===n}(e);if(t){const t=e.slice(0,tl);return n?{body:t,warnings:["MAYBE_JSON_TRUNCATED"]}:{body:`${t}‚Ä¶`,warnings:["TEXT_TRUNCATED"]}}if(n)try{return{body:JSON.parse(e)}}catch(e){}return{body:e}}(n);return r.body=o,s&&s.length>0&&(r._meta={warnings:s}),r}function _p(e,t){return Object.keys(e).reduce(((n,r)=>{const o=r.toLowerCase();return t.includes(o)&&e[r]&&(n[o]=e[r]),n}),{})}function yp(e){return new URLSearchParams(e).toString()}function vp(e,t){const n=function(e,t=Kc.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(Kc.location.origin))return e;const n=new URL(e,t);if(n.origin!==new URL(t).origin)return e;const r=n.href;if(!e.endsWith("/")&&r.endsWith("/"))return r.slice(0,-1);return r}(e);return Se(n,t)}async function Tp(e,t,n){try{const r=await async function(e,t,n){const r=Date.now(),{startTimestamp:o=r,endTimestamp:s=r}=t,{url:a,method:i,status_code:c=0,request_body_size:l,response_body_size:u}=e.data,d=vp(a,n.networkDetailAllowUrls)&&!vp(a,n.networkDetailDenyUrls),p=d?function({networkCaptureBodies:e,networkRequestHeaders:t},n,r){const o=n?function(e,t){if(1===e.length&&"string"!=typeof e[0])return Ep(e[0],t);if(2===e.length)return Ep(e[1],t);return{}}(n,t):{};if(!e)return mp(o,r,void 0);const s=Sp(n),[a,i]=pp(s),c=mp(o,r,a);if(i)return hp(c,i);return c}(n,t.input,l):gp(l),h=await async function(e,{networkCaptureBodies:t,textEncoder:n,networkResponseHeaders:r},o,s){if(!e&&void 0!==s)return gp(s);const a=o?bp(o.headers,r):{};if(!o||!t&&void 0!==s)return mp(a,s,void 0);const[i,c]=await async function(e){const t=function(e){try{return e.clone()}catch(e){Od&&je.warn("[Replay] Failed to clone response body",e)}}(e);if(!t)return[void 0,"BODY_PARSE_ERROR"];try{const e=await function(e){return new Promise(((t,n)=>{const r=setTimeout((()=>n(new Error("Timeout while trying to read response body"))),500);(async function(e){return await e.text()})(e).then((e=>t(e)),(e=>n(e))).finally((()=>clearTimeout(r)))}))}(t);return[e]}catch(e){return Od&&je.warn("[Replay] Failed to get text body from response",e),[void 0,"BODY_PARSE_ERROR"]}}(o),l=function(e,{networkCaptureBodies:t,textEncoder:n,responseBodySize:r,captureDetails:o,headers:s}){try{const a=e&&e.length&&void 0===r?up(e,n):r;return o?mp(s,a,t?e:void 0):gp(a)}catch(e){return Od&&je.warn("[Replay] Failed to serialize response body",e),mp(s,r,void 0)}}(i,{networkCaptureBodies:t,textEncoder:n,responseBodySize:s,captureDetails:e,headers:a});if(c)return hp(l,c);return l}(d,n,t.response,u);return{startTimestamp:o,endTimestamp:s,url:a,method:i,statusCode:c,request:p,response:h}}(e,t,n),o=fp("resource.fetch",r);cp(n.replay,o)}catch(e){Od&&je.error("[Replay] Failed to capture fetch breadcrumb",e)}}function Sp(e=[]){if(2===e.length&&"object"==typeof e[1])return e[1].body}function bp(e,t){const n={};return t.forEach((t=>{e.get(t)&&(n[t]=e.get(t))})),n}function Ep(e,t){if(!e)return{};const n=e.headers;return n?n instanceof Headers?bp(n,t):Array.isArray(n)?{}:_p(n,t):{}}async function wp(e,t,n){try{const r=function(e,t,n){const r=Date.now(),{startTimestamp:o=r,endTimestamp:s=r,input:a,xhr:i}=t,{url:c,method:l,status_code:u=0,request_body_size:d,response_body_size:p}=e.data;if(!c)return null;if(!i||!vp(c,n.networkDetailAllowUrls)||vp(c,n.networkDetailDenyUrls)){return{startTimestamp:o,endTimestamp:s,url:c,method:l,statusCode:u,request:gp(d),response:gp(p)}}const h=i[Kt],f=h?_p(h.request_headers,n.networkRequestHeaders):{},g=_p(function(e){const t=e.getAllResponseHeaders();if(!t)return{};return t.split("\r\n").reduce(((e,t)=>{const[n,r]=t.split(": ");return e[n.toLowerCase()]=r,e}),{})}(i),n.networkResponseHeaders),[m,_]=n.networkCaptureBodies?pp(a):[void 0],[y,v]=n.networkCaptureBodies?function(e){const t=[];try{return[e.responseText]}catch(e){t.push(e)}try{return function(e,t){try{if("string"==typeof e)return[e];if(e instanceof Document)return[e.body.outerHTML];if("json"===t&&e&&"object"==typeof e)return[JSON.stringify(e)];if(!e)return[void 0]}catch(t){return Od&&je.warn("[Replay] Failed to serialize body",e),[void 0,"BODY_PARSE_ERROR"]}return Od&&je.info("[Replay] Skipping network body because of body type",e),[void 0,"UNPARSEABLE_BODY_TYPE"]}(e.response,e.responseType)}catch(e){t.push(e)}return Od&&je.warn("[Replay] Failed to get xhr response body",...t),[void 0]}(i):[void 0],T=mp(f,d,m),S=mp(g,p,y);return{startTimestamp:o,endTimestamp:s,url:c,method:l,statusCode:u,request:_?hp(T,_):T,response:v?hp(S,v):S}}(e,t,n),o=fp("resource.xhr",r);cp(n.replay,o)}catch(e){Od&&je.error("[Replay] Failed to capture xhr breadcrumb",e)}}function Ap(e,t,n){const{xhr:r,input:o}=t;if(!r)return;const s=up(o,n.textEncoder),a=r.getResponseHeader("content-length")?dp(r.getResponseHeader("content-length")):function(e,t,n){try{return up("json"===t&&e&&"object"==typeof e?JSON.stringify(e):e,n)}catch(e){return}}(r.response,r.responseType,n.textEncoder);void 0!==s&&(e.data.request_body_size=s),void 0!==a&&(e.data.response_body_size=a)}function Ip(e){const t=Or();try{const n=new TextEncoder,{networkDetailAllowUrls:r,networkDetailDenyUrls:o,networkCaptureBodies:s,networkRequestHeaders:a,networkResponseHeaders:i}=e.getOptions(),c={replay:e,textEncoder:n,networkDetailAllowUrls:r,networkDetailDenyUrls:o,networkCaptureBodies:s,networkRequestHeaders:a,networkResponseHeaders:i};t&&t.on?t.on("beforeAddBreadcrumb",((e,t)=>function(e,t,n){if(!t.data)return;try{(function(e){return"xhr"===e.category})(t)&&function(e){return e&&e.xhr}(n)&&(Ap(t,n,e),wp(t,n,e)),function(e){return"fetch"===e.category}(t)&&function(e){return e&&e.response}(n)&&(!function(e,t,n){const{input:r,response:o}=t,s=up(r?Sp(r):void 0,n.textEncoder),a=o?dp(o.headers.get("content-length")):void 0;void 0!==s&&(e.data.request_body_size=s),void 0!==a&&(e.data.response_body_size=a)}(t,n,e),Tp(t,n,e))}catch(e){Od&&je.warn("Error when enriching network breadcrumb")}}(c,e,t))):(Dt(function(e){return t=>{if(!e.isEnabled())return;const n=function(e){const{startTimestamp:t,endTimestamp:n,fetchData:r,response:o}=e;if(!n)return null;const{method:s,url:a}=r;return{type:"resource.fetch",start:t/1e3,end:n/1e3,name:a,data:{method:s,statusCode:o?o.status:void 0}}}(t);cp(e,n)}}(e)),Qt(lp(e)))}catch(e){}}let Rp=null;const kp=e=>t=>{if(!e.isEnabled())return;const n=function(e){const t=e.getLastBreadcrumb&&e.getLastBreadcrumb();if(Rp===t||!t)return null;if(Rp=t,!function(e){return!!e.category}(t)||["fetch","xhr","sentry.event","sentry.transaction"].includes(t.category)||t.category.startsWith("ui."))return null;if("console"===t.category)return function(e){const t=e.data&&e.data.arguments;if(!Array.isArray(t)||0===t.length)return vd(e);let n=!1;const r=t.map((e=>{if(!e)return e;if("string"==typeof e)return e.length>nl?(n=!0,`${e.slice(0,nl)}‚Ä¶`):e;if("object"==typeof e)try{const t=on(e,7);return JSON.stringify(t).length>nl?(n=!0,`${JSON.stringify(t,null,2).slice(0,nl)}‚Ä¶`):t}catch(e){}return e}));return vd({...e,data:{...e.data,arguments:r,...n?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(t);return vd(t)}(t);n&&cd(e,n)};function Cp(e){return!(!e||!e.on)}function Op(e){const{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}=e,o=Date.now()/1e3;return{type:"memory",name:"memory",start:o,end:o,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:n,usedJSHeapSize:r}}}}function xp(e){let t=!1;return(n,r)=>{if(!e.checkAndHandleExpiredSession())return void(Od&&je.warn("[Replay] Received replay event after session expired."));const o=r||!t;t=!0,e.clickDetector&&yd(e.clickDetector,n),e.addUpdate((()=>{if("buffer"===e.recordingMode&&o&&e.setInitialState(),!Kd(e,n,o))return!0;if(!o)return!1;if(function(e,t){if(!t||!e.session||0!==e.session.segmentId)return;Kd(e,function(e){const t=e.getOptions();return{type:gu.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:e.isRecordingCanvas(),sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:!!e.eventBuffer&&"worker"===e.eventBuffer.type,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}(e),!1)}(e,o),e.session&&e.session.previousSessionId)return!0;if("buffer"===e.recordingMode&&e.session&&e.eventBuffer){const t=e.eventBuffer.getEarliestTimestamp();t&&(Ld(`[Replay] Updating session start time to earliest event in buffer to ${new Date(t)}`,e.getOptions()._experiments.traceInternals),e.session.started=t,e.getOptions().stickySession&&Bd(e.session))}return"session"===e.recordingMode&&e.flush(),!0}))}}async function Lp({recordingData:e,replayId:t,segmentId:n,eventContext:r,timestamp:o,session:s}){const a=function({recordingData:e,headers:t}){let n;const r=`${JSON.stringify(t)}\n`;if("string"==typeof e)n=`${r}${e}`;else{const t=(new TextEncoder).encode(r);n=new Uint8Array(t.length+e.length),n.set(t),n.set(e,t.length)}return n}({recordingData:e,headers:{segment_id:n}}),{urls:i,errorIds:c,traceIds:l,initialTimestamp:u}=r,d=Or(),p=xr(),h=d&&d.getTransport(),f=d&&d.getDsn();if(!(d&&h&&f&&s.sampled))return;const g={type:Zc,replay_start_timestamp:u/1e3,timestamp:o/1e3,error_ids:c,trace_ids:l,urls:i,replay_id:t,segment_id:n,replay_type:s.sampled},m=await async function({client:e,scope:t,replayId:n,event:r}){const o={event_id:n,integrations:"object"!=typeof e._integrations||null===e._integrations||Array.isArray(e._integrations)?void 0:Object.keys(e._integrations)};e.emit&&e.emit("preprocessEvent",r,o);const s=await Tr(e.getOptions(),r,o,t,e,Qr());if(!s)return null;s.platform=s.platform||"javascript";const a=e.getSdkMetadata&&e.getSdkMetadata(),{name:i,version:c}=a&&a.sdk||{};return s.sdk={...s.sdk,name:i||"sentry.javascript.unknown",version:c||"0.0.0"},s}({scope:p,client:d,replayId:t,event:g});if(!m)return d.recordDroppedEvent("event_processor","replay",g),void Ld("An event processor returned `null`, will not send event.");delete m.sdkProcessingMetadata;const _=function(e,t,n,r){return Wn(Qn(e,Kn(e),r,n),[[{type:"replay_event"},e],[{type:"replay_recording",length:"string"==typeof t?(new TextEncoder).encode(t).length:t.length},t]])}(m,a,f,d.getOptions().tunnel);let y;try{y=await h.send(_)}catch(e){const t=new Error(el);try{t.cause=e}catch(e){}throw t}if(!y)return y;if("number"==typeof y.statusCode&&(y.statusCode<200||y.statusCode>=300))throw new Np(y.statusCode);const v=nr({},y);if(tr(v,"replay"))throw new Pp(v);return y}class Np extends Error{constructor(e){super(`Transport returned status code ${e}`)}}class Pp extends Error{constructor(e){super("Rate limit hit"),this.rateLimits=e}}async function Dp(e,t={count:0,interval:5e3}){const{recordingData:n,options:r}=e;if(n.length)try{return await Lp(e),!0}catch(n){if(n instanceof Np||n instanceof Pp)throw n;if(kr("Replays",{_retryCount:t.count}),Od&&r._experiments&&r._experiments.captureExceptions&&wr(n),t.count>=3){const e=new Error(`${el} - max retries exceeded`);try{e.cause=n}catch(e){}throw e}return t.interval*=++t.count,new Promise(((n,r)=>{setTimeout((async()=>{try{await Dp(e,t),n(!0)}catch(e){r(e)}}),t.interval)}))}}const Mp="__THROTTLED";function Up(e,t,n){const r=new Map;let o=!1;return(...s)=>{const a=Math.floor(Date.now()/1e3);if((e=>{const t=e-n;r.forEach(((e,n)=>{n<t&&r.delete(n)}))})(a),[...r.values()].reduce(((e,t)=>e+t),0)>=t){const e=o;return o=!0,e?"__SKIPPED":Mp}o=!1;const i=r.get(a)||0;return r.set(a,i+1),e(...s)}}class $p{constructor({options:e,recordingOptions:t}){$p.prototype.__init.call(this),$p.prototype.__init2.call(this),$p.prototype.__init3.call(this),$p.prototype.__init4.call(this),$p.prototype.__init5.call(this),$p.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEntries=[],this.replayPerformanceEntries=[],this.recordingMode="session",this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=t,this._options=e,this._debouncedFlush=function(e,t,n){let r,o,s;const a=n&&n.maxWait?Math.max(n.maxWait,t):0;function i(){return c(),r=e(),r}function c(){void 0!==o&&clearTimeout(o),void 0!==s&&clearTimeout(s),o=s=void 0}function l(){return o&&clearTimeout(o),o=setTimeout(i,t),a&&void 0===s&&(s=setTimeout(i,a)),r}return l.cancel=c,l.flush=function(){return void 0!==o||void 0!==s?i():r},l}((()=>this._flush()),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=Up(((e,t)=>function(e,t,n){return Zd(e,t)?Qd(e,t,n):Promise.resolve(null)}(this,e,t)),300,5);const{slowClickTimeout:n,slowClickIgnoreSelectors:r}=this.getOptions(),o=n?{threshold:Math.min(3e3,n),timeout:n,scrollTimeout:300,ignoreSelector:r?r.join(","):""}:void 0;o&&(this.clickDetector=new gd(this,o))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return Boolean(this._canvas)}getOptions(){return this._options}initializeSampling(e){const{errorSampleRate:t,sessionSampleRate:n}=this._options;t<=0&&n<=0||(this._initializeSessionForSampling(e),this.session?!1!==this.session.sampled&&(this.recordingMode="buffer"===this.session.sampled&&0===this.session.segmentId?"buffer":"session",Nd(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording()):this._handleException(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)throw new Error("Replay recording is already in progress");if(this._isEnabled&&"buffer"===this.recordingMode)throw new Error("Replay buffering is in progress, call `flush()` to save the replay");Nd("[Replay] Starting replay in session mode",this._options._experiments.traceInternals),this._updateUserActivity();const e=Xd({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:!1});this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");Nd("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const e=Xd({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:!0});this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{const e=this._canvas;this._stopRecording=od({...this._recordingOptions,..."buffer"===this.recordingMode&&{checkoutEveryNms:6e4},emit:xp(this),onMutation:this._onMutationHandler,...e?{recordCanvas:e.recordCanvas,getCanvasManager:e.getCanvasManager,sampling:e.sampling,dataURLOptions:e.dataURLOptions}:{}})}catch(e){this._handleException(e)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(e){return this._handleException(e),!1}}async stop({forceFlush:e=!1,reason:t}={}){if(this._isEnabled){this._isEnabled=!1;try{Ld("[Replay] Stopping Replay"+(t?` triggered by ${t}`:""),this._options._experiments.traceInternals),this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),e&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,Vd(this)}catch(e){this._handleException(e)}}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),Ld("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){this._isPaused&&this._checkSession()&&(this._isPaused=!1,this.startRecording(),Ld("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:e=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const t=Date.now();Ld("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const n=this.stopRecording();e&&n&&"session"!==this.recordingMode&&(this.recordingMode="session",this.session&&(this._updateUserActivity(t),this._updateSessionActivity(t),this._maybeSaveSession()),this.startRecording())}addUpdate(e){const t=e();"buffer"!==this.recordingMode&&!0!==t&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._checkSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(!(this._lastActivity&&Jd(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled))return!!this._checkSession();this.pause()}setInitialState(){const e=`${Kc.location.pathname}${Kc.location.hash}${Kc.location.search}`,t=`${Kc.location.origin}${e}`;this.performanceEntries=[],this.replayPerformanceEntries=[],this._clearContext(),this._context.initialUrl=t,this._context.initialTimestamp=Date.now(),this._context.urls.push(t)}throttledAddEvent(e,t){const n=this._throttledAddEvent(e,t);if(n===Mp){const e=vd({category:"replay.throttled"});this.addUpdate((()=>!Kd(this,{type:5,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e,metric:!0}})))}return n}getCurrentRoute(){const e=this.lastTransaction||xr().getTransaction(),t=(e&&yr(e).data||{})[Eo];if(e&&t&&["route","custom"].includes(t))return yr(e).description}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=Gd({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this._isPaused=!1,this.startRecording()}_handleException(e){Od&&je.error("[Replay]",e),Od&&this._options._experiments&&this._options._experiments.captureExceptions&&wr(e)}_initializeSessionForSampling(e){const t=this._options.errorSampleRate>0,n=Xd({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,traceInternals:this._options._experiments.traceInternals,previousSessionId:e},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:t});this.session=n}_checkSession(){if(!this.session)return!1;const e=this.session;return!Yd(e,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})||(this._refreshSession(e),!1)}async _refreshSession(e){this._isEnabled&&(await this.stop({reason:"refresh session"}),this.initializeSampling(e.id))}_addListeners(){try{Kc.document.addEventListener("visibilitychange",this._handleVisibilityChange),Kc.addEventListener("blur",this._handleWindowBlur),Kc.addEventListener("focus",this._handleWindowFocus),Kc.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(!function(e){const t=xr(),n=Or();t.addScopeListener(kp(e)),kt(Ed(e)),zt(ip(e)),Ip(e);const r=sp(e,!Cp(n));n&&n.addEventProcessor?n.addEventProcessor(r):ss(r),Cp(n)&&(n.on("beforeSendEvent",op(e)),n.on("afterSendEvent",rp(e)),n.on("createDsc",(t=>{const n=e.getSessionId();n&&e.isEnabled()&&"session"===e.recordingMode&&e.checkAndHandleExpiredSession()&&(t.replay_id=n)})),n.on("startTransaction",(t=>{e.lastTransaction=t})),n.on("finishTransaction",(t=>{e.lastTransaction=t})),n.on("beforeSendFeedback",((t,n)=>{const r=e.getSessionId();n&&n.includeReplay&&e.isEnabled()&&r&&t.contexts&&t.contexts.feedback&&(t.contexts.feedback.replay_id=r)})))}(this),this._hasInitializedCoreListeners=!0)}catch(e){this._handleException(e)}this._performanceCleanupCallback=Cd(this)}_removeListeners(){try{Kc.document.removeEventListener("visibilitychange",this._handleVisibilityChange),Kc.removeEventListener("blur",this._handleWindowBlur),Kc.removeEventListener("focus",this._handleWindowFocus),Kc.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceCleanupCallback&&this._performanceCleanupCallback()}catch(e){this._handleException(e)}}__init(){this._handleVisibilityChange=()=>{"visible"===Kc.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const e=vd({category:"ui.blur"});this._doChangeToBackgroundTasks(e)}}__init3(){this._handleWindowFocus=()=>{const e=vd({category:"ui.focus"});this._doChangeToForegroundTasks(e)}}__init4(){this._handleKeyboardEvent=e=>{Ad(this,e)}}_doChangeToBackgroundTasks(e){if(!this.session)return;zd(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire})||(e&&this._createCustomBreadcrumb(e),this.conditionalFlush())}_doChangeToForegroundTasks(e){if(!this.session)return;this.checkAndHandleExpiredSession()?e&&this._createCustomBreadcrumb(e):Ld("[Replay] Document has become active, but session has expired")}_updateUserActivity(e=Date.now()){this._lastActivity=e}_updateSessionActivity(e=Date.now()){this.session&&(this.session.lastActivity=e,this._maybeSaveSession())}_createCustomBreadcrumb(e){this.addUpdate((()=>{this.throttledAddEvent({type:gu.Custom,timestamp:e.timestamp||0,data:{tag:"breadcrumb",payload:e}})}))}_addPerformanceEntries(){const e=(t=this.performanceEntries,t.map(Rd).filter(Boolean)).concat(this.replayPerformanceEntries);var t;return this.performanceEntries=[],this.replayPerformanceEntries=[],Promise.all(ap(this,e))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:e,eventBuffer:t}=this;if(!e||!t)return;if(e.segmentId)return;const n=t.getEarliestTimestamp();n&&n<this._context.initialTimestamp&&(this._context.initialTimestamp=n)}_popEventContext(){const e={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),e}async _runFlush(){const e=this.getSessionId();if(this.session&&this.eventBuffer&&e){if(await this._addPerformanceEntries(),this.eventBuffer&&this.eventBuffer.hasEvents&&(await async function(e){try{return Promise.all(ap(e,[Op(Kc.performance.memory)]))}catch(e){return[]}}(this),this.eventBuffer&&e===this.getSessionId()))try{this._updateInitialTimestampFromEventBuffer();const t=Date.now();if(t-this._context.initialTimestamp>this._options.maxReplayDuration+3e4)throw new Error("Session is too long, not sending replay");const n=this._popEventContext(),r=this.session.segmentId++;this._maybeSaveSession();const o=await this.eventBuffer.finish();await Dp({replayId:e,recordingData:o,segmentId:r,eventContext:n,session:this.session,options:this.getOptions(),timestamp:t})}catch(e){this._handleException(e),this.stop({reason:"sendReplay"});const t=Or();t&&t.recordDroppedEvent("send_error","replay")}}else Od&&je.error("[Replay] No session or eventBuffer found to flush.")}__init5(){this._flush=async({force:e=!1}={})=>{if(!this._isEnabled&&!e)return;if(!this.checkAndHandleExpiredSession())return void(Od&&je.error("[Replay] Attempting to finish replay event after session expired."));if(!this.session)return;const t=this.session.started,n=Date.now()-t;this._debouncedFlush.cancel();const r=n<this._options.minReplayDuration,o=n>this._options.maxReplayDuration+5e3;if(r||o)return Ld(`[Replay] Session duration (${Math.floor(n/1e3)}s) is too ${r?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),void(r&&this._debouncedFlush());const s=this.eventBuffer;if(s&&0===this.session.segmentId&&!s.hasCheckout&&Ld("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock)return this._flushLock=this._runFlush(),await this._flushLock,void(this._flushLock=void 0);try{await this._flushLock}catch(e){Od&&je.error(e)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&Bd(this.session)}__init6(){this._onMutationHandler=e=>{const t=e.length,n=this._options.mutationLimit,r=n&&t>n;if(t>this._options.mutationBreadcrumbLimit||r){const e=vd({category:"replay.mutations",data:{count:t,limit:r}});this._createCustomBreadcrumb(e)}return!r||(this.stop({reason:"mutationLimit",forceFlush:"session"===this.recordingMode}),!1)}}}function Fp(e,t,n,r){const o=[...e,..."string"==typeof r?r.split(","):[],...t];return void 0!==n&&("string"==typeof n&&o.push(`.${n}`),Ge((()=>{console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")}))),o.join(",")}const Gp='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',jp=["content-length","content-type","accept"];let Vp=!1;class Wp{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:e=5e3,flushMaxDelay:t=5500,minReplayDuration:n=4999,maxReplayDuration:r=36e5,stickySession:o=!0,useCompression:s=!0,workerUrl:a,_experiments:i={},sessionSampleRate:c,errorSampleRate:l,maskAllText:u=!0,maskAllInputs:d=!0,blockAllMedia:p=!0,mutationBreadcrumbLimit:h=750,mutationLimit:f=1e4,slowClickTimeout:g=7e3,slowClickIgnoreSelectors:m=[],networkDetailAllowUrls:_=[],networkDetailDenyUrls:y=[],networkCaptureBodies:v=!0,networkRequestHeaders:T=[],networkResponseHeaders:S=[],mask:b=[],maskAttributes:E=["title","placeholder"],unmask:w=[],block:A=[],unblock:I=[],ignore:R=[],maskFn:k,beforeAddRecordingEvent:C,beforeErrorSampling:O,blockClass:x,blockSelector:L,maskInputOptions:N,maskTextClass:P,maskTextSelector:D,ignoreClass:M}={}){this.name=Wp.id;const U=function({mask:e,unmask:t,block:n,unblock:r,ignore:o,blockClass:s,blockSelector:a,maskTextClass:i,maskTextSelector:c,ignoreClass:l}){const u={maskTextSelector:Fp(e,[".sentry-mask","[data-sentry-mask]"],i,c),unmaskTextSelector:Fp(t,[".sentry-unmask","[data-sentry-unmask]"]),blockSelector:Fp(n,[".sentry-block","[data-sentry-block]",'base[href="/"]'],s,a),unblockSelector:Fp(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:Fp(o,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],l)};return s instanceof RegExp&&(u.blockClass=s),i instanceof RegExp&&(u.maskTextClass=i),u}({mask:b,unmask:w,block:A,unblock:I,ignore:R,blockClass:x,blockSelector:L,maskTextClass:P,maskTextSelector:D,ignoreClass:M});if(this._recordingOptions={maskAllInputs:d,maskAllText:u,maskInputOptions:{...N||{},password:!0},maskTextFn:k,maskInputFn:k,maskAttributeFn:(e,t,n)=>function({el:e,key:t,maskAttributes:n,maskAllText:r,privacyOptions:o,value:s}){return r?o.unmaskTextSelector&&e.matches(o.unmaskTextSelector)?s:n.includes(t)||"value"===t&&"INPUT"===e.tagName&&["submit","button"].includes(e.getAttribute("type")||"")?s.replace(/[\S]/g,"*"):s:s}({maskAttributes:E,maskAllText:u,privacyOptions:U,key:e,value:t,el:n}),...U,slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,errorHandler:e=>{try{e.__rrweb__=!0}catch(e){}}},this._initialOptions={flushMinDelay:e,flushMaxDelay:t,minReplayDuration:Math.min(n,15e3),maxReplayDuration:Math.min(r,ol),stickySession:o,sessionSampleRate:c,errorSampleRate:l,useCompression:s,workerUrl:a,blockAllMedia:p,maskAllInputs:d,maskAllText:u,mutationBreadcrumbLimit:h,mutationLimit:f,slowClickTimeout:g,slowClickIgnoreSelectors:m,networkDetailAllowUrls:_,networkDetailDenyUrls:y,networkCaptureBodies:v,networkRequestHeaders:qp(T),networkResponseHeaders:qp(S),beforeAddRecordingEvent:C,beforeErrorSampling:O,_experiments:i},"number"==typeof c&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysSessionSampleRate: ${c} })`),this._initialOptions.sessionSampleRate=c),"number"==typeof l&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysOnErrorSampleRate: ${l} })`),this._initialOptions.errorSampleRate=l),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${Gp}`:Gp),this._isInitialized&&rn())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return Vp}set _isInitialized(e){Vp=e}setupOnce(){rn()&&(this._setup(),setTimeout((()=>this._initialize())))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:"session"===this._replay.recordingMode}):Promise.resolve()}flush(e){return this._replay&&this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(e):Promise.resolve()}getReplayId(){if(this._replay&&this._replay.isEnabled())return this._replay.getSessionId()}_initialize(){this._replay&&(this._maybeLoadFromReplayCanvasIntegration(),this._replay.initializeSampling())}_setup(){const e=function(e){const t=Or(),n=t&&t.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...tt(e)};if(!n)return Ge((()=>{console.warn("SDK client is not available.")})),r;null==e.sessionSampleRate&&null==e.errorSampleRate&&null==n.replaysSessionSampleRate&&null==n.replaysOnErrorSampleRate&&Ge((()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")}));"number"==typeof n.replaysSessionSampleRate&&(r.sessionSampleRate=n.replaysSessionSampleRate);"number"==typeof n.replaysOnErrorSampleRate&&(r.errorSampleRate=n.replaysOnErrorSampleRate);return r}(this._initialOptions);this._replay=new $p({options:e,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(){try{const e=Or().getIntegrationByName("ReplayCanvas");if(!e)return;this._replay._canvas=e.getOptions()}catch(e){}}}function qp(e){return[...jp,...e.map((e=>e.toLowerCase()))]}var Bp;function Hp(e,t,n=1/0,r=0){return e?e.nodeType!==e.ELEMENT_NODE||r>n?-1:t(e)?r:Hp(e.parentNode,t,n,r+1):-1}function Jp(e,t){return n=>{const r=n;if(null===r)return!1;try{if(e)if("string"==typeof e){if(r.matches(`.${e}`))return!0}else if(function(e,t){for(let n=e.classList.length;n--;){const r=e.classList[n];if(t.test(r))return!0}return!1}(r,e))return!0;return!(!t||!r.matches(t))}catch(e){return!1}}}Wp.__initStatic(),function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(Bp||(Bp={}));const zp="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let Yp={map:{},getId:()=>(console.error(zp),-1),getNode:()=>(console.error(zp),null),removeNodeFromMap(){console.error(zp)},has:()=>(console.error(zp),!1),reset(){console.error(zp)}};function Xp(e,t,n,r,o=window){const s=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(e){nh((()=>{n.set.call(this,e)}),0),s&&s.set&&s.set.call(this,e)}}),()=>Xp(e,t,s||{},!0)}function Kp(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch(e){return()=>{}}}function Qp(e,t,n,r,o){if(!e)return!1;const s=function(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}(e);if(!s)return!1;const a=Jp(t,n);if(!o){const e=r&&s.matches(r);return a(s)&&!e}const i=Hp(s,a);let c=-1;return!(i<0)&&(r&&(c=Hp(s,Jp(null,r))),i>-1&&c<0||i<c)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Yp=new Proxy(Yp,{get:(e,t,n)=>("map"===t&&console.error(zp),Reflect.get(e,t,n))})),/[1-9][0-9]{12}/.test(Date.now().toString());const Zp={};function eh(e){const t=Zp[e];if(t)return t;const n=window.document;let r=window[e];if(n&&"function"==typeof n.createElement)try{const t=n.createElement("iframe");t.hidden=!0,n.head.appendChild(t);const o=t.contentWindow;o&&o[e]&&(r=o[e]),n.head.removeChild(t)}catch(e){}return Zp[e]=r.bind(window)}function th(...e){return eh("requestAnimationFrame")(...e)}function nh(...e){return eh("setTimeout")(...e)}var rh=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(rh||{});let oh;function sh(e){oh=e}const ah=e=>{if(!oh)return e;return(...t)=>{try{return e(...t)}catch(e){if(oh&&!0===oh(e))return()=>{};throw e}}};for(var ih="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ch="undefined"==typeof Uint8Array?[]:new Uint8Array(256),lh=0;lh<64;lh++)ch[ih.charCodeAt(lh)]=lh;const uh=new Map;const dh=(e,t,n)=>{if(!e||!fh(e,t)&&"object"!=typeof e)return;const r=function(e,t){let n=uh.get(e);return n||(n=new Map,uh.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name);let o=r.indexOf(e);return-1===o&&(o=r.length,r.push(e)),o};function ph(e,t,n){if(e instanceof Array)return e.map((e=>ph(e,t,n)));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray){return{rr_type:e.constructor.name,args:[Object.values(e)]}}if(e instanceof ArrayBuffer){const t=e.constructor.name,n=function(e){var t,n=new Uint8Array(e),r=n.length,o="";for(t=0;t<r;t+=3)o+=ih[n[t]>>2],o+=ih[(3&n[t])<<4|n[t+1]>>4],o+=ih[(15&n[t+1])<<2|n[t+2]>>6],o+=ih[63&n[t+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o}(e);return{rr_type:t,base64:n}}if(e instanceof DataView){return{rr_type:e.constructor.name,args:[ph(e.buffer,t,n),e.byteOffset,e.byteLength]}}if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:n}=e;return{rr_type:t,src:n}}if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}if(e instanceof ImageData){return{rr_type:e.constructor.name,args:[ph(e.data,t,n),e.width,e.height]}}if(fh(e,t)||"object"==typeof e){return{rr_type:e.constructor.name,index:dh(e,t,n)}}return e}const hh=(e,t,n)=>e.map((e=>ph(e,t,n))),fh=(e,t)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((e=>"function"==typeof t[e]));return Boolean(n.find((n=>e instanceof t[n])))};function gh(e,t,n,r,o){const s=[];try{const a=Kp(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(s,...a){if(!Qp(this,t,n,r,!0)){const e=function(e){return"experimental-webgl"===e?"webgl":e}(s);if("__context"in this||(this.__context=e),o&&["webgl","webgl2"].includes(e))if(a[0]&&"object"==typeof a[0]){const e=a[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else a.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[s,...a])}}));s.push(a)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach((e=>e()))}}function mh(e,t,n,r,o,s,a,i){const c=[],l=Object.getOwnPropertyNames(e);for(const a of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(a))try{if("function"!=typeof e[a])continue;const l=Kp(e,a,(function(e){return function(...c){const l=e.apply(this,c);if(dh(l,i,this),"tagName"in this.canvas&&!Qp(this.canvas,r,o,s,!0)){const e=hh(c,i,this),r={type:t,property:a,args:e};n(this.canvas,r)}return l}}));c.push(l)}catch(r){const o=Xp(e,a,{set(e){n(this.canvas,{type:t,property:a,args:[e],setter:!0})}});c.push(o)}return c}class _h{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{sampling:t="all",win:n,blockClass:r,blockSelector:o,unblockSelector:s,maxCanvasSize:a,recordCanvas:i,dataURLOptions:c,errorHandler:l}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,this.options=e,l&&sh(l),e.enableManualSnapshot||ah((()=>{i&&"all"===t&&this.initCanvasMutationObserver(n,r,o,s),i&&"number"==typeof t&&this.initCanvasFPSObserver(t,n,r,o,s,a,{dataURLOptions:c})}))()}initCanvasFPSObserver(e,t,n,r,o,s,a){const i=gh(t,n,r,o,!0),c=this.takeSnapshot(!1,e,t,n,r,o,s,a.dataURLOptions);this.resetObservers=()=>{i(),cancelAnimationFrame(c)}}initCanvasMutationObserver(e,t,n,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const o=gh(e,t,n,r,!1),s=function(e,t,n,r,o){const s=[],a=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const i of a)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[i])continue;const a=Kp(t.CanvasRenderingContext2D.prototype,i,(function(s){return function(...a){return Qp(this.canvas,n,r,o,!0)||nh((()=>{const n=hh(a,t,this);e(this.canvas,{type:rh["2D"],property:i,args:n})}),0),s.apply(this,a)}}));s.push(a)}catch(n){const r=Xp(t.CanvasRenderingContext2D.prototype,i,{set(t){e(this.canvas,{type:rh["2D"],property:i,args:[t],setter:!0})}});s.push(r)}return()=>{s.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n,r),a=function(e,t,n,r,o,s){const a=[];return a.push(...mh(t.WebGLRenderingContext.prototype,rh.WebGL,e,n,r,o,0,t)),void 0!==t.WebGL2RenderingContext&&a.push(...mh(t.WebGL2RenderingContext.prototype,rh.WebGL2,e,n,r,o,0,t)),()=>{a.forEach((e=>e()))}}(this.processMutation.bind(this),e,t,n,r,this.mirror);this.resetObservers=()=>{o(),s(),a()}}snapshot(e){const{options:t}=this,n=this.takeSnapshot(!0,"all"===t.sampling?2:t.sampling||2,t.win,t.blockClass,t.blockSelector,t.unblockSelector,t.maxCanvasSize,t.dataURLOptions,e);this.resetObservers=()=>{cancelAnimationFrame(n)}}takeSnapshot(e,t,n,r,o,s,a,i,c){const l=new Map,u=new Worker(function(){const e=new Blob(['for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="undefined"==typeof Uint8Array?[]:new Uint8Array(256),a=0;a<64;a++)t[e.charCodeAt(a)]=a;var n=function(t){var a,n=new Uint8Array(t),r=n.length,s="";for(a=0;a<r;a+=3)s+=e[n[a]>>2],s+=e[(3&n[a])<<4|n[a+1]>>4],s+=e[(15&n[a+1])<<2|n[a+2]>>6],s+=e[63&n[a+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s};const r=new Map,s=new Map;const i=self;i.onmessage=async function(e){if(!("OffscreenCanvas"in globalThis))return i.postMessage({id:e.data.id});{const{id:t,bitmap:a,width:o,height:f,maxCanvasSize:c,dataURLOptions:g}=e.data,u=async function(e,t,a){const r=e+"-"+t;if("OffscreenCanvas"in globalThis){if(s.has(r))return s.get(r);const i=new OffscreenCanvas(e,t);i.getContext("2d");const o=await i.convertToBlob(a),f=await o.arrayBuffer(),c=n(f);return s.set(r,c),c}return""}(o,f,g),[h,d]=function(e,t,a){if(!a)return[e,t];const[n,r]=a;if(e<=n&&t<=r)return[e,t];let s=e,i=t;return s>n&&(i=Math.floor(n*t/e),s=n),i>r&&(s=Math.floor(r*e/t),i=r),[s,i]}(o,f,c),l=new OffscreenCanvas(h,d),w=l.getContext("bitmaprenderer"),p=h===o&&d===f?a:await createImageBitmap(a,{resizeWidth:h,resizeHeight:d,resizeQuality:"low"});w.transferFromImageBitmap(p),a.close();const y=await l.convertToBlob(g),v=y.type,b=await y.arrayBuffer(),m=n(b);if(p.close(),!r.has(t)&&await u===m)return r.set(t,m),i.postMessage({id:t});if(r.get(t)===m)return i.postMessage({id:t});i.postMessage({id:t,type:v,base64:m,width:o,height:f}),r.set(t,m)}};']);return URL.createObjectURL(e)}());u.onmessage=e=>{const t=e.data,{id:n}=t;if(l.set(n,!1),!("base64"in t))return;const{base64:r,type:o,width:s,height:a}=t;this.mutationCb({id:n,type:rh["2D"],commands:[{property:"clearRect",args:[0,0,s,a]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:o}]},0,0,s,a]}]})};const d=1e3/t;let p,h=0;const f=t=>{h&&t-h<d||(h=t,(e=>{if(e)return[e];const t=[];return n.document.querySelectorAll("canvas").forEach((e=>{Qp(e,r,o,s,!0)||t.push(e)})),t})(c).forEach((t=>{const n=this.mirror.getId(t);if(!l.get(n)&&t.width&&t.height){if(l.set(n,!0),!e&&["webgl","webgl2"].includes(t.__context)){const e=t.getContext(t.__context);!1===or([e,"optionalAccess",e=>e.getContextAttributes,"call",e=>e(),"optionalAccess",e=>e.preserveDrawingBuffer])&&e.clear(e.COLOR_BUFFER_BIT)}createImageBitmap(t).then((e=>{u.postMessage({id:n,bitmap:e,width:t.width,height:t.height,dataURLOptions:i,maxCanvasSize:a},[e])})).catch((e=>{ah((()=>{throw e}))()}))}}))),p=th(f)};return p=th(f),p}startPendingCanvasMutationFlusher(){th((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,th(e)};th(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((e,t)=>{const n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)})),th((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;const r=n.map((e=>{const{type:t,...n}=e;return n})),{type:o}=n[0];this.mutationCb({id:t,type:o,commands:r}),this.pendingCanvasMutations.delete(e)}}const yh={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}},vh="ReplayCanvas",Th=1280,Sh=(e={})=>{const[t,n]=e.maxCanvasSize||[],r={quality:e.quality||"medium",enableManualSnapshot:e.enableManualSnapshot,maxCanvasSize:[t?Math.min(t,Th):Th,n?Math.min(n,Th):Th]};let o;const s=new Promise((e=>o=e));return{name:vh,setupOnce(){},getOptions(){const{quality:e,enableManualSnapshot:t,maxCanvasSize:n}=r;return{enableManualSnapshot:t,recordCanvas:!0,getCanvasManager:e=>{const r=new _h({...e,enableManualSnapshot:t,maxCanvasSize:n,errorHandler:e=>{try{"object"==typeof e&&(e.__rrweb__=!0)}catch(e){}}});return o(r),r},...yh[e||"medium"]||yh.medium}},async snapshot(e){(await s).snapshot(e)}}},bh=Xo(vh,Sh),Eh=Re,wh="#ffffff",Ah="inherit",Ih="rgba(108, 95, 199, 1)",Rh={fontFamily:"system-ui, 'Helvetica Neue', Arial, sans-serif",fontSize:"14px",background:wh,backgroundHover:"#f6f6f7",foreground:"#2b2233",border:"1.5px solid rgba(41, 35, 47, 0.13)",borderRadius:"25px",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",success:"#268d75",error:"#df3338",submitBackground:"rgba(88, 74, 192, 1)",submitBackgroundHover:Ih,submitBorder:Ih,submitOutlineFocus:"#29232f",submitForeground:wh,submitForegroundHover:wh,cancelBackground:"transparent",cancelBackgroundHover:"var(--background-hover)",cancelBorder:"var(--border)",cancelOutlineFocus:"var(--input-outline-focus)",cancelForeground:"var(--foreground)",cancelForegroundHover:"var(--foreground)",inputBackground:Ah,inputForeground:Ah,inputBorder:"var(--border)",inputOutlineFocus:Ih,formBorderRadius:"20px",formContentBorderRadius:"6px"},kh=Rh,Ch={...Rh,background:"#29232f",backgroundHover:"#352f3b",foreground:"#ebe6ef",border:"1.5px solid rgba(235, 230, 239, 0.15)",success:"#2da98c",error:"#f55459"},Oh="widget",xh="api";async function Lh({feedback:{message:e,email:t,name:n,source:r,url:o}},{includeReplay:s=!0}={}){const a=Or(),i=a&&a.getTransport(),c=a&&a.getDsn();if(!a||!i||!c)return;const l={contexts:{feedback:{contact_email:t,name:n,message:e,url:o,source:r}},type:"feedback"};return Cr((async e=>{e.clearBreadcrumbs(),[xh,Oh].includes(String(r))&&e.setLevel("info");const t=await async function({client:e,scope:t,event:n}){const r={};e.emit&&e.emit("preprocessEvent",n,r);const o=await Tr(e.getOptions(),n,r,t,e,Qr());return null===o?(e.recordDroppedEvent("event_processor","feedback",n),null):(o.platform=o.platform||"javascript",o)}({scope:e,client:a,event:l});if(!t)return;a.emit&&a.emit("beforeSendFeedback",t,{includeReplay:Boolean(s)});const n=jo(t,c,a.getOptions()._metadata,a.getOptions().tunnel);let o;try{o=await i.send(n)}catch(e){const t=new Error("Unable to send Feedback");try{t.cause=e}catch(e){}throw t}if(o){if("number"==typeof o.statusCode&&(o.statusCode<200||o.statusCode>=300))throw new Error("Unable to send Feedback");return o}}))}function Nh({name:e,email:t,message:n,source:r=xh,url:o=Pe()},s={}){if(!n)throw new Error("Unable to submit feedback with empty message");return Lh({feedback:{name:e,email:t,message:n,url:o,source:r}},s)}const Ph="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Dh(e,t){return{...e,...t,themeDark:{...e.themeDark,...t.themeDark},themeLight:{...e.themeLight,...t.themeLight}}}function Mh(e){return`\n  --background: ${e.background};\n  --background-hover: ${e.backgroundHover};\n  --foreground: ${e.foreground};\n  --error: ${e.error};\n  --success: ${e.success};\n  --border: ${e.border};\n  --border-radius: ${e.borderRadius};\n  --box-shadow: ${e.boxShadow};\n\n  --submit-background: ${e.submitBackground};\n  --submit-background-hover: ${e.submitBackgroundHover};\n  --submit-border: ${e.submitBorder};\n  --submit-outline-focus: ${e.submitOutlineFocus};\n  --submit-foreground: ${e.submitForeground};\n  --submit-foreground-hover: ${e.submitForegroundHover};\n\n  --cancel-background: ${e.cancelBackground};\n  --cancel-background-hover: ${e.cancelBackgroundHover};\n  --cancel-border: ${e.cancelBorder};\n  --cancel-outline-focus: ${e.cancelOutlineFocus};\n  --cancel-foreground: ${e.cancelForeground};\n  --cancel-foreground-hover: ${e.cancelForegroundHover};\n\n  --input-background: ${e.inputBackground};\n  --input-foreground: ${e.inputForeground};\n  --input-border: ${e.inputBorder};\n  --input-outline-focus: ${e.inputOutlineFocus};\n\n  --form-border-radius: ${e.formBorderRadius};\n  --form-content-border-radius: ${e.formContentBorderRadius};\n  `}function Uh({id:e,colorScheme:t,themeDark:n,themeLight:r}){try{const o=Eh.document,s=o.createElement("div");s.id=e;const a=s.attachShadow({mode:"open"});return a.appendChild(function(e,t,n){const r=e.createElement("style");return r.textContent=`\n:host {\n  --bottom: 1rem;\n  --right: 1rem;\n  --top: auto;\n  --left: auto;\n  --z-index: 100000;\n  --font-family: ${n.light.fontFamily};\n  --font-size: ${n.light.fontSize};\n\n  position: fixed;\n  left: var(--left);\n  right: var(--right);\n  bottom: var(--bottom);\n  top: var(--top);\n  z-index: var(--z-index);\n\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n\n  ${Mh("dark"===t?n.dark:n.light)}\n}\n\n${"system"===t?`\n@media (prefers-color-scheme: dark) {\n  :host {\n    ${Mh(n.dark)}\n  }\n}`:""}\n}`,r}(o,t,{dark:n,light:r})),a.appendChild(function(e){const t=e.createElement("style");return t.textContent="\n.dialog {\n  line-height: 25px;\n  background-color: rgba(0, 0, 0, 0.05);\n  border: none;\n  position: fixed;\n  inset: 0;\n  z-index: 10000;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 1;\n  transition: opacity 0.2s ease-in-out;\n}\n\n.dialog:not([open]) {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n}\n.dialog:not([open]) .dialog__content {\n  transform: translate(0, -16px) scale(0.98);\n}\n\n.dialog__content {\n  position: fixed;\n  left: var(--left);\n  right: var(--right);\n  bottom: var(--bottom);\n  top: var(--top);\n\n  border: var(--border);\n  border-radius: var(--form-border-radius);\n  background-color: var(--background);\n  color: var(--foreground);\n\n  width: 320px;\n  max-width: 100%;\n  max-height: calc(100% - 2rem);\n  display: flex;\n  flex-direction: column;\n  box-shadow: var(--box-shadow);\n  transition: transform 0.2s ease-in-out;\n  transform: translate(0, 0) scale(1);\n}\n\n.dialog__header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 20px;\n  font-weight: 600;\n  padding: 24px 24px 0 24px;\n  margin: 0;\n  margin-bottom: 16px;\n}\n\n.brand-link {\n  display: inline-flex;\n}\n\n.error {\n  color: var(--error);\n  margin-bottom: 16px;\n}\n\n.form {\n  display: grid;\n  overflow: auto;\n  flex-direction: column;\n  gap: 16px;\n  padding: 0 24px 24px;\n}\n\n.form__error-container {\n  color: var(--error);\n}\n\n.form__error-container--hidden {\n  display: none;\n}\n\n.form__label {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  margin: 0px;\n}\n\n.form__label__text {\n  display: grid;\n  gap: 4px;\n  align-items: center;\n  grid-auto-flow: column;\n  grid-auto-columns: max-content;\n}\n\n.form__label__text--required {\n  font-size: 0.85em;\n}\n\n.form__input {\n  line-height: inherit;\n  background-color: var(--input-background);\n  box-sizing: border-box;\n  border: var(--input-border);\n  border-radius: var(--form-content-border-radius);\n  color: var(--input-foreground);\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 500;\n  padding: 6px 12px;\n}\n\n.form__input::placeholder {\n  color: var(--input-foreground);\n  opacity: 0.65;\n}\n\n.form__input:focus-visible {\n  outline: 1px auto var(--input-outline-focus);\n}\n\n.form__input--textarea {\n  font-family: inherit;\n  resize: vertical;\n}\n\n.btn-group {\n  display: grid;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.btn {\n  line-height: inherit;\n  border: var(--cancel-border);\n  border-radius: var(--form-content-border-radius);\n  cursor: pointer;\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 600;\n  padding: 6px 16px;\n}\n.btn[disabled] {\n  opacity: 0.6;\n  pointer-events: none;\n}\n\n.btn--primary {\n  background-color: var(--submit-background);\n  border-color: var(--submit-border);\n  color: var(--submit-foreground);\n}\n.btn--primary:hover {\n  background-color: var(--submit-background-hover);\n  color: var(--submit-foreground-hover);\n}\n.btn--primary:focus-visible {\n  outline: 1px auto var(--submit-outline-focus);\n}\n\n.btn--default {\n  background-color: var(--cancel-background);\n  color: var(--cancel-foreground);\n  font-weight: 500;\n}\n.btn--default:hover {\n  background-color: var(--cancel-background-hover);\n  color: var(--cancel-foreground-hover);\n}\n.btn--default:focus-visible {\n  outline: 1px auto var(--cancel-outline-focus);\n}\n\n.success-message {\n  background-color: var(--background);\n  border: var(--border);\n  border-radius: var(--border-radius);\n  box-shadow: var(--box-shadow);\n  font-weight: 600;\n  color: var(--success);\n  padding: 12px 24px;\n  line-height: 25px;\n  display: grid;\n  align-items: center;\n  grid-auto-flow: column;\n  gap: 6px;\n  cursor: default;\n}\n\n.success-icon path {\n  fill: var(--success);\n}\n",t}(o)),{shadow:a,host:s}}catch(e){throw je.warn("[Feedback] Browser does not support shadow DOM API"),new Error("Browser does not support shadow DOM API.")}}async function $h(e,t,n){if(!e)return;e.hideError();try{return await Nh({...t,source:Oh},n)}catch(t){Ph&&je.error(t),e&&e.showError("There was a problem submitting feedback, please wait and try again.")}}function Fh(e,t){return Object.entries(t).forEach((([t,n])=>{e.setAttributeNS(null,t,n)})),e}const Gh=20,jh="http://www.w3.org/2000/svg";function Vh(e,t,...n){const r=Eh.document.createElement(e);t&&Object.entries(t).forEach((([e,t])=>{"className"===e&&"string"==typeof t?r.setAttribute("class",t):"boolean"==typeof t&&t?r.setAttribute(e,""):"string"==typeof t?r.setAttribute(e,t):e.startsWith("on")&&"function"==typeof t&&r.addEventListener(e.substring(2).toLowerCase(),t)}));for(const e of n)Wh(r,e);return r}function Wh(e,t){const n=Eh.document;if(null!=t)if(Array.isArray(t))for(const n of t)Wh(e,n);else!1===t||("string"==typeof t?e.appendChild(n.createTextNode(t)):t instanceof Node?e.appendChild(t):e.appendChild(n.createTextNode(String(t))))}function qh({buttonLabel:e,onClick:t}){const n=Vh("button",{type:"button",className:"widget__actor","aria-label":e,"aria-hidden":"false"},function(){const e=e=>Eh.document.createElementNS(jh,e),t=Fh(e("svg"),{class:"feedback-icon",width:`${Gh}`,height:`${Gh}`,viewBox:`0 0 ${Gh} ${Gh}`,fill:"none"}),n=Fh(e("g"),{clipPath:"url(#clip0_57_80)"}),r=Fh(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.6622 15H12.3997C12.2129 14.9959 12.031 14.9396 11.8747 14.8375L8.04965 12.2H7.49956V19.1C7.4875 19.3348 7.3888 19.5568 7.22256 19.723C7.05632 19.8892 6.83435 19.9879 6.59956 20H2.04956C1.80193 19.9968 1.56535 19.8969 1.39023 19.7218C1.21511 19.5467 1.1153 19.3101 1.11206 19.0625V12.2H0.949652C0.824431 12.2017 0.700142 12.1783 0.584123 12.1311C0.468104 12.084 0.362708 12.014 0.274155 11.9255C0.185602 11.8369 0.115689 11.7315 0.0685419 11.6155C0.0213952 11.4995 -0.00202913 11.3752 -0.00034808 11.25V3.75C-0.00900498 3.62067 0.0092504 3.49095 0.0532651 3.36904C0.0972798 3.24712 0.166097 3.13566 0.255372 3.04168C0.344646 2.94771 0.452437 2.87327 0.571937 2.82307C0.691437 2.77286 0.82005 2.74798 0.949652 2.75H8.04965L11.8747 0.1625C12.031 0.0603649 12.2129 0.00407221 12.3997 0H15.6622C15.9098 0.00323746 16.1464 0.103049 16.3215 0.278167C16.4966 0.453286 16.5964 0.689866 16.5997 0.9375V3.25269C17.3969 3.42959 18.1345 3.83026 18.7211 4.41679C19.5322 5.22788 19.9878 6.32796 19.9878 7.47502C19.9878 8.62209 19.5322 9.72217 18.7211 10.5333C18.1345 11.1198 17.3969 11.5205 16.5997 11.6974V14.0125C16.6047 14.1393 16.5842 14.2659 16.5395 14.3847C16.4948 14.5035 16.4268 14.6121 16.3394 14.7042C16.252 14.7962 16.147 14.8698 16.0307 14.9206C15.9144 14.9714 15.7891 14.9984 15.6622 15ZM1.89695 10.325H1.88715V4.625H8.33715C8.52423 4.62301 8.70666 4.56654 8.86215 4.4625L12.6872 1.875H14.7247V13.125H12.6872L8.86215 10.4875C8.70666 10.3835 8.52423 10.327 8.33715 10.325H2.20217C2.15205 10.3167 2.10102 10.3125 2.04956 10.3125C1.9981 10.3125 1.94708 10.3167 1.89695 10.325ZM2.98706 12.2V18.1625H5.66206V12.2H2.98706ZM16.5997 9.93612V5.01393C16.6536 5.02355 16.7072 5.03495 16.7605 5.04814C17.1202 5.13709 17.4556 5.30487 17.7425 5.53934C18.0293 5.77381 18.2605 6.06912 18.4192 6.40389C18.578 6.73866 18.6603 7.10452 18.6603 7.47502C18.6603 7.84552 18.578 8.21139 18.4192 8.54616C18.2605 8.88093 18.0293 9.17624 17.7425 9.41071C17.4556 9.64518 17.1202 9.81296 16.7605 9.90191C16.7072 9.91509 16.6536 9.9265 16.5997 9.93612Z"});t.appendChild(n).appendChild(r);const o=e("defs"),s=Fh(e("clipPath"),{id:"clip0_57_80"}),a=Fh(e("rect"),{width:`${Gh}`,height:`${Gh}`,fill:"white"});return s.appendChild(a),o.appendChild(s),t.appendChild(o).appendChild(s).appendChild(a),{get el(){return t}}}().el,e?Vh("span",{className:"widget__actor__text"},e):null);return n.addEventListener("click",(function(e){t&&t(e)})),{get el(){return n},show:()=>{n.classList.remove("widget__actor--hidden"),n.setAttribute("aria-hidden","false")},hide:()=>{n.classList.add("widget__actor--hidden"),n.setAttribute("aria-hidden","true")}}}function Bh(e,t){const n=e.get(t);return"string"==typeof n?n.trim():""}function Hh({nameLabel:e,namePlaceholder:t,emailLabel:n,emailPlaceholder:r,messageLabel:o,messagePlaceholder:s,isRequiredLabel:a,cancelButtonLabel:i,submitButtonLabel:c,showName:l,showEmail:u,isNameRequired:d,isEmailRequired:p,defaultName:h,defaultEmail:f,onCancel:g,onSubmit:m}){const{el:_}=function({label:e}){return{el:Vh("button",{type:"submit",className:"btn btn--primary","aria-label":e},e)}}({label:c});const y=Vh("div",{className:"form__error-container form__error-container--hidden","aria-hidden":"true"});const v=Vh("input",{id:"name",type:l?"text":"hidden","aria-hidden":l?"false":"true",name:"name",required:d,className:"form__input",placeholder:t,value:h}),T=Vh("input",{id:"email",type:u?"text":"hidden","aria-hidden":u?"false":"true",name:"email",required:p,className:"form__input",placeholder:r,value:f}),S=Vh("textarea",{id:"message",autoFocus:"true",rows:"5",name:"message",required:!0,className:"form__input form__input--textarea",placeholder:s}),b=Vh("button",{type:"button",className:"btn btn--default","aria-label":i,onClick:e=>{g&&g(e)}},i),E=Vh("form",{className:"form",onSubmit:function(e){if(e.preventDefault(),e.target instanceof HTMLFormElement)try{if(m){const t=new FormData(e.target),n={name:Bh(t,"name"),email:Bh(t,"email"),message:Bh(t,"message")};m(n)}}catch(e){}}},[y,l&&Vh("label",{htmlFor:"name",className:"form__label"},[Vh("span",{className:"form__label__text"},e,d&&Vh("span",{className:"form__label__text--required"},` ${a}`)),v]),!l&&v,u&&Vh("label",{htmlFor:"email",className:"form__label"},[Vh("span",{className:"form__label__text"},n,p&&Vh("span",{className:"form__label__text--required"},` ${a}`)),T]),!u&&T,Vh("label",{htmlFor:"message",className:"form__label"},[Vh("span",{className:"form__label__text"},o,Vh("span",{className:"form__label__text--required"},` ${a}`)),S]),Vh("div",{className:"btn-group"},[_,b])]);return{get el(){return E},showError:function(e){y.textContent=e,y.classList.remove("form__error-container--hidden"),y.setAttribute("aria-hidden","false")},hideError:function(){y.textContent="",y.classList.add("form__error-container--hidden"),y.setAttribute("aria-hidden","true")}}}const Jh="http://www.w3.org/2000/svg";function zh({formTitle:e,showBranding:t,showName:n,showEmail:r,isNameRequired:o,isEmailRequired:s,colorScheme:a,defaultName:i,defaultEmail:c,onClosed:l,onCancel:u,onSubmit:d,...p}){let h=null;function f(){h&&(h.open=!1)}const{el:g,showError:m,hideError:_}=Hh({showEmail:r,showName:n,isEmailRequired:s,isNameRequired:o,defaultName:i,defaultEmail:c,onSubmit:d,onCancel:u,...p});return h=Vh("dialog",{className:"dialog",open:!0,onClick:function(){f(),l&&l()}},Vh("div",{className:"dialog__content",onClick:e=>{e.stopPropagation()}},Vh("h2",{className:"dialog__header"},e,t&&Vh("a",{className:"brand-link",target:"_blank",href:"https://sentry.io/welcome/",title:"Powered by Sentry",rel:"noopener noreferrer"},function({colorScheme:e}){const t=e=>Eh.document.createElementNS(Jh,e),n=Fh(t("svg"),{class:"sentry-logo",width:"32",height:"30",viewBox:"0 0 72 66",fill:"none"}),r=Fh(t("path"),{transform:"translate(11, 11)",d:"M29,2.26a4.67,4.67,0,0,0-8,0L14.42,13.53A32.21,32.21,0,0,1,32.17,40.19H27.55A27.68,27.68,0,0,0,12.09,17.47L6,28a15.92,15.92,0,0,1,9.23,12.17H4.62A.76.76,0,0,1,4,39.06l2.94-5a10.74,10.74,0,0,0-3.36-1.9l-2.91,5a4.54,4.54,0,0,0,1.69,6.24A4.66,4.66,0,0,0,4.62,44H19.15a19.4,19.4,0,0,0-8-17.31l2.31-4A23.87,23.87,0,0,1,23.76,44H36.07a35.88,35.88,0,0,0-16.41-31.8l4.67-8a.77.77,0,0,1,1.05-.27c.53.29,20.29,34.77,20.66,35.17a.76.76,0,0,1-.68,1.13H40.6q.09,1.91,0,3.81h4.78A4.59,4.59,0,0,0,50,39.43a4.49,4.49,0,0,0-.62-2.28Z"});n.append(r);const o=t("defs"),s=t("style");return s.textContent=`\n    path {\n      fill: ${"dark"===e?"#fff":"#362d59"};\n    }`,"system"===e&&(s.textContent+="\n    @media (prefers-color-scheme: dark) {\n      path: {\n        fill: '#fff';\n      }\n    }\n    "),o.append(s),n.append(o),{get el(){return n}}}({colorScheme:a}).el)),g)),{get el(){return h},showError:m,hideError:_,open:function(){h&&(h.open=!0)},close:f,checkIsOpen:function(){return h&&!0===h.open||!1}}}const Yh=16,Xh=17,Kh="http://www.w3.org/2000/svg";function Qh({message:e,onRemove:t}){function n(){r&&(r.remove(),t&&t())}const r=Vh("div",{className:"success-message",onClick:n},function(){const e=e=>Eh.document.createElementNS(Kh,e),t=Fh(e("svg"),{class:"success-icon",width:`${Yh}`,height:`${Xh}`,viewBox:`0 0 ${Yh} ${Xh}`,fill:"none"}),n=Fh(e("g"),{clipPath:"url(#clip0_57_156)"}),r=Fh(e("path"),{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.55544 15.1518C4.87103 16.0308 6.41775 16.5 8 16.5C10.1217 16.5 12.1566 15.6571 13.6569 14.1569C15.1571 12.6566 16 10.6217 16 8.5C16 6.91775 15.5308 5.37103 14.6518 4.05544C13.7727 2.73985 12.5233 1.71447 11.0615 1.10897C9.59966 0.503466 7.99113 0.34504 6.43928 0.653721C4.88743 0.962403 3.46197 1.72433 2.34315 2.84315C1.22433 3.96197 0.462403 5.38743 0.153721 6.93928C-0.15496 8.49113 0.00346625 10.0997 0.608967 11.5615C1.21447 13.0233 2.23985 14.2727 3.55544 15.1518ZM4.40546 3.1204C5.46945 2.40946 6.72036 2.03 8 2.03C9.71595 2.03 11.3616 2.71166 12.575 3.92502C13.7883 5.13838 14.47 6.78405 14.47 8.5C14.47 9.77965 14.0905 11.0306 13.3796 12.0945C12.6687 13.1585 11.6582 13.9878 10.476 14.4775C9.29373 14.9672 7.99283 15.0953 6.73777 14.8457C5.48271 14.596 4.32987 13.9798 3.42502 13.075C2.52018 12.1701 1.90397 11.0173 1.65432 9.76224C1.40468 8.50718 1.5328 7.20628 2.0225 6.02404C2.5122 4.8418 3.34148 3.83133 4.40546 3.1204Z"}),o=Fh(e("path"),{d:"M6.68775 12.4297C6.78586 12.4745 6.89218 12.4984 7 12.5C7.11275 12.4955 7.22315 12.4664 7.32337 12.4145C7.4236 12.3627 7.51121 12.2894 7.58 12.2L12 5.63999C12.0848 5.47724 12.1071 5.28902 12.0625 5.11098C12.0178 4.93294 11.9095 4.77744 11.7579 4.67392C11.6064 4.57041 11.4221 4.52608 11.24 4.54931C11.0579 4.57254 10.8907 4.66173 10.77 4.79999L6.88 10.57L5.13 8.56999C5.06508 8.49566 4.98613 8.43488 4.89768 8.39111C4.80922 8.34735 4.713 8.32148 4.61453 8.31498C4.51605 8.30847 4.41727 8.32147 4.32382 8.35322C4.23038 8.38497 4.14413 8.43484 4.07 8.49999C3.92511 8.63217 3.83692 8.81523 3.82387 9.01092C3.81083 9.2066 3.87393 9.39976 4 9.54999L6.43 12.24C6.50187 12.3204 6.58964 12.385 6.68775 12.4297Z"});t.appendChild(n).append(o,r);const s=e("defs"),a=Fh(e("clipPath"),{id:"clip0_57_156"}),i=Fh(e("rect"),{width:`${Yh}`,height:`${Yh}`,fill:"white",transform:"translate(0 0.5)"});return a.appendChild(i),s.appendChild(a),t.appendChild(s).appendChild(a).appendChild(i),{get el(){return t}}}().el,e);return{el:r,remove:n}}function Zh({shadow:e,options:{shouldCreateActor:t=!0,...n},attachTo:r}){let o,s,a=!1;async function i(t){if(!s)return;const r=[];if(n.isNameRequired&&!t.name&&r.push(n.nameLabel),n.isEmailRequired&&!t.email&&r.push(n.emailLabel),t.message||r.push(n.messageLabel),r.length>0)return void s.showError(`Please enter in the following required fields: ${r.join(", ")}`);await $h(s,t)?(h(),function(){if(e)try{const t=Qh({message:n.successMessageText,onRemove:()=>{r&&clearTimeout(r),l()}});if(!t.el)throw new Error("Unable to show success message");e.appendChild(t.el);const r=setTimeout((()=>{t&&t.remove()}),5e3)}catch(e){je.error(e)}}(),n.onSubmitSuccess&&n.onSubmitSuccess()):n.onSubmitError&&n.onSubmitError()}function c(){const e=Or(),t=e&&e.getIntegrationByName&&e.getIntegrationByName("Replay");t&&t.flush().catch((e=>{Ph&&je.error(e)}))}function l(){o&&o.show()}function u(){o&&o.hide()}function d(){try{if(s)return s.open(),a=!0,n.onFormOpen&&n.onFormOpen(),void c();const t=n.useSentryUser,r=xr(),o=r&&r.getUser();if(s=zh({colorScheme:n.colorScheme,showBranding:n.showBranding,showName:n.showName||n.isNameRequired,showEmail:n.showEmail||n.isEmailRequired,isNameRequired:n.isNameRequired,isEmailRequired:n.isEmailRequired,formTitle:n.formTitle,cancelButtonLabel:n.cancelButtonLabel,submitButtonLabel:n.submitButtonLabel,emailLabel:n.emailLabel,emailPlaceholder:n.emailPlaceholder,messageLabel:n.messageLabel,messagePlaceholder:n.messagePlaceholder,nameLabel:n.nameLabel,namePlaceholder:n.namePlaceholder,isRequiredLabel:n.isRequiredLabel,defaultName:t&&o&&o[t.name]||"",defaultEmail:t&&o&&o[t.email]||"",onClosed:()=>{l(),a=!1,n.onFormClose&&n.onFormClose()},onCancel:()=>{p(),l()},onSubmit:i}),!s.el)throw new Error("Unable to open Feedback dialog");e.appendChild(s.el),u(),n.onFormOpen&&n.onFormOpen(),c()}catch(e){je.error(e)}}function p(){s&&(s.close(),a=!1,n.onFormClose&&n.onFormClose())}function h(){if(s){p();const e=s.el;e&&e.remove(),s=void 0}}function f(){a||d(),u()}return r?r.addEventListener("click",f):t&&(o=qh({buttonLabel:n.buttonLabel,onClick:f}),o.el&&e.appendChild(o.el)),{get actor(){return o},get dialog(){return s},showActor:l,hideActor:u,removeActor:function(){o&&o.el&&o.el.remove()},openDialog:d,closeDialog:p,removeDialog:h}}const ef=Eh.document;class tf{static __initStatic(){this.id="Feedback"}constructor({autoInject:e=!0,id:t="sentry-feedback",isEmailRequired:n=!1,isNameRequired:r=!1,showBranding:o=!0,showEmail:s=!0,showName:a=!0,useSentryUser:i={email:"email",name:"username"},themeDark:c,themeLight:l,colorScheme:u="system",buttonLabel:d="Report a Bug",cancelButtonLabel:p="Cancel",submitButtonLabel:h="Send Bug Report",formTitle:f="Report a Bug",emailPlaceholder:g="your.email@example.org",emailLabel:m="Email",messagePlaceholder:_="What's the bug? What did you expect?",messageLabel:y="Description",namePlaceholder:v="Your Name",nameLabel:T="Name",isRequiredLabel:S="(required)",successMessageText:b="Thank you for your report!",onFormClose:E,onFormOpen:w,onSubmitError:A,onSubmitSuccess:I}={}){this.name=tf.id,this._host=null,this._shadow=null,this._widget=null,this._widgets=new Set,this._hasInsertedActorStyles=!1,this.options={autoInject:e,showBranding:o,id:t,isEmailRequired:n,isNameRequired:r,showEmail:s,showName:a,useSentryUser:i,colorScheme:u,themeDark:{...Ch,...c},themeLight:{...kh,...l},buttonLabel:d,cancelButtonLabel:p,submitButtonLabel:h,formTitle:f,emailLabel:m,emailPlaceholder:g,messageLabel:y,messagePlaceholder:_,nameLabel:T,namePlaceholder:v,isRequiredLabel:S,successMessageText:b,onFormClose:E,onFormOpen:w,onSubmitError:A,onSubmitSuccess:I}}setupOnce(){if(rn())try{this._cleanupWidgetIfExists();const{autoInject:e}=this.options;if(!e)return;this._createWidget(this.options)}catch(e){Ph&&je.error(e)}}openDialog(){this._widget||this._createWidget({...this.options,shouldCreateActor:!1}),this._widget&&this._widget.openDialog()}closeDialog(){this._widget&&this._widget.closeDialog()}attachTo(e,t){try{const n=Dh(this.options,t||{});return this._ensureShadowHost(n,(({shadow:t})=>{const r="string"==typeof e?ef.querySelector(e):"function"==typeof e.addEventListener?e:null;if(!r)return Ph&&je.error("[Feedback] Unable to attach to target element"),null;const o=Zh({shadow:t,options:n,attachTo:r});return this._widgets.add(o),this._widget||(this._widget=o),o}))}catch(e){return Ph&&je.error(e),null}}createWidget(e){try{return this._createWidget(Dh(this.options,e||{}))}catch(e){return Ph&&je.error(e),null}}removeWidget(e){if(!e)return!1;try{if(this._widgets.has(e))return e.removeActor(),e.removeDialog(),this._widgets.delete(e),this._widget===e&&(this._widget=null),!0}catch(e){Ph&&je.error(e)}return!1}getWidget(){return this._widget}remove(){this._host&&this._host.remove(),this._initialize()}_initialize(){this._host=null,this._shadow=null,this._widget=null,this._widgets=new Set,this._hasInsertedActorStyles=!1}_cleanupWidgetIfExists(){this._host&&this.remove();const e=ef.querySelector(`#${this.options.id}`);e&&e.remove()}_createWidget(e){return this._ensureShadowHost(e,(({shadow:t})=>{const n=Zh({shadow:t,options:e});return!this._hasInsertedActorStyles&&n.actor&&(t.appendChild(function(e){const t=e.createElement("style");return t.textContent="\n.widget__actor {\n  position: fixed;\n  left: var(--left);\n  right: var(--right);\n  bottom: var(--bottom);\n  top: var(--top);\n  z-index: var(--z-index);\n\n  line-height: 16px;\n\n  display: flex;\n  align-items: center;\n  gap: 8px;\n\n  border-radius: var(--border-radius);\n  cursor: pointer;\n  font-family: inherit;\n  font-size: var(--font-size);\n  font-weight: 600;\n  padding: 16px;\n  text-decoration: none;\n  z-index: 9000;\n\n  color: var(--foreground);\n  background-color: var(--background);\n  border: var(--border);\n  box-shadow: var(--box-shadow);\n  opacity: 1;\n  transition: opacity 0.1s ease-in-out;\n}\n\n.widget__actor:hover {\n  background-color: var(--background-hover);\n}\n\n.widget__actor svg {\n  width: 16px;\n  height: 16px;\n}\n\n.widget__actor--hidden {\n  opacity: 0;\n  pointer-events: none;\n  visibility: hidden;\n}\n\n.widget__actor__text {\n}\n\n@media (max-width: 600px) {\n  .widget__actor__text {\n    display: none;\n  }\n}\n\n.feedback-icon path {\n  fill: var(--foreground);\n}\n",t}(ef)),this._hasInsertedActorStyles=!0),this._widgets.add(n),this._widget||(this._widget=n),n}))}_ensureShadowHost(e,t){let n=!1;if(!this._shadow||!this._host){const{id:t,colorScheme:r,themeLight:o,themeDark:s}=e,{shadow:a,host:i}=Uh({id:t,colorScheme:r,themeLight:o,themeDark:s});this._shadow=a,this._host=i,n=!0}this._host.dataset.sentryFeedbackColorscheme=e.colorScheme;const r=t({shadow:this._shadow,host:this._host});return n&&ef.body.appendChild(this._host),r}}tf.__initStatic();const nf="CaptureConsole",rf=(e={})=>{const t=e.levels||$e;return{name:nf,setupOnce(){},setup(e){"console"in Re&&ft((({args:n,level:r})=>{Or()===e&&t.includes(r)&&function(e,t){const n={level:Rn(t),extra:{arguments:e}};Cr((r=>{if(r.addEventProcessor((e=>(e.logger="console",Tt(e,{handled:!1,type:"console"}),e))),"assert"===t&&!1===e[0]){const t=`Assertion failed: ${Te(e.slice(1)," ")||"console.assert"}`;return r.setExtra("arguments",e.slice(1)),void Ar(t,n)}const o=e.find((e=>e instanceof Error));if("error"===t&&o)return void wr(o,n);Ar(Te(e," "),n)}))}(n,r)}))}}};Xo(nf,rf);const of="Debug",sf=(e={})=>{const t={debugger:!1,stringify:!1,...e};return{name:of,setupOnce(){},setup(e){e.on&&e.on("beforeSendEvent",((e,n)=>{t.debugger,Ge((()=>{t.stringify?(console.log(JSON.stringify(e,null,2)),n&&Object.keys(n).length&&console.log(JSON.stringify(n,null,2))):(console.log(e),n&&Object.keys(n).length&&console.log(n))}))}))}}};Xo(of,sf);const af="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,cf="Dedupe",lf=()=>{let e;return{name:cf,setupOnce(){},processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!df(e,t))return!1;if(!uf(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=pf(t),r=pf(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!df(e,t))return!1;if(!uf(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return af&&je.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}};function uf(e,t){let n=hf(e),r=hf(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],o=n[e];if(t.filename!==o.filename||t.lineno!==o.lineno||t.colno!==o.colno||t.function!==o.function)return!1}return!0}function df(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function pf(e){return e.exception&&e.exception.values&&e.exception.values[0]}function hf(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}}Xo(cf,lf);const ff="ExtraErrorData",gf=(e={})=>{const t=e.depth||3,n=e.captureErrorCause||!1;return{name:ff,setupOnce(){},processEvent:(e,r)=>function(e,t={},n,r){if(!t.originalException||!oe(t.originalException))return e;const o=t.originalException.name||t.originalException.constructor.name,s=function(e,t){try{const n=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],r={};for(const t of Object.keys(e)){if(-1!==n.indexOf(t))continue;const o=e[t];r[t]=oe(o)?o.toString():o}if(t&&void 0!==e.cause&&(r.cause=oe(e.cause)?e.cause.toString():e.cause),"function"==typeof e.toJSON){const t=e.toJSON();for(const e of Object.keys(t)){const n=t[e];r[e]=oe(n)?n.toString():n}}return r}catch(e){af&&je.error("Unable to extract extra data from the Error object:",e)}return null}(t.originalException,r);if(s){const t={...e.contexts},r=on(s,n);return de(r)&&(Ye(r,"__sentry_skip_normalization__",!0),t[o]=r),{...e,contexts:t}}return e}(e,r,t,n)}};Xo(ff,gf);var mf="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _f(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yf={exports:{}};
/*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  */!function(e,t){e.exports=function e(t,n,r){function o(a,i){if(!n[a]){if(!t[a]){if(!i&&_f)return _f(a);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){var n=t[a][1][e];return o(n||e)}),l,l.exports,e,t,n,r)}return n[a].exports}for(var s=_f,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){(function(e){var n,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var s=0,a=new o(u),i=e.document.createTextNode("");a.observe(i,{characterData:!0}),n=function(){i.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var c=new e.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;r=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}r=!1}function d(e){1!==l.push(e)||r||n()}t.exports=d}).call(this,void 0!==mf?mf:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){var r=e(1);function o(){}var s={},a=["REJECTED"],i=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&h(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return s.reject(e,t)}r===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,r)}))}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,s.reject(e,t))}function o(t){n||(n=!0,s.resolve(e,t))}function a(){t(o,r)}var i=f(a);"error"===i.status&&r(i.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function g(e){return e instanceof this?e:s.resolve(new this(o),e)}function m(e){var t=new this(o);return s.reject(t,e)}function _(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),i=0,c=-1,l=new this(o);++c<n;)u(e[c],c);return l;function u(e,o){function c(e){a[o]=e,++i!==n||r||(r=!0,s.resolve(l,a))}t.resolve(e).then(c,(function(e){r||(r=!0,s.reject(l,e))}))}}function y(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var a=-1,i=new this(o);++a<n;)c(e[a]);return i;function c(e){t.resolve(e).then((function(e){r||(r=!0,s.resolve(i,e))}),(function(e){r||(r=!0,s.reject(i,e))}))}}t.exports=l,l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===i||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(o);return this.state!==c?d(n,this.state===i?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){s.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},s.resolve=function(e,t){var n=f(p,t);if("error"===n.status)return s.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=i,e.outcome=t;for(var o=-1,a=e.queue.length;++o<a;)e.queue[o].callFulfilled(t)}return e},s.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},l.resolve=g,l.reject=m,l.all=_,l.race=y},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==mf?mf:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var a=s();function i(){try{if(!a||!a.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function c(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var l=Promise;function u(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function d(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function p(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f="local-forage-detect-blob-support",g=void 0,m={},_=Object.prototype.toString,y="readonly",v="readwrite";function T(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function S(e){return new l((function(t){var n=e.transaction(f,v),r=c([""]);n.objectStore(f).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function b(e){return"boolean"==typeof g?l.resolve(g):S(e).then((function(e){return g=e}))}function E(e){var t=m[e.name],n={};n.promise=new l((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function w(e){var t=m[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function A(e,t){var n=m[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function I(e,t){return new l((function(n,r){if(m[e.name]=m[e.name]||M(),e.db){if(!t)return n(e.db);E(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var s=a.open.apply(a,o);t&&(s.onupgradeneeded=function(t){var n=s.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(f)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),r(s.error)},s.onsuccess=function(){var t=s.result;t.onversionchange=function(e){e.target.close()},n(t),w(e)}}))}function R(e){return I(e,!1)}function k(e){return I(e,!0)}function C(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var s=e.db.version+1;s>e.version&&(e.version=s)}return!0}return!1}function O(e){return new l((function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)}))}function x(e){return c([T(atob(e.data))],{type:e.type})}function L(e){return e&&e.__local_forage_encoded_blob}function N(e){var t=this,n=t._initReady().then((function(){var e=m[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return d(n,e,e),n}function P(e){E(e);for(var t=m[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,R(e).then((function(t){return e.db=t,C(e)?k(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw A(e,t),t}))}function D(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return l.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),k(e)})).then((function(){return P(e).then((function(){D(e,t,n,r-1)}))})).catch(n);n(o)}}function M(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function U(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=m[n.name];o||(o=M(),m[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=N);var s=[];function a(){return l.resolve()}for(var i=0;i<o.forages.length;i++){var c=o.forages[i];c!==t&&s.push(c._initReady().catch(a))}var u=o.forages.slice(0);return l.all(s).then((function(){return n.db=o.db,R(n)})).then((function(e){return n.db=e,C(n,t._defaultConfig.version)?k(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var s=u[r];s!==t&&(s._dbInfo.db=n.db,s._dbInfo.version=n.version)}}))}function $(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){D(n._dbInfo,y,(function(o,s){if(o)return r(o);try{var a=s.objectStore(n._dbInfo.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),L(e)&&(e=x(e)),t(e)},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function F(e,t){var n=this,r=new l((function(t,r){n.ready().then((function(){D(n._dbInfo,y,(function(o,s){if(o)return r(o);try{var a=s.objectStore(n._dbInfo.storeName).openCursor(),i=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;L(r)&&(r=x(r));var o=e(r,n.key,i++);void 0!==o?t(o):n.continue()}else t()},a.onerror=function(){r(a.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function G(e,t,n){var r=this;e=p(e);var o=new l((function(n,o){var s;r.ready().then((function(){return s=r._dbInfo,"[object Blob]"===_.call(t)?b(s.db).then((function(e){return e?t:O(t)})):t})).then((function(t){D(r._dbInfo,v,(function(s,a){if(s)return o(s);try{var i=a.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=i.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return u(o,n),o}function j(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){D(n._dbInfo,v,(function(o,s){if(o)return r(o);try{var a=s.objectStore(n._dbInfo.storeName).delete(e);s.oncomplete=function(){t()},s.onerror=function(){r(a.error)},s.onabort=function(){var e=a.error?a.error:a.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function V(e){var t=this,n=new l((function(e,n){t.ready().then((function(){D(t._dbInfo,v,(function(r,o){if(r)return n(r);try{var s=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=s.error?s.error:s.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function W(e){var t=this,n=new l((function(e,n){t.ready().then((function(){D(t._dbInfo,y,(function(r,o){if(r)return n(r);try{var s=o.objectStore(t._dbInfo.storeName).count();s.onsuccess=function(){e(s.result)},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function q(e,t){var n=this,r=new l((function(t,r){e<0?t(null):n.ready().then((function(){D(n._dbInfo,y,(function(o,s){if(o)return r(o);try{var a=s.objectStore(n._dbInfo.storeName),i=!1,c=a.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===e||i?t(n.key):(i=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return u(r,t),r}function B(e){var t=this,n=new l((function(e,n){t.ready().then((function(){D(t._dbInfo,y,(function(r,o){if(r)return n(r);try{var s=o.objectStore(t._dbInfo.storeName).openKeyCursor(),a=[];s.onsuccess=function(){var t=s.result;t?(a.push(t.key),t.continue()):e(a)},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return u(n,e),n}function H(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;if(e.name){var s=e.name===n.name&&o._dbInfo.db?l.resolve(o._dbInfo.db):R(e).then((function(t){var n=m[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t}));r=e.storeName?s.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;E(e);var r=m[e.name],o=r.forages;t.close();for(var s=0;s<o.length;s++){var i=o[s];i._dbInfo.db=null,i._dbInfo.version=n}var c=new l((function(t,r){var o=a.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}}));return c.then((function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,w(n._dbInfo)}})).catch((function(t){throw(A(e,t)||l.resolve()).catch((function(){})),t}))}})):s.then((function(t){E(e);var n=m[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;var s=new l((function(t,n){var r=a.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}));return s.then((function(e){n.db=e;for(var t=0;t<r.length;t++)w(r[t]._dbInfo)})).catch((function(t){throw(A(e,t)||l.resolve()).catch((function(){})),t}))}))}else r=l.reject("Invalid arguments");return u(r,t),r}var J={_driver:"asyncStorage",_initStorage:U,_support:i(),iterate:F,getItem:$,setItem:G,removeItem:j,clear:V,length:W,key:q,keys:B,dropInstance:H};function z(){return"function"==typeof openDatabase}var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X="~~local_forage_type~",K=/^~~local_forage_type~([^~]+)~/,Q="__lfsc__:",Z=Q.length,ee="arbf",te="blob",ne="si08",re="ui08",oe="uic8",se="si16",ae="si32",ie="ur16",ce="ui32",le="fl32",ue="fl64",de=Z+ee.length,pe=Object.prototype.toString;function he(e){var t,n,r,o,s,a=.75*e.length,i=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var l=new ArrayBuffer(a),u=new Uint8Array(l);for(t=0;t<i;t+=4)n=Y.indexOf(e[t]),r=Y.indexOf(e[t+1]),o=Y.indexOf(e[t+2]),s=Y.indexOf(e[t+3]),u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|o>>2,u[c++]=(3&o)<<6|63&s;return l}function fe(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=Y[n[t]>>2],r+=Y[(3&n[t])<<4|n[t+1]>>4],r+=Y[(15&n[t+1])<<2|n[t+2]>>6],r+=Y[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function ge(e,t){var n="";if(e&&(n=pe.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===pe.call(e.buffer))){var r,o=Q;e instanceof ArrayBuffer?(r=e,o+=ee):(r=e.buffer,"[object Int8Array]"===n?o+=ne:"[object Uint8Array]"===n?o+=re:"[object Uint8ClampedArray]"===n?o+=oe:"[object Int16Array]"===n?o+=se:"[object Uint16Array]"===n?o+=ie:"[object Int32Array]"===n?o+=ae:"[object Uint32Array]"===n?o+=ce:"[object Float32Array]"===n?o+=le:"[object Float64Array]"===n?o+=ue:t(new Error("Failed to get type for BinaryArray"))),t(o+fe(r))}else if("[object Blob]"===n){var s=new FileReader;s.onload=function(){var n=X+e.type+"~"+fe(this.result);t(Q+te+n)},s.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function me(e){if(e.substring(0,Z)!==Q)return JSON.parse(e);var t,n=e.substring(de),r=e.substring(Z,de);if(r===te&&K.test(n)){var o=n.match(K);t=o[1],n=n.substring(o[0].length)}var s=he(n);switch(r){case ee:return s;case te:return c([s],{type:t});case ne:return new Int8Array(s);case re:return new Uint8Array(s);case oe:return new Uint8ClampedArray(s);case se:return new Int16Array(s);case ie:return new Uint16Array(s);case ae:return new Int32Array(s);case ce:return new Uint32Array(s);case le:return new Float32Array(s);case ue:return new Float64Array(s);default:throw new Error("Unkown type: "+r)}}var _e={serialize:ge,deserialize:me,stringToBuffer:he,bufferToString:fe};function ye(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function ve(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new l((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(o){ye(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=_e,o}function Te(e,t,n,r,o,s){e.executeSql(n,r,o,(function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,i){i.rows.length?s(e,a):ye(e,t,(function(){e.executeSql(n,r,o,s)}),s)}),s):s(e,a)}),s)}function Se(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Te(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function be(e,t){var n=this,r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Te(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var s=r.rows,a=s.length,i=0;i<a;i++){var c=s.item(i),l=c.value;if(l&&(l=o.serializer.deserialize(l)),void 0!==(l=e(l,c.key,i+1)))return void t(l)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ee(e,t,n,r){var o=this;e=p(e);var s=new l((function(s,a){o.ready().then((function(){void 0===t&&(t=null);var i=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,l){l?a(l):c.db.transaction((function(n){Te(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){s(i)}),(function(e,t){a(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void s(Ee.apply(o,[e,i,n,r-1]));a(t)}}))}))})).catch(a)}));return u(s,n),s}function we(e,t,n){return Ee.apply(this,[e,t,n,1])}function Ae(e,t){var n=this;e=p(e);var r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Te(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ie(e){var t=this,n=new l((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Te(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Re(e){var t=this,n=new l((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Te(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function ke(e,t){var n=this,r=new l((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){Te(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return u(r,t),r}function Ce(e){var t=this,n=new l((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){Te(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return u(n,e),n}function Oe(e){return new l((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],s=0;s<r.rows.length;s++)o.push(r.rows.item(s).name);t({db:e,storeNames:o})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}function xe(e,t){t=h.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return r=e.name?new l((function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(Oe(r))})).then((function(e){return new l((function(t,n){e.db.transaction((function(r){function o(e){return new l((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var s=[],a=0,i=e.storeNames.length;a<i;a++)s.push(o(e.storeNames[a]));l.all(s).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):l.reject("Invalid arguments"),u(r,t),r}var Le={_driver:"webSQLStorage",_initStorage:ve,_support:z(),iterate:be,getItem:Se,setItem:we,removeItem:Ae,clear:Ie,length:Re,key:ke,keys:Ce,dropInstance:xe};function Ne(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Pe(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function De(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function Me(){return!De()||localStorage.length>0}function Ue(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=Pe(e,t._defaultConfig),Me()?(t._dbInfo=n,n.serializer=_e,l.resolve()):l.reject()}function $e(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return u(n,e),n}function Fe(e,t){var n=this;e=p(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return u(r,t),r}function Ge(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,s=localStorage.length,a=1,i=0;i<s;i++){var c=localStorage.key(i);if(0===c.indexOf(r)){var l=localStorage.getItem(c);if(l&&(l=t.serializer.deserialize(l)),void 0!==(l=e(l,c.substring(o),a++)))return l}}}));return u(r,t),r}function je(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return u(r,t),r}function Ve(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var s=localStorage.key(o);0===s.indexOf(e.keyPrefix)&&r.push(s.substring(e.keyPrefix.length))}return r}));return u(n,e),n}function We(e){var t=this.keys().then((function(e){return e.length}));return u(t,e),t}function qe(e,t){var n=this;e=p(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return u(r,t),r}function Be(e,t,n){var r=this;e=p(e);var o=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new l((function(o,s){var a=r._dbInfo;a.serializer.serialize(t,(function(t,r){if(r)s(r);else try{localStorage.setItem(a.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||s(e),s(e)}}))}))}));return u(o,n),o}function He(e,t){if(t=h.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return r=e.name?new l((function(t){e.storeName?t(Pe(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):l.reject("Invalid arguments"),u(r,t),r}var Je={_driver:"localStorageWrapper",_initStorage:Ue,_support:Ne(),iterate:Ge,getItem:Fe,setItem:Be,removeItem:qe,clear:$e,length:We,key:je,keys:Ve,dropInstance:He},ze=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ye=function(e,t){for(var n=e.length,r=0;r<n;){if(ze(e[r],t))return!0;r++}return!1},Xe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ke={},Qe={},Ze={INDEXEDDB:J,WEBSQL:Le,LOCALSTORAGE:Je},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],nt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),rt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ot(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function st(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(Xe(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var at=function(){function e(t){for(var n in o(this,e),Ze)if(Ze.hasOwnProperty(n)){var r=Ze[n],s=r._driver;this[n]=s,Ke[s]||this.defineDriver(r)}this._defaultConfig=st({},rt),this._config=st({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new l((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var s=nt.concat("_initStorage"),a=0,i=s.length;a<i;a++){var c=s[a];if((!Ye(tt,c)||e[c])&&"function"!=typeof e[c])return void n(o)}var d=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=l.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=tt.length;n<r;n++){var o=tt[n];e[o]||(e[o]=t(o))}};d();var p=function(n){Ke[r]&&console.info("Redefining LocalForage driver: "+r),Ke[r]=e,Qe[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(p,n):p(!!e._support):p(!0)}catch(e){n(e)}}));return d(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Ke[e]?l.resolve(Ke[e]):l.reject(new Error("Driver not found."));return d(r,t,n),r},e.prototype.getSerializer=function(e){var t=l.resolve(_e);return d(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return d(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;Xe(e)||(e=[e]);var o=this._getSupportedDrivers(e);function s(){r._config.driver=r.driver()}function a(e){return r._extend(e),s(),r._ready=r._initStorage(r._config),r._ready}function i(e){return function(){var t=0;function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(a).catch(n)}s();var i=new Error("No available storage method found.");return r._driverSet=l.reject(i),r._driverSet}return n()}}var c=null!==this._driverSet?this._driverSet.catch((function(){return l.resolve()})):l.resolve();return this._driverSet=c.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,s(),r._wrapLibraryMethodsWithReady(),r._initDriver=i(o)}))})).catch((function(){s();var e=new Error("No available storage method found.");return r._driverSet=l.reject(e),r._driverSet})),d(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Qe[e]},e.prototype._extend=function(e){st(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=nt.length;e<t;e++)ot(this,nt[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),it=new at;t.exports=it},{3:3}]},{},[4])(4)}(yf);const vf=Re;class Tf{static __initStatic(){this.id="Offline"}constructor(e={}){this.name=Tf.id,this.maxStoredEvents=e.maxStoredEvents||30,this.offlineEventStore=yf.exports.createInstance({name:"sentry/offlineEventStore"})}setupOnce(e,t){this.hub=t(),"addEventListener"in vf&&vf.addEventListener("online",(()=>{this._sendEvents().catch((()=>{af&&je.warn("could not send cached events")}))}));const n=e=>this.hub&&this.hub.getIntegration(Tf)&&"navigator"in vf&&"onLine"in vf.navigator&&!vf.navigator.onLine?(af&&je.log("Event dropped due to being a offline - caching instead"),this._cacheEvent(e).then((e=>this._enforceMaxEvents())).catch((e=>{af&&je.warn("could not cache event while offline")})),null):e;n.id=this.name,e(n),"navigator"in vf&&"onLine"in vf.navigator&&vf.navigator.onLine&&this._sendEvents().catch((()=>{af&&je.warn("could not send cached events")}))}async _cacheEvent(e){return this.offlineEventStore.setItem(mt(),on(e))}async _enforceMaxEvents(){const e=[];return this.offlineEventStore.iterate(((t,n,r)=>{e.push({cacheKey:n,event:t})})).then((()=>this._purgeEvents(e.sort(((e,t)=>(t.event.timestamp||0)-(e.event.timestamp||0))).slice(this.maxStoredEvents<e.length?this.maxStoredEvents:e.length).map((e=>e.cacheKey))))).catch((e=>{af&&je.warn("could not enforce max events")}))}async _purgeEvent(e){return this.offlineEventStore.removeItem(e)}async _purgeEvents(e){return Promise.all(e.map((e=>this._purgeEvent(e)))).then()}async _sendEvents(){return this.offlineEventStore.iterate(((e,t,n)=>{this.hub?(this.hub.captureEvent(e),this._purgeEvent(t).catch((e=>{af&&je.warn("could not purge event from cache")}))):af&&je.warn("no hub found - could not send cached event")}))}}Tf.__initStatic();const Sf=Re,bf="ReportingObserver",Ef=new WeakMap,wf=(e={})=>{const t=e.types||["crash","deprecation","intervention"];function n(e){if(Ef.has(Or()))for(const t of e)Cr((e=>{e.setExtra("url",t.url);const n=`ReportingObserver [${t.type}]`;let r="No details available";if(t.body){const n={};for(const e in t.body)n[e]=t.body[e];if(e.setExtra("body",n),"crash"===t.type){const e=t.body;r=[e.crashId||"",e.reason||""].join(" ").trim()||r}else{r=t.body.message||r}}Ar(`${n}: ${r}`)}))}return{name:bf,setupOnce(){if(!("ReportingObserver"in xt))return;new Sf.ReportingObserver(n,{buffered:!0,types:t}).observe()},setup(e){Ef.set(e,!0)}}};Xo(bf,wf);const Af="RewriteFrames",If=(e={})=>{const t=e.root,n=e.prefix||"app:///",r=e.iteratee||(e=>{if(!e.filename)return e;const r=/^[a-zA-Z]:\\/.test(e.filename)||e.filename.includes("\\")&&!e.filename.includes("/"),o=/^\//.test(e.filename);if(r||o){const o=r?e.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):e.filename,s=t?function(e,t){e=ln(e).slice(1),t=ln(t).slice(1);const n=un(e.split("/")),r=un(t.split("/")),o=Math.min(n.length,r.length);let s=o;for(let e=0;e<o;e++)if(n[e]!==r[e]){s=e;break}let a=[];for(let e=s;e<n.length;e++)a.push("..");return a=a.concat(r.slice(s)),a.join("/")}(t,o):dn(o);e.filename=`${n}${s}`}return e});return{name:Af,setupOnce(){},processEvent(e){let t=e;return e.exception&&Array.isArray(e.exception.values)&&(t=function(e){try{return{...e,exception:{...e.exception,values:e.exception.values.map((e=>{return{...e,...e.stacktrace&&{stacktrace:(t=e.stacktrace,{...t,frames:t&&t.frames&&t.frames.map((e=>r(e)))})}};var t}))}}}catch(t){return e}}(t)),t}}};Xo(Af,If);const Rf="SessionTiming",kf=()=>{const e=Date.now();return{name:Rf,setupOnce(){},processEvent(t){const n=Date.now();return{...t,extra:{...t.extra,"session:start":e,"session:duration":n-e,"session:end":n}}}}};Xo(Rf,kf);const Cf="Transaction";function Of(e){return e.module||e.function?`${e.module||"?"}/${e.function||"?"}`:"<unknown>"}Xo(Cf,(()=>({name:Cf,setupOnce(){},processEvent(e){const t=function(e){const t=e.exception&&e.exception.values&&e.exception.values[0];return t&&t.stacktrace&&t.stacktrace.frames||[]}(e);for(let n=t.length-1;n>=0;n--){const r=t[n];if(!0===r.in_app){e.transaction=Of(r);break}}return e}})));const xf="HttpClient",Lf=(e={})=>{const t={failedRequestStatusCodes:[[500,599]],failedRequestTargets:[/.*/],...e};return{name:xf,setupOnce(){},setup(e){!function(e,t){if(!Pt())return;Dt((n=>{if(Or()!==e)return;const{response:r,args:o}=n,[s,a]=o;r&&function(e,t,n,r){if(Df(e,n.status,n.url)){const e=function(e,t){if(!t&&e instanceof Request)return e;if(e instanceof Request&&e.bodyUsed)return e;return new Request(e,t)}(t,r);let o,s,a,i;Uf()&&([{headers:o,cookies:a},{headers:s,cookies:i}]=[{cookieHeader:"Cookie",obj:e},{cookieHeader:"Set-Cookie",obj:n}].map((({cookieHeader:e,obj:t})=>{const n=function(e){const t={};return e.forEach(((e,n)=>{t[n]=e})),t}(t.headers);let r;try{const t=n[e]||n[e.toLowerCase()]||void 0;t&&(r=Pf(t))}catch(t){af&&je.log(`Could not extract cookies from header ${e}`)}return{headers:n,cookies:r}})));Ir(Mf({url:e.url,method:e.method,status:n.status,requestHeaders:o,responseHeaders:s,requestCookies:a,responseCookies:i}))}}(t,s,r,a)}))}(e,t),function(e,t){if(!("XMLHttpRequest"in Re))return;Qt((n=>{if(Or()!==e)return;const r=n.xhr,o=r[Kt];if(!o)return;const{method:s,request_headers:a}=o;try{!function(e,t,n,r){if(Df(e,t.status,t.responseURL)){let e,o,s;if(Uf()){try{const e=t.getResponseHeader("Set-Cookie")||t.getResponseHeader("set-cookie")||void 0;e&&(o=Pf(e))}catch(e){af&&je.log("Could not extract cookies from response headers")}try{s=function(e){const t=e.getAllResponseHeaders();if(!t)return{};return t.split("\r\n").reduce(((e,t)=>{const[n,r]=t.split(": ");return e[n]=r,e}),{})}(t)}catch(e){af&&je.log("Could not extract headers from response")}e=r}Ir(Mf({url:t.responseURL,method:n,status:t.status,requestHeaders:e,responseHeaders:s,responseCookies:o}))}}(t,r,s,a)}catch(e){af&&je.warn("Error while extracting response event form XHR response",e)}}))}(e,t)}}};function Nf(e){if(e){const t=e["Content-Length"]||e["content-length"];if(t)return parseInt(t,10)}}function Pf(e){return e.split("; ").reduce(((e,t)=>{const[n,r]=t.split("=");return e[n]=r,e}),{})}function Df(e,t,n){return function(e,t){return e.some((e=>"number"==typeof e?e===t:t>=e[0]&&t<=e[1]))}(e.failedRequestStatusCodes,t)&&(r=e.failedRequestTargets,o=n,r.some((e=>"string"==typeof e?o.includes(e):e.test(o))))&&!ys(n,Or());var r,o}function Mf(e){const t=`HTTP Client Error with status code: ${e.status}`,n={message:t,exception:{values:[{type:"Error",value:t}]},request:{url:e.url,method:e.method,headers:e.requestHeaders,cookies:e.requestCookies},contexts:{response:{status_code:e.status,headers:e.responseHeaders,cookies:e.responseCookies,body_size:Nf(e.responseHeaders)}}};return Tt(n,{type:"http.client",handled:!1}),n}function Uf(){const e=Or();return!!e&&Boolean(e.getOptions().sendDefaultPii)}Xo(xf,Lf);const $f=Re,Ff="ContextLines",Gf=(e={})=>{const t=null!=e.frameContextLines?e.frameContextLines:7;return{name:Ff,setupOnce(){},processEvent:e=>function(e,t){const n=$f.document,r=$f.location&&yn($f.location.href);if(!n||!r)return e;const o=e.exception&&e.exception.values;if(!o||!o.length)return e;const s=n.documentElement.innerHTML;if(!s)return e;const a=["<!DOCTYPE html>","<html>",...s.split("\n"),"</html>"];return o.forEach((e=>{const n=e.stacktrace;n&&n.frames&&(n.frames=n.frames.map((e=>function(e,t,n,r){if(e.filename!==n||!e.lineno||!t.length)return e;return function(e,t,n=5){if(void 0===t.lineno)return;const r=e.length,o=Math.max(Math.min(r-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,o-n),o).map((e=>ve(e,0))),t.context_line=ve(e[Math.min(r-1,o)],t.colno||0),t.post_context=e.slice(Math.min(o+1,r),o+1+n).map((e=>ve(e,0)))}(t,e,r),e}(e,a,r,t))))})),e}(e,t)}};function jf(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function Vf(e){return jf(e.getAllKeys())}function Wf(e){let t;function n(){return null==t&&(t=function(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=jf(n);return e=>r.then((n=>e(n.transaction(t,"readwrite").objectStore(t))))}(e.dbName||"sentry-offline",e.storeName||"queue")),t}return{insert:async t=>{try{const r=await Jn(t,e.textEncoder);await function(e,t,n){return e((e=>Vf(e).then((r=>{if(!(r.length>=n))return e.put(t,Math.max(...r,0)+1),jf(e.transaction)}))))}(n(),r,e.maxQueueSize||30)}catch(e){}},pop:async()=>{try{const t=await function(e){return e((e=>Vf(e).then((t=>{if(0!==t.length)return jf(e.get(t[0])).then((n=>(e.delete(t[0]),jf(e.transaction).then((()=>n)))))}))))}(n());if(t)return function(e,t,n){let r="string"==typeof e?t.encode(e):e;function o(e){const t=r.subarray(0,e);return r=r.subarray(e+1),t}function s(){let e=r.indexOf(10);return e<0&&(e=r.length),JSON.parse(n.decode(o(e)))}const a=s(),i=[];for(;r.length;){const e=s(),t="number"==typeof e.length?e.length:void 0;i.push([e,t?o(t):s()])}return[a,i]}(t,e.textEncoder||new TextEncoder,e.textDecoder||new TextDecoder)}catch(e){}}}}Xo(Ff,Gf);const qf=1e6,Bf=String(0),Hf="main";let Jf="",zf="",Yf="",Xf=Li.navigator&&Li.navigator.userAgent||"",Kf="";const Qf=Li.navigator&&Li.navigator.language||Li.navigator&&Li.navigator.languages&&Li.navigator.languages[0]||"";const Zf=Li.navigator&&Li.navigator.userAgentData;var eg;function tg(e){return function(e){return!("thread_metadata"in e)}(e)?function(e){let t,n=0;const r={samples:[],stacks:[],frames:[],thread_metadata:{[Bf]:{name:Hf}}};if(!e.samples.length)return r;const o=e.samples[0].timestamp,s="number"==typeof performance.timeOrigin?performance.timeOrigin:xn||0,a=s-(xn||s);for(let s=0;s<e.samples.length;s++){const i=e.samples[s];if(void 0===i.stackId){void 0===t&&(t=n,r.stacks[t]=[],n++),r.samples[s]={elapsed_since_start_ns:((i.timestamp+a-o)*qf).toFixed(0),stack_id:t,thread_id:Bf};continue}let c=e.stacks[i.stackId];const l=[];for(;c;){l.push(c.frameId);const t=e.frames[c.frameId];void 0===r.frames[c.frameId]&&(r.frames[c.frameId]={function:t.name,abs_path:"number"==typeof t.resourceId?e.resources[t.resourceId]:void 0,lineno:t.line,colno:t.column}),c=void 0===c.parentId?void 0:e.stacks[c.parentId]}const u={elapsed_since_start_ns:((i.timestamp+a-o)*qf).toFixed(0),stack_id:n,thread_id:Bf};r.stacks[n]=l,r.samples[s]=u,n++}return r}(e):e}function ng(e,t,n,r){if("transaction"!==r.type)throw new TypeError("Profiling events may only be attached to transactions, this should never occur.");if(null==n)throw new TypeError(`Cannot construct profiling event envelope without a valid profile. Got ${n} instead.`);const o=function(e){const t=e&&e.contexts&&e.contexts.trace&&e.contexts.trace.trace_id;return"string"==typeof t&&32!==t.length&&Mi&&je.log(`[Profiling] Invalid traceId: ${t} on profiled event`),"string"!=typeof t?"":t}(r),s=tg(n),a=t||("number"==typeof r.start_timestamp?1e3*r.start_timestamp:Date.now()),i="number"==typeof r.timestamp?1e3*r.timestamp:Date.now();return{event_id:e,timestamp:new Date(a).toISOString(),platform:"javascript",version:"1",release:r.release||"",environment:r.environment||ar,runtime:{name:"javascript",version:Li.navigator.userAgent},os:{name:Jf,version:zf,build_number:Xf},device:{locale:Qf,model:Kf,manufacturer:Xf,architecture:Yf,is_emulator:!1},debug_meta:{images:sg(n.resources)},profile:s,transactions:[{name:r.transaction||"",id:r.event_id||mt(),trace_id:o,active_thread_id:Bf,relative_start_ns:"0",relative_end_ns:(1e6*(i-a)).toFixed(0)}]}}function rg(e){return"pageload"===e.op}"object"==typeof(eg=Zf)&&null!==eg&&"getHighEntropyValues"in eg&&Zf.getHighEntropyValues(["architecture","model","platform","platformVersion","fullVersionList"]).then((e=>{if(Jf=e.platform||"",Yf=e.architecture||"",Kf=e.model||"",zf=e.platformVersion||"",e.fullVersionList&&e.fullVersionList.length>0){const t=e.fullVersionList[e.fullVersionList.length-1];Xf=`${t.brand} ${t.version}`}})).catch((e=>{}));const og=new WeakMap;function sg(e){const t=Re._sentryDebugIds;if(!t)return[];const n=Or(),r=n&&n.getOptions(),o=r&&r.stackParser;if(!o)return[];let s;const a=og.get(o);a?s=a:(s=new Map,og.set(o,s));const i=Object.keys(t).reduce(((e,n)=>{let r;const a=s.get(n);a?r=a:(r=o(n),s.set(n,r));for(let o=r.length-1;o>=0;o--){const s=r[o],a=s&&s.filename;if(s&&a){e[a]=t[n];break}}return e}),{}),c=[];for(const t of e)t&&i[t]&&c.push({type:"sourcemap",code_file:t,debug_id:i[t]});return c}let ag=!1;const ig=3e4;function cg(e){if(ag)return Mi&&je.log("[Profiling] Profiling has been disabled for the duration of the current user session."),!1;if(!e.isRecording())return Mi&&je.log("[Profiling] Discarding profile because transaction was not sampled."),!1;const t=Or(),n=t&&t.getOptions();if(!n)return Mi&&je.log("[Profiling] Profiling disabled, no options found."),!1;const r=n.profilesSampleRate;if(!("number"!=typeof(o=r)&&"boolean"!=typeof o||"number"==typeof o&&isNaN(o)?(Mi&&je.warn(`[Profiling] Invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(o)} of type ${JSON.stringify(typeof o)}.`),0):!0===o||!1===o||!(o<0||o>1)||(Mi&&je.warn(`[Profiling] Invalid sample rate. Sample rate must be between 0 and 1. Got ${o}.`),0)))return Mi&&je.warn("[Profiling] Discarding profile because of invalid sample rate."),!1;var o;if(!r)return Mi&&je.log("[Profiling] Discarding profile because a negative sampling decision was inherited or profileSampleRate is set to 0"),!1;return!!(!0===r||Math.random()<r)||(Mi&&je.log(`[Profiling] Discarding profile because it's not included in the random sample (sampling rate = ${Number(r)})`),!1)}function lg(e,t,n,r){return function(e){return e.samples.length<2?(Mi&&je.log("[Profiling] Discarding profile because it contains less than 2 samples"),!1):!!e.frames.length||(Mi&&je.log("[Profiling] Discarding profile because it contains no frames"),!1)}(n)?ng(e,t,n,r):null}const ug=new Map;function dg(e){const t=ug.get(e);return t&&ug.delete(e),t}function pg(e){let t;rg(e)&&(t=1e3*On());const n=function(){const e=Li.Profiler;if("function"!=typeof e)return void(Mi&&je.log("[Profiling] Profiling is not supported by this browser, Profiler interface missing on window object."));const t=Math.floor(ig/10);try{return new e({sampleInterval:10,maxBufferSize:t})}catch(e){Mi&&(je.log("[Profiling] Failed to initialize the Profiling constructor, this is likely due to a missing 'Document-Policy': 'js-profiling' header."),je.log("[Profiling] Disabling profiling for current user session.")),ag=!0}}();if(!n)return e;Mi&&je.log(`[Profiling] started profiling transaction: ${yr(e).description}`);const r=mt();async function o(){return e&&n?n.stop().then((t=>(s&&(Li.clearTimeout(s),s=void 0),Mi&&je.log(`[Profiling] stopped profiling of transaction: ${yr(e).description}`),t?(function(e,t){if(ug.set(e,t),ug.size>30){const e=ug.keys().next().value;ug.delete(e)}}(r,t),null):(Mi&&je.log(`[Profiling] profiler returned null profile for: ${yr(e).description}`,"this may indicate an overlapping transaction or a call to stopProfiling with a profile title that was never started"),null)))).catch((e=>(Mi&&je.log("[Profiling] error while stopping profiler:",e),null))):null}let s=Li.setTimeout((()=>{Mi&&je.log("[Profiling] max profile duration elapsed, stopping profiling for:",yr(e).description),o()}),ig);const a=e.end.bind(e);return e.end=function(){return e?(o().then((()=>{e.setContext("profile",{profile_id:r,start_timestamp:t}),a()}),(()=>{a()})),e):a()},e}const hg="BrowserProfiling",fg=()=>({name:hg,setupOnce(){},setup(e){const t=xr().getTransaction();t&&rg(t)&&cg(t)&&pg(t),"function"==typeof e.on?(e.on("startTransaction",(e=>{cg(e)&&pg(e)})),e.on("beforeEnvelope",(e=>{if(!ug.size)return;const t=function(e){const t=[];return Bn(e,((e,n)=>{if("transaction"===n)for(let n=1;n<e.length;n++){const r=e[n];r&&r.contexts&&r.contexts.profile&&r.contexts.profile.profile_id&&t.push(e[n])}})),t}(e);if(!t.length)return;const n=[];for(const e of t){const t=e&&e.contexts,r=t&&t.profile&&t.profile.profile_id,o=t&&t.profile&&t.profile.start_timestamp;if("string"!=typeof r){Mi&&je.log("[Profiling] cannot find profile for a transaction without a profile context");continue}if(!r){Mi&&je.log("[Profiling] cannot find profile for a transaction without a profile context");continue}t&&t.profile&&delete t.profile;const s=dg(r);if(!s){Mi&&je.log(`[Profiling] Could not retrieve profile for transaction: ${r}`);continue}const a=lg(r,o,s,e);a&&n.push(a)}!function(e,t){if(!t.length)return e;for(const n of t)e[1].push([{type:"profile"},n])}(e,n)}))):je.warn("[Profiling] Client does not support hooks, profiling will be disabled")}}),gg=Xo(hg,fg);let mg={};Li.Sentry&&Li.Sentry.Integrations&&(mg=Li.Sentry.Integrations);const _g={...mg,...Js,...Xc};var yg=Object.freeze({__proto__:null,Integrations:_g,FunctionToString:$s,Hub:zr,InboundFilters:Ls,ModuleMetadata:As,SDK_VERSION:Br,SEMANTIC_ATTRIBUTE_SENTRY_OP:Ao,SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN:Io,SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE:wo,SEMANTIC_ATTRIBUTE_SENTRY_SOURCE:Eo,Scope:Wr,addBreadcrumb:Rr,addEventProcessor:ss,addGlobalEventProcessor:cr,addIntegration:function(e){const t=Or();t&&t.addIntegration?t.addIntegration(e):sr&&je.warn(`Cannot add integration "${e.name}" because no SDK Client is available.`)},addTracingExtensions:Fo,captureEvent:Ir,captureException:wr,captureMessage:Ar,captureSession:Dr,close:async function(e){const t=Or();return t?t.close(e):(sr&&je.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))},configureScope:function(e){Kr().configureScope(e)},continueTrace:({sentryTrace:e,baggage:t},n)=>{const r=xr(),{traceparentData:o,dynamicSamplingContext:s,propagationContext:a}=function(e,t){const n=Gn(e),r=Mn(t),{traceId:o,parentSpanId:s,parentSampled:a}=n||{};return n?{traceparentData:n,dynamicSamplingContext:r||{},propagationContext:{traceId:o||mt(),parentSpanId:s||mt().substring(16),spanId:mt().substring(16),sampled:a,dsc:r||{}}}:{traceparentData:n,dynamicSamplingContext:void 0,propagationContext:{traceId:o||mt(),spanId:mt().substring(16)}}}(e,t);r.setPropagationContext(a),sr&&o&&je.log(`[Tracing] Continuing trace ${o.traceId}.`);const i={...o,metadata:tt({dynamicSamplingContext:s})};return n?Zr((()=>n(i))):i},createTransport:ls,endSession:Nr,extractTraceparentData:ro,flush:async function(e){const t=Or();return t?t.flush(e):(sr&&je.warn("Cannot flush events. No client defined."),Promise.resolve(!1))},functionToStringIntegration:Us,getActiveSpan:go,getActiveTransaction:no,getClient:Or,getCurrentHub:Kr,getCurrentScope:xr,getHubFromCarrier:eo,getSpanStatusFromHttpCode:io,inboundFiltersIntegration:xs,isInitialized:function(){return!!Or()},lastEventId:function(){return Kr().lastEventId()},makeMain:Xr,makeMultiplexedTransport:function(e,t){return n=>{const r=e(n),o=new Map;function s(t,r){const s=r?`${t}:${r}`:t;let a=o.get(s);if(!a){const i=qe(t);if(!i)return;const c=Bo(i,n.tunnel);a=r?function(e,t){return n=>{const r=e(n);return{...r,send:async e=>{const n=ms(e,["event","transaction","profile","replay_event"]);return n&&(n.release=t),r.send(e)}}}}(e,r)({...n,url:c}):e({...n,url:c}),o.set(s,a)}return[t,a]}return{send:async function(e){const n=t({envelope:e,getEvent:function(t){const n=t&&t.length?t:["event"];return ms(e,n)}}).map((e=>"string"==typeof e?s(e,void 0):s(e.dsn,e.release))).filter((e=>!!e));0===n.length&&n.push(["",r]);return(await Promise.all(n.map((([t,n])=>n.send(function(e,t){return Wn(t?{...e[0],dsn:t}:e[0],e[1])}(e,t))))))[0]},flush:async function(e){const t=[await r.flush(e)];for(const[,n]of o)t.push(await n.flush(e));return t.every((e=>e))}}}},metrics:Hs,moduleMetadataIntegration:ws,parameterize:function(e,...t){const n=new String(String.raw(e,...t));return n.__sentry_template_string__=e.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=t,n},setContext:kr,setCurrentClient:is,setExtra:function(e,t){Kr().setExtra(e,t)},setExtras:function(e){Kr().setExtras(e)},setHttpStatus:lo,setMeasurement:Go,setTag:function(e,t){Kr().setTag(e,t)},setTags:function(e){Kr().setTags(e)},setUser:function(e){Kr().setUser(e)},spanStatusfromHttpCode:co,startInactiveSpan:fo,startSession:Lr,startSpan:ho,startSpanManual:function(e,t){const n=_o(e);return Zr((()=>Cr(e.scope,(r=>{const o=Kr(),s=r.getSpan(),a=e.onlyIfParent&&!s?void 0:mo(o,{parentSpan:s,spanContext:n,forceTransaction:e.forceTransaction,scope:r});function i(){a&&a.end()}return uo((()=>t(a,i)),(()=>{if(a&&a.isRecording()){const{status:e}=yr(a);e&&"ok"!==e||a.setStatus("internal_error")}}))}))))},startTransaction:function(e,t){return Kr().startTransaction({...e},t)},trace:function(e,t,n=(()=>{}),r=(()=>{})){const o=Kr(),s=xr(),a=s.getSpan(),i=_o(e),c=mo(o,{parentSpan:a,spanContext:i,forceTransaction:!1,scope:s});return s.setSpan(c),uo((()=>t(c)),(e=>{c&&c.setStatus("internal_error"),n(e,c)}),(()=>{c&&c.end(),s.setSpan(a),r()}))},withActiveSpan:function(e,t){return Cr((n=>(n.setSpan(e),t(n))))},withIsolationScope:function(e){return Zr((()=>e(Qr())))},withScope:Cr,WINDOW:Li,BrowserClient:zi,makeFetchTransport:Xi,makeXHRTransport:Qi,chromeStackLineParser:rc,defaultStackLineParsers:hc,defaultStackParser:fc,geckoStackLineParser:ac,opera10StackLineParser:uc,opera11StackLineParser:pc,winjsStackLineParser:cc,eventFromException:Vi,eventFromMessage:Wi,exceptionFromError:Ui,createUserFeedbackEnvelope:Ji,captureUserFeedback:function(e){const t=Or();t&&t.captureUserFeedback(e)},defaultIntegrations:Jc,forceLoad:function(){},getDefaultIntegrations:zc,init:Yc,onLoad:function(e){e()},showReportDialog:(e={},t=Kr())=>{if(!Li.document)return void(Mi&&je.error("Global document not defined in showReportDialog call"));const{client:n,scope:r}=t.getStackTop(),o=e.dsn||n&&n.getDsn();if(!o)return void(Mi&&je.error("DSN not configured for showReportDialog call"));r&&(e.user={...r.getUser(),...e.user}),e.eventId||(e.eventId=t.lastEventId());const s=Li.document.createElement("script");s.async=!0,s.crossOrigin="anonymous",s.src=function(e,t){const n=He(e);if(!n)return"";const r=`${Wo(n)}embed/error-page/`;let o=`dsn=${We(n)}`;for(const e in t)if("dsn"!==e&&"onClose"!==e)if("user"===e){const e=t.user;if(!e)continue;e.name&&(o+=`&name=${encodeURIComponent(e.name)}`),e.email&&(o+=`&email=${encodeURIComponent(e.email)}`)}else o+=`&${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`;return`${r}?${o}`}(o,e),e.onLoad&&(s.onload=e.onLoad);const{onClose:a}=e;if(a){const e=t=>{if("__sentry_reportdialog_closed__"===t.data)try{a()}finally{Li.removeEventListener("message",e)}};Li.addEventListener("message",e)}const i=Li.document.head||Li.document.body;i?i.appendChild(s):Mi&&je.error("Not injecting report dialog. No injection point found in HTML")},wrap:function(e){return Di(e)()},Breadcrumbs:vc,breadcrumbsIntegration:yc,Dedupe:bc,GlobalHandlers:Cc,globalHandlersIntegration:kc,HttpContext:Dc,httpContextIntegration:Pc,LinkedErrors:$c,linkedErrorsIntegration:Uc,TryCatch:Vc,browserApiErrorsIntegration:jc,Replay:Wp,getReplay:function(){const e=Or();return e&&e.getIntegrationByName&&e.getIntegrationByName("Replay")},replayIntegration:e=>new Wp(e),ReplayCanvas:bh,replayCanvasIntegration:Sh,Feedback:tf,feedbackIntegration:e=>new tf(e),sendFeedback:Nh,captureConsoleIntegration:rf,contextLinesIntegration:Gf,debugIntegration:sf,dedupeIntegration:lf,extraErrorDataIntegration:gf,httpClientIntegration:Lf,reportingObserverIntegration:wf,rewriteFramesIntegration:If,sessionTimingIntegration:kf,BrowserTracing:class{constructor(e){this.name="BrowserTracing",this._hasSetTracePropagationTargets=!1,Fo(),zs&&(this._hasSetTracePropagationTargets=!(!e||!e.tracePropagationTargets&&!e.tracingOrigins)),this.options={...Ei,...e},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=ci(),this._interactionIdToRouteNameMapping={},this.options.enableInp&&di(this._interactionIdToRouteNameMapping,this.options.interactionsSampleRate),this.options.enableLongTask&&li(),this.options._experiments.enableInteractions&&ui(),this._latestRoute={name:void 0,context:void 0}}setupOnce(e,t){this._getCurrentHub=t;const n=t().getClient(),r=n&&n.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:s,startTransactionOnPageLoad:a,markBackgroundTransactions:i,traceFetch:c,traceXHR:l,shouldCreateSpanForRequest:u,enableHTTPTimings:d,_experiments:p}=this.options,h=r&&r.tracePropagationTargets,f=h||this.options.tracePropagationTargets;zs&&this._hasSetTracePropagationTargets&&h&&je.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o((e=>{const n=this._createRouteTransaction(e);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(n,e,t),n}),a,s),i&&la(),p.enableInteractions&&this._registerInteractionListener(),this.options.enableInp&&this._registerInpInteractionListener(),vi({traceFetch:c,traceXHR:l,tracePropagationTargets:f,shouldCreateSpanForRequest:u,enableHTTPTimings:d})}_createRouteTransaction(e){if(!this._getCurrentHub)return void(zs&&je.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`));const t=this._getCurrentHub(),{beforeNavigate:n,idleTimeout:r,finalTimeout:o,heartbeatInterval:s}=this.options,a="pageload"===e.op;let i;if(a){const t=a?wi("sentry-trace"):"",n=a?wi("baggage"):void 0,{traceId:r,dsc:o,parentSpanId:s,sampled:c}=jn(t,n);i={traceId:r,parentSpanId:s,parentSampled:c,...e,metadata:{...e.metadata,dynamicSamplingContext:o},trimEnd:!0}}else i={trimEnd:!0,...e};const c="function"==typeof n?n(i):i,l=void 0===c?{...i,sampled:!1}:c;l.metadata=l.name!==i.name?{...l.metadata,source:"custom"}:l.metadata,this._latestRoute.name=l.name,this._latestRoute.context=l,!1===l.sampled&&zs&&je.log(`[Tracing] Will not send ${l.op} transaction because of beforeNavigate.`),zs&&je.log(`[Tracing] Starting ${l.op} transaction on scope`);const{location:u}=ca,d=$o(t,l,r,o,!0,{location:u},s,a);return a&&ca.document&&(ca.document.addEventListener("readystatechange",(()=>{["interactive","complete"].includes(ca.document.readyState)&&d.sendAutoFinishSignal()})),["interactive","complete"].includes(ca.document.readyState)&&d.sendAutoFinishSignal()),d.registerBeforeFinishCallback((e=>{this._collectWebVitals(),hi(e)})),d}_registerInteractionListener(){let e;const t=()=>{const{idleTimeout:t,finalTimeout:n,heartbeatInterval:r}=this.options,o="ui.action.click",s=no();if(s&&s.op&&["navigation","pageload"].includes(s.op))return void(zs&&je.warn(`[Tracing] Did not create ${o} transaction because a pageload or navigation transaction is in progress.`));if(e&&(e.setFinishReason("interactionInterrupted"),e.end(),e=void 0),!this._getCurrentHub)return void(zs&&je.warn(`[Tracing] Did not create ${o} transaction because _getCurrentHub is invalid.`));if(!this._latestRoute.name)return void(zs&&je.warn(`[Tracing] Did not create ${o} transaction because _latestRouteName is missing.`));const a=this._getCurrentHub(),{location:i}=ca,c={name:this._latestRoute.name,op:o,trimEnd:!0,data:{[Eo]:this._latestRoute.context?Ai(this._latestRoute.context):"url"}};e=$o(a,c,t,n,!0,{location:i},r)};["click"].forEach((e=>{ca.document&&addEventListener(e,t,{once:!1,capture:!0})}))}_registerInpInteractionListener(){const e=({entries:e})=>{const t=Or(),n=void 0!==t&&void 0!==t.getIntegrationByName?t.getIntegrationByName("Replay"):void 0,r=void 0!==n?n.getReplayId():void 0,o=no(),s=xr(),a=void 0!==s?s.getUser():void 0;e.forEach((e=>{if(function(e){return"duration"in e}(e)){const t=e.interactionId;if(void 0===t)return;const n=this._interactionIdToRouteNameMapping[t],s=e.duration,i=e.startTime,c=Object.keys(this._interactionIdToRouteNameMapping),l=c.length>0?c.reduce(((e,t)=>this._interactionIdToRouteNameMapping[e].duration<this._interactionIdToRouteNameMapping[t].duration?e:t)):void 0;if("first-input"===e.entryType){if(c.map((e=>this._interactionIdToRouteNameMapping[e])).some((e=>e.duration===s&&e.startTime===i)))return}if(!t)return;if(n)n.duration=Math.max(n.duration,s);else if(c.length<10||void 0===l||s>this._interactionIdToRouteNameMapping[l].duration){const e=this._latestRoute.name,n=this._latestRoute.context;e&&n&&(l&&Object.keys(this._interactionIdToRouteNameMapping).length>=10&&delete this._interactionIdToRouteNameMapping[l],this._interactionIdToRouteNameMapping[t]={routeName:e,duration:s,parentContext:n,user:a,activeTransaction:o,replayId:r,startTime:i})}}}))};Wa("event",e),Wa("first-input",e)}},browserTracingIntegration:(e={})=>{const t=!!zs&&!(!e.tracePropagationTargets&&!e.tracingOrigins);Fo(),!e.tracePropagationTargets&&e.tracingOrigins&&(e.tracePropagationTargets=e.tracingOrigins);const n={...Ii,...e},r=ci(),o={};n.enableInp&&di(o,n.interactionsSampleRate),n.enableLongTask&&li(),n._experiments.enableInteractions&&ui();const s={name:void 0,context:void 0};function a(e){const t=Kr(),{beforeStartSpan:o,idleTimeout:a,finalTimeout:i,heartbeatInterval:c}=n,l="pageload"===e.op;let u;if(l){const t=l?Ci("sentry-trace"):"",n=l?Ci("baggage"):void 0,{traceId:r,dsc:o,parentSpanId:s,sampled:a}=jn(t,n);u={traceId:r,parentSpanId:s,parentSampled:a,...e,metadata:{...e.metadata,dynamicSamplingContext:o},trimEnd:!0}}else u={trimEnd:!0,...e};const d=o?o(u):u;d.metadata=d.name!==u.name?{...d.metadata,source:"custom"}:d.metadata,s.name=d.name,s.context=d,!1===d.sampled&&zs&&je.log(`[Tracing] Will not send ${d.op} transaction because of beforeNavigate.`),zs&&je.log(`[Tracing] Starting ${d.op} transaction on scope`);const{location:p}=ca,h=$o(t,d,a,i,!0,{location:p},c,l);return l&&ca.document&&(ca.document.addEventListener("readystatechange",(()=>{["interactive","complete"].includes(ca.document.readyState)&&h.sendAutoFinishSignal()})),["interactive","complete"].includes(ca.document.readyState)&&h.sendAutoFinishSignal()),h.registerBeforeFinishCallback((e=>{r(),hi(e)})),h}return{name:"BrowserTracing",setupOnce:()=>{},afterAllSetup(e){const r=e.getOptions(),{markBackgroundSpan:i,traceFetch:c,traceXHR:l,shouldCreateSpanForRequest:u,enableHTTPTimings:d,_experiments:p}=n,h=r&&r.tracePropagationTargets,f=h||n.tracePropagationTargets;let g;zs&&t&&h&&je.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used.");let m=ca.location&&ca.location.href;if(e.on&&(e.on("startNavigationSpan",(e=>{g&&(zs&&je.log(`[Tracing] Finishing current transaction with op: ${yr(g).op}`),g.end()),g=a({op:"navigation",...e})})),e.on("startPageLoadSpan",(e=>{g&&(zs&&je.log(`[Tracing] Finishing current transaction with op: ${yr(g).op}`),g.end()),g=a({op:"pageload",...e})}))),n.instrumentPageLoad&&e.emit&&ca.location){const t={name:ca.location.pathname,startTimestamp:xn?xn/1e3:void 0,origin:"auto.pageload.browser",attributes:{[Eo]:"url"}};Ri(e,t)}n.instrumentNavigation&&e.emit&&ca.location&&zt((({to:t,from:n})=>{if(void 0===n&&m&&-1!==m.indexOf(t))m=void 0;else if(n!==t){m=void 0;const t={name:ca.location.pathname,origin:"auto.navigation.browser",attributes:{[Eo]:"url"}};ki(e,t)}})),i&&la(),p.enableInteractions&&function(e,t){let n;const r=()=>{const{idleTimeout:r,finalTimeout:o,heartbeatInterval:s}=e,a="ui.action.click",i=no();if(i&&i.op&&["navigation","pageload"].includes(i.op))return void(zs&&je.warn(`[Tracing] Did not create ${a} transaction because a pageload or navigation transaction is in progress.`));if(n&&(n.setFinishReason("interactionInterrupted"),n.end(),n=void 0),!t.name)return void(zs&&je.warn(`[Tracing] Did not create ${a} transaction because _latestRouteName is missing.`));const{location:c}=ca,l={name:t.name,op:a,trimEnd:!0,data:{[Eo]:t.context?xi(t.context):"url"}};n=$o(Kr(),l,r,o,!0,{location:c},s)};["click"].forEach((e=>{ca.document&&addEventListener(e,r,{once:!1,capture:!0})}))}(n,s),n.enableInp&&function(e,t){const n=({entries:n})=>{const r=Or(),o=void 0!==r&&void 0!==r.getIntegrationByName?r.getIntegrationByName("Replay"):void 0,s=void 0!==o?o.getReplayId():void 0,a=no(),i=xr(),c=void 0!==i?i.getUser():void 0;n.forEach((n=>{if(function(e){return"duration"in e}(n)){const r=n.interactionId;if(void 0===r)return;const o=e[r],i=n.duration,l=n.startTime,u=Object.keys(e),d=u.length>0?u.reduce(((t,n)=>e[t].duration<e[n].duration?t:n)):void 0;if("first-input"===n.entryType){if(u.map((t=>e[t])).some((e=>e.duration===i&&e.startTime===l)))return}if(!r)return;if(o)o.duration=Math.max(o.duration,i);else if(u.length<Oi||void 0===d||i>e[d].duration){const n=t.name,o=t.context;n&&o&&(d&&Object.keys(e).length>=Oi&&delete e[d],e[r]={routeName:n,duration:i,parentContext:o,user:c,activeTransaction:a,replayId:s,startTime:l})}}}))};Wa("event",n),Wa("first-input",n)}(o,s),vi({traceFetch:c,traceXHR:l,tracePropagationTargets:f,shouldCreateSpanForRequest:u,enableHTTPTimings:d})},options:n}},defaultRequestInstrumentationOptions:yi,instrumentOutgoingRequests:vi,startBrowserTracingNavigationSpan:ki,startBrowserTracingPageLoadSpan:Ri,makeBrowserOfflineTransport:function(e){return function(e){return t=>e({...t,createStore:Wf})}(gs(e))},onProfilingStartRouteTransaction:function(e){return e?cg(e)?pg(e):e:(Mi&&je.log("[Profiling] Transaction is undefined, skipping profiling"),e)},BrowserProfilingIntegration:gg,browserProfilingIntegration:fg});const vg=()=>{let e=navigator.languages?navigator.languages[0].substring(0,2).toUpperCase():"EN";var t;e="EN"===(t=e)?"EN-GB":"PT"===t?"PT-PT":t;return s.map((e=>e.langCode)).includes(e)?e:"EN"},Tg=()=>{const e={};return s.forEach((t=>{let n=t.langCode;["EN-GB","EN-US"].includes(n)&&(n="EN"),["PT-PT","PT-BR"].includes(n)&&(n="PT"),["ZH-HANT"].includes(n)&&(n="ZH"),e[n]=0})),e},Sg=e=>e.substring(0,2).toUpperCase();const bg=e=>{let t=s.find((t=>t.langCode.toUpperCase()===e.toUpperCase()));return t||(t=s.find((t=>t.langCode.substring(0,2).toUpperCase()===e.substring(0,2).toUpperCase())),t)};function Eg(e,t){const n=["EN-US","EN-GB","PT-PT","PT-BR","ZH-HANT"].includes(e?.toUpperCase());let r,o=e?.toUpperCase();return n&&(o=e?.toUpperCase().slice(0,2),r=t||function(e){const t=e.split("-");if(2===t.length)return t[0].toLowerCase()+"-"+t[1].toUpperCase();return e}(e?.toUpperCase())),{langCode:o,regionalVariant:r}}function wg(e){return s.find((t=>t.langCode===e.toUpperCase())).langCodeForIta}const Ag=()=>({settingSchemeVersion:41,blacklistDomains:[],blacklistDomainsForReading:[],blacklistDomainsForWriting:[],languagesForTranslation:s.reduce(((e,t)=>({...e,[t.langCode]:c})),{}),selectedTargetLanguage:vg(),isTargetLanguageConfirmed:!1,deepLProApiKey:{IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.30.0",interactiveTextApiFree:"https://ita-free.www.deepl.com/v1",interactiveTextApiPro:"https://ita-pro.www.deepl.com/v1",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplDomain:"https://www.deepl.com",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.30.0",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!0}}.DEEPL_PRO_API_KEY,installationId:n(),enableFullPageTranslation:!0,enableInputTranslation:!0,enableInlineTranslation:!0,languagePreferenceForWriting:Tg(),languagePreferenceForReading:Tg(),languagePreferenceForDeeplWrite:"EN-US",blacklistedPopupWidgets:[],successfulTranslations:0,successfulArabicTranslations:0,isReviewPopupShown:!1,shouldDisplayFeedbackPopup:!1,isInputHighlighterShown:!1,isInlineHighlighterShown:!1,regionalVariant:void 0,isSurveyLinkHidden:!1,isGlossaryEnabled:!1,activeTermbaseId:null,isZendeskOnboarded:!1,isZendeskEnabled:!0,isZendeskOnboardingShown:!1,zendeskFormality:"auto",zendeskSuccessfulTranslations:0,zendeskActiveTermbase:null,isGDocsEnabled:!0,isGDocsOnboardingShown:!1,gDocsSegmentation:W.SENTENCE,gDocsWriteLang:null,isGmailEnabled:!0,wasGmailOnboardingShown:!1,successfulTranslationsGmail:0,wasGmailFeedbackPopupShown:!1,isGSlidesEnabled:!0,isGSlidesOnboardingShown:!1,wasGSlidesFeedbackPopupShown:!1,successfulTranslationsGSlides:0,isWhatsAppWebEnabled:!0,isTwitterEnabled:!0,isYoutubeEnabled:!0,customizationsActiveStates:{[k.linkedIn]:!0},hasUserSeenAccountCreationNudge:!1,hasUserSeenPostAccountCreationOnboarding:!1,hasUserSeenProCustomerSegmentationSurvey:!1,firefoxAnonPermissionGranted:!0,firefoxPersonalPermissionGranted:!1,enableItaDev:!1,enableItaWriteDev:!1,enableItaInputDev:!1}),Ig={prod:"production",dev:"development",test:"testing"};function Rg(){return Ig.prod}function kg(){return Rg()===Ig.dev}function Cg(){return Rg()===Ig.prod}function Og(){}function xg(e){return e()}const Lg=[];function Ng(e,t=Og){let n;const r=new Set;function o(t){if(s=t,((o=e)!=o?s==s:o!==s||o&&"object"==typeof o||"function"==typeof o)&&(e=t,n)){const t=!Lg.length;for(const t of r)t[1](),Lg.push(t,e);if(t){for(let e=0;e<Lg.length;e+=2)Lg[e][0](Lg[e+1]);Lg.length=0}}var o,s}function s(t){o(t(e))}return{set:o,update:s,subscribe:function(a,i=Og){const c=[a,i];return r.add(c),1===r.size&&(n=t(o,s)||Og),a(e),()=>{r.delete(c),0===r.size&&n&&(n(),n=null)}}}}const Pg=function(){const{subscribe:e,set:t,update:n}=Ng({});return chrome.storage.sync.get(null,(e=>{t(e),chrome.storage.local.get(["isLoggedIn","isProUser","translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","browserInstanceId","featureSet","hasTermbaseService"],(e=>{n((t=>({...t,...e})))}))})),chrome.storage.onChanged.addListener((e=>{const t=["a_t","r_t","i_t","accountId"];let r={};for(const[n,o]of Object.entries(e))!1===t.includes(n)&&(r[n]=o.newValue);if(kg()){const e="background-color: #324054;padding: 3px; font-size:12px;color:#e1e8c3; font-weight:600";console.log(`%c${(new Date).toISOString()} UPDATE USER SETTINGS`,e,r)}return n((e=>({...e,...r}))),!0})),{subscribe:e,set:e=>chrome.storage.sync.set(e)}}(),Dg=function(){const{subscribe:e,update:t}=Ng({});return chrome.runtime.onMessage.addListener((function(e,n){switch(e.action){case"newWebsiteState":e.payload&&t((t=>({...t,[n.tab.id]:{...t[n.tab.id],...e.payload,error:e.payload.error?e.payload.error:void 0}})));break;case"resetWebsiteState":e.payload&&t((t=>({...t,[n.tab.id]:{...e.payload}})))}return!0})),{subscribe:e,fetchCurrentWebsiteSettings:()=>{chrome.tabs&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"dlGetWebsiteData"},(function(n){t((t=>({...t,[e[0].id]:{...t[e[0].id],...n}})))}))}))}}}();!function(e,t,n){const r=!Array.isArray(e),o=r?[e]:e;if(!o.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=t.length<2;return a=(e,n)=>{let a=!1;const i=[];let c=0,l=Og;const u=()=>{if(c)return;l();const o=t(r?i[0]:i,e,n);s?e(o):l="function"==typeof o?o:Og},d=o.map(((e,t)=>function(e,...t){if(null==e){for(const e of t)e(void 0);return Og}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}(e,(e=>{i[t]=e,c&=~(1<<t),a&&u()}),(()=>{c|=1<<t}))));return a=!0,u(),function(){d.forEach(xg),l(),a=!1}},{subscribe:Ng(n,a).subscribe};var a}(Dg,(async(e,t)=>{if(!chrome.tabs)return;t(e[(await chrome.tabs.query({active:!0,currentWindow:!0}))[0].id])})),function(){const{subscribe:e,set:t}=Ng([]);var n;(n={action:"dlGetExperiments",payload:{forceFetch:!1}},new Promise(((e,t)=>{chrome.runtime.sendMessage(n,(function(n){n&&n.error&&t(n),e(n)}))}))).then((e=>t(e))),chrome.runtime.onMessage.addListener((function(e){if("dlExperimentsUpdated"===e.action)e.payload&&t(e.payload.experiments);return!0}))}();const Mg=(e,t)=>((e,t)=>{if(!e)throw new Error("No settings supplied to getServiceType");if(!Object.keys(D).includes(t))throw new Error("Unidentified service name supplied to getServiceType");if(!e.isLoggedIn)return M.free;switch(t){case D.TRANSLATOR:return e.translatorServiceType;case D.WRITE:return e.writeServiceType;case D.API:return e.apiServiceType;case D.DOC_TRANSLATOR:return e.docTranslatorServiceType}})(e,t)===M.pro,Ug=e=>e.isLoggedIn&&e.hasTermbaseService,$g=e=>!![/Receiving end does not exist/,/message channel closed before a response was received/,/Extension context invalidated/].some((t=>t.test(e))),Fg={dsn:"https://f7c23f019d154c319e91e8de004727dc@errortracking.deepl.com/12",release:"deepl-browser-extension@1.30.0",environment:Rg(),tracesSampleRate:Cg()?.1:1,sampleRate:Cg()?.1:1,ignoreErrors:[/Receiving end does not exist/,/message channel closed before a response was received/,/Extension context invalidated/],beforeSend(e){const t=e.message||e.exception&&e.exception.values&&e.exception.values[0].value||"";return $g(t)?null:(kg()&&console.error(e),e)}};function Gg(e,t){t.captureException(e)}const jg={PROTOCOL_ERROR:"PROTOCOL_ERROR",NETWORK_ERROR:"NETWORK_ERROR",FULL_PAGE_SERVER_ERROR:"FULL_PAGE_SERVER_ERROR",USER_UNAUTHORIZED:"-32003",USER_BLOCKED:"429",FORBIDDEN_REQUEST:"403",QUOTA_HAS_BEEN_REACHED:"1045601",TOO_MANY_REQUESTS:"1042902"},Vg={ENTRY_NOT_FOUND:"ENTRY_NOT_FOUND",SERVER_ERROR:"SERVER_ERROR"},Wg="INSTALLATION_ERROR",qg="TRANSLATED_INPUT_NOT_SET",Bg="TRANSLATOR_FREE_ACCOUNT_LIMIT_EXCEEDED",Hg="TRANSLATOR_ANONYMOUS_LIMIT_EXCEEDED",Jg="TRANSLATOR_FREE_ANON_WITH_WRITE_PRO",zg="WRITE_ANON_OR_FREE_LIMIT_EXCEEDED",Yg="WRITE_WITH_PRO_TRANSLATOR_LIMIT_EXCEEDED";class Xg extends Error{constructor(e){super(e),this.name=jg.PROTOCOL_ERROR,this.message=e}}class Kg extends Error{constructor(e){super(e),this.name=jg.FULL_PAGE_SERVER_ERROR,this.message=e}}class Qg extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}class Zg extends Error{constructor(e,t){super(t),this.name=Bg,this.limit=e,this.message=t}}class em extends Error{constructor(e,t){super(t),this.name=Hg,this.limit=e,this.message=t}}class tm extends Error{constructor(e,t){super(t),this.name=zg,this.limit=e,this.message=t}}class nm extends Error{constructor(e,t){super(t),this.name=Yg,this.limit=e,this.message=t}}class rm extends Error{constructor(e,t){super(t),this.name=Jg,this.limit=e,this.message=t}}class om extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}function sm(e,t){try{Gg(e,t),console.error(e)}catch(e){console.error(e)}return{error:e.name}}function am(){return{url:"https://s.deepl.com/chrome/statistics"}}function im(e){switch(e){case l.manual:return 1;case l.automatic:return 2;case l.inline:return 3;case l.input:return 4;case l.input_alternatives:return 5;default:return 0}}function cm(e){switch(e){case Vg.ENTRY_NOT_FOUND:return 1;case Vg.SERVER_ERROR:return 2}}function lm(e){switch(e){case h.defaultPopup:return f.extensionIcon;case h.fptInjectedPopup:return f.fptAutoInject;default:return 0}}function um(e){switch(e){case h.defaultPopup:return g.defaultPopup;case h.fptInjectedPopup:return g.injectedFptPopup;case h.inlineTooltipPopup:return g.inlinePopup;default:return 0}}function dm(e){return e===m.hintKeyboardShortcut?1:0}function pm(e){switch(e){case _.inputTranslationTriggerIcon:return 1;case _.inlineTranslationTriggerIcon:return 2;case _.inlineTranslationSettingPopup:return 3;case _.inputTranslationSettingPopup:return 4;case _.settingsPageFPT:return 5;case _.settingsPageReading:return 6;case _.settingsPageWriting:return 7;case _.fptHideModal:return 8;case _.inputTranslationSettingsIcon:return 9;case _.inlineTranslationSettingsIcon:return 10;case _.inputTranslationReadMoreLink:return 11;case _.inlineTranslationReadMoreLink:return 12;case _.fptTranslationReadMoreLink:return 13;case _.extensionHubToggleSwitch:return 14;case _.hubCustomizeShortcut:return 15;case _.hubLoginButton:return 16;case _.hubUpgradeToProLink:return 17;case _.hubTryProLink:return 18;case _.settingsPageCustomizeShortcutButton:return 19;case _.hubFPTEnableCheckbox:return 20;case _.hubFPTDisableCheckbox:return 21;case _.deeplWriteIcon:return 22;case _.hubViewIntegrations:return 23;case _.hubCloseCustomizationsWidget:return 24;case _.gmailOnboardingPopup:return 25;case _.gmailOnboardingIcon:return 26;case _.gmailCharLimitLogin:return 27;case _.gmailFeedbackSurvey:return 28;case _.gslidesFeedbackSurvey:return 29;case _.gslidesCharLimitLogin:return 30;case _.zendeskTryProLink:return 31;case _.settingsPageIntegrations:return 32;case _.onboardingSignUp:return 33;case _.onboardingSkipSignUp:return 34;case _.onboardingLoginLink:return 35;case _.onboardingSeeAllIntegrations:return 36;case _.inputImproveTriggerIcon:return 37;case _.iconToggleInHubTranslator:return 38;case _.iconToggleInHubWrite:return 39;case _.manageIconSettings:return 40;case _.writeLanguageSwitchedInHub:return 41;case _.writeLanguageSwitchedInSettings:return 42;default:return 0}}function hm(e){return e===y.triggerTranslation?1:0}function fm(e){switch(e){case v.clickOnShortcutNotifiction:return 60011;case v.clickOnInlineTranslationShowAlternatives:return 60026;case v.clickOnInlineTranslationCloseIcon:return 60027;case v.clickOnLogoutMenuEntry:return 60028;default:return 0}}function gm(e){switch(e){case S.inputTranslation:return 1;case S.inlineTranslation:return 2;case S.fullPageTranslation:return 3;default:return 0}}function mm(e){switch(e){case T.disableEverywhere:return 1;case T.disablePerSite:return 2;case T.enableEverywhere:return 3;case T.enablePerSite:return 4;default:return 0}}function _m(e){switch(e){case"top":return b.top;case"right":return b.right;case"bottom":return b.bottom;case"left":return b.left;default:return 0}}function ym(e){switch(e){case Q.shortcut_settings:return Z.SHORTCUT_SETTINGS;case Q.support_article:return Z.SUPPORT_ARTICLE;case Q.external.whatsapp:return Z.EXTERNAL.WHATSAPP;case Q.external.twitter:return Z.EXTERNAL.TWITTER;case Q.external.youtube:return Z.EXTERNAL.YOUTUBE;case Q.external.facebook:return Z.EXTERNAL.FACEBOOK;case Q.external.github:return Z.EXTERNAL.GITHUB;case Q.external.discord:return Z.EXTERNAL.DISCORD;case Q.external.telegram:return Z.EXTERNAL.TELEGRAM;case Q.external.reddit:return Z.EXTERNAL.REDDIT;case Q.external.gmail:return Z.EXTERNAL.GMAIL;case Q.external.gdocs:return Z.EXTERNAL.GDOCS;case Q.external.gslides:return Z.EXTERNAL.GSLIDES;case Q.external.msOffice:return Z.EXTERNAL.MSOFFICE;default:return""}}function vm(e){switch(e){case E.openPage:return 1;case E.backButton:return 2;case E.nextButton:return 3;case E.navigation:return 4;default:return 0}}function Tm(e){switch(e){case A.chrome:return w.chrome;case A.edge:return w.edge;case A.firefox:return w.firefox;case A.local:return w.local;default:return w.unspecified}}function Sm(e){return I[e]||0}function bm(e){switch(e){case k.default:return 1;case k.gdocs:return 2;case k.whatsappWeb:return 3;case k.twitter:return 4;case k.zendesk:return 5;case k.gmail:return 6;case k.gslides:return 7;case k.linkedIn:return 8;case k.youtube:return 9;default:return 0}}function Em(e){switch(e){case C.source:return 1;case C.target:return 2;default:return 0}}function wm(e){switch(e){case O.translate:return 1;case O.write:return 2;default:return 0}}function Am(e){switch(e){case B.simple:return 1;case B.business:return 2;case B.academic:return 3;case B.casual:return 4;case B.enthusiastic:return 5;case B.friendly:return 6;case B.confident:return 7;case B.diplomatic:return 8;default:return 0}}function Im(e){switch(e){case H.auto:return 0;case H.formal:return 1;case H.informal:return 2;default:return 0}}function Rm(e){switch(e){case 60026:case 60027:return!0;default:return!1}}function km(e){switch(e){case x.user:return 1;case x.extension:return 2;default:return 0}}function Cm(e){switch(e){case N.translation:return 1;case N.login:return 2;default:return 0}}function Om(e){switch(e){case P.message:return 1;case P.chat:return 2;default:return 0}}function xm(e){switch(e){case M.free:return 1;case M.pro:return 2;case M.none:return 3;default:return 0}}function Lm(e){switch(e){case G.READING_VIEW_TRANSLATE:return 1;case G.COMPOSE_VIEW_TRANSLATE:return 2;case G.COMPOSE_VIEW_IMPROVE:return 3;default:return 0}}function Nm(e){switch(e){case j.ANONYMOUS_USER_LIMIT_EXCEEDED:return 1;case j.FREE_ACCOUNT_LIMIT_EXCEEDED:return 2;case j.WRITE_ANONYMOUS_USER_LIMIT_EXCEEDED:return 3;case j.WRITE_FREE_ACCOUNT_LIMIT_EXCEEDED:return 4;default:return 0}}function Pm(e){switch(e){case O.translate:return 1;case O.write:return 2;default:return 0}}function Dm(e){switch(e){case V.LOGIN:return 1;case V.SIGNUP:return 2;case V.PRO_TRIAL:return 3;default:return 0}}function Mm(e){switch(e){case W.WORD:return 1;case W.SENTENCE:return 2;default:return 0}}function Um(e){switch(e){case q.none:return 1;case q.pro:return 2;case q.free:return 3;default:return 0}}const $m=["accountData","domainName"],Fm=[60067,60068,60069],Gm=(e,t)=>e&&"object"==typeof e?Array.isArray(e)?e.map((e=>Gm(e,t))):Object.keys(e).reduce(((n,r)=>(t.includes(r)||(n[r]=Gm(e[r],t)),n)),{}):e,jm=(e,t=!1,n=!1)=>e?n&&t?e:!n&&Fm.includes(e?.eventId)?null:Gm(e,$m):null,Vm=(e=!1,t=!1)=>!(!e&&!t)&&(!(!e&&t)&&(!(!e||t)||(!(!e||!t)||void 0)));function Wm(e,t,n){return{jsonrpc:"2.0",method:e,params:t,id:n}}const qm=e=>({isLoggedIn:!!e?.loginState?.accountId,translatorServiceType:xm(e?.featureSet?.translator?.service),docTranslatorServiceType:xm(e?.featureSet?.documentTranslation?.service),apiServiceType:xm(e?.featureSet?.api?.service),writeServiceType:xm(e?.featureSet?.write?.service)});async function Bm(e){let t,n,r,o,s,a,i,c,l,d,p,h=!1;try{const e=await ky(["session","installationId","firefoxAnonPermissionGranted","firefoxPersonalPermissionGranted"]);n=e.session.id,t=e.installationId,d=e.firefoxAnonPermissionGranted,p=e.firefoxPersonalPermissionGranted}catch(e){console.error(`DAP: Failed to fetch settings. Error: ${e.message}`)}try{const e=await Vy();h=!!e.accountId,r=xm(e.translatorServiceType),o=xm(e.apiServiceType),s=xm(e.docTranslatorServiceType),l=xm(e.writeServiceType),i=h?2===r||2===o||2===l||2===s?u.loggedInPro:u.loggedInFree:u.notLoggedIn,c=e.sessionType?Um(e.sessionType):Um(q.none)}catch(e){console.error(`DAP: Failed to fetch user information. Error: ${e.message}`)}try{a=await qy()}catch(e){console.error(e)}const f=X(),g=await Hy();let m,_;try{m=await By()}catch(e){console.error(e)}try{_=await Ky()}catch(e){console.error(e)}const y={eventId:void 0,extensionVersion:"1.30.0",sessionId:n,sessionType:c,installationId:t,browserInstanceId:a,originStore:Tm(chrome.runtime.id),userInfos:{...m&&{accountData:{accountId:m}},userType:i,translatorServiceType:r,apiServiceType:o,docTranslatorServiceType:s,writeServiceType:l},userAgent:f.userAgent,platform:f.platform,browser:f.browser,browserVersion:f.browserVersion,browserLang:f.browserLang,clientExperiments:g,..._&&{webInstanceId:_}};let v=e?e(y):y;if(K()){if(!Vm(d,p))return;if(v=jm(v,d,p),!v)return}return fetch("https://s.deepl.com/chrome/statistics",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(v),credentials:"omit"}).then((e=>{e.ok||console.log(`DAP ${v.eventId} request failed: ${e}`)}))}async function Hm(e){return Bm((t=>({...t,eventId:60001,translationRequestData:{extensionVersion:"1.30.0",domainName:e.domainName,userId:e.installationId,translationTrigger:im(e.trigger),translationData:{sourceLang:e.websiteLanguage,targetLang:e.targetLanguage,sourceLength:e.characterCount},...e.translationPerformance&&{translationPerformance:e.translationPerformance},nicheIntegration:bm(e.nicheIntegration||k.default),...e.glossaryTrackingInfo&&{isGlossaryEnabled:e.glossaryTrackingInfo.isGlossaryEnabled,isGlossaryShared:e.glossaryTrackingInfo.isGlossaryShared,didGlossaryChangeTranslation:e.glossaryTrackingInfo.didGlossaryChangeTranslation},...e.isIta&&{isIta:e.isIta}}})))}async function Jm(e){return Bm((t=>({...t,eventId:60002,errorData:{extensionVersion:"1.30.0",errorCode:e.errorCode,errorMessage:e.errorMessage}})))}async function zm(e){return Bm((t=>({...t,eventId:60003,translationErrorData:{errorData:{extensionVersion:"1.30.0",errorCode:e.errorCode,errorMessage:e.errorMessage},targetLang:e.targetLang,domainName:e.domainName,websiteLanguage:e.websiteLanguage,sourceLength:e.characterCount,translationTrigger:im(e.trigger),nicheIntegration:bm(e.nicheIntegration||k.default)}})))}async function Ym(e){return Bm((t=>({...t,eventId:60004,contentScriptErrorData:{errorData:{extensionVersion:"1.30.0",errorCode:e.errorCode,errorMessage:e.errorMessage},domainName:e.domainName}})))}async function Xm(e){return Bm((t=>({...t,eventId:60005,inputInjectionData:{extensionVersion:"1.30.0",domainName:e.domainName}})))}async function Km(e){return Bm((t=>({...t,eventId:60007,extensionOpenedData:{extensionVersion:"1.30.0",domainName:e.domainName,pathName:e.pathName,extensionOpenedFrom:e.extensionOpenedFrom}})))}async function Qm(e){return Bm((t=>({...t,eventId:60008,logoClickedData:{extensionVersion:"1.30.0",logoClickedFrom:e.logoClickedFrom}})))}async function Zm(e){return Bm((t=>({...t,eventId:60009,notificationViewedData:{extensionVersion:"1.30.0",notificationType:dm(e.notificationType)}})))}async function e_(e){return Bm((t=>({...t,eventId:60010,shortcutUsedData:{shortcutType:hm(e.shortcutType),uiLocation:pm(e.location),shortcut:e.shortcut,nicheIntegration:bm(e.nicheIntegration||k.default)}})))}async function t_(e){const t={eventId:fm(e.uiAction)};return Rm(t.eventId)&&(t.payload={nicheIntegration:bm(e.nicheIntegration||k.default)}),Bm((e=>({...e,...t})))}async function n_(){return Bm((e=>({...e,eventId:60012})))}async function r_(){return Bm((e=>({...e,eventId:60013})))}async function o_(e){return Bm((t=>({...t,eventId:60014,inlineSettingOpenedData:{uiFunction:gm(e.uiFunction),uiLocation:pm(e.uiLocation),nicheIntegration:bm(e.nicheIntegration)}})))}async function s_(e){return Bm((t=>({...t,eventId:60015,settingChangedData:{settingType:mm(e.settingType),uiFunction:gm(e.uiFunction),uiLocation:pm(e.uiLocation),domainName:e.domainName}})))}async function a_(e){return Bm((t=>({...t,eventId:60016,detectLanguageData:{domainName:e.domainName,language:e.language}})))}async function i_(e){return Bm((t=>({...t,eventId:60017,rightClickData:{domainName:e.domainName,translationType:e.translationType}})))}async function c_(e){return Bm((t=>({...t,eventId:60018,inlinePositionChangeData:{newPosition:_m(e.newPosition)}})))}async function l_(e){return Bm((t=>({...t,eventId:60019,inlineDragStartData:{nicheIntegration:bm(e?.nicheIntegration||k.default)}})))}async function u_(e){return Bm((t=>({...t,eventId:60020,whatsAppMessageTranslatedData:{messageLang:e.messageLang,targetLang:e.targetLang,messageLength:e.messageLength,translator:Om(e.translator),numberOfLanguages:e.numberOfLanguages,numberOfMessages:e.numberOfMessages}})))}async function d_(e){return Bm((t=>({...t,eventId:60021,whatsAppMessageTranslationFailedData:{errorCode:e.errorCode,domainName:e.domainName,translationConfig:{messageLength:e.messageLength,targetLang:e.targetLang,messageLang:e.messageLang,translator:Om(e.translator),numberOfLanguages:e.numberOfLanguages,numberOfMessages:e.numberOfMessages}}})))}async function p_(e){return Bm((t=>({...t,eventId:60057,twitterTweetTranslationFailedData:{errorCode:e.errorCode,domainName:e.domainName,translationConfig:{messageLength:e.messageLength,targetLang:e.targetLang,messageLang:e.messageLang}}})))}async function h_(e){return Bm((t=>({...t,eventId:60094,youtubeCommentTranslationFailedData:{errorCode:e.errorCode,domainName:e.domainName,translationConfig:{messageLength:e.messageLength,targetLang:e.targetLang,messageLang:e.messageLang}}})))}async function f_(e){return Bm((t=>({...t,eventId:60022,fptHideData:{hideOption:e.hideOption,sourceLang:e.sourceLang,domainName:e.domainName,uiLocation:pm(e.uiLocation)}})))}async function g_(e){return Bm((t=>({...t,eventId:60023,inlineCopyData:{targetLang:e.targetLang,targetLength:e.targetLength,nicheIntegration:bm(e.nicheIntegration||k.default)}})))}async function m_(e){return Bm((t=>({...t,eventId:60024,inlineListenData:{targetLang:e.targetLang,targetLength:e.targetLength,actionType:e.actionType,textKind:Em(e.textKind),context:wm(e.context),nicheIntegration:bm(e.nicheIntegration||k.default)}})))}async function __(e){return Bm((t=>({...t,eventId:60025,iconHoverData:{uiLocation:pm(e.uiLocation),domainName:e.domainName,nicheIntegration:bm(e.nicheIntegration||k.default)}})))}async function y_(e){return Bm((t=>({...t,eventId:60029,onboardingStepChangeData:{previousStep:e.previousStep,newStep:e.newStep,trigger:vm(e.trigger),secondsOnOnboarding:e.secondsOnOnboarding,secondsOnPreviousStep:e.secondsOnPreviousStep}})))}async function v_(e){return Bm((t=>({...t,eventId:60030,onboardingOpenExternalPageData:{url:ym(e.url)}})))}async function T_(e){return Bm((t=>({...t,eventId:60031,readMoreClickedData:{uiLocation:pm(e.uiLocation)}})))}async function S_(e){return Bm((t=>({...t,eventId:60032,landOnWebsiteData:{website:Sm(e.website)}})))}async function b_(e){return Bm((t=>({...t,eventId:60033,inlineListenData:{targetLang:e.targetLang,targetLength:e.targetLength,triggerType:e.triggerType,textKind:Em(e.textKind),context:wm(e.context),nicheIntegration:bm(e.nicheIntegration||k.default)}})))}async function E_(e){return Bm((t=>({...t,eventId:60034,openInputHighlighterData:{domainName:e.domainName}})))}async function w_(e){return Bm((t=>({...t,eventId:60035,closeInputHighlighterData:{trigger:e.trigger}})))}async function A_(e){return Bm((t=>({...t,eventId:60036,gdocsReplaceTextData:{sourceLang:e.sourceLang,targetLang:e.targetLang,sourceLength:e.sourceLength,targetLength:e.targetLength}})))}async function I_(){return Bm((e=>({...e,eventId:60037})))}async function R_(e){return Bm((t=>({...t,eventId:60038,openInputHighlighterData:{domainName:e.domainName}})))}async function k_(e){return Bm((t=>({...t,eventId:60039,closeInputHighlighterData:{trigger:e.trigger}})))}async function C_(e){return Bm((t=>({...t,eventId:60040,dictionaryStatus:{status:e.status,langPair:e.langPair}})))}async function O_(){return Bm((e=>({...e,eventId:60041})))}async function x_(){return Bm((e=>({...e,eventId:60042})))}async function L_(e){return Bm((t=>({...t,eventId:60043,errorData:{lingueeError:cm(e.error)}})))}async function N_(e,t){let n;switch(e){case L.OPEN_TICKET:n=60044;break;case L.DETECT_TICKET_LANGUAGE:n=60045;break;case L.SWITCH_TICKET_LANGUAGE:n=60046;break;case L.ENABLE_AUTOTRANSLATE:n=60047;break;case L.DISABLE_AUTOTRANSLATE:n=60048;break;case L.TRANSLATE_MESSAGE:n=60049;break;case L.TRANSLATE_INPUT:n=60050;break;case L.ERROR:n=60051;break;default:return}return Bm((e=>({...e,eventId:n,zendeskMetaData:{agentLanguage:t.agentLanguage,ticketLanguage:t.ticketLanguage,isTicketLanguageAutodetected:t.isTicketLanguageAutodetected,isTicketLanguageSupported:t.isTicketLanguageSupported,isAutoTranslateEnabled:t.isAutoTranslateEnabled,sourceTextLength:t.sourceTextLength,targetTextLength:t.targetTextLength,inputHasSelection:t.inputHasSelection,error:t.error}})))}async function P_(e){let t;if(e.glossaryConfigOpenedWithoutGlossaryPermissions?t=60084:e.glossaryConfigOpenedWithNoGlossariesFound&&(t=60085),t)return Bm((e=>({...e,eventId:t})))}async function D_(){return Bm((e=>({...e,eventId:60054})))}async function M_(e){const t=Math.round(await Gy()/60);return Bm((n=>({...n,eventId:60055,logoutData:{trigger:km(e.trigger),minutesSinceLastLogin:t,reason:e.reason}})))}async function U_(e){return Bm((t=>({...t,eventId:60052,gdocsMaxCharExceededData:{sourceLang:e.sourceLang,targetLang:e.targetLang,sourceLength:e.sourceLength}})))}async function $_(e){return Bm((t=>({...t,eventId:60053,gdocsMaxCharExceededData:{sourceLang:e.sourceLang,targetLang:e.targetLang,sourceLength:e.sourceLength}})))}async function F_(e){return Bm((t=>({...t,eventId:60056,sessionTypeData:{sessionType:e.sessionType,trigger:Cm(e.trigger)}})))}async function G_(e){let t="";try{t=await My()}catch(e){console.log(`DAP: Failed to fetch session type. Error: ${e.message}`)}return Bm((n=>({...n,eventId:60058,onboardingModalShownData:{nicheIntegration:bm(e.nicheIntegration||k.default),sessionType:t}})))}async function j_(e){return Bm((t=>({...t,eventId:60059,UILocationClickedData:{uiLocation:pm(e)}})))}async function V_(){return Bm((e=>({...e,eventId:60060})))}async function W_(){return Bm((e=>({...e,eventId:60061})))}async function q_(e,t){let n;switch(e){case U.TEXT_REFINEMENT_REQUEST:n=60062;break;case U.GDOCS_INSERT_COPY:n=60063;break;case U.GDOCS_DISCARD_COPY:n=60064;break;case U.GDOCS_CHAR_LIMIT_REACHED:n=60065;break;case U.ERROR:n=60066;break;case U.RESULT_ACCEPTED:n=60071;break;case U.RESULT_REVERTED:n=60072;break;case U.GET_ALTERNATIVES_FOR_INPUT:n=60088;break;default:return}return Bm((e=>({...e,eventId:n,deeplWriteMetaData:{lang:t.lang,sourceLength:t.sourceLength,targetLength:t.targetLength,nicheIntegration:bm(t.nicheIntegration||k.default),error:t.error,style:Am(t.style)}})))}async function B_(){if(!await Dy())return;const e=await By();return Bm((t=>({...t,eventId:60067,accountData:{accountUuid:e}})))}async function H_(){const e=await By();return Bm((t=>({...t,eventId:60068,accountData:{accountUuid:e}})))}async function J_(){const e=await By();return Bm((t=>({...t,eventId:60069,accountData:{accountUuid:e}})))}async function z_(e,t){let n;switch(e){case $.RESULT_ACCEPTED:n=60073;break;case $.RESULT_REVERTED:n=60074;break;default:return}return Bm((e=>({...e,eventId:n,translationResultActionData:{sourceLang:t.sourceLang,sourceLength:t.sourceLength,targetLength:t.targetLength,nicheIntegration:bm(t.nicheIntegration||k.default),error:t.error}})))}async function Y_(e){return Bm((t=>({...t,eventId:60070,customizationOnOffData:{nicheIntegration:bm(e.nicheIntegration||k.default),uiLocation:pm(e.location),customizationEnabled:e.customizationEnabled}})))}async function X_(e){return Bm((t=>({...t,eventId:60075,gmailCharLimitReachedData:{gmailActionType:Lm(e.type)}})))}async function K_(e){return Bm((t=>({...t,eventId:60076,upgradeNotificationDisplayedData:{type:Nm(e)}})))}async function Q_(e){return Bm((t=>({...t,eventId:60077,upgradeNotificationClosedData:{type:Nm(e)}})))}async function Z_(e,t){return Bm((n=>({...n,eventId:60078,upgradeNotificationActionData:{type:Nm(e),action:Dm(t)}})))}async function ey(e,t){let n;switch(e){case F.ALTERNATIVES_OPENED:n=60079;break;case F.SEGMENTATION_SELECTED:n=60080;break;case F.ALTERNATIVE_SELECTED:n=80081;break;default:return}return Bm((e=>({...e,eventId:n,alternativesMetaData:{sourceLang:t.sourceLang,targetLang:t.targetLang,nicheIntegration:bm(t.nicheIntegration||k.default),contentProcessingMode:Pm(t.contentProcessingMode),...t.alternativesSegmentation&&{alternativesSegmentation:Mm(t.alternativesSegmentation)}}})))}async function ty(e,t){const n=e?60082:60083;return Bm((e=>({...e,eventId:n,glossaryMetadata:{nicheIntegration:bm(t.nicheIntegration||k.default)}})))}async function ny(e){return Bm((t=>({...t,eventId:60086,languageDetectionTextProcessingData:{detectedLanguageCode:e.lang,textLength:e.textLength,domainName:e.domainName,isReliable:e.isReliable,translationTrigger:im(e.trigger),nicheIntegration:bm(e.nicheIntegration||k.default)}})))}async function ry(){return Bm((e=>({...e,eventId:60087})))}async function oy(e){return Bm((t=>({...t,eventId:60089,alternativesMetaData:{sourceLang:e.sourceLang,targetLang:e.targetLang,numberOfAlternatives:e.numberOfAlternatives,selectedAlternativeIndex:e.selectedAlternative,nicheIntegration:bm(e.nicheIntegration||k.default),contentProcessingMode:Pm(e.contentProcessingMode),...e.alternativesSegmentation&&{alternativesSegmentation:Mm(e.alternativesSegmentation)}}})))}async function sy(){return Bm((e=>({...e,eventId:60090})))}async function ay(e){return Bm((t=>({...t,eventId:60091,errorData:{extensionVersion:"1.30.0",errorCode:e.errorCode,errorMessage:e.errorMessage}})))}async function iy(){return Bm((e=>({...e,eventId:60092})))}async function cy(e){return Bm((t=>({...t,eventId:60093,adsShownData:{matchedWord:e.matchedWord}})))}async function ly(e){return Bm((t=>({...t,eventId:60098,writeTextStylesData:{style:Am(e.style)}})))}async function uy(e){return Bm((t=>({...t,eventId:60099,writeTextStylesData:{style:Am(e.style)}})))}async function dy(e){return Bm((t=>({...t,eventId:60100,writeTextStylesData:{style:Am(e.tone)}})))}async function py(e){const t=qm(e);return Bm((e=>({...e,eventId:60095,webUserInfoData:t})))}async function hy(e){const t=qm(e);return Bm((e=>({...e,eventId:60096,webUserInfoData:t})))}async function fy(){return Bm((e=>({...e,eventId:60097})))}async function gy(e){return Bm((t=>({...t,eventId:60102,translationFormalityData:{formality:Im(e.formality)}})))}let my;const _y="dlBrowserExtension",yy="dlCache",vy="dlclientstate",Ty="dlexperiments";function Sy(){return new Promise(((e,t)=>{let n=indexedDB.open(_y,1);n.onerror=function(){t(n.error)},n.onsuccess=function(t){my=t.target.result,e()},n.onupgradeneeded=function(t){my=t.target.result,my.objectStoreNames.contains(yy)||my.createObjectStore(yy,{keyPath:"id"}),e()}}))}async function by(e,t,n){return my||await Sy(),new Promise(((r,o)=>{let s=my.transaction(n,"readwrite").objectStore(n).put({id:e,data:t,meta:{createdAt:Date.now()}});s.onsuccess=function(){r()},s.onerror=function(e){o(e)}}))}async function Ey(e,t){return my||await Sy(),new Promise(((n,r)=>{let o=my.transaction(t,"readonly").objectStore(t).get(e);o.onerror=function(e){r(e)},o.onsuccess=function(){o.result?n(o.result):n(null)}}))}async function wy(e){try{await by(vy,e,yy)}catch(e){Gg(e,yg)}}async function Ay(){const e=await Ey(vy,yy);if(!e||!e.meta)return;return(Date.now()-e.meta.createdAt)/6e4>20?void 0:e.data}async function Iy(e){try{await by(Ty,e,yy)}catch(e){Gg(e,yg)}}async function Ry(){const e=await Ey(Ty,yy);if(!e||!e.meta)return[];return(Date.now()-e.meta.createdAt)/6e4>9?[]:e.data&&0!==e.data.length?e.data:[]}async function ky(e){if(e.includes("session")){const e=await chrome.storage.sync.get(["session"]);e&&!e.session&&await Cy()}return new Promise(((t,n)=>{chrome.storage.sync.get(e,(r=>{r?t(r):n(`Can not get ${e}`)}))}))}async function Cy(){const e=n();await chrome.storage.sync.set({session:{id:e,timestamp:Date.now()}});try{await B_()}catch(e){console.error(e)}}async function Oy(){const{session:e}=await ky(["session"]);!e||(Date.now()-e.timestamp)/6e4>30?await Cy():await chrome.storage.sync.set({session:{...e,timestamp:Date.now()}})}async function xy(e,t,n){const r=o(e);return await chrome.storage.local.set({a_t:e,r_t:t,i_t:n,isLoggedIn:!(!e||!t),isProUser:!(!r||"Pro"!==r.sessionType),sessionType:r?.sessionType}),r?.sessionType}async function Ly(){await chrome.storage.local.remove(["a_t","r_t","i_t"]),await chrome.storage.local.set({isLoggedIn:!1,isProUser:!1,sessionType:""})}async function Ny(){await chrome.storage.sync.remove(["activeTermbaseId","isGlossaryEnabled"]),await chrome.storage.sync.set({activeTermbaseId:"",isGlossaryEnabled:!1})}async function Py(){const e=await chrome.storage.local.get(["a_t","r_t","i_t"]);return{access_token:e?e.a_t:void 0,refresh_token:e?e.r_t:void 0,id_token:e?e.i_t:void 0}}async function Dy(){const e=await chrome.storage.local.get(["isLoggedIn"]);return!(!e||!e.isLoggedIn)}async function My(){const e=await chrome.storage.local.get(["sessionType"]);return e?.sessionType}async function Uy(){return(await chrome.storage.sync.get(["installationId"])).installationId}async function $y(){await chrome.storage.local.set({last_login:Date.now()})}async function Fy(){await chrome.storage.local.remove(["last_login"])}async function Gy(){const e=await chrome.storage.local.get(["last_login"]);return e&&e.last_login?(Date.now()-e.last_login)/1e3:0}async function jy(e){const t=e.featureSet.translator.service,n=e.featureSet.write.service,r=e.featureSet.api.service,o=e.featureSet.documentTranslation.service,s=e.featureSet.glossary.termbaseService,a=e.featureSet.glossary.maxGlossaries;let i,c;e.loginState?.accountId&&(i=e.loginState.accountId),e.featureSet?.integrations?.browserExtension&&(c=e.featureSet?.integrations?.browserExtension),await chrome.storage.local.set({translatorServiceType:t,writeServiceType:n,apiServiceType:r,docTranslatorServiceType:o,accountId:i||"",featureSet:c,hasTermbaseService:s&&a>0})}async function Vy(){return await chrome.storage.local.get(["isLoggedIn","isProUser","sessionType","translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","accountId","hasTermbaseService"])}async function Wy(){await chrome.storage.local.set({browserInstanceId:n()})}async function qy(){return(await chrome.storage.local.get(["browserInstanceId"])).browserInstanceId}async function By(){const e=await chrome.storage.local.get(["accountId","a_t","i_t"]);if(e&&e.accountId)return e.accountId;if(e&&e.a_t){const t=o(e.a_t),n=o(e.i_t);return t.sub||n.sub}}async function Hy(){let e=[];try{e=await Ry()}catch(e){}if(!e||0===e.length)return[];const t=e.map((e=>({id:e.id,variant:e.variant,breakout:e.breakout})));return t}async function Jy(e="translatorServiceType"){const t=await Vy(),n=!!t.accountId,r=t[e];return n?r===M.pro?u.loggedInPro:u.loggedInFree:u.notLoggedIn}async function zy(e="translatorServiceType"){const t=await Jy(e);let n;switch(e){case"translatorServiceType":default:n=d;break;case"writeServiceType":n=p}switch(t){case u.notLoggedIn:return n.notLoggedIn;case u.loggedInFree:return n.loggedInFree;case u.loggedInPro:return;default:return n.notLoggedIn}}async function Yy(e){const t=await chrome.storage.local.get(["translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","isLoggedIn"]);return Mg(t,e)}async function Xy(){return await chrome.storage.local.get(["translatorServiceType","writeServiceType","apiServiceType","docTranslatorServiceType","isLoggedIn"])}async function Ky(){if(K())return;const e=await chrome.cookies.get({name:"dapUid",url:"https://www.deepl.com"});return e?e.value:void 0}async function Qy(e=!1){if(!e){let e;try{e=await Ry()}catch(e){}if(e&&e.length)return e}const t=await Uy();if(!t)throw new Error("Installation ID is not valid");let n=[];try{n=await Ry()}catch(e){}const r=`https://experimentation.deepl.com/experiments/${t}`;let o;try{const e=await fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:JSON.stringify(n),credentials:"omit"});return o=(await e.json()).client_experiments,o?(Iy(o),o):[]}catch(e){return[]}}const Zy={ACCESS_DENIED:"ACCESS_DENIED",INVALID_REQUEST:"INVALID_REQUEST",INVALID_GRANT:"INVALID_GRANT",GET_TOKEN_ERROR:"GET_TOKEN_ERROR",INVALID_NONCE:"INVALID_NONCE"};class ev extends Error{constructor(e,t){super(e),this.name=Zy.ACCESS_DENIED,this.message=e,this.httpStatusCode=t}}class tv extends Error{constructor(e,t){super(e),this.name=Zy.INVALID_REQUEST,this.message=e,this.httpStatusCode=t}}class nv extends Error{constructor(e,t){super(e),this.name=Zy.INVALID_GRANT,this.message=e,this.httpStatusCode=t}}class rv extends Error{constructor(e,t){super(e),this.name=Zy.GET_TOKEN_ERROR,this.message=e,this.httpStatusCode=t}}class ov extends Error{constructor(e){super(e),this.name=Zy.INVALID_NONCE,this.message=e}}function sv(e,t){const n=e.split("?")[1];if(n){var r=n.split("&");for(let e=0;e<r.length;e++){const n=r[e].split("=");if(decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}}}async function av(e,t,n="https://test.deepl.com/oidc-login"){const o=r(),s=r(),a=await async function(e){const t=await crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(s);return{url:n+"?"+new URLSearchParams([["client_id",e],["redirect_uri",t],["code_challenge",a],["code_challenge_method","S256"],["nonce",o]]),nonce:o,codeVerifier:s}}function iv(e,t){if(200!==e){if("invalid_request"===t.error)throw new tv(`dl-oidc (get tokens): invalid request - http status: ${e}`,e);if("invalid_grant"===t.error)throw new nv(`dl-oidc (get tokens): invalid grant - http status: ${e}`,e);throw new rv(`dl-oidc (get tokens): http status: ${e}`,e)}}async function cv(e,t="https://deepl.com/oidc/token"){const n=await fetch(t,{method:"POST",credentials:"omit",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:e})}),r=await n.json();return iv(n.status,r),r.access_token}async function lv(e,t,n=!1){let r=t.access_token;async function o(){return await fetch(e,{...t,headers:{...t.headers,Authorization:r?`Bearer ${r}`:"None"},...t.omitCookies&&{credentials:"omit"}})}n&&r&&(r=await cv(t.refresh_token,t.token_url));let s=await o();return 401!==s.status&&403!==s.status||(r=await cv(t.refresh_token,t.token_url),s=await o()),{response:s,accessToken:r}}async function uv(e=!1,n=!0){if(!e){const e=await Ay();if(e)return e}const r=Wm("getClientState",{v:"20180814"},t()),s=await Py(),a=n||function(e){try{const t=o(e);if(t.exp&&Date.now()/1e3<t.exp-5)return!1}catch(e){console.error("Error decoding token:",e)}return!0}(s.access_token),{response:i,accessToken:c}=await lv("https://w.deepl.com/web",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(r),access_token:s.access_token,refresh_token:s.refresh_token,token_url:"https://w.deepl.com/oidc/token",credentials:"omit"},a);await xy(c,s.refresh_token,s.id_token);const l=(await i.json()).result;return l&&(wy(l),jy(l)),l}async function dv(e=!1){const t=async()=>{const t=await av("chromeExtension",chrome.identity.getRedirectURL(),"https://www.deepl.com/auth/login");return new Promise(((n,r)=>{chrome.identity.launchWebAuthFlow({interactive:!0,url:e?`${t.url}#error_loginfailed`:t.url},(async e=>{if(!e){const e=chrome.runtime.lastError.message;return console.error("response url undefined",e),Gg(`login - response url undefined. ${e}`,yg),/The user did not approve access/gm.test(e)||/User cancelled or denied access/gm.test(e)?n():r()}try{const r=await async function(e,t,n,r,s,a="https://deepl.com/oidc/token"){const i=sv(n,"code");if(!i){const e=sv(n,"error");if("access_denied"===e)throw new ev("dl-oidc (get tokens): access denied - undefined code",401);if("invalid_request"===e)throw new tv("dl-oidc (get tokens): invalid request - undefined code",400)}let c={client_id:e,code_verifier:s,grant_type:"authorization_code",redirect_uri:t};i&&(c.code=i);const l=await fetch(`${a}`,{method:"POST",credentials:"omit",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c)}),u=await l.json();if(iv(l.status,u),o(u.id_token).nonce!==r)throw new ov("dl-oidc (get tokens): invalid nonce");return u}("chromeExtension",chrome.identity.getRedirectURL(),e,t.nonce,t.codeVerifier,"https://w.deepl.com/oidc/token"),s=await xy(r.access_token,r.refresh_token,r.id_token);try{await uv(!0,!1),D_(),H_(),s&&await F_({sessionType:s,trigger:"LOGIN"})}catch(e){console.error(e)}await $y(),n()}catch(e){console.error(e);try{Jm({errorCode:e.name,errorMessage:e.message})}catch(e){console.error(e)}r(e)}}))}))};try{await t()}catch(e){dv(!0)}}async function pv(e){const t=await Py(),n=new URLSearchParams([["id_token_hint",t.id_token],["post_logout_redirect_uri",chrome.identity.getRedirectURL()]]),r=async()=>{await Fy();try{await J_()}catch(e){console.error(e)}await Ly();try{await M_({trigger:e.trigger,reason:e.reason})}catch(e){console.error(e)}await uv(!0),Ny(),e.showAlert&&chrome.tabs.query({active:!0,currentWindow:!0},(function(t){chrome.tabs.sendMessage(t[0].id,{action:"dlShowAlert",payload:{error:e.reason}})}))};if(!t.id_token)return void await r();const o=`https://www.deepl.com/auth/logout?${n}`;chrome.identity.launchWebAuthFlow({url:o,interactive:!0},(()=>{r()}))}async function hv(){const e=await Py();let t=e.access_token;if(t){const n=6e4;if(1e3*o(t).exp-Date.now()<n){const n="https://w.deepl.com/oidc/token";t=await cv(e.refresh_token,n),await xy(t,e.refresh_token,e.id_token)}}return t}async function fv(e,t,n,r){const o=await Py(),s=await Yy(D.TRANSLATOR),a=await Yy(D.WRITE);let i=o&&o.access_token&&s?"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0":"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0";r&&(i=o&&o.access_token&&a?"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0":"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0");try{const{response:r,accessToken:s}=await lv(i,{method:"POST",headers:{"Content-Type":t},body:e,access_token:o.access_token,refresh_token:o.refresh_token,token_url:"https://w.deepl.com/oidc/token",omitCookies:!0}),a=await xy(s,o.refresh_token,o.id_token);if(a)try{await F_({sessionType:a,trigger:"TRANSLATION"})}catch(e){console.log(e)}try{await uv(!1,!1)}catch(e){console.error(`Failed to get the client state ${e.message}`)}let c=function(e,t,n){let r;try{r=JSON.parse(e)}catch(e){throw 200===t?new Xg("JSON_RPC: Parsing of response object failed"):t>=500&&n?new Kg(`FPT failed: Http status code ${t}`):new Qg(t.toString(),403===t?`Translation failed: Http status code ${t} forbidden request. re-authenticating makes no difference.`:`Translation failed: Http status code ${t}`)}if("2.0"!==r.jsonrpc||void 0!==r.result&&200!==t||void 0===r.result&&void 0===r.error)throw new Xg("JSON_RPC: missing field, wrong id, proper result without 200 status, or missing data");if(r.error){const e=r.error;if(void 0===e.code)throw new Xg('JSON_RPC: Missing field "code" in error response');throw new Qg(e.code.toString(),e.message)}if(200!==t)throw new Qg(t.toString(),`Http status code ${t}`);return r}(await r.text(),r.status,n);return{data:c,status:r.status}}catch(e){throw e.name!==Zy.ACCESS_DENIED&&e.name!==Zy.INVALID_REQUEST&&e.name!==Zy.INVALID_GRANT&&e.name!==jg.USER_UNAUTHORIZED&&e.name!==jg.FORBIDDEN_REQUEST||setTimeout((()=>{pv({trigger:x.extension,reason:e.name})}),5e3),e}}async function gv(e,t,n=(e=>e),r,o,s){const a=function(e,t,n){return{jsonrpc:"2.0",method:e,params:t,id:n}}(e,t,r),i=n(JSON.stringify(a),a);return(await fv(i,"application/json; charset=utf-8",o,s)).data.result}async function mv(e){let t,n={};for(const t in e.weights)e.weights[t]>0&&(n[t]=e.weights[t]);try{t=await Jy()}catch(e){t=u.notLoggedIn,console.log(e)}const r=e.nicheIntegration===k.default||e.nicheIntegration===k.gmail||e.nicheIntegration===k.gslides||!e.nicheIntegration,o=await Yy(D.TRANSLATOR),s=await Yy(D.WRITE);if((!o||!s)&&r){const n=e.sourceTexts.reduce(((e,t)=>e+t.length),0),r=e.isWriteRequest?"writeServiceType":"translatorServiceType",a=await zy(r);if(e.isWriteRequest){if(o&&!s&&n>a)throw new nm(a,"Char limit exceeded (Translator Pro, Write Free)");if(!s&&n>a)throw new tm(a,"Char limit exceeded (Write Free Or Anonymous)")}else{if(t===u.loggedInFree&&s&&n>a)throw new rm(a,"Char limit exceeded (Free or Anon Translator, Write Pro)");if(t===u.loggedInFree&&n>a)throw new Zg(a,"Char limit exceeded (Translator Free)");if(t===u.notLoggedIn&&n>a)throw new em(a,"Char limit exceeded (Translator Anon)")}}let a=e.sourceTexts;const i=["EN-US","EN-GB","PT-PT","PT-BR","ZH-HANT"].includes(e.targetLangCode?.toUpperCase());let c=e.targetLangCode?.toUpperCase();i&&(c=e.targetLangCode?.toUpperCase().slice(0,2));const l=e.isWriteRequest?e.sourceTexts.map((e=>({text:e,requestAlternatives:4}))):a.map((e=>({text:e}))),d={texts:l,...e.isHtml&&{html:"enabled"},...!e.isHtml&&{splitting:e.splitting?e.splitting:"paragraphs"},lang:{target_lang:c,source_lang_user_selected:"auto"===e.sourceLang?"auto":e.sourceLang.toUpperCase(),preference:{weight:n}},commonJobParams:{regionalVariant:e.regionalVariant&&i?e.regionalVariant:void 0,...e.isWriteRequest&&{mode:"write"},...e.formality&&{formality:e.formality}}};let p=1;const h=Date.now();a.forEach((e=>p+=(e.match(/[i]/g)||[]).length)),d.timestamp=h-h%p+p;const f=await gv("LMT_handle_texts",d,((e,t)=>e=(t.id+3)%13==0||(t.id+5)%29==0?e.replace('"method":"','"method" : "'):e.replace('"method":"','"method": "')),e.id,e.isHtml,e.isWriteRequest);return{texts:f.texts.map((e=>e.text)),sourceLang:f.lang.toUpperCase(),detectedLanguages:f.detectedLanguages}}const _v=new Map([["ZH_EN","chinese-english"],["EN_ZH","english-chinese"],["NL_EN","dutch-english"],["EN_NL","english-dutch"],["FR_EN","french-english"],["EN_FR","english-french"],["FR_DE","french-german"],["DE_FR","german-french"],["FR_PT","french-portuguese"],["PT_FR","portuguese-french"],["FR_ES","french-spanish"],["ES_FR","spanish-french"],["DE_EN","german-english"],["EN_DE","english-german"],["DE_PT","german-portuguese"],["PT_DE","portuguese-german"],["DE_ES","german-spanish"],["ES_DE","spanish-german"],["IT_EN","italian-english"],["EN_IT","english-italian"],["JA_EN","japanese-english"],["EN_JA","english-japanese"],["PL_EN","polish-english"],["EN_PL","english-polish"],["PT_EN","portuguese-english"],["EN_PT","english-portuguese"],["PT_ES","portuguese-spanish"],["ES_PT","spanish-portuguese"],["RU_EN","russian-english"],["EN_RU","english-russian"],["ES_EN","spanish-english"],["EN_ES","english-spanish"]]);async function yv(e){const t=function(e,t){const n=`${e.toUpperCase()}_${t.toUpperCase()}`;return _v.get(n)}(vv(e.sourceLang),vv(e.targetLang)),n=encodeURIComponent(e.text),r=`https://www-app.linguee.com/${t}/search?dlApp=BrowserExtension&il=${e.interfaceLang}&query=${n}`;let o=async function(e){let t;if(200!==e.status)throw 404===e.status?(console.error("Dictionary Entry not found: 404"),new om(Vg.ENTRY_NOT_FOUND)):(console.error("Dictionary Server Error"),new om(Vg.SERVER_ERROR));{try{t=await e.text()}catch(e){throw new om(Vg.SERVER_ERROR)}const n=/href=["']([^"']*)["']/g;t=t.replace(n,"")}return t}(await fetch(r));return o}function vv(e){return["EN-US","EN-GB","PT-PT","PT-BR","ZH-HANT"].includes(e)?["EN-US","EN-GB"].includes(e)?"EN":["PT-PT","PT-BR"].includes(e)?"PT":["ZH-CN","ZH-HANT"].includes(e)?"ZH":e:e}function Tv(e,t){const n=1e-5;return n*Math.floor((.97*e+t)/n)}async function Sv(){const e=Wm("getClientState",{v:"20180814"},t()),n=await fetch("https://w.deepl.com/web",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(e)});return(await n.json()).result}const bv="PROTOCOL_ERROR",Ev="FULL_PAGE_SERVER_ERROR",wv="-32003",Av="403",Iv="401";class Rv extends Error{constructor(e){super(e),this.name=bv,this.message=e}}class kv extends Error{constructor(e,t){super(t),this.name=e,this.message=t}}class Cv extends Error{constructor(e){super(e),this.name=Ev,this.message=e}}function Ov(){let e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}function xv(e,t){return{jsonrpc:"2.0",method:e,params:t,id:Ov()}}const Lv={TRANSLATE:"translate",WRITE:"write"},Nv="pro",Pv="LMT_split_text",Dv="LMT_handle_jobs",Mv="getTermbases";const Uv=async({mode:e,texts:t,config:n,sourceLang:r="auto",queryParameter:o,textType:s,advancedMode:a})=>{const i=await Gv(n,e),c=o?`${i}&method=${Pv}&${o}`:`${i}&method=${Pv}`,l=xv(Pv,{commonJobParams:{mode:e,...!0===a&&{advancedMode:!0}},lang:{lang_user_selected:r},texts:t,textType:s});return await Fv(c,{method:"POST",headers:{"Content-Type":"application/json"},body:Vv(l)},n)},$v=async({mode:e,jobs:t,sourceLang:n,targetLang:r,config:o,textType:s,formality:a,termbase:i,styleVariant:c,queryParameter:l,regionalVariant:u})=>{const d=await Gv(o,e),p=l?`${d}&method=${Dv}&${l}`:`${d}&method=${Dv}`,h=xv(Dv,{commonJobParams:{mode:e,...s&&{textType:s},...a&&{formality:a},...c&&{style_variant:c},...i&&{termbase:i},...c&&{style_variant:c},...u&&{regionalVariant:u}},lang:{source_lang_computed:n,target_lang:r},jobs:t,priority:1,timestamp:jv(t)});return await Fv(p,{method:"POST",headers:{"Content-Type":"application/json"},body:Vv(h)},o)},Fv=async(e,t,n)=>{const r=await n.auth.getAuthTokens(),o=r?{access_token:r.access_token,refresh_token:r.refresh_token,token_url:n.auth.tokenUrl}:{},{response:s,accessToken:a}=await lv(e,{...t,...o,omitCookies:n.omitCookies});return await n.auth.setAuthTokens(a,r.refresh_token,r.id_token),await Wv({response:s,isHtml:!1})},Gv=async({auth:e,baseUrls:t,isTermbase:n},r=void 0)=>{const o=await e.getAuthTokens(),s=r===Lv.WRITE?t.write:t.translate;if(n)return t.glossary;if(!o||!o.access_token)return s.free;if(!e.getServiceLevels){const e=(e=>{try{return JSON.parse(atob(e.split(".")[1]))}catch(e){return null}})(o.access_token),t=e&&"Pro"===e.sessionType;return o.access_token&&t?s.pro:s.free}{const t=await e.getServiceLevels();switch(r){case Lv.WRITE:return t.write===Nv?s.pro:s.free;case Lv.TRANSLATE:return t.translator===Nv?s.pro:s.free;default:return s.free}}},jv=e=>{const t=e.reduce(((e,t)=>[...e,...t.sentences.map((e=>e.text))]),[]);let n=1;const r=Date.now();return t.forEach((e=>n+=(e.match(/[i]/g)||[]).length)),r-r%n+n},Vv=e=>{let t=JSON.stringify(e);return t=(e.id+3)%13==0||(e.id+5)%29==0?t.replace('"method":"','"method" : "'):t.replace('"method":"','"method": "'),t},Wv=async({response:e,isHtml:t})=>{let n;try{if(403===e.status)throw new kv(e.status.toString(),`Translation failed: Http status code ${e.status} forbidden request. re-authenticating makes no difference.`);if(401===e.status)throw new kv(e.status.toString(),`Translation failed: Http status code ${e.status} unauthorized request.`);n=JSON.parse(await e.text())}catch(n){throw 200===e.status?new Rv("JSON_RPC: Parsing of response object failed"):e.status>=500&&t?new Cv(`FPT failed: Http status code ${e.status}`):new kv(e.status.toString(),`Translation failed: Http status code ${e.status}`)}if("2.0"!==n.jsonrpc||void 0!==n.result&&200!==e.status||void 0===n.result&&void 0===n.error)throw new Rv("JSON_RPC: missing field, wrong id, proper result without 200 status, or missing data");if(n.error){if(void 0===n.error.code)throw new Rv('JSON_RPC: Missing field "code" in error response');throw new kv(n.error.code.toString(),n.error.message)}if(200!==e.status)throw new kv(e.status.toString(),`Http status code ${e.status}`);return n},qv=Lv;async function Bv({texts:e,mode:t=Lv.TRANSLATE,targetLang:n}){return Yv((async r=>await async function({texts:e,mode:t=Lv.TRANSLATE,targetLang:n,config:r}){const o=await Uv({mode:t,texts:e,config:r}),s=o.result.texts[0].chunks.map(((e,n,r)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:n<r.length-1&&r.length>1?[r[n+1].sentences[0].text]:[],raw_en_context_before:n>0?[r[n-1].sentences[0].text]:[],sentences:[{...e.sentences[0],id:n}],...t===Lv.WRITE&&{write_variant_requests:["main","variants"]}})));return await $v({mode:t,jobs:s,sourceLang:o.result.lang.detected,targetLang:t===Lv.WRITE?o.result.lang.detected:n,config:r})}({texts:e,mode:t,targetLang:n,config:r})))}const Hv=async({mode:e,texts:t,sourceLang:n="auto",textType:r="plaintext",advancedMode:o})=>Yv((async s=>await Uv({mode:e,texts:t,sourceLang:n,config:s,textType:r,advancedMode:o}))),Jv=async({mode:e,jobs:t,sourceLang:n,targetLang:r,textType:o,formality:s,termbase:a,styleVariant:i,regionalVariant:c})=>Yv((async l=>await $v({mode:e,jobs:t,sourceLang:n,targetLang:r,config:l,textType:o,formality:s,termbase:a,styleVariant:i,regionalVariant:c}))),zv=async()=>Yv((async e=>await(async({config:e})=>{const t=`${await Gv({...e,isTermbase:!0})}&method=${Mv}`,n=xv(Mv,{});return await Fv(t,{method:"POST",headers:{"Content-Type":"application/json"},body:Vv(n)},e)})({config:e}))),Yv=async e=>{try{return await e(Xv())}catch(e){throw e.name!==Zy.ACCESS_DENIED&&e.name!==Zy.INVALID_REQUEST&&e.name!==Zy.INVALID_GRANT&&e.name!==wv&&e.name!==Av&&e.name!==Iv||setTimeout((()=>{pv({trigger:x.extension,reason:e.name})}),5e3),e}},Xv=()=>({baseUrls:{translate:{free:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",pro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0"},write:{free:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",pro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0"},glossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.30.0"},auth:{getAuthTokens:Py,setAuthTokens:xy,getServiceLevels:async()=>{const e=await Xy();return{translator:e.translatorServiceType,write:e.writeServiceType}},tokenUrl:"https://w.deepl.com/oidc/token"},omitCookies:!0}),Kv=async e=>{let t;try{t=await Jy()}catch(e){t=u.notLoggedIn,console.log(e)}const n=e.nicheIntegration===k.default||e.nicheIntegration===k.gmail||e.nicheIntegration===k.gslides||!e.nicheIntegration,r=await Yy(D.TRANSLATOR),o=await Yy(D.WRITE);if((!r||!o)&&n){const n=e.sourceTexts.reduce(((e,t)=>e+t.length),0),s=e.isWriteRequest?"writeServiceType":"translatorServiceType",a=await zy(s);if(e.isWriteRequest){if(r&&!o&&n>a)throw new nm(a,"Char limit exceeded (Translator Pro, Write Free)");if(!o&&n>a)throw new tm(a,"Char limit exceeded (Write Free Or Anonymous)")}else{if(t===u.loggedInFree&&o&&n>a)throw new rm(a,"Char limit exceeded (Free or Anon Translator, Write Pro)");if(t===u.loggedInFree&&n>a)throw new Zg(a,"Char limit exceeded (Translator Free)");if(t===u.notLoggedIn&&n>a)throw new em(a,"Char limit exceeded (Translator Anon)")}}},Qv=(e,t=[])=>{if(!e||0===t.length)return null;if(t.map((e=>e.id)).includes(e)){return t.find((t=>t.id===e))}return null},Zv=e=>e.translations[0].beams.map((e=>e.sentences[0])).some((e=>e.glossary_highlights&&e.glossary_highlights.length>0)),eT=(e,t,n)=>{const r=[];let o=[],s=0;for(const a of e){const e=n?n(a):a,i=tT(e);s+i>t&&o.length>0&&(r.push(o),o=[],s=0),o.push(a),s+=i}return o.length>0&&r.push(o),r},tT=e=>(new TextEncoder).encode(e).length,nT=24576,rT=e=>sT(e),oT=e=>sT(e,lT),sT=async(e,t=void 0)=>{await Kv(e);const{activeTermbaseId:n,isLoggedIn:r,isGlossaryEnabled:o,hasTermbaseService:s}=await ky(["activeTermbaseId","isLoggedIn","isGlossaryEnabled","hasTermbaseService"]),{textLinesComponents:a,sentences:i,sourceLang:c}=await aT(e);let l,u=!1,d=!1;const p=Eg(e.targetLangCode,e.regionalVariant);if(Ug({isLoggedIn:r,hasTermbaseService:s})&&n&&!e.isWriteRequest&&o)try{const[e]=await kT(),t=Qv(n,e);if(t)for(let e of t.termDictionaries)if(e.languagePair===`${c.substr(0,2)}>${p.langCode.substr(0,2)}`.toLowerCase()){l={id:t.id,dictionaryId:e.id},u=!0,d=t.shared;break}}catch(e){console.log({e:e,message:"fetching glossaries failed"})}const h=e.isWriteRequest?qv.WRITE:qv.TRANSLATE;let f;h===qv.WRITE?"EN"===c&&p.regionalVariant&&["EN-GB","EN-US"].includes(p.regionalVariant.toUpperCase())&&(f=p.regionalVariant):f=p.regionalVariant;const g={mode:h,sourceLang:c,targetLang:e.isWriteRequest?c:p.langCode,textType:e.textType,...e.formality&&{formality:e.formality},...l&&{termbase:l},...f&&{regionalVariant:f}},m=t??cT;let _=(await m(g,i)).result;const y=Zv(_);e.autoImproveForTranslate&&h===qv.TRANSLATE&&(_=await iT(e,g,_));const v=_.translations.map(((e,t)=>`${i[t].prefix}${e.beams[0]?.sentences[0].text??""}`)),T=a.map((e=>e.map((e=>v[e]))));return{processedText:T,result:_,...u&&{glossaryTrackingInfo:{isGlossaryEnabled:!!l,isGlossaryShared:d,didGlossaryChangeTranslation:y}}}},aT=async e=>{const t=[],n=[],r=e.isWriteRequest?qv.WRITE:qv.TRANSLATE,o=await Hv({texts:e.sourceTexts,mode:r});for(const e of o.result.texts){const r=[];for(const t of e.chunks)for(const e of t.sentences)n.push(e),r.push(n.length-1);t.push(r)}return{sentences:n,textLinesComponents:t,sourceLang:o.result.lang.detected}},iT=async(e,t,n)=>{const r=e.targetLangCode.substring(0,2).toUpperCase();if(n.source_lang.substring(0,2).toUpperCase()===r&&function(e){try{return e.replace(/[^\p{L}]/gu,"").length}catch(t){return e.replace(/[^a-zA-Z]/g,"").length}}(e.sourceTexts.join(""))>4&&(o=r,a.includes(o?.substr(0,2).toUpperCase()))){return(await Jv({...t,mode:qv.WRITE})).result}var o;return n},cT=async(e,t)=>{const n=t.map(((e,n)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:n<t.length-1?[t[n+1].text]:[],raw_en_context_before:n>0?[t[n-1].text]:[],sentences:[{...e,id:n+1}]}))),r={...e,jobs:n};return await Jv(r)},lT=async(e,t)=>{const n=t.map(((e,n)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:n<t.length-1?[t[n+1].text]:[],raw_en_context_before:n>0?[t[n-1].text]:[],sentences:[{...e,id:n+1}]}))),r=eT(n,nT,(e=>JSON.stringify(e))),o=await Promise.allSettled(r.map((async t=>{const n={...e,jobs:t};return await Jv(n)})));if(o.some((e=>"rejected"===e.status)))throw new Error("Failed to process all jobs");const s=o.filter((e=>"fulfilled"===e.status)).map((e=>e.value)),a=s[0];if(s.length>1)for(let e=1;e<s.length;++e){const t=s[e];a.result.translations.push(...t.result.translations)}return a};async function uT(e){const t=await ky(["selectedTargetLanguage"]);chrome.tabs.sendMessage(e,{action:"dlTranslateInline",targetLang:t.selectedTargetLanguage})}async function dT(e){const t=await ky(["selectedTargetLanguage"]);chrome.tabs.sendMessage(e,{action:"dlTranslateInput",targetLang:t.selectedTargetLanguage})}async function pT(e){await Oy();const n=await ky(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=new Date;let o=[],s=null;try{const r={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),isHtml:!0,sourceTexts:e.payload.texts,regionalVariant:n.regionalVariant},a=tT(e.payload.texts.join(""))>nT/4?oT:rT,i=await a(r);o=i.processedText,s=i.glossaryTrackingInfo}catch(t){try{zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,websiteLanguage:e.payload.sourceLang,trigger:e.payload.trigger,characterCount:e.payload.texts.reduce(((e,t)=>e+t.length),0)})}catch(e){console.log(e)}throw t}aS(e?.payload?.sourceLang,n?.selectedTargetLanguage);const a={isFirstTime:e.payload.isFirstTime,processingTimeInMs:(new Date).getTime()-r.getTime()};try{Hm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.sourceLang,targetLanguage:n.selectedTargetLanguage,characterCount:e.payload.texts.reduce(((e,t)=>e+t.length),0),translationPerformance:a,domainName:e.payload.domainName,glossaryTrackingInfo:s})}catch(e){console.error(e)}const i=o.map((e=>e.join("")));return i}async function hT(e){await Oy();const n=await ky(["selectedTargetLanguage","session","installationId","languagePreferenceForReading","regionalVariant"]),r=e.payload.nicheIntegration||k.default,o={sourceLang:e.payload.sourceLang||"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:e.payload.requests.map((e=>e.text)),weights:n.languagePreferenceForReading,splitting:"newlines",regionalVariant:n.regionalVariant,nicheIntegration:r,isWriteRequest:e.payload.isWriteRequest};let s,a,i;try{const e=await rT(o);s=e.result,a=e.processedText,i=e.glossaryTrackingInfo}catch(t){try{e.payload.isWriteRequest?q_(U.ERROR,{lang:e.payload.websiteLanguage,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:0,nicheIntegration:r,error:t.name}):zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,websiteLanguage:e.payload.websiteLanguage,trigger:e.payload.trigger,characterCount:e.payload.requests.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}aS(s?.source_lang,n?.selectedTargetLanguage),e.payload.platformBehavior===k.gslides&&OS();try{if(s.detectedLanguages){for(const e in s.detectedLanguages)(n.languagePreferenceForReading[e]||0===n.languagePreferenceForReading[e])&&(n.languagePreferenceForReading[e]=Tv(n.languagePreferenceForReading[e],s.detectedLanguages[e]));chrome.storage.sync.set({languagePreferenceForReading:n.languagePreferenceForReading})}}catch(e){console.error(e)}try{e.payload.isWriteRequest?q_(U.TEXT_REFINEMENT_REQUEST,{lang:e.payload.sourceLang,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:a.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:r}):Hm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:s.source_lang,targetLanguage:n.selectedTargetLanguage,characterCount:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),domainName:e.payload.domainName,nicheIntegration:r,glossaryTrackingInfo:i})}catch(e){console.error(e)}return a.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function fT(e){await Oy();const n=await ky(["targetLanguageUserInput","session","installationId","languagePreferenceForWriting","regionalVariant"]),r=e.payload.requests,o=e.payload.targetLang||n.targetLanguageUserInput,s=e.payload.platformBehavior||k.default,a={sourceLang:"auto",targetLangCode:o,sessionId:n.session.id,id:t(),sourceTexts:r.map((e=>e.text))||[],weights:n.languagePreferenceForWriting,splitting:"paragraphs",textType:"richtext",regionalVariant:n.regionalVariant,nicheIntegration:s,...e.payload.isHtml&&{isHtml:e.payload.isHtml},...e.payload.formality&&{formality:e.payload.formality},...e.payload.isWriteRequest&&{isWriteRequest:e.payload.isWriteRequest}};let i,c,u;try{const e=await rT(a);i=e.result,c=e.processedText,u=e.glossaryTrackingInfo}catch(t){try{e.payload.isWriteRequest?q_(U.ERROR,{lang:e.payload.source_lang,sourceLength:r.reduce(((e,t)=>e+t.text.length),0),targetLength:0,nicheIntegration:s,error:t.name}):zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:o,websiteLanguage:e.payload.websiteLanguage,trigger:l.input,characterCount:r.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}aS(i?.source_lang,o),e.payload.platformBehavior===k.gmail?kS():e.payload.platformBehavior===k.gslides&&OS();try{if(i.detectedLanguages){for(const e in i.detectedLanguages)(n.languagePreferenceForWriting[e]||0===n.languagePreferenceForWriting[e])&&(n.languagePreferenceForWriting[e]=Tv(n.languagePreferenceForWriting[e],i.detectedLanguages[e]));chrome.storage.sync.set({languagePreferenceForWriting:n.languagePreferenceForWriting})}}catch(e){console.error(e)}if(!0!==e.payload.skipDapReporting)try{e.payload.isWriteRequest?q_(U.TEXT_REFINEMENT_REQUEST,{lang:e.payload.source_lang,sourceLength:r.reduce(((e,t)=>e+t.text.length),0),targetLength:c.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:s}):Hm({installationId:n.installationId,trigger:l.input,websiteLanguage:i.sourceLang,targetLanguage:o,characterCount:r.reduce(((e,t)=>e+t.text.length),0),domainName:e.payload.domainName,nicheIntegration:s,glossaryTrackingInfo:u})}catch(e){console.error(e)}return[{detected_source_language:i.source_lang,text:c.flat().join(""),texts:c.map((e=>e.join("")))}]}async function gT(e){await Oy();const t=await ky(["session","installationId","languagePreferenceForWriting","regionalVariant","zendeskActiveTermbase"]),n=[e.payload.content],r=e.payload.targetLang,o=k.zendesk,s=qv.TRANSLATE,a=e.payload.formality;let i,c;const u=[],d=[];let p;try{const e=await Hv({texts:n,mode:s});let o;if(c=e.result.lang.detected,t.zendeskActiveTermbase?.termDictionaries)for(let e of t.zendeskActiveTermbase.termDictionaries)if(e.languagePair===`${c.substring(0,2)}>${r.substring(0,2)}`.toLowerCase()){o={id:t.zendeskActiveTermbase.id,dictionaryId:e.id},p=!0;break}for(const t of e.result.texts){const e=[];for(const n of t.chunks)for(const t of n.sentences)d.push(t),e.push(d.length-1);u.push(e)}const l=d.map(((e,t)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:t<d.length-1?[d[t+1].text]:[],raw_en_context_before:t>0?[d[t-1].text]:[],sentences:[{...e,id:t+1}]})));i=await Jv({mode:s,jobs:l,sourceLang:c,targetLang:r.substr(0,2),textType:"richtext",...a&&{formality:a},...o&&{termbase:o}})}catch(t){try{zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:r,websiteLanguage:e.payload.websiteLanguage,trigger:l.input,characterCount:n.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}const h=i.result.translations.map(((e,t)=>`${d[t].prefix}${e.beams[0].sentences[0].text}`)),f=u.map((e=>e.map((e=>h[e]))));if(aS(c,r),sS(),!0!==e.payload.skipDapReporting)try{Hm({installationId:t.installationId,trigger:l.input,websiteLanguage:c,targetLanguage:r,characterCount:n.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:o,isGlossaryEnabled:p})}catch(e){console.error(e)}return[{detected_source_language:c,text:f[0],texts:f}]}async function mT(e){await Oy();const n=await ky(["targetLanguage","session","installationId","regionalVariant"]),r=e.payload.requests,o=e.payload.sourceLang,s=e.payload.targetLang||n.targetLanguage,a=k.gmail,i={sourceLang:o||"auto",targetLangCode:s,sessionId:n.session.id,id:t(),sourceTexts:r.map((e=>e.text))||[],splitting:"newlines",regionalVariant:n.regionalVariant};let c,u,d;try{const e=await rT(i);c=e.result,u=e.processedText,d=e.glossaryTrackingInfo}catch(t){try{zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:s,trigger:l.input,characterCount:r.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}aS(c?.source_lang,s),kS();try{Hm({installationId:n.installationId,trigger:l.manual,websiteLanguage:c.source_lang,targetLanguage:s,characterCount:r.reduce(((e,t)=>e+t.text.length),0),domainName:e.payload.domainName,nicheIntegration:a,glossaryTrackingInfo:d})}catch(e){console.error(e)}return[{detected_source_language:c.source_lang,text:u.flat().join(""),texts:u.map((e=>e.join("")))}]}async function _T(e){await Oy();const n=await ky(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o=r.replace(/\n/g,"<br>"),s={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),textType:"richtext",sourceTexts:[o],regionalVariant:n.regionalVariant};let a;try{a=(await mv(s)).texts[0]}catch(t){throw tb((()=>p_({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.length}))),t}aS(a?.source_lang,n?.selectedTargetLanguage),tb((()=>Hm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.twitter})));return a.replace(/<br\s*\/?>/gi,"\n")}async function yT(e){await Oy();const n=await ky(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:[r],splitting:"paragraphs",regionalVariant:n.regionalVariant};let s,a,i;try{const e=await rT(o);s=e.result,a=e.processedText,i=e.glossaryTrackingInfo}catch(t){throw tb((()=>h_({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.length}))),t}return aS(s?.source_lang,n?.selectedTargetLanguage),tb((()=>Hm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.youtube,glossaryTrackingInfo:i}))),a.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function vT(e){await Oy();const n=await ky(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:[r],splitting:"paragraphs",regionalVariant:n.regionalVariant};let s,a,i;try{const e=await rT(o);s=e.result,a=e.processedText,i=e.glossaryTrackingInfo}catch(t){throw tb((()=>zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,websiteLanguage:e.payload.messageLang,characterCount:r.length,trigger:e.payload.trigger,nicheIntegration:k.linkedIn}))),t}return aS(s?.source_lang,n?.selectedTargetLanguage),tb((()=>Hm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.linkedIn,glossaryTrackingInfo:i}))),a.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function TT(e){await Oy();const n=await ky(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.message,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:[r],splitting:"paragraphs",regionalVariant:n.regionalVariant};let s,a,i;try{const e=await rT(o);s=e.result,a=e.processedText,i=e.glossaryTrackingInfo}catch(t){throw tb((()=>d_({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.length,numberOfLanguages:1,numberOfMessages:1,translator:P.message}))),t}return aS(s?.sourceLang,n?.selectedTargetLanguage),tb((()=>u_({messageLang:e.payload.messageLang,targetLang:n.selectedTargetLanguage,messageLength:r.length,numberOfLanguages:1,numberOfMessages:1,translator:P.message}))),tb((()=>Hm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.length,domainName:e.payload.domainName,nicheIntegration:k.whatsappWeb,glossaryTrackingInfo:i}))),a.map((e=>({text:e.join(""),detected_source_language:s.source_lang})))}async function ST(e){await Oy();const n=await ky(["selectedTargetLanguage","session","installationId","regionalVariant"]),r=e.payload.messages,o={sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:r,splitting:"paragraphs",regionalVariant:n.regionalVariant};let s;try{s=await mv(o)}catch(t){try{d_({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:n.selectedTargetLanguage,messageLang:e.payload.messageLang,messageLength:r.reduce(((e,t)=>e+t.length),0),numberOfLanguages:e.payload.detectedLanguages?.length,numberOfMessages:r.length,translator:P.chat})}catch(e){console.log(e)}throw t}aS(s?.sourceLang,n?.selectedTargetLanguage);try{u_({messageLang:e.payload.messageLang,targetLang:n.selectedTargetLanguage,messageLength:r.reduce(((e,t)=>e+t.length),0),numberOfLanguages:e.payload.detectedLanguages?.length,numberOfMessages:r.length,translator:P.chat}),Hm({installationId:n.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.messageLang,targetLanguage:n.selectedTargetLanguage,characterCount:r.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:k.whatsappWeb})}catch(e){console.error(e)}return[{detected_source_language:s.sourceLang,texts:s.texts}]}async function bT(e){const{texts:t,mode:n}=e.payload;return await Hv({texts:t,mode:n})}async function ET(e){await Oy();const t=await ky(["session","installationId","regionalVariant","activeTermbaseId","isGlossaryEnabled","isLoggedIn","hasTermbaseService"]),{mode:n,sentences:r,sourceLang:o,targetLang:s,domain:a}=e.payload,c=n===qv.WRITE;let l;try{l=await JS({isLoggedIn:t.isLoggedIn,activeTermbaseId:t.activeTermbaseId,isGlossaryEnabled:t.isGlossaryEnabled,hasTermbaseService:t.hasTermbaseService,sourceLang:o,targetLang:s,mode:n})}catch(e){console.error(e)}let u=4,d=null,p=i.includes(o);c&&(p&&(u=1),d=o),await chrome.storage.sync.set({gdocsWriteLang:d});const h=r.map(((e,t)=>({kind:"default",preferred_num_beams:u,raw_en_context_after:t<r.length-1?[r[t+1].text]:[],raw_en_context_before:t>0?[r[t-1].text]:[],sentences:[{...e,id:t+1}],...c&&!p&&{write_variant_requests:["main"]}}))),f=new Date,g=await Jv({mode:n,jobs:h,sourceLang:o,targetLang:s,...l&&{termbase:l}});try{n===qv.TRANSLATE&&Hm({installationId:t.installationId,trigger:e.payload.trigger,websiteLanguage:e.payload.sourceLang,targetLanguage:s,characterCount:r.map((e=>e.text)).reduce(((e,t)=>e+t.length),0),translationPerformance:{isFirstTime:!1,processingTimeInMs:new Date-f},domainName:a,nicheIntegration:k.gdocs})}catch(e){console.error(e)}return g}async function wT(e){const{mode:t,sourceLang:n,targetLang:r,sentence:o,contextBefore:s,contextAfter:a}=e.payload,i=[{kind:"default",preferred_num_beams:4,raw_en_context_after:a?[a]:[],raw_en_context_before:s?[s]:[],sentences:[{...o,partial_translation:"",id:0}],...t===qv.WRITE&&{write_variant_requests:["main","variants"]}}];return await Jv({mode:t,jobs:i,sourceLang:n,targetLang:r})}async function AT(e){const{mode:t,sourceLang:n,targetLang:r,sentence:o,contextBefore:s,contextAfter:a,partialTranslation:i}=e.payload,c=[{kind:"alternatives_at_position",raw_en_context_after:a?[a]:[],raw_en_context_before:s?[s]:[],sentences:[{...o,partial_translation:i,id:0}],...t===qv.WRITE&&{write_variant_requests:["main"]}}];return await Jv({mode:t,jobs:c,sourceLang:n,targetLang:r})}async function IT(e){const{mode:t,sourceLang:n,targetLang:r,sentence:o,contextBefore:s,contextAfter:a,partialTranslation:c}=e.payload,l=t===qv.WRITE,u=i.includes(n);let d=4;l&&u&&(d=1);const p=[{kind:"default",raw_en_context_after:a?[a]:[],raw_en_context_before:s?[s]:[],preferred_num_beams:d,sentences:[{...o,partial_translation:c,id:0}],...t===qv.WRITE&&!u&&{write_variant_requests:["main"]}}];return await Jv({mode:t,jobs:p,sourceLang:n,targetLang:r})}async function RT(e){await Oy();const t=await ky(["session","installationId","regionalVariant","zendeskActiveTermbase"]),n=qv.TRANSLATE,r=k.zendesk,{targetLang:o}=e.payload,s=[e.payload.text],a=s.map((e=>e.replaceAll("\n","<br>"))),i=[],c=[];let u,d,p,h;try{const e=await Hv({texts:a,mode:n,textType:"richtext"});if(h=e.result.lang.detected,t.zendeskActiveTermbase?.termDictionaries)for(let e of t.zendeskActiveTermbase.termDictionaries)if(e.languagePair===`${h.substring(0,2)}>${o.substring(0,2)}`.toLowerCase()){u={id:t.zendeskActiveTermbase.id,dictionaryId:e.id},d=!0;break}for(const t of e.result.texts){const e=[];for(const n of t.chunks)for(const t of n.sentences)c.push(t),e.push(c.length-1);i.push(e)}const r=c.map(((e,t)=>({kind:"default",preferred_num_beams:4,raw_en_context_after:t<c.length-1?[c[t+1].text]:[],raw_en_context_before:t>0?[c[t-1].text]:[],sentences:[{...e,id:t+1}]})));p=await Jv({mode:n,jobs:r,sourceLang:h,targetLang:o.substr(0,2),textType:"richtext",...u&&{termbase:u}})}catch(t){try{zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:o,websiteLanguage:e.payload.websiteLanguage,trigger:l.inline,characterCount:s.reduce(((e,t)=>e+t.text.length),0)})}catch(e){console.log(e)}throw t}aS(h,o),sS();const f=p.result.translations.map(((e,t)=>`${c[t].prefix}${e.beams[0].sentences[0].text}`)),g=i.map((e=>e.map((e=>f[e])))),m=g[0].join("");try{Hm({installationId:t.installationId,trigger:l.input,websiteLanguage:h,targetLanguage:o,characterCount:s.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:r,isGlossaryEnabled:d})}catch(e){console.error(e)}return m}async function kT(){let e,t,n="";try{e=await QT()}catch(e){t=e.message}if(!e?.isLoggedIn||t)return[[],t];try{n=(await zv()).result||[]}catch(e){t=e.message}return[n,t]}async function CT(e){await tb((()=>a_({language:e.payload.language,domainName:e.payload.domainName})))}async function OT(e){await tb((()=>Xm({domainName:e})))}async function xT(e){await tb((()=>Km({domainName:e.domainName,pathName:e.pathName,extensionOpenedFrom:lm(e.extensionContext)})))}async function LT(e){await tb((()=>Qm({logoClickedFrom:um(e.extensionContext)})))}async function NT(){await tb((()=>n_()))}async function PT(){await tb((()=>r_()))}async function DT(e){await tb((()=>o_({uiFunction:e.uiFunction,uiLocation:e.uiLocation,nicheIntegration:e.nicheIntegration||k.default})))}async function MT(e){await tb((()=>s_({settingType:e.settingType,newValue:e.newValue,uiFunction:e.uiFunction,uiLocation:e.uiLocation,domainName:e.domainName})))}async function UT(e){await tb((()=>i_({translationType:e.translationType,domainName:e.domainName})))}async function $T(e){await tb((()=>c_({newPosition:e.newPosition})))}async function FT(e){await tb((()=>l_(e)))}async function GT(e){await tb((()=>f_(e)))}async function jT(e){await tb((()=>__(e)))}async function VT(e){await tb((()=>g_(e)))}async function WT(e){await tb((()=>y_(e)))}async function qT(e){await tb((()=>m_(e)))}async function BT(e){await tb((()=>b_(e)))}async function HT(e){await tb((()=>v_(e)))}async function JT(e){await tb((()=>T_(e)))}async function zT(e){await tb((()=>A_(e)))}async function YT(e=!1){const t=await Qy(e);return chrome.runtime.sendMessage({action:"dlExperimentsUpdated",payload:{experiments:[...t]}}),t}async function XT(){dv()}async function KT(){pv({trigger:x.user})}async function QT(){const e=await Vy();return{isLoggedIn:e.isLoggedIn,translatorServiceType:e.translatorServiceType,writeServiceType:e.writeServiceType,hasTermbaseService:e.hasTermbaseService}}async function ZT(e){switch(e.type){case m.hintKeyboardShortcut:{const e=await chrome.storage.sync.get(["notificationsViewed"]);if(e.notificationsViewed?.hintKeyboardShortcut)return;await chrome.storage.sync.set({notificationsViewed:{...e.notificationsViewed,hintKeyboardShortcut:!0}});break}case m.showAdsForMSAddins:{const t=await chrome.storage.sync.get(["notificationsViewed"]),n=`showAdsFor${e.options.matchedWord}`;if(t.notificationsViewed?.[n])return;tb((()=>cy({matchedWord:e.options.matchedWord}))),await chrome.storage.sync.set({notificationsViewed:{...t.notificationsViewed,[n]:!0}});break}}tb((()=>Zm({notificationType:e.type})));const t=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(t[0].id,{action:"dlShowNotification",payload:e})}async function eS(){return await chrome.commands.getAll()}async function tS(e){const t=await eS();try{e_({shortcutType:e.shortcutType,location:e.location,shortcut:t.filter((t=>t.name===e.shortcutType))[0].shortcut,nicheIntegration:e.nicheIntegration||k.default})}catch(e){console.error(e)}}async function nS(e){t_({uiAction:e.uiAction,nicheIntegration:e.nicheIntegration||k.default})}function rS(e){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){chrome.tabs.sendMessage(t[0].id,{action:"dlTranslateSelectionRightClick",payload:e})}))}async function oS(e){await tb((()=>S_(e)))}async function sS(){const e=(await chrome.storage.sync.get(["zendeskSuccessfulTranslations"])).zendeskSuccessfulTranslations+1;await chrome.storage.sync.set({zendeskSuccessfulTranslations:e})}async function aS(e,t){const n=await chrome.storage.sync.get(["isReviewPopupShown","successfulTranslations","hasUserSeenProCustomerSegmentationSurvey","hasUserSeenArabicSurvey","successfulArabicTranslations"]),r=await QT();Mg(r,D.TRANSLATOR);const o=n.successfulTranslations+1;n.hasUserSeenProCustomerSegmentationSurvey;let s=n.isReviewPopupShown,a=n.hasUserSeenArabicSurvey,i=n.successfulArabicTranslations;if("AR"!==e&&"AR"!==t||(i+=1),!a&&"ar"===chrome.i18n.getUILanguage()&&o>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});return chrome.tabs.sendMessage(e[0].id,{action:"dlShowArabicSurveyPopup"}),void await chrome.storage.sync.set({hasUserSeenArabicSurvey:!0,successfulArabicTranslations:i,successfulTranslations:o})}if(!a&&i>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});return chrome.tabs.sendMessage(e[0].id,{action:"dlShowArabicSurveyPopup"}),void await chrome.storage.sync.set({hasUserSeenArabicSurvey:!0,successfulArabicTranslations:i,successfulTranslations:o})}if(!s&&o>=R){const e=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(e[0].id,{action:"dlShowAskForAReviewPopup"}),s=!0}await chrome.storage.sync.set({isReviewPopupShown:s,successfulArabicTranslations:i,successfulTranslations:o})}async function iS(e,t){let n=bg(e.lang);if(K())!function(e,t,n){const r=new SpeechSynthesisUtterance(e);r.lang=t,r.onend=function(){n()},speechSynthesis.speak(r)}(e.text,n.langCodeForSpeech,(()=>{chrome.tabs.sendMessage(t,{action:"dlVoiceOverStopped"})}));else{const r={lang:n.langCodeForSpeech,onEvent:function(e){"end"===e.type&&chrome.tabs.sendMessage(t,{action:"dlVoiceOverStopped"}),"error"==e.type&&chrome.tabs.sendMessage(t,{action:"dlVoiceOverErrorOccurred"})}};(function(){const e=navigator?.userAgentData?.platform||navigator?.platform||void 0;return e&&-1!==e?.toUpperCase().indexOf("MAC")})()&&(r.rate=.9,n.voice&&A.chrome===chrome.runtime.id&&(r.voiceName=n.voice)),chrome.tts.speak(e.text,r)}}async function cS(){let e;return e=K()?await new Promise(((e,t)=>{if("speechSynthesis"in window){const t=speechSynthesis.getVoices();t.length>0?e(t):speechSynthesis.onvoiceschanged=()=>{const t=speechSynthesis.getVoices();e(t)}}else t(new Error("SpeechSynthesis not supported"))})):await chrome.tts.getVoices(),e.map((e=>Sg(e.lang)))}async function lS(){if(!K())return chrome.tts.stop();speechSynthesis.cancel()}async function uS(e){await tb((()=>E_(e)))}async function dS(e){await tb((()=>R_(e)))}async function pS(e){await tb((()=>w_(e)))}async function hS(e){await tb((()=>k_(e)))}async function fS(e){return await yv(e)}async function gS(e){await tb((()=>C_(e)))}async function mS(e){await tb((()=>O_()))}async function _S(e){await tb((()=>x_()))}async function yS({eventType:e,zendeskMetaData:t}){await tb((()=>N_(e,t)))}async function vS(e){await tb((()=>L_(e)))}async function TS(e){await tb((()=>U_(e)))}async function SS(e){await tb((()=>$_(e)))}async function bS(e){await tb((()=>G_(e)))}async function ES(e){await tb((()=>j_(e)))}async function wS({eventType:e,deeplWriteMetaData:t}){await tb((()=>q_(e,t)))}async function AS(e){try{await Oy();const n=await ky(["selectedTargetLanguage","session"]),r=e.payload.requests,o={sourceLang:e.payload?.sourceLang?e.payload.sourceLang:"auto",targetLangCode:n.selectedTargetLanguage,sessionId:n.session.id,id:t(),sourceTexts:r.map((e=>e.text))||[],isWriteRequest:!0,...e.payload.isHtml&&{isHtml:!0}},s=await rT(o),a=s.result,i=s.processedText;if(!e.payload.skipDapReporting)try{q_(U.TEXT_REFINEMENT_REQUEST,{lang:a.source_lang,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:i.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:e.payload.nicheIntegration||k.default})}catch(e){console.error(e)}return[{detected_source_language:a.source_lang,text:i.flat().join(""),texts:i.map((e=>e.join("")))}]}catch(t){try{q_(U.ERROR,{lang:e.payload.sourceLang,sourceLength:e.payload.requests.reduce(((e,t)=>e+t.text.length),0),targetLength:void 0,nicheIntegration:e.payload.nicheIntegration||k.default,error:t.name})}catch(e){console.error(e)}throw t}}async function IS({eventType:e,acceptOrRevertMetadata:t}){await tb((()=>z_(e,t)))}async function RS(e){await tb((()=>Y_(e)))}async function kS(){const e=await chrome.storage.sync.get(["wasGmailFeedbackPopupShown","successfulTranslationsGmail"]),t=e.successfulTranslationsGmail+1;let n=e.wasGmailFeedbackPopupShown;if(!n&&t>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(e[0].id,{action:"dlShowGmailFeedbackPopup"}),n=!0}await chrome.storage.sync.set({wasGmailFeedbackPopupShown:n,successfulTranslationsGmail:t})}async function CS(e){await tb((()=>X_(e)))}async function OS(){const e=await chrome.storage.sync.get(["wasGSlidesFeedbackPopupShown","successfulTranslationsGSlides"]),t=e.successfulTranslationsGSlides+1;let n=e.wasGSlidesFeedbackPopupShown;if(!n&&t>=10){const e=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.tabs.sendMessage(e[0].id,{action:"dlShowSlidesFeedbackPopup"}),n=!0}await chrome.storage.sync.set({wasGSlidesFeedbackPopupShown:n,successfulTranslationsGSlides:t})}async function xS({eventType:e,alternativesMetaData:t}){await tb((()=>ey(e,t)))}async function LS(e=!1,t=!0){let n;try{n=await uv(e,t)}catch(e){throw e.name===Zy.INVALID_GRANT&&pv({trigger:x.extension,reason:e.name,showAlert:!0}),e}return n}async function NS(){let e;return e=await Sv(),e}async function PS(){return await zy()}function DS(e){tb((()=>K_(e)))}function MS(e){tb((()=>Q_(e)))}function US(e){tb((()=>P_(e)))}function $S(e){tb((()=>ty(!0,e)))}function FS(e){tb((()=>ty(!1,e)))}function GS(e,t){tb((()=>Z_(e,t)))}async function jS({text:e}){return await Bv({texts:[e],targetLang:"EN",mode:qv.WRITE})}function VS(e){ny(e)}function WS(){ry()}function qS(e){oy(e)}async function BS(e){await Oy();const t=e.payload.texts,n=qv.TRANSLATE;let r;const o=[],s=[],a=await Hv({texts:t,mode:n});r=a.result.lang.detected;for(const e of a.result.texts){const t=[];for(const n of e.chunks)for(const e of n.sentences)s.push(e),t.push(s.length-1);o.push(t)}return{detected_source_language:r,sentences:s,textLinesComponents:o}}async function HS(e){await Oy();const t=await ky(["activeTermbaseId","targetLanguageUserInput","session","installationId","languagePreferenceForWriting","regionalVariant","isLoggedIn","isGlossaryEnabled","hasTermbaseService"]),n=e.payload.texts,r=e.payload.mode?e.payload.mode:qv.TRANSLATE,o=e.payload.targetLang,s=e.payload.writeLang,a=Eg(o,t.regionalVariant);let i;const c=[],u=[];let d,p,h=!1,f=!1,g=!1;try{const l=await Hv({texts:n,mode:r,advancedMode:!!e.payload.style});if(i=l.result.lang.detected,Ug({isLoggedIn:t.isLoggedIn,hasTermbaseService:t.hasTermbaseService})&&t.activeTermbaseId&&r!==qv.WRITE&&t.isGlossaryEnabled)try{const[e]=await kT(),n=Qv(t.activeTermbaseId,e);if(n)for(let e of n.termDictionaries)if(e.languagePair===`${i.substring(0,2)}>${a.langCode.substring(0,2)}`.toLowerCase()){p={id:n.id,dictionaryId:e.id},h=!0,f=n.shared;break}}catch(e){console.log({e:e,message:"fetching glossaries failed"})}for(const e of l.result.texts){const t=[];for(const n of e.chunks)for(const e of n.sentences)u.push(e),t.push(u.length-1);c.push(t)}const g=u.map(((t,n)=>({kind:"default",preferred_num_beams:6,raw_en_context_after:n<u.length-1?[u[n+1].text]:[],raw_en_context_before:n>0?[u[n-1].text]:[],sentences:[{...t,id:n+1}],...e.payload.style&&{style_variant:e.payload.style,write_variant_requests:["main","variants"]},...e.payload.formality&&{formality:e.payload.formality}}))),m=a.regionalVariant&&!s;d=await Jv({mode:r,jobs:g,sourceLang:s&&r===qv.WRITE?s.substr(0,2):i,targetLang:s&&r===qv.WRITE?s.substr(0,2):o.substr(0,2),textType:"plaintext",styleVariant:e.payload.style,...p&&{termbase:p},...m&&{regionalVariant:a.regionalVariant}})}catch(t){throw r===qv.WRITE?q_(U.ERROR,{lang:i,sourceLength:n.reduce(((e,t)=>e+t.length),0),targetLength:0,nicheIntegration:k.default,error:t.name,style:e.payload.style}):zm({errorCode:t.name,errorMessage:t.message,domainName:e.payload.domainName,targetLang:o,websiteLanguage:i,trigger:l.input_alternatives,characterCount:n.reduce(((e,t)=>e+t.length),0)}),t}h&&(g=Zv(d.result)),aS(i,o);const m=d.result.translations,_=d.result.translations.map(((e,t)=>`${u[t].prefix}${e.beams[0].sentences[0].text}`)),y=function(e,t){let n=e[0].beams.length;e.forEach((e=>{e.beams.length<n&&(n=e.beams.length)}));const r=[];for(let o=0;o<n;o++){let n=[];for(let r=0;r<e.length;r++){const s=`${t[r].prefix}`;n.push(`${s}${e[r].beams[o].sentences[0].text}`)}r.push(n)}return r}(m,u),v=c.map((e=>e.map((e=>_[e])))),T=y.map((e=>c.map((t=>t.map((t=>e[t])))))),S=function(e,t){let n=e[0].beams.length;e.forEach((e=>{e.beams.length<n&&(n=e.beams.length)}));const r=[];for(let o=0;o<n;o++){let n="";for(let r=0;r<e.length;r++){n=`${n}${`${t[r].prefix}`}${e[r].beams[o].sentences[0].text}`}r.push(n)}return r}(m,u),b=T.map((e=>e.map((e=>e.join("")))));try{r===qv.WRITE?(q_(U.TEXT_REFINEMENT_REQUEST,{lang:i,sourceLength:n.reduce(((e,t)=>e+t.length),0),targetLength:v.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:k.default,style:e.payload.style}),q_(U.GET_ALTERNATIVES_FOR_INPUT,{lang:i,sourceLength:n.reduce(((e,t)=>e+t.length),0),targetLength:v.flat().reduce(((e,t)=>e+t.length),0),nicheIntegration:k.default,style:e.payload.style})):Hm({installationId:t.installationId,trigger:l.input_alternatives,websiteLanguage:i,targetLanguage:o,characterCount:n.reduce(((e,t)=>e+t.length),0),domainName:e.payload.domainName,nicheIntegration:k.default,...h&&{glossaryTrackingInfo:{isGlossaryEnabled:!!p,isGlossaryShared:f,didGlossaryChangeTranslation:g}}})}catch(e){console.error(e)}return{detected_source_language:i,processedText:v[0].join(""),textLinesComponents:c,alternatives:S,alternativeComponents:b}}const JS=async e=>{if(Ug(e)&&e.activeTermbaseId&&e.isGlossaryEnabled&&e.mode!==qv.WRITE){const[t]=await kT(),n=Qv(e.activeTermbaseId,t);if(n)for(let t of n.termDictionaries)if(t.languagePair===`${e.sourceLang.substr(0,2)}>${e.targetLang.substr(0,2)}`.toLowerCase())return{id:n.id,dictionaryId:t.id}}};function zS(){sy()}function YS(e){ay(e)}function XS(){iy()}function KS(e){cy(e)}function QS(e){ly(e)}function ZS(e){uy(e)}function eb(e){dy(e)}const tb=async e=>{try{await e()}catch(e){kg()&&console.log(e)}};class nb extends Error{constructor(e,t){const n=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=n}}class rb extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class ob extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class sb extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=n}}class ab extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=n}}class ib extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=n}}class cb extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class lb extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=n}}class ub{constructor(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}class db{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}var pb;!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(pb||(pb={}));class hb{constructor(){}log(e,t){}}hb.instance=new hb;const fb="8.0.7";class gb{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,n){if(!(e in t))throw new Error(`Unknown ${n} value: ${e}.`)}}class mb{static get isBrowser(){return!mb.isNode&&"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return!mb.isNode&&"object"==typeof self&&"importScripts"in self}static get isReactNative(){return!mb.isNode&&"object"==typeof window&&void 0===window.document}static get isNode(){return"undefined"!=typeof process&&process.release&&"node"===process.release.name}}function _b(e,t){let n="";return yb(e)?(n=`Binary data of length ${e.byteLength}`,t&&(n+=`. Content: '${function(e){const t=new Uint8Array(e);let n="";return t.forEach((e=>{n+=`0x${e<16?"0":""}${e.toString(16)} `})),n.substr(0,n.length-1)}(e)}'`)):"string"==typeof e&&(n=`String data of length ${e.length}`,t&&(n+=`. Content: '${e}'`)),n}function yb(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}async function vb(e,t,n,r,o,s){const a={},[i,c]=bb();a[i]=c,e.log(pb.Trace,`(${t} transport) sending data. ${_b(o,s.logMessageContent)}.`);const l=yb(o)?"arraybuffer":"text",u=await n.post(r,{content:o,headers:{...a,...s.headers},responseType:l,timeout:s.timeout,withCredentials:s.withCredentials});e.log(pb.Trace,`(${t} transport) request complete. Response status: ${u.statusCode}.`)}class Tb{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch((e=>{}))}}class Sb{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const n=`[${(new Date).toISOString()}] ${pb[e]}: ${t}`;switch(e){case pb.Critical:case pb.Error:this.out.error(n);break;case pb.Warning:this.out.warn(n);break;case pb.Information:this.out.info(n);break;default:this.out.log(n)}}}}function bb(){let e="X-SignalR-User-Agent";return mb.isNode&&(e="User-Agent"),[e,Eb(fb,wb(),Ib(),Ab())]}function Eb(e,t,n,r){let o="Microsoft SignalR/";const s=e.split(".");return o+=`${s[0]}.${s[1]}`,o+=` (${e}; `,o+=t&&""!==t?`${t}; `:"Unknown OS; ",o+=`${n}`,o+=r?`; ${r}`:"; Unknown Runtime Version",o+=")",o}function wb(){if(!mb.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function Ab(){if(mb.isNode)return process.versions.node}function Ib(){return mb.isNode?"NodeJS":"Browser"}function Rb(e){return e.stack?e.stack:e.message?e.message:`${e}`}class kb extends db{constructor(e){if(super(),this._logger=e,"undefined"==typeof fetch||mb.isNode){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;this._jar=new(e("tough-cookie").CookieJar),"undefined"==typeof fetch?this._fetchType=e("node-fetch"):this._fetchType=fetch,this._fetchType=e("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;this._abortControllerType=e("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new ob;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let n;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),n=new ob});let r,o=null;if(e.timeout){const r=e.timeout;o=setTimeout((()=>{t.abort(),this._logger.log(pb.Warning,"Timeout from HTTP request."),n=new rb}),r)}""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},yb(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");try{r=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(e){if(n)throw n;throw this._logger.log(pb.Warning,`Error from HTTP request. ${e}.`),e}finally{o&&clearTimeout(o),e.abortSignal&&(e.abortSignal.onabort=null)}if(!r.ok){const e=await Cb(r,"text");throw new nb(e||r.statusText,r.status)}const s=Cb(r,e.responseType),a=await s;return new ub(r.status,r.statusText,a)}getCookieString(e){let t="";return mb.isNode&&this._jar&&this._jar.getCookies(e,((e,n)=>t=n.join("; "))),t}}function Cb(e,t){let n;switch(t){case"arraybuffer":n=e.arrayBuffer();break;case"text":default:n=e.text();break;case"blob":case"document":case"json":throw new Error(`${t} is not supported.`)}return n}class Ob extends db{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ob):e.method?e.url?new Promise(((t,n)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=void 0===e.withCredentials||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(yb(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const o=e.headers;o&&Object.keys(o).forEach((e=>{r.setRequestHeader(e,o[e])})),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),n(new ob)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new ub(r.status,r.statusText,r.response||r.responseText)):n(new nb(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(pb.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),n(new nb(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(pb.Warning,"Timeout from HTTP request."),n(new rb)},r.send(e.content)})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class xb extends db{constructor(e){if(super(),"undefined"!=typeof fetch||mb.isNode)this._httpClient=new kb(e);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new Ob(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ob):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class Lb{static write(e){return`${e}${Lb.RecordSeparator}`}static parse(e){if(e[e.length-1]!==Lb.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(Lb.RecordSeparator);return t.pop(),t}}Lb.RecordSeparatorCode=30,Lb.RecordSeparator=String.fromCharCode(Lb.RecordSeparatorCode);class Nb{writeHandshakeRequest(e){return Lb.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,n;if(yb(e)){const r=new Uint8Array(e),o=r.indexOf(Lb.RecordSeparatorCode);if(-1===o)throw new Error("Message is incomplete.");const s=o+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(r.slice(0,s))),n=r.byteLength>s?r.slice(s).buffer:null}else{const r=e,o=r.indexOf(Lb.RecordSeparator);if(-1===o)throw new Error("Message is incomplete.");const s=o+1;t=r.substring(0,s),n=r.length>s?r.substring(s):null}const r=Lb.parse(t),o=JSON.parse(r[0]);if(o.type)throw new Error("Expected a handshake response from the server.");return[n,o]}}var Pb;!function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close",e[e.Ack=8]="Ack",e[e.Sequence=9]="Sequence"}(Pb||(Pb={}));class Db{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new Tb(this,e)}}class Mb{constructor(e,t,n){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=n}async _send(e){const t=this._protocol.writeMessage(e);let n=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let e=()=>{},r=()=>{};yb(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(n=new Promise(((t,n)=>{e=t,r=n}))),this._messages.push(new Ub(t,this._totalMessageCount,e,r))}try{this._reconnectInProgress||await this._connection.send(t)}catch{this._disconnected()}await n}_ack(e){let t=-1;for(let n=0;n<this._messages.length;n++){const r=this._messages[n];if(r._id<=e.sequenceId)t=n,yb(r._message)?this._bufferedByteCount-=r._message.byteLength:this._bufferedByteCount-=r._message.length,r._resolver();else{if(!(this._bufferedByteCount<this._bufferSize))break;r._resolver()}}-1!==t&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type===Pb.Sequence&&(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){e.sequenceId>this._nextReceivingSequenceId?this._connection.stop(new Error("Sequence ID greater than amount of messages we've received.")):this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=0!==this._messages.length?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:Pb.Sequence,sequenceId:e}));const t=this._messages;for(const e of t)await this._connection.send(e._message);this._reconnectInProgress=!1}_dispose(e){null!=e||(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case Pb.Invocation:case Pb.StreamItem:case Pb.Completion:case Pb.StreamInvocation:case Pb.CancelInvocation:return!0;case Pb.Close:case Pb.Sequence:case Pb.Ping:case Pb.Ack:return!1}}_ackTimer(){void 0===this._ackTimerHandle&&(this._ackTimerHandle=setTimeout((async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:Pb.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0}),1e3))}}class Ub{constructor(e,t,n,r){this._message=e,this._id=t,this._resolver=n,this._rejector=r}}var $b;!function(e){e.Disconnected="Disconnected",e.Connecting="Connecting",e.Connected="Connected",e.Disconnecting="Disconnecting",e.Reconnecting="Reconnecting"}($b||($b={}));class Fb{static create(e,t,n,r,o,s,a){return new Fb(e,t,n,r,o,s,a)}constructor(e,t,n,r,o,s,a){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(pb.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},gb.isRequired(e,"connection"),gb.isRequired(t,"logger"),gb.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=null!=o?o:3e4,this.keepAliveIntervalInMilliseconds=null!=s?s:15e3,this._statefulReconnectBufferSize=null!=a?a:1e5,this._logger=t,this._protocol=n,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new Nb,this.connection.onreceive=e=>this._processIncomingData(e),this.connection.onclose=e=>this._connectionClosed(e),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=$b.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:Pb.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==$b.Disconnected&&this._connectionState!==$b.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==$b.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=$b.Connecting,this._logger.log(pb.Debug,"Starting HubConnection.");try{await this._startInternal(),mb.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=$b.Connected,this._connectionStarted=!0,this._logger.log(pb.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=$b.Disconnected,this._logger.log(pb.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise(((e,t)=>{this._handshakeResolver=e,this._handshakeRejecter=t}));await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const n={protocol:this._protocol.name,version:t};if(this._logger.log(pb.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(n)),this._logger.log(pb.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new Mb(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(e){throw this._logger.log(pb.Debug,`Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(e),e}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch(e){}}_stopInternal(e){if(this._connectionState===$b.Disconnected)return this._logger.log(pb.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===$b.Disconnecting)return this._logger.log(pb.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=$b.Disconnecting,this._logger.log(pb.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(pb.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===$b.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new ob("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...t){const[n,r]=this._replaceStreamingParams(t),o=this._createStreamInvocation(e,t,r);let s;const a=new Db;return a.cancelCallback=()=>{const e=this._createCancelInvocation(o.invocationId);return delete this._callbacks[o.invocationId],s.then((()=>this._sendWithProtocol(e)))},this._callbacks[o.invocationId]=(e,t)=>{t?a.error(t):e&&(e.type===Pb.Completion?e.error?a.error(new Error(e.error)):a.complete():a.next(e.item))},s=this._sendWithProtocol(o).catch((e=>{a.error(e),delete this._callbacks[o.invocationId]})),this._launchStreams(n,s),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[n,r]=this._replaceStreamingParams(t),o=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(n,o),o}invoke(e,...t){const[n,r]=this._replaceStreamingParams(t),o=this._createInvocation(e,t,!1,r),s=new Promise(((e,t)=>{this._callbacks[o.invocationId]=(n,r)=>{r?t(r):n&&(n.type===Pb.Completion?n.error?t(new Error(n.error)):e(n.result):t(new Error(`Unexpected message type: ${n.type}`)))};const r=this._sendWithProtocol(o).catch((e=>{t(e),delete this._callbacks[o.invocationId]}));this._launchStreams(n,r)}));return s}on(e,t){e&&t&&(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const n=this._methods[e];if(n)if(t){const r=n.indexOf(t);-1!==r&&(n.splice(r,1),0===n.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const e of t)if(!this._messageBuffer||this._messageBuffer._shouldProcessMessage(e))switch(e.type){case Pb.Invocation:this._invokeClientMethod(e).catch((e=>{this._logger.log(pb.Error,`Invoke client method threw error: ${Rb(e)}`)}));break;case Pb.StreamItem:case Pb.Completion:{const t=this._callbacks[e.invocationId];if(t){e.type===Pb.Completion&&delete this._callbacks[e.invocationId];try{t(e)}catch(e){this._logger.log(pb.Error,`Stream callback threw error: ${Rb(e)}`)}}break}case Pb.Ping:break;case Pb.Close:{this._logger.log(pb.Information,"Close message received from server.");const t=e.error?new Error("Server returned an error on close: "+e.error):void 0;!0===e.allowReconnect?this.connection.stop(t):this._stopPromise=this._stopInternal(t);break}case Pb.Ack:this._messageBuffer&&this._messageBuffer._ack(e);break;case Pb.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(e);break;default:this._logger.log(pb.Warning,`Invalid message type: ${e.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,n;try{[n,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(e){const t="Error parsing handshake response: "+e;this._logger.log(pb.Error,t);const n=new Error(t);throw this._handshakeRejecter(n),n}if(t.error){const e="Server returned handshake error: "+t.error;this._logger.log(pb.Error,e);const n=new Error(e);throw this._handshakeRejecter(n),n}return this._logger.log(pb.Debug,"Server handshake complete."),this._handshakeResolver(),n}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let e=this._nextKeepAlive-(new Date).getTime();e<0&&(e=0),this._pingServerHandle=setTimeout((async()=>{if(this._connectionState===$b.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}),e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),n=this._methods[t];if(!n)return this._logger.log(pb.Warning,`No client method with the name '${t}' found.`),void(e.invocationId&&(this._logger.log(pb.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const r=n.slice(),o=!!e.invocationId;let s,a,i;for(const n of r)try{const r=s;s=await n.apply(this,e.arguments),o&&s&&r&&(this._logger.log(pb.Error,`Multiple results provided for '${t}'. Sending error to server.`),i=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),a=void 0}catch(e){a=e,this._logger.log(pb.Error,`A callback for the method '${t}' threw error '${e}'.`)}i?await this._sendWithProtocol(i):o?(a?i=this._createCompletionMessage(e.invocationId,`${a}`,null):void 0!==s?i=this._createCompletionMessage(e.invocationId,null,s):(this._logger.log(pb.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),i=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(i)):s&&this._logger.log(pb.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(pb.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new ob("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===$b.Disconnecting?this._completeClose(e):this._connectionState===$b.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===$b.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=$b.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(null!=e?e:new Error("Connection closed.")),this._messageBuffer=void 0),mb.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(pb.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let n=0,r=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),o=this._getNextRetryDelay(n++,0,r);if(null===o)return this._logger.log(pb.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(e);if(this._connectionState=$b.Reconnecting,e?this._logger.log(pb.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(pb.Information,"Connection reconnecting."),0!==this._reconnectingCallbacks.length){try{this._reconnectingCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(pb.Error,`An onreconnecting callback called with error '${e}' threw error '${t}'.`)}if(this._connectionState!==$b.Reconnecting)return void this._logger.log(pb.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(this._logger.log(pb.Information,`Reconnect attempt number ${n} will start in ${o} ms.`),await new Promise((e=>{this._reconnectDelayHandle=setTimeout(e,o)})),this._reconnectDelayHandle=void 0,this._connectionState!==$b.Reconnecting)return void this._logger.log(pb.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=$b.Connected,this._logger.log(pb.Information,"HubConnection reconnected successfully."),0!==this._reconnectedCallbacks.length)try{this._reconnectedCallbacks.forEach((e=>e.apply(this,[this.connection.connectionId])))}catch(e){this._logger.log(pb.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`)}return}catch(e){if(this._logger.log(pb.Information,`Reconnect attempt failed because of error '${e}'.`),this._connectionState!==$b.Reconnecting)return this._logger.log(pb.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===$b.Disconnecting&&this._completeClose());r=e instanceof Error?e:new Error(e.toString()),o=this._getNextRetryDelay(n++,Date.now()-t,r)}}this._logger.log(pb.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${n} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:n})}catch(n){return this._logger.log(pb.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${n}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach((n=>{const r=t[n];try{r(null,e)}catch(t){this._logger.log(pb.Error,`Stream 'error' callback called with '${e}' threw error: ${Rb(t)}`)}}))}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,n,r){if(n)return 0!==r.length?{arguments:t,streamIds:r,target:e,type:Pb.Invocation}:{arguments:t,target:e,type:Pb.Invocation};{const n=this._invocationId;return this._invocationId++,0!==r.length?{arguments:t,invocationId:n.toString(),streamIds:r,target:e,type:Pb.Invocation}:{arguments:t,invocationId:n.toString(),target:e,type:Pb.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const n in e)e[n].subscribe({complete:()=>{t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n))))},error:e=>{let r;r=e instanceof Error?e.message:e&&e.toString?e.toString():"Unknown error",t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n,r))))},next:e=>{t=t.then((()=>this._sendWithProtocol(this._createStreamItemMessage(n,e))))}})}}_replaceStreamingParams(e){const t=[],n=[];for(let r=0;r<e.length;r++){const o=e[r];if(this._isObservable(o)){const s=this._invocationId;this._invocationId++,t[s]=o,n.push(s.toString()),e.splice(r,1)}}return[t,n]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,n){const r=this._invocationId;return this._invocationId++,0!==n.length?{arguments:t,invocationId:r.toString(),streamIds:n,target:e,type:Pb.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:Pb.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:Pb.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:Pb.StreamItem}}_createCompletionMessage(e,t,n){return t?{error:t,invocationId:e,type:Pb.Completion}:{invocationId:e,result:n,type:Pb.Completion}}_createCloseMessage(){return{type:Pb.Close}}}const Gb=[0,2e3,1e4,3e4,null];class jb{constructor(e){this._retryDelays=void 0!==e?[...e,null]:Gb}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class Vb{}Vb.Authorization="Authorization",Vb.Cookie="Cookie";class Wb extends db{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const n=await this._innerClient.send(e);return t&&401===n.statusCode&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):n}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[Vb.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[Vb.Authorization]&&delete e.headers[Vb.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var qb,Bb;!function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(qb||(qb={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(Bb||(Bb={}));class Hb{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class Jb{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,n){this._httpClient=e,this._logger=t,this._pollAbort=new Hb,this._options=n,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,t){if(gb.isRequired(e,"url"),gb.isRequired(t,"transferFormat"),gb.isIn(t,Bb,"transferFormat"),this._url=e,this._logger.log(pb.Trace,"(LongPolling transport) Connecting."),t===Bb.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[n,r]=bb(),o={[n]:r,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:o,timeout:1e5,withCredentials:this._options.withCredentials};t===Bb.Binary&&(s.responseType="arraybuffer");const a=`${e}&_=${Date.now()}`;this._logger.log(pb.Trace,`(LongPolling transport) polling: ${a}.`);const i=await this._httpClient.get(a,s);200!==i.statusCode?(this._logger.log(pb.Error,`(LongPolling transport) Unexpected response code: ${i.statusCode}.`),this._closeError=new nb(i.statusText||"",i.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _poll(e,t){try{for(;this._running;)try{const n=`${e}&_=${Date.now()}`;this._logger.log(pb.Trace,`(LongPolling transport) polling: ${n}.`);const r=await this._httpClient.get(n,t);204===r.statusCode?(this._logger.log(pb.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):200!==r.statusCode?(this._logger.log(pb.Error,`(LongPolling transport) Unexpected response code: ${r.statusCode}.`),this._closeError=new nb(r.statusText||"",r.statusCode),this._running=!1):r.content?(this._logger.log(pb.Trace,`(LongPolling transport) data received. ${_b(r.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(r.content)):this._logger.log(pb.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(e){this._running?e instanceof rb?this._logger.log(pb.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=e,this._running=!1):this._logger.log(pb.Trace,`(LongPolling transport) Poll errored after shutdown: ${e.message}`)}}finally{this._logger.log(pb.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?vb(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(pb.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(pb.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,n]=bb();e[t]=n;const r={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let o;try{await this._httpClient.delete(this._url,r)}catch(e){o=e}o?o instanceof nb&&(404===o.statusCode?this._logger.log(pb.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(pb.Trace,`(LongPolling transport) Error sending a DELETE request: ${o}`)):this._logger.log(pb.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(pb.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(pb.Trace,e),this.onclose(this._closeError)}}}class zb{constructor(e,t,n,r){this._httpClient=e,this._accessToken=t,this._logger=n,this._options=r,this.onreceive=null,this.onclose=null}async connect(e,t){return gb.isRequired(e,"url"),gb.isRequired(t,"transferFormat"),gb.isIn(t,Bb,"transferFormat"),this._logger.log(pb.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise(((n,r)=>{let o,s=!1;if(t===Bb.Text){if(mb.isBrowser||mb.isWebWorker)o=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const t=this._httpClient.getCookieString(e),n={};n.Cookie=t;const[r,s]=bb();n[r]=s,o=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...n,...this._options.headers}})}try{o.onmessage=e=>{if(this.onreceive)try{this._logger.log(pb.Trace,`(SSE transport) data received. ${_b(e.data,this._options.logMessageContent)}.`),this.onreceive(e.data)}catch(e){return void this._close(e)}},o.onerror=e=>{s?this._close():r(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},o.onopen=()=>{this._logger.log(pb.Information,`SSE connected to ${this._url}`),this._eventSource=o,s=!0,n()}}catch(e){return void r(e)}}else r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))}async send(e){return this._eventSource?vb(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Yb{constructor(e,t,n,r,o,s){this._logger=n,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=o,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}async connect(e,t){let n;return gb.isRequired(e,"url"),gb.isRequired(t,"transferFormat"),gb.isIn(t,Bb,"transferFormat"),this._logger.log(pb.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory&&(n=await this._accessTokenFactory()),new Promise(((r,o)=>{let s;e=e.replace(/^http/,"ws");const a=this._httpClient.getCookieString(e);let i=!1;if(mb.isNode||mb.isReactNative){const t={},[r,o]=bb();t[r]=o,n&&(t[Vb.Authorization]=`Bearer ${n}`),a&&(t[Vb.Cookie]=a),s=new this._webSocketConstructor(e,void 0,{headers:{...t,...this._headers}})}else n&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(n)}`);s||(s=new this._webSocketConstructor(e)),t===Bb.Binary&&(s.binaryType="arraybuffer"),s.onopen=t=>{this._logger.log(pb.Information,`WebSocket connected to ${e}.`),this._webSocket=s,i=!0,r()},s.onerror=e=>{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"There was an error with the transport",this._logger.log(pb.Information,`(WebSockets transport) ${t}.`)},s.onmessage=e=>{if(this._logger.log(pb.Trace,`(WebSockets transport) data received. ${_b(e.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(e.data)}catch(e){return void this._close(e)}},s.onclose=e=>{if(i)this._close(e);else{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(t))}}}))}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(pb.Trace,`(WebSockets transport) sending data. ${_b(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(pb.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}class Xb{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,gb.isRequired(e,"url"),this._logger=function(e){return void 0===e?new Sb(pb.Information):null===e?hb.instance:void 0!==e.log?e:new Sb(e)}(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let n=null,r=null;if(mb.isNode&&"undefined"!=typeof require){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;n=e("ws"),r=e("eventsource")}mb.isNode||"undefined"==typeof WebSocket||t.WebSocket?mb.isNode&&!t.WebSocket&&n&&(t.WebSocket=n):t.WebSocket=WebSocket,mb.isNode||"undefined"==typeof EventSource||t.EventSource?mb.isNode&&!t.EventSource&&void 0!==r&&(t.EventSource=r):t.EventSource=EventSource,this._httpClient=new Wb(t.httpClient||new xb(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||Bb.Binary,gb.isIn(e,Bb,"transferFormat"),this._logger.log(pb.Debug,`Starting connection with transfer format '${Bb[e]}'.`),"Disconnected"!==this._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,"Disconnecting"===this._connectionState){const e="Failed to start the HttpConnection before stop() was called.";return this._logger.log(pb.Error,e),await this._stopPromise,Promise.reject(new ob(e))}if("Connected"!==this._connectionState){const e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(pb.Error,e),Promise.reject(new ob(e))}this._connectionStarted=!0}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Kb(this.transport)),this._sendQueue.send(e))}async stop(e){return"Disconnected"===this._connectionState?(this._logger.log(pb.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===this._connectionState?(this._logger.log(pb.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise((e=>{this._stopPromiseResolver=e})),await this._stopInternal(e),void await this._stopPromise)}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch(e){}if(this.transport){try{await this.transport.stop()}catch(e){this._logger.log(pb.Error,`HttpConnection.transport.stop() threw error '${e}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(pb.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==qb.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(qb.WebSockets),await this._startTransport(t,e)}else{let n=null,r=0;do{if(n=await this._getNegotiationResponse(t),"Disconnecting"===this._connectionState||"Disconnected"===this._connectionState)throw new ob("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(n.url&&(t=n.url),n.accessToken){const e=n.accessToken;this._accessTokenFactory=()=>e,this._httpClient._accessToken=e,this._httpClient._accessTokenFactory=void 0}r++}while(n.url&&r<100);if(100===r&&n.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,n,e)}this.transport instanceof Jb&&(this.features.inherentKeepAlive=!0),"Connecting"===this._connectionState&&(this._logger.log(pb.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(e){return this._logger.log(pb.Error,"Failed to start the connection: "+e),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(e)}}async _getNegotiationResponse(e){const t={},[n,r]=bb();t[n]=r;const o=this._resolveNegotiateUrl(e);this._logger.log(pb.Debug,`Sending negotiation request: ${o}.`);try{const e=await this._httpClient.post(o,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(200!==e.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${e.statusCode}'`));const n=JSON.parse(e.content);return(!n.negotiateVersion||n.negotiateVersion<1)&&(n.connectionToken=n.connectionId),n.useStatefulReconnect&&!0!==this._options._useStatefulReconnect?Promise.reject(new cb("Client didn't negotiate Stateful Reconnect but the server did.")):n}catch(e){let t="Failed to complete negotiation with the server: "+e;return e instanceof nb&&404===e.statusCode&&(t+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(pb.Error,t),Promise.reject(new cb(t))}}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}async _createTransport(e,t,n,r){let o=this._createConnectUrl(e,n.connectionToken);if(this._isITransport(t))return this._logger.log(pb.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(o,r),void(this.connectionId=n.connectionId);const s=[],a=n.availableTransports||[];let i=n;for(const n of a){const a=this._resolveTransportOrError(n,t,r,!0===(null==i?void 0:i.useStatefulReconnect));if(a instanceof Error)s.push(`${n.transport} failed:`),s.push(a);else if(this._isITransport(a)){if(this.transport=a,!i){try{i=await this._getNegotiationResponse(e)}catch(e){return Promise.reject(e)}o=this._createConnectUrl(e,i.connectionToken)}try{return await this._startTransport(o,r),void(this.connectionId=i.connectionId)}catch(e){if(this._logger.log(pb.Error,`Failed to start the transport '${n.transport}': ${e}`),i=void 0,s.push(new ib(`${n.transport} failed: ${e}`,qb[n.transport])),"Connecting"!==this._connectionState){const e="Failed to select transport before stop() was called.";return this._logger.log(pb.Debug,e),Promise.reject(new ob(e))}}}}return s.length>0?Promise.reject(new lb(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case qb.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Yb(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case qb.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new zb(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case qb.LongPolling:return new Jb(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async n=>{let r=!1;if(this.features.reconnect){try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend()}catch{r=!0}r&&this._stopConnection(n)}else this._stopConnection(n)}:this.transport.onclose=e=>this._stopConnection(e),this.transport.connect(e,t)}_resolveTransportOrError(e,t,n,r){const o=qb[e.transport];if(null==o)return this._logger.log(pb.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function(e,t){return!e||!!(t&e)}(t,o))return this._logger.log(pb.Debug,`Skipping transport '${qb[o]}' because it was disabled by the client.`),new ab(`'${qb[o]}' is disabled by the client.`,o);if(!(e.transferFormats.map((e=>Bb[e])).indexOf(n)>=0))return this._logger.log(pb.Debug,`Skipping transport '${qb[o]}' because it does not support the requested transfer format '${Bb[n]}'.`),new Error(`'${qb[o]}' does not support ${Bb[n]}.`);if(o===qb.WebSockets&&!this._options.WebSocket||o===qb.ServerSentEvents&&!this._options.EventSource)return this._logger.log(pb.Debug,`Skipping transport '${qb[o]}' because it is not supported in your environment.'`),new sb(`'${qb[o]}' is not supported in your environment.`,o);this._logger.log(pb.Debug,`Selecting transport '${qb[o]}'.`);try{return this.features.reconnect=o===qb.WebSockets?r:void 0,this._constructTransport(o)}catch(e){return e}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(pb.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(pb.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(pb.Error,`Connection disconnected with error '${e}'.`):this._logger.log(pb.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch((e=>{this._logger.log(pb.Error,`TransportSendQueue.stop() threw error '${e}'.`)})),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(pb.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(pb.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!mb.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(pb.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const n=new URLSearchParams(t.searchParams);return n.has("negotiateVersion")||n.append("negotiateVersion",this._negotiateVersion.toString()),n.has("useStatefulReconnect")?"true"===n.get("useStatefulReconnect")&&(this._options._useStatefulReconnect=!0):!0===this._options._useStatefulReconnect&&n.append("useStatefulReconnect","true"),t.search=n.toString(),t.toString()}}class Kb{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new Qb,this._transportResult=new Qb,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new Qb),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new Qb;const e=this._transportResult;this._transportResult=void 0;const t="string"==typeof this._buffer[0]?this._buffer.join(""):Kb._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(t){e.reject(t)}}}static _concatBuffers(e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),n=new Uint8Array(t);let r=0;for(const t of e)n.set(new Uint8Array(t),r),r+=t.byteLength;return n.buffer}}class Qb{constructor(){this.promise=new Promise(((e,t)=>[this._resolver,this._rejecter]=[e,t]))}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class Zb{constructor(){this.name="json",this.version=2,this.transferFormat=Bb.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=hb.instance);const n=Lb.parse(e),r=[];for(const e of n){const n=JSON.parse(e);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case Pb.Invocation:this._isInvocationMessage(n);break;case Pb.StreamItem:this._isStreamItemMessage(n);break;case Pb.Completion:this._isCompletionMessage(n);break;case Pb.Ping:case Pb.Close:break;case Pb.Ack:this._isAckMessage(n);break;case Pb.Sequence:this._isSequenceMessage(n);break;default:t.log(pb.Information,"Unknown message type '"+n.type+"' ignored.");continue}r.push(n)}return r}writeMessage(e){return Lb.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const eE={trace:pb.Trace,debug:pb.Debug,info:pb.Information,information:pb.Information,warn:pb.Warning,warning:pb.Warning,error:pb.Error,critical:pb.Critical,none:pb.None};class tE{configureLogging(e){if(gb.isRequired(e,"logging"),function(e){return void 0!==e.log}(e))this.logger=e;else if("string"==typeof e){const t=function(e){const t=eE[e.toLowerCase()];if(void 0!==t)return t;throw new Error(`Unknown log level: ${e}`)}(e);this.logger=new Sb(t)}else this.logger=new Sb(e);return this}withUrl(e,t){return gb.isRequired(e,"url"),gb.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return gb.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new jb(e):this.reconnectPolicy=e:this.reconnectPolicy=new jb,this}withServerTimeout(e){return gb.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return gb.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return void 0===this.httpConnectionOptions&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=null==e?void 0:e.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new Xb(this.url,e);return Fb.create(t,this.logger||hb.instance,this.protocol||new Zb,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}var nE,rE,oE,sE=4294967295;function aE(e,t,n){var r=Math.floor(n/4294967296),o=n;e.setUint32(t,r),e.setUint32(t+4,o)}function iE(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var cE=("undefined"==typeof process||"never"!==(null===(nE=null===process||void 0===process?void 0:process.env)||void 0===nE?void 0:nE.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function lE(e){for(var t=e.length,n=0,r=0;r<t;){var o=e.charCodeAt(r++);if(4294967168&o)if(4294965248&o){if(o>=55296&&o<=56319&&r<t){var s=e.charCodeAt(r);56320==(64512&s)&&(++r,o=((1023&o)<<10)+(1023&s)+65536)}n+=4294901760&o?4:3}else n+=2;else n++}return n}var uE=cE?new TextEncoder:void 0,dE=cE?"undefined"!=typeof process&&"force"!==(null===(rE=null===process||void 0===process?void 0:process.env)||void 0===rE?void 0:rE.TEXT_ENCODING)?200:0:sE;var pE=(null==uE?void 0:uE.encodeInto)?function(e,t,n){uE.encodeInto(e,t.subarray(n))}:function(e,t,n){t.set(uE.encode(e),n)};function hE(e,t,n){for(var r=t,o=r+n,s=[],a="";r<o;){var i=e[r++];if(128&i)if(192==(224&i)){var c=63&e[r++];s.push((31&i)<<6|c)}else if(224==(240&i)){c=63&e[r++];var l=63&e[r++];s.push((31&i)<<12|c<<6|l)}else if(240==(248&i)){var u=(7&i)<<18|(c=63&e[r++])<<12|(l=63&e[r++])<<6|63&e[r++];u>65535&&(u-=65536,s.push(u>>>10&1023|55296),u=56320|1023&u),s.push(u)}else s.push(i);else s.push(i);s.length>=4096&&(a+=String.fromCharCode.apply(String,s),s.length=0)}return s.length>0&&(a+=String.fromCharCode.apply(String,s)),a}var fE=cE?new TextDecoder:null,gE=cE?"undefined"!=typeof process&&"force"!==(null===(oE=null===process||void 0===process?void 0:process.env)||void 0===oE?void 0:oE.TEXT_DECODER)?200:0:sE;var mE=function(e,t){this.type=e,this.data=t},_E=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yE=function(e){function t(n){var r=e.call(this,n)||this,o=Object.create(t.prototype);return Object.setPrototypeOf(r,o),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return _E(t,e),t}(Error),vE=4294967295,TE=17179869183;var SE={type:-1,encode:function(e){var t,n,r,o;return e instanceof Date?function(e){var t,n=e.sec,r=e.nsec;if(n>=0&&r>=0&&n<=TE){if(0===r&&n<=vE){var o=new Uint8Array(4);return(t=new DataView(o.buffer)).setUint32(0,n),o}var s=n/4294967296,a=4294967295&n;return o=new Uint8Array(8),(t=new DataView(o.buffer)).setUint32(0,r<<2|3&s),t.setUint32(4,a),o}return o=new Uint8Array(12),(t=new DataView(o.buffer)).setUint32(0,r),aE(t,4,n),o}((t=e.getTime(),n=Math.floor(t/1e3),r=1e6*(t-1e3*n),o=Math.floor(r/1e9),{sec:n+o,nsec:r-1e9*o})):null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:iE(t,4),nsec:t.getUint32(0)};default:throw new yE("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},bE=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(SE)}return e.prototype.register=function(e){var t=e.type,n=e.encode,r=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{var o=1+t;this.builtInEncoders[o]=n,this.builtInDecoders[o]=r}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++){if(null!=(r=this.builtInEncoders[n]))if(null!=(o=r(e,t)))return new mE(-1-n,o)}for(n=0;n<this.encoders.length;n++){var r,o;if(null!=(r=this.encoders[n]))if(null!=(o=r(e,t)))return new mE(n,o)}return e instanceof mE?e:null},e.prototype.decode=function(e,t,n){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,n):new mE(t,e)},e.defaultCodec=new e,e}();function EE(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var wE=function(){function e(e,t,n,r,o,s,a,i){void 0===e&&(e=bE.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=100),void 0===r&&(r=2048),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===i&&(i=!1),this.extensionCodec=e,this.context=t,this.maxDepth=n,this.initialBufferSize=r,this.sortKeys=o,this.forceFloat32=s,this.ignoreUndefined=a,this.forceIntegerToFloat=i,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),r=new DataView(t);n.set(this.bytes),this.view=r,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>dE){var t=lE(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),pE(e,this.bytes,this.pos),this.pos+=t}else{t=lE(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,n){for(var r=e.length,o=n,s=0;s<r;){var a=e.charCodeAt(s++);if(4294967168&a){if(4294965248&a){if(a>=55296&&a<=56319&&s<r){var i=e.charCodeAt(s);56320==(64512&i)&&(++s,a=((1023&a)<<10)+(1023&i)+65536)}4294901760&a?(t[o++]=a>>18&7|240,t[o++]=a>>12&63|128,t[o++]=a>>6&63|128):(t[o++]=a>>12&15|224,t[o++]=a>>6&63|128)}else t[o++]=a>>6&31|192;t[o++]=63&a|128}else t[o++]=a}}(e,this.bytes,this.pos),this.pos+=t}},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var n=EE(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var r=0,o=e;r<o.length;r++){var s=o[r];this.doEncode(s,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,r=0,o=t;r<o.length;r++){void 0!==e[o[r]]&&n++}return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large map object: ".concat(r));this.writeU8(223),this.writeU32(r)}for(var o=0,s=n;o<s.length;o++){var a=s[o],i=e[a];this.ignoreUndefined&&void 0===i||(this.encodeString(a),this.doEncode(i,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var r=n/4294967296,o=n;e.setUint32(t,r),e.setUint32(t+4,o)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),aE(this.view,this.pos,e),this.pos+=8},e}();function AE(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var IE=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){e:for(var r=0,o=this.caches[n-1];r<o.length;r++){for(var s=o[r],a=s.bytes,i=0;i<n;i++)if(a[i]!==e[t+i])continue e;return s.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],r={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},e.prototype.decode=function(e,t,n){var r=this.find(e,t,n);if(null!=r)return this.hit++,r;this.miss++;var o=hE(e,t,n),s=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(s,o),o},e}(),RE=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function i(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},kE=function(e,t){var n,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},CE=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}},OE=function(e){return this instanceof OE?(this.v=e,this):new OE(e)},xE=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||i(e,t)}))})}function i(e,t){try{!function(e){e.value instanceof OE?Promise.resolve(e.value.v).then(c,l):u(s[0][2],e)}(o[e](t))}catch(e){u(s[0][3],e)}}function c(e){i("next",e)}function l(e){i("throw",e)}function u(e,t){e(t),s.shift(),s.length&&i(s[0][0],s[0][1])}},LE=new DataView(new ArrayBuffer(0)),NE=new Uint8Array(LE.buffer),PE=function(){try{LE.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),DE=new PE("Insufficient data"),ME=new IE,UE=function(){function e(e,t,n,r,o,s,a,i){void 0===e&&(e=bE.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=sE),void 0===r&&(r=sE),void 0===o&&(o=sE),void 0===s&&(s=sE),void 0===a&&(a=sE),void 0===i&&(i=ME),this.extensionCodec=e,this.context=t,this.maxStrLength=n,this.maxBinLength=r,this.maxArrayLength=o,this.maxMapLength=s,this.maxExtLength=a,this.keyDecoder=i,this.totalPos=0,this.pos=0,this.view=LE,this.bytes=NE,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=EE(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=EE(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=EE(e),r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),this.setBuffer(r)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return kE(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,n,r,o;return RE(this,void 0,void 0,(function(){var s,a,i,c,l,u,d,p;return kE(this,(function(h){switch(h.label){case 0:s=!1,h.label=1;case 1:h.trys.push([1,6,7,12]),t=CE(e),h.label=2;case 2:return[4,t.next()];case 3:if((n=h.sent()).done)return[3,5];if(i=n.value,s)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i);try{a=this.doDecodeSync(),s=!0}catch(e){if(!(e instanceof PE))throw e}this.totalPos+=this.pos,h.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=h.sent(),r={error:c},[3,12];case 7:return h.trys.push([7,,10,11]),n&&!n.done&&(o=t.return)?[4,o.call(t)]:[3,9];case 8:h.sent(),h.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(s){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,a]}throw u=(l=this).headByte,d=l.pos,p=l.totalPos,new RangeError("Insufficient data in parsing ".concat(AE(u)," at ").concat(p," (").concat(d," in the current buffer)"))}}))}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return xE(this,arguments,(function(){var n,r,o,s,a,i,c,l,u;return kE(this,(function(d){switch(d.label){case 0:n=t,r=-1,d.label=1;case 1:d.trys.push([1,13,14,19]),o=CE(e),d.label=2;case 2:return[4,OE(o.next())];case 3:if((s=d.sent()).done)return[3,12];if(a=s.value,t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a),n&&(r=this.readArraySize(),n=!1,this.complete()),d.label=4;case 4:d.trys.push([4,9,,10]),d.label=5;case 5:return[4,OE(this.doDecodeSync())];case 6:return[4,d.sent()];case 7:return d.sent(),0==--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((i=d.sent())instanceof PE))throw i;return[3,10];case 10:this.totalPos+=this.pos,d.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=d.sent(),l={error:c},[3,19];case 14:return d.trys.push([14,,17,18]),s&&!s.done&&(u=o.return)?[4,OE(u.call(o))]:[3,16];case 15:d.sent(),d.label=16;case 16:return[3,18];case 17:if(l)throw l.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!==(r=e-128)){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){if(0!==(r=e-144)){this.pushArrayState(r),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e){n=this.lookU8();t=this.decodeUtf8String(n,1)}else if(218===e){n=this.lookU16();t=this.decodeUtf8String(n,2)}else if(219===e){n=this.lookU32();t=this.decodeUtf8String(n,4)}else if(220===e){if(0!==(r=this.readU16())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(221===e){if(0!==(r=this.readU32())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(222===e){if(0!==(r=this.readU16())){this.pushMapState(r),this.complete();continue e}t={}}else if(223===e){if(0!==(r=this.readU32())){this.pushMapState(r),this.complete();continue e}t={}}else if(196===e){var r=this.lookU8();t=this.decodeBinary(r,1)}else if(197===e){r=this.lookU16();t=this.decodeBinary(r,2)}else if(198===e){r=this.lookU32();t=this.decodeBinary(r,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){r=this.lookU8();t=this.decodeExtension(r,1)}else if(200===e){r=this.lookU16();t=this.decodeExtension(r,2)}else{if(201!==e)throw new yE("Unrecognized type byte: ".concat(AE(e)));r=this.lookU32();t=this.decodeExtension(r,4)}this.complete();for(var o=this.stack;o.length>0;){var s=o[o.length-1];if(0===s.type){if(s.array[s.position]=t,s.position++,s.position!==s.size)continue e;o.pop(),t=s.array}else{if(1===s.type){if(a=void 0,"string"!==(a=typeof t)&&"number"!==a)throw new yE("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new yE("The key __proto__ is not allowed");s.key=t,s.type=2;continue e}if(s.map[s.key]=t,s.readCount++,s.readCount!==s.size){s.key=null,s.type=1;continue e}o.pop(),t=s.map}}return t}var a},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new yE("Unrecognized array type byte: ".concat(AE(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new yE("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new yE("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new yE("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw DE;var r,o=this.pos+t;return r=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,o,e):e>gE?function(e,t,n){var r=e.subarray(t,t+n);return fE.decode(r)}(this.bytes,o,e):hE(this.bytes,o,e),this.pos+=t+e,r},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new yE("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw DE;var n=this.pos+t,r=this.bytes.subarray(n,n+e);return this.pos+=t+e,r},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new yE("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=iE(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}();class $E{static write(e){let t=e.byteLength||e.length;const n=[];do{let e=127&t;t>>=7,t>0&&(e|=128),n.push(e)}while(t>0);t=e.byteLength||e.length;const r=new Uint8Array(n.length+t);return r.set(n,0),r.set(e,n.length),r.buffer}static parse(e){const t=[],n=new Uint8Array(e),r=[0,7,14,21,28];for(let o=0;o<e.byteLength;){let s,a=0,i=0;do{s=n[o+a],i|=(127&s)<<r[a],a++}while(a<Math.min(5,e.byteLength-o)&&128&s);if(128&s&&a<5)throw new Error("Cannot read message size.");if(5===a&&s>7)throw new Error("Messages bigger than 2GB are not supported.");if(!(n.byteLength>=o+a+i))throw new Error("Incomplete message.");t.push(n.slice?n.slice(o+a,o+a+i):n.subarray(o+a,o+a+i)),o=o+a+i}return t}}const FE=new Uint8Array([145,Pb.Ping]);class GE{constructor(e){this.name="messagepack",this.version=2,this.transferFormat=Bb.Binary,this._errorResult=1,this._voidResult=2,this._nonVoidResult=3,e=e||{},this._encoder=new wE(e.extensionCodec,e.context,e.maxDepth,e.initialBufferSize,e.sortKeys,e.forceFloat32,e.ignoreUndefined,e.forceIntegerToFloat),this._decoder=new UE(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength)}parseMessages(e,t){if(!(n=e)||"undefined"==typeof ArrayBuffer||!(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name))throw new Error("Invalid input for MessagePack hub protocol. Expected an ArrayBuffer.");var n;null===t&&(t=hb.instance);const r=$E.parse(e),o=[];for(const e of r){const n=this._parseMessage(e,t);n&&o.push(n)}return o}writeMessage(e){switch(e.type){case Pb.Invocation:return this._writeInvocation(e);case Pb.StreamInvocation:return this._writeStreamInvocation(e);case Pb.StreamItem:return this._writeStreamItem(e);case Pb.Completion:return this._writeCompletion(e);case Pb.Ping:return $E.write(FE);case Pb.CancelInvocation:return this._writeCancelInvocation(e);case Pb.Close:return this._writeClose();case Pb.Ack:return this._writeAck(e);case Pb.Sequence:return this._writeSequence(e);default:throw new Error("Invalid message type.")}}_parseMessage(e,t){if(0===e.length)throw new Error("Invalid payload.");const n=this._decoder.decode(e);if(0===n.length||!(n instanceof Array))throw new Error("Invalid payload.");const r=n[0];switch(r){case Pb.Invocation:return this._createInvocationMessage(this._readHeaders(n),n);case Pb.StreamItem:return this._createStreamItemMessage(this._readHeaders(n),n);case Pb.Completion:return this._createCompletionMessage(this._readHeaders(n),n);case Pb.Ping:return this._createPingMessage(n);case Pb.Close:return this._createCloseMessage(n);case Pb.Ack:return this._createAckMessage(n);case Pb.Sequence:return this._createSequenceMessage(n);default:return t.log(pb.Information,"Unknown message type '"+r+"' ignored."),null}}_createCloseMessage(e){if(e.length<2)throw new Error("Invalid payload for Close message.");return{allowReconnect:e.length>=3?e[2]:void 0,error:e[1],type:Pb.Close}}_createPingMessage(e){if(e.length<1)throw new Error("Invalid payload for Ping message.");return{type:Pb.Ping}}_createInvocationMessage(e,t){if(t.length<5)throw new Error("Invalid payload for Invocation message.");const n=t[2];return n?{arguments:t[4],headers:e,invocationId:n,streamIds:[],target:t[3],type:Pb.Invocation}:{arguments:t[4],headers:e,streamIds:[],target:t[3],type:Pb.Invocation}}_createStreamItemMessage(e,t){if(t.length<4)throw new Error("Invalid payload for StreamItem message.");return{headers:e,invocationId:t[2],item:t[3],type:Pb.StreamItem}}_createCompletionMessage(e,t){if(t.length<4)throw new Error("Invalid payload for Completion message.");const n=t[3];if(n!==this._voidResult&&t.length<5)throw new Error("Invalid payload for Completion message.");let r,o;switch(n){case this._errorResult:r=t[4];break;case this._nonVoidResult:o=t[4]}return{error:r,headers:e,invocationId:t[2],result:o,type:Pb.Completion}}_createAckMessage(e){if(e.length<1)throw new Error("Invalid payload for Ack message.");return{sequenceId:e[1],type:Pb.Ack}}_createSequenceMessage(e){if(e.length<1)throw new Error("Invalid payload for Sequence message.");return{sequenceId:e[1],type:Pb.Sequence}}_writeInvocation(e){let t;return t=e.streamIds?this._encoder.encode([Pb.Invocation,e.headers||{},e.invocationId||null,e.target,e.arguments,e.streamIds]):this._encoder.encode([Pb.Invocation,e.headers||{},e.invocationId||null,e.target,e.arguments]),$E.write(t.slice())}_writeStreamInvocation(e){let t;return t=e.streamIds?this._encoder.encode([Pb.StreamInvocation,e.headers||{},e.invocationId,e.target,e.arguments,e.streamIds]):this._encoder.encode([Pb.StreamInvocation,e.headers||{},e.invocationId,e.target,e.arguments]),$E.write(t.slice())}_writeStreamItem(e){const t=this._encoder.encode([Pb.StreamItem,e.headers||{},e.invocationId,e.item]);return $E.write(t.slice())}_writeCompletion(e){const t=e.error?this._errorResult:void 0!==e.result?this._nonVoidResult:this._voidResult;let n;switch(t){case this._errorResult:n=this._encoder.encode([Pb.Completion,e.headers||{},e.invocationId,t,e.error]);break;case this._voidResult:n=this._encoder.encode([Pb.Completion,e.headers||{},e.invocationId,t]);break;case this._nonVoidResult:n=this._encoder.encode([Pb.Completion,e.headers||{},e.invocationId,t,e.result])}return $E.write(n.slice())}_writeCancelInvocation(e){const t=this._encoder.encode([Pb.CancelInvocation,e.headers||{},e.invocationId]);return $E.write(t.slice())}_writeClose(){const e=this._encoder.encode([Pb.Close,null]);return $E.write(e.slice())}_writeAck(e){const t=this._encoder.encode([Pb.Ack,e.sequenceId]);return $E.write(t.slice())}_writeSequence(e){const t=this._encoder.encode([Pb.Sequence,e.sequenceId]);return $E.write(t.slice())}_readHeaders(e){const t=e[1];if("object"!=typeof t)throw new Error("Invalid headers.");return t}}var jE=function(e,t){return jE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},jE(e,t)};function VE(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}jE(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function WE(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function i(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))}function qE(e,t){var n,r,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function BE(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function HE(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return a}function JE(e,t,n){if(n||2===arguments.length)for(var r,o=0,s=t.length;o<s;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function zE(e){return this instanceof zE?(this.v=e,this):new zE(e)}function YE(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||i(e,t)}))})}function i(e,t){try{!function(e){e.value instanceof zE?Promise.resolve(e.value.v).then(c,l):u(s[0][2],e)}(o[e](t))}catch(e){u(s[0][3],e)}}function c(e){i("next",e)}function l(e){i("throw",e)}function u(e,t){e(t),s.shift(),s.length&&i(s[0][0],s[0][1])}}function XE(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=BE(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}}function KE(e){return"function"==typeof e}function QE(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}"function"==typeof SuppressedError&&SuppressedError;var ZE=QE((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function ew(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var tw=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=BE(s),i=a.next();!i.done;i=a.next()){i.value.remove(this)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else s.remove(this);var c=this.initialTeardown;if(KE(c))try{c()}catch(e){o=e instanceof ZE?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var u=BE(l),d=u.next();!d.done;d=u.next()){var p=d.value;try{ow(p)}catch(e){o=null!=o?o:[],e instanceof ZE?o=JE(JE([],HE(o)),HE(e.errors)):o.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(o)throw new ZE(o)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)ow(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&ew(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&ew(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),nw=tw.EMPTY;function rw(e){return e instanceof tw||e&&"closed"in e&&KE(e.remove)&&KE(e.add)&&KE(e.unsubscribe)}function ow(e){KE(e)?e():e.unsubscribe()}var sw={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},aw={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,JE([e,t],HE(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function iw(e){aw.setTimeout((function(){throw e}))}function cw(){}function lw(e){e()}var uw=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,rw(t)&&t.add(n)):n.destination=mw,n}return VE(t,e),t.create=function(e,t,n){return new fw(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(tw),dw=Function.prototype.bind;function pw(e,t){return dw.call(e,t)}var hw=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){gw(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){gw(e)}else gw(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){gw(e)}},e}(),fw=function(e){function t(t,n,r){var o,s,a=e.call(this)||this;KE(t)||!t?o={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:a&&sw.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},o={next:t.next&&pw(t.next,s),error:t.error&&pw(t.error,s),complete:t.complete&&pw(t.complete,s)}):o=t;return a.destination=new hw(o),a}return VE(t,e),t}(uw);function gw(e){iw(e)}var mw={closed:!0,next:cw,error:function(e){throw e},complete:cw},_w="function"==typeof Symbol&&Symbol.observable||"@@observable";function yw(e){return e}var vw=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,o=this,s=(r=e)&&r instanceof uw||function(e){return e&&KE(e.next)&&KE(e.error)&&KE(e.complete)}(r)&&rw(r)?e:new fw(e,t,n);return lw((function(){var e=o,t=e.operator,n=e.source;s.add(t?t.call(s,n):n?o._subscribe(s):o._trySubscribe(s))})),s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Tw(t))((function(t,r){var o=new fw({next:function(t){try{e(t)}catch(e){r(e),o.unsubscribe()}},error:r,complete:t});n.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[_w]=function(){return this},e.prototype.pipe=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(0===(e=t).length?yw:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Tw(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Tw(e){var t;return null!==(t=null!=e?e:sw.Promise)&&void 0!==t?t:Promise}function Sw(e){return KE(null==e?void 0:e.lift)}function bw(e){return function(t){if(Sw(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function Ew(e,t,n,r,o){return new ww(e,t,n,r,o)}var ww=function(e){function t(t,n,r,o,s,a){var i=e.call(this,t)||this;return i.onFinalize=s,i.shouldUnsubscribe=a,i._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,i._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,i._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,i}return VE(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(uw);!function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._subject=null,r._refCount=0,r._connection=null,Sw(t)&&(r.lift=t.lift),r}VE(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype._teardown=function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()},t.prototype.connect=function(){var e=this,t=this._connection;if(!t){t=this._connection=new tw;var n=this.getSubject();t.add(this.source.subscribe(Ew(n,void 0,(function(){e._teardown(),n.complete()}),(function(t){e._teardown(),n.error(t)}),(function(){return e._teardown()})))),t.closed&&(this._connection=null,t=tw.EMPTY)}return t},t.prototype.refCount=function(){return bw((function(e,t){var n=null;e._refCount++;var r=Ew(t,void 0,void 0,void 0,(function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,o=n;n=null,!r||o&&r!==o||r.unsubscribe(),t.unsubscribe()}}));e.subscribe(r),r.closed||(n=e.connect())}))(this)}}(vw);var Aw,Iw={now:function(){return(Iw.delegate||performance).now()},delegate:void 0},Rw={schedule:function(e){var t=requestAnimationFrame,n=cancelAnimationFrame,r=t((function(t){n=void 0,e(t)}));return new tw((function(){return null==n?void 0:n(r)}))},requestAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Rw.delegate;return((null==n?void 0:n.requestAnimationFrame)||requestAnimationFrame).apply(void 0,JE([],HE(e)))},cancelAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return cancelAnimationFrame.apply(void 0,JE([],HE(e)))},delegate:void 0};new vw((function(e){var t=Aw||Iw,n=t.now(),r=0,o=function(){e.closed||(r=Rw.requestAnimationFrame((function(s){r=0;var a=t.now();e.next({timestamp:Aw?a:s,elapsed:a-n}),o()})))};return o(),function(){r&&Rw.cancelAnimationFrame(r)}}));var kw=QE((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Cw=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return VE(t,e),t.prototype.lift=function(e){var t=new Ow(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new kw},t.prototype.next=function(e){var t=this;lw((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=BE(t.currentObservers),s=o.next();!s.done;s=o.next()){s.value.next(e)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;lw((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;lw((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,o=n.isStopped,s=n.observers;return r||o?nw:(this.currentObservers=null,s.push(e),new tw((function(){t.currentObservers=null,ew(s,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,o=t.isStopped;n?e.error(r):o&&e.complete()},t.prototype.asObservable=function(){var e=new vw;return e.source=this,e},t.create=function(e,t){return new Ow(e,t)},t}(vw),Ow=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return VE(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:nw},t}(Cw),xw=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return VE(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Cw),Lw={now:function(){return(Lw.delegate||Date).now()},delegate:void 0},Nw=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=Lw);var o=e.call(this)||this;return o._bufferSize=t,o._windowTime=n,o._timestampProvider=r,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=n===1/0,o._bufferSize=Math.max(1,t),o._windowTime=Math.max(1,n),o}return VE(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,o=n._buffer,s=n._infiniteTimeWindow,a=n._timestampProvider,i=n._windowTime;r||(o.push(t),!s&&o.push(a.now()+i)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),o=0;o<r.length&&!e.closed;o+=n?1:2)e.next(r[o]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,o=e._infiniteTimeWindow,s=(o?1:2)*t;if(t<1/0&&s<r.length&&r.splice(0,r.length-s),!o){for(var a=n.now(),i=0,c=1;c<r.length&&r[c]<=a;c+=2)i=c;i&&r.splice(0,i+1)}},t}(Cw);!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}VE(t,e),t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t._hasValue,o=t._value,s=t.thrownError,a=t.isStopped,i=t._isComplete;n?e.error(s):(a||i)&&(r&&e.next(o),e.complete())},t.prototype.next=function(e){this.isStopped||(this._value=e,this._hasValue=!0)},t.prototype.complete=function(){var t=this,n=t._hasValue,r=t._value;t._isComplete||(this._isComplete=!0,n&&e.prototype.next.call(this,r),e.prototype.complete.call(this))}}(Cw);var Pw,Dw=function(e){function t(t,n){return e.call(this)||this}return VE(t,e),t.prototype.schedule=function(e,t){return this},t}(tw),Mw=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,JE([e,t],HE(n)))},Uw=function(e){return clearInterval(e)},$w=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return VE(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),Mw(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Uw(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,ew(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Dw),Fw=1,Gw={};function jw(e){return e in Gw&&(delete Gw[e],!0)}var Vw=function(e){var t=Fw++;return Gw[t]=!0,Pw||(Pw=Promise.resolve()),Pw.then((function(){return jw(t)&&e()})),t},Ww=function(e){jw(e)},qw={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qw.delegate;return((null==n?void 0:n.setImmediate)||Vw).apply(void 0,JE([],HE(e)))},clearImmediate:function(e){return Ww(e)},delegate:void 0},Bw=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return VE(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=qw.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){var o;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var s=t.actions;null!=n&&(null===(o=s[s.length-1])||void 0===o?void 0:o.id)!==n&&(qw.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},t}($w),Hw=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Lw.now,e}(),Jw=function(e){function t(t,n){void 0===n&&(n=Hw.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return VE(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Hw),zw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return VE(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(Jw);new zw(Bw),new Jw($w);var Yw=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return VE(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.flush(this),0)},t}($w),Xw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return VE(t,e),t}(Jw);new Xw(Yw);var Kw=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return VE(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=Rw.requestAnimationFrame((function(){return t.flush(void 0)}))))},t.prototype.recycleAsyncId=function(t,n,r){var o;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var s=t.actions;null!=n&&(null===(o=s[s.length-1])||void 0===o?void 0:o.id)!==n&&(Rw.cancelAnimationFrame(n),t._scheduled=void 0)},t}($w),Qw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return VE(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(Jw);new Qw(Kw),function(e){function t(t,n){void 0===t&&(t=Zw),void 0===n&&(n=1/0);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}VE(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10}(Jw);var Zw=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var o=e.call(this,t,n)||this;return o.scheduler=t,o.work=n,o.index=r,o.active=!0,o.index=t.index=r,o}return VE(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),Number.isFinite(r)){if(!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var o=new t(this.scheduler,this.work);return this.add(o),o.schedule(n,r)}return tw.EMPTY},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var o=e.actions;return o.push(this),o.sort(t.sortActions),1},t.prototype.recycleAsyncId=function(e,t,n){},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}($w),eA=new vw((function(e){return e.complete()}));function tA(e){return e[e.length-1]}function nA(e){return(t=tA(e))&&KE(t.schedule)?e.pop():void 0;var t}var rA=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function oA(e){return KE(null==e?void 0:e.then)}function sA(e){return KE(e[_w])}function aA(e){return Symbol.asyncIterator&&KE(null==e?void 0:e[Symbol.asyncIterator])}function iA(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var cA,lA="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function uA(e){return KE(null==e?void 0:e[lA])}function dA(e){return YE(this,arguments,(function(){var t,n,r;return qE(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,zE(t.read())];case 3:return n=o.sent(),r=n.value,n.done?[4,zE(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,zE(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function pA(e){return KE(null==e?void 0:e.getReader)}function hA(e){if(e instanceof vw)return e;if(null!=e){if(sA(e))return o=e,new vw((function(e){var t=o[_w]();if(KE(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(rA(e))return r=e,new vw((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(oA(e))return n=e,new vw((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,iw)}));if(aA(e))return fA(e);if(uA(e))return t=e,new vw((function(e){var n,r;try{for(var o=BE(t),s=o.next();!s.done;s=o.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}e.complete()}));if(pA(e))return fA(dA(e))}var t,n,r,o;throw iA(e)}function fA(e){return new vw((function(t){(function(e,t){var n,r,o,s;return WE(this,void 0,void 0,(function(){var a,i;return qE(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=XE(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return i=c.sent(),o={error:i},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function gA(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=!1);var s=t.schedule((function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(s),!o)return s}function mA(e,t){return void 0===t&&(t=0),bw((function(n,r){n.subscribe(Ew(r,(function(n){return gA(r,e,(function(){return r.next(n)}),t)}),(function(){return gA(r,e,(function(){return r.complete()}),t)}),(function(n){return gA(r,e,(function(){return r.error(n)}),t)})))}))}function _A(e,t){return void 0===t&&(t=0),bw((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function yA(e,t){if(!e)throw new Error("Iterable cannot be null");return new vw((function(n){gA(n,t,(function(){var r=e[Symbol.asyncIterator]();gA(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function vA(e,t){if(null!=e){if(sA(e))return function(e,t){return hA(e).pipe(_A(t),mA(t))}(e,t);if(rA(e))return function(e,t){return new vw((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(oA(e))return function(e,t){return hA(e).pipe(_A(t),mA(t))}(e,t);if(aA(e))return yA(e,t);if(uA(e))return function(e,t){return new vw((function(n){var r;return gA(n,t,(function(){r=e[lA](),gA(n,t,(function(){var e,t,o;try{t=(e=r.next()).value,o=e.done}catch(e){return void n.error(e)}o?n.complete():n.next(t)}),0,!0)})),function(){return KE(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(pA(e))return function(e,t){return yA(dA(e),t)}(e,t)}throw iA(e)}function TA(e,t){return t?vA(e,t):hA(e)}function SA(e,t){return bw((function(n,r){var o=0;n.subscribe(Ew(r,(function(n){r.next(e.call(t,n,o++))})))}))}!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(cA||(cA={})),QE((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),QE((function(e){return function(){e(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}})),QE((function(e){return function(t){e(this),this.name="NotFoundError",this.message=t}})),QE((function(e){return function(t){e(this),this.name="SequenceError",this.message=t}})),QE((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));var bA=Array.isArray;function EA(e){return SA((function(t){return function(e,t){return bA(t)?e.apply(void 0,JE([],HE(t))):e(t)}(e,t)}))}var wA=Array.isArray,AA=Object.getPrototypeOf,IA=Object.prototype,RA=Object.keys;function kA(e){if(1===e.length){var t=e[0];if(wA(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&AA(r)===IA){var n=RA(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}function CA(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=nA(e),r=function(e){return KE(tA(e))?e.pop():void 0}(e),o=kA(e),s=o.args,a=o.keys;if(0===s.length)return TA([],n);var i=new vw(function(e,t,n){void 0===n&&(n=yw);return function(r){OA(t,(function(){for(var o=e.length,s=new Array(o),a=o,i=o,c=function(o){OA(t,(function(){var c=TA(e[o],t),l=!1;c.subscribe(Ew(r,(function(e){s[o]=e,l||(l=!0,i--),i||r.next(n(s.slice()))}),(function(){--a||r.complete()})))}),r)},l=0;l<o;l++)c(l)}),r)}}(s,n,a?function(e){return function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}(a,e)}:yw));return r?i.pipe(EA(r)):i}function OA(e,t,n){e?gA(n,e,t):t()}function xA(e,t,n){return void 0===n&&(n=1/0),KE(t)?xA((function(n,r){return SA((function(e,o){return t(n,e,r,o)}))(hA(e(n,r)))}),n):("number"==typeof t&&(n=t),bw((function(t,r){return function(e,t,n,r,o,s,a,i){var c=[],l=0,u=0,d=!1,p=function(){!d||c.length||l||t.complete()},h=function(e){return l<r?f(e):c.push(e)},f=function(e){s&&t.next(e),l++;var i=!1;hA(n(e,u++)).subscribe(Ew(t,(function(e){null==o||o(e),s?h(e):t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{l--;for(var e=function(){var e=c.shift();a?gA(t,a,(function(){return f(e)})):f(e)};c.length&&l<r;)e();p()}catch(e){t.error(e)}})))};return e.subscribe(Ew(t,h,(function(){d=!0,p()}))),function(){null==i||i()}}(t,r,e,n)})))}function LA(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=nA(e),r=function(e,t){return"number"==typeof tA(e)?e.pop():t}(e,1/0),o=e;return o.length?1===o.length?hA(o[0]):function(e){return void 0===e&&(e=1/0),xA(yw,e)}(r)(TA(o,n)):eA}function NA(e,t){return bw((function(n,r){var o=0;n.subscribe(Ew(r,(function(n){return e.call(t,n,o++)&&r.next(n)})))}))}function PA(e,t){return bw(function(e,t,n,r,o){return function(s,a){var i=n,c=t,l=0;s.subscribe(Ew(a,(function(t){var n=l++;c=i?e(c,t,n):(i=!0,t),r&&a.next(c)}),o&&function(){i&&a.next(c),a.complete()}))}}(e,t,arguments.length>=2,!0))}function DA(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new Cw}:t,r=e.resetOnError,o=void 0===r||r,s=e.resetOnComplete,a=void 0===s||s,i=e.resetOnRefCountZero,c=void 0===i||i;return function(e){var t,r,s,i=0,l=!1,u=!1,d=function(){null==r||r.unsubscribe(),r=void 0},p=function(){d(),t=s=void 0,l=u=!1},h=function(){var e=t;p(),null==e||e.unsubscribe()};return bw((function(e,f){i++,u||l||d();var g=s=null!=s?s:n();f.add((function(){0!==--i||u||l||(r=MA(h,c))})),g.subscribe(f),!t&&i>0&&(t=new fw({next:function(e){return g.next(e)},error:function(e){u=!0,d(),r=MA(p,o,e),g.error(e)},complete:function(){l=!0,d(),r=MA(p,a),g.complete()}}),hA(e).subscribe(t))}))(e)}}function MA(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0!==t){if(!1!==t){var o=new fw({next:function(){o.unsubscribe(),e()}});return hA(t.apply(void 0,JE([],HE(n)))).subscribe(o)}}else e()}function UA(){let e=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(e|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,!(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function $A(e,t,n){for(let r=0;r<28;r+=7){const o=e>>>r,s=!(o>>>7==0&&0==t),a=255&(s?128|o:o);if(n.push(a),!s)return}const r=e>>>28&15|(7&t)<<4,o=!!(t>>3);if(n.push(255&(o?128|r:r)),o){for(let e=3;e<31;e+=7){const r=t>>>e,o=!(r>>>7==0),s=255&(o?128|r:r);if(n.push(s),!o)return}n.push(t>>>31&1)}}new vw(cw);const FA=4294967296;function GA(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let r=0,o=0;function s(t,s){const a=Number(e.slice(t,s));o*=n,r=r*n+a,r>=FA&&(o+=r/FA|0,r%=FA)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),t?WA(r,o):VA(r,o)}function jA(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(FA*t+e);const n=16777215&(e>>>24|t<<8),r=t>>16&65535;let o=(16777215&e)+6777216*n+6710656*r,s=n+8147497*r,a=2*r;const i=1e7;return o>=i&&(s+=Math.floor(o/i),o%=i),s>=i&&(a+=Math.floor(s/i),s%=i),a.toString()+qA(s)+qA(o)}function VA(e,t){return{lo:0|e,hi:0|t}}function WA(e,t){return t=~t,e?e=1+~e:t+=1,VA(e,t)}const qA=e=>{const t=String(e);return"0000000".slice(t.length)+t};function BA(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function HA(){let e=this.buf[this.pos++],t=127&e;if(!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,!(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;128&e&&t<10;t++)e=this.buf[this.pos++];if(128&e)throw new Error("invalid varint");return this.assertBounds(),t>>>0}const JA=zA();function zA(){const e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),r=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const r="bigint"==typeof e?e:BigInt(e);if(r>n||r<t)throw new Error(`invalid int64: ${e}`);return r},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>o||t<r)throw new Error(`invalid uint64: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),YA(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),XA(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),YA(e),GA(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),XA(e),GA(e)),dec:(e,t)=>function(e,t){let n=VA(e,t);const r=2147483648&n.hi;r&&(n=WA(n.lo,n.hi));const o=jA(n.lo,n.hi);return r?"-"+o:o}(e,t),uDec:(e,t)=>jA(e,t)}}function YA(e){if(!/^-?[0-9]+$/.test(e))throw new Error("invalid int64: "+e)}function XA(e){if(!/^[0-9]+$/.test(e))throw new Error("invalid uint64: "+e)}const KA=Symbol.for("@bufbuild/protobuf/text-encoding");function QA(){if(null==globalThis[KA]){const e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[KA]={encodeUtf8:t=>e.encode(t),decodeUtf8:e=>t.decode(e),checkUtf8(e){try{return encodeURIComponent(e),!0}catch(e){return!1}}}}return globalThis[KA]}var ZA;!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(ZA||(ZA={}));const eI=34028234663852886e22,tI=-34028234663852886e22;class nI{constructor(e=QA().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(sI(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return oI(e),BA(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.encodeUtf8(e);return this.uint32(t.byteLength),this.raw(t)}float(e){!function(e){if("string"==typeof e){const t=e;if(e=Number(e),isNaN(e)&&"NaN"!==t)throw new Error("invalid float32: "+t)}else if("number"!=typeof e)throw new Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>eI||e<tI))throw new Error("invalid float32: "+e)}(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){sI(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){oI(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return oI(e),BA(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=JA.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=JA.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=JA.enc(e);return $A(t.lo,t.hi,this.buf),this}sint64(e){let t=JA.enc(e),n=t.hi>>31;return $A(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=JA.uEnc(e);return $A(t.lo,t.hi,this.buf),this}}class rI{constructor(e,t=QA().decodeUtf8){this.decodeUtf8=t,this.varint64=UA,this.uint32=HA,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case ZA.Varint:for(;128&this.buf[this.pos++];);break;case ZA.Bit64:this.pos+=4;case ZA.Bit32:this.pos+=4;break;case ZA.LengthDelimited:let n=this.uint32();this.pos+=n;break;case ZA.StartGroup:for(;;){const[e,n]=this.tag();if(n===ZA.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return JA.dec(...this.varint64())}uint64(){return JA.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,JA.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return JA.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return JA.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.decodeUtf8(this.bytes())}}function oI(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw new Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int32: "+e)}function sI(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw new Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint32: "+e)}var aI;!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(aI||(aI={}));var iI,cI;function lI(e){switch(e){case 0:case"STATUS_CODE_UNSPECIFIED":return cI.UNSPECIFIED;case 1:case"STATUS_CODE_CANCELLED":return cI.CANCELLED;case 2:case"STATUS_CODE_UNKNOWN":return cI.UNKNOWN;case 3:case"STATUS_CODE_INVALID_ARGUMENT":return cI.INVALID_ARGUMENT;case 4:case"STATUS_CODE_DEADLINE_EXCEEDED":return cI.DEADLINE_EXCEEDED;case 5:case"STATUS_CODE_NOT_FOUND":return cI.NOT_FOUND;case 6:case"STATUS_CODE_ALREADY_EXISTS":return cI.ALREADY_EXISTS;case 7:case"STATUS_CODE_PERMISSION_DENIED":return cI.PERMISSION_DENIED;case 8:case"STATUS_CODE_RESOURCE_EXHAUSTED":return cI.RESOURCE_EXHAUSTED;case 9:case"STATUS_CODE_FAILED_PRECONDITION":return cI.FAILED_PRECONDITION;case 10:case"STATUS_CODE_ABORTED":return cI.ABORTED;case 11:case"STATUS_CODE_OUT_OF_RANGE":return cI.OUT_OF_RANGE;case 12:case"STATUS_CODE_UNIMPLEMENTED":return cI.UNIMPLEMENTED;case 13:case"STATUS_CODE_INTERNAL":return cI.INTERNAL;case 14:case"STATUS_CODE_UNAVAILABLE":return cI.UNAVAILABLE;case 15:case"STATUS_CODE_DATA_LOSS":return cI.DATA_LOSS;case 16:case"STATUS_CODE_UNAUTHENTICATED":return cI.UNAUTHENTICATED;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum StatusCode")}}!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.START_SESSION_REQUEST=1]="START_SESSION_REQUEST",e[e.START_SESSION_RESPONSE=2]="START_SESSION_RESPONSE",e[e.EVENT_VERSION=3]="EVENT_VERSION",e[e.PARTICIPANT_REQUEST=4]="PARTICIPANT_REQUEST",e[e.PARTICIPANT_RESPONSE=5]="PARTICIPANT_RESPONSE",e[e.CLIENT_ERROR_INFO=6]="CLIENT_ERROR_INFO"}(iI||(iI={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(cI||(cI={}));const uI={$type:"deepl.pb.interactive_text_api.signalr.DetailCode",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.signalr.DetailCode",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:uI.$type,value:pI(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const dI={$type:"deepl.pb.interactive_text_api.signalr.ClientErrorInfo",encode(e,t=new nI){0!==e.statusCode&&t.uint32(8).int32(e.statusCode),void 0!==e.detailCode&&uI.encode(e.detailCode,t.uint32(18).fork()).join();for(const n of e.fallbackDetailCodes)uI.encode(n,t.uint32(26).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.signalr.ClientErrorInfo",statusCode:0,detailCode:void 0,fallbackDetailCodes:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.statusCode=n.int32();continue;case 2:if(18!==e)break;o.detailCode=uI.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.fallbackDetailCodes.push(uI.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:dI.$type,statusCode:pI(e.statusCode)?lI(e.statusCode):0,detailCode:pI(e.detailCode)?uI.fromJSON(e.detailCode):void 0,fallbackDetailCodes:globalThis.Array.isArray(null==e?void 0:e.fallbackDetailCodes)?e.fallbackDetailCodes.map((e=>uI.fromJSON(e))):[]}),toJSON(e){var t;const n={};return 0!==e.statusCode&&(n.statusCode=function(e){switch(e){case cI.UNSPECIFIED:return"STATUS_CODE_UNSPECIFIED";case cI.CANCELLED:return"STATUS_CODE_CANCELLED";case cI.UNKNOWN:return"STATUS_CODE_UNKNOWN";case cI.INVALID_ARGUMENT:return"STATUS_CODE_INVALID_ARGUMENT";case cI.DEADLINE_EXCEEDED:return"STATUS_CODE_DEADLINE_EXCEEDED";case cI.NOT_FOUND:return"STATUS_CODE_NOT_FOUND";case cI.ALREADY_EXISTS:return"STATUS_CODE_ALREADY_EXISTS";case cI.PERMISSION_DENIED:return"STATUS_CODE_PERMISSION_DENIED";case cI.RESOURCE_EXHAUSTED:return"STATUS_CODE_RESOURCE_EXHAUSTED";case cI.FAILED_PRECONDITION:return"STATUS_CODE_FAILED_PRECONDITION";case cI.ABORTED:return"STATUS_CODE_ABORTED";case cI.OUT_OF_RANGE:return"STATUS_CODE_OUT_OF_RANGE";case cI.UNIMPLEMENTED:return"STATUS_CODE_UNIMPLEMENTED";case cI.INTERNAL:return"STATUS_CODE_INTERNAL";case cI.UNAVAILABLE:return"STATUS_CODE_UNAVAILABLE";case cI.DATA_LOSS:return"STATUS_CODE_DATA_LOSS";case cI.UNAUTHENTICATED:return"STATUS_CODE_UNAUTHENTICATED";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum StatusCode")}}(e.statusCode)),void 0!==e.detailCode&&(n.detailCode=uI.toJSON(e.detailCode)),(null===(t=e.fallbackDetailCodes)||void 0===t?void 0:t.length)&&(n.fallbackDetailCodes=e.fallbackDetailCodes.map((e=>uI.toJSON(e)))),n}};function pI(e){return null!=e}const hI={$type:"google.protobuf.Timestamp",encode:(e,t=new nI)=>(0!==e.seconds&&t.uint32(8).int64(e.seconds),0!==e.nanos&&t.uint32(16).int32(e.nanos),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"google.protobuf.Timestamp",seconds:0,nanos:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.seconds=fI(n.int64());continue;case 2:if(16!==e)break;o.nanos=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:hI.$type,seconds:gI(e.seconds)?globalThis.Number(e.seconds):0,nanos:gI(e.nanos)?globalThis.Number(e.nanos):0}),toJSON(e){const t={};return 0!==e.seconds&&(t.seconds=Math.round(e.seconds)),0!==e.nanos&&(t.nanos=Math.round(e.nanos)),t}};function fI(e){const t=globalThis.Number(e.toString());if(t>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(t<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return t}function gI(e){return null!=e}const mI={$type:"google.protobuf.Int32Value",encode:(e,t=new nI)=>(0!==e.value&&t.uint32(8).int32(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"google.protobuf.Int32Value",value:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.value=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON(e){return{$type:mI.$type,value:(t=e.value,null!=t?globalThis.Number(e.value):0)};var t},toJSON(e){const t={};return 0!==e.value&&(t.value=Math.round(e.value)),t}};const _I={$type:"deepl.pb.interactive_text_api.TextRange",encode:(e,t=new nI)=>(0!==e.start&&t.uint32(8).int32(e.start),0!==e.end&&t.uint32(16).int32(e.end),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.TextRange",start:0,end:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.start=n.int32();continue;case 2:if(16!==e)break;o.end=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:_I.$type,start:yI(e.start)?globalThis.Number(e.start):0,end:yI(e.end)?globalThis.Number(e.end):0}),toJSON(e){const t={};return 0!==e.start&&(t.start=Math.round(e.start)),0!==e.end&&(t.end=Math.round(e.end)),t}};function yI(e){return null!=e}var vI,TI;function SI(e){switch(e){case 0:case"CALCULATED_LANGUAGE_ORIGIN_UNSPECIFIED":return vI.UNSPECIFIED;case 1:case"CALCULATED_LANGUAGE_ORIGIN_REQUESTED_LANGUAGE":return vI.REQUESTED_LANGUAGE;case 2:case"CALCULATED_LANGUAGE_ORIGIN_LANGUAGE_DETECTION":return vI.LANGUAGE_DETECTION;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum CalculatedLanguageOrigin")}}function bI(e){switch(e){case vI.UNSPECIFIED:return"CALCULATED_LANGUAGE_ORIGIN_UNSPECIFIED";case vI.REQUESTED_LANGUAGE:return"CALCULATED_LANGUAGE_ORIGIN_REQUESTED_LANGUAGE";case vI.LANGUAGE_DETECTION:return"CALCULATED_LANGUAGE_ORIGIN_LANGUAGE_DETECTION";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum CalculatedLanguageOrigin")}}function EI(e){switch(e){case 0:case"TEXT_DIRECTION_UNSPECIFIED":return TI.UNSPECIFIED;case 1:case"TEXT_DIRECTION_LEFT_TO_RIGHT":return TI.LEFT_TO_RIGHT;case 2:case"TEXT_DIRECTION_RIGHT_TO_LEFT":return TI.RIGHT_TO_LEFT;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum TextDirection")}}!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.REQUESTED_LANGUAGE=1]="REQUESTED_LANGUAGE",e[e.LANGUAGE_DETECTION=2]="LANGUAGE_DETECTION"}(vI||(vI={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT"}(TI||(TI={}));const wI={$type:"deepl.pb.interactive_text_api.translator.TextUnitAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.textUnitId&&iR.encode(e.textUnitId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitAnnotationPayload",textUnitId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.textUnitId=iR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:wI.$type,textUnitId:fR(e.textUnitId)?iR.fromJSON(e.textUnitId):void 0}),toJSON(e){const t={};return void 0!==e.textUnitId&&(t.textUnitId=iR.toJSON(e.textUnitId)),t}};const AI={$type:"deepl.pb.interactive_text_api.translator.RequestWordAlternativesAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.flowId&&lR.encode(e.flowId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestWordAlternativesAnnotationPayload",flowId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=lR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:AI.$type,flowId:fR(e.flowId)?lR.fromJSON(e.flowId):void 0}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=lR.toJSON(e.flowId)),t}};const II={$type:"deepl.pb.interactive_text_api.translator.ProvidedWordAlternativesAnnotationPayload",encode(e,t=new nI){void 0!==e.flowId&&lR.encode(e.flowId,t.uint32(10).fork()).join();for(const n of e.alternatives)cR.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedWordAlternativesAnnotationPayload",flowId:void 0,alternatives:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=lR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.alternatives.push(cR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:II.$type,flowId:fR(e.flowId)?lR.fromJSON(e.flowId):void 0,alternatives:globalThis.Array.isArray(null==e?void 0:e.alternatives)?e.alternatives.map((e=>cR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.flowId&&(n.flowId=lR.toJSON(e.flowId)),(null===(t=e.alternatives)||void 0===t?void 0:t.length)&&(n.alternatives=e.alternatives.map((e=>cR.toJSON(e)))),n}};const RI={$type:"deepl.pb.interactive_text_api.translator.SelectWordAlternativeAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.flowId&&lR.encode(e.flowId,t.uint32(10).fork()).join(),""!==e.selection&&t.uint32(18).string(e.selection),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectWordAlternativeAnnotationPayload",flowId:void 0,selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=lR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:RI.$type,flowId:fR(e.flowId)?lR.fromJSON(e.flowId):void 0,selection:fR(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=lR.toJSON(e.flowId)),""!==e.selection&&(t.selection=e.selection),t}};const kI={$type:"deepl.pb.interactive_text_api.translator.RequestTextUnitAlternativesAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.flowId&&pR.encode(e.flowId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestTextUnitAlternativesAnnotationPayload",flowId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=pR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:kI.$type,flowId:fR(e.flowId)?pR.fromJSON(e.flowId):void 0}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=pR.toJSON(e.flowId)),t}};const CI={$type:"deepl.pb.interactive_text_api.translator.ProvidedTextUnitAlternativesAnnotationPayload",encode(e,t=new nI){void 0!==e.flowId&&pR.encode(e.flowId,t.uint32(10).fork()).join();for(const n of e.alternatives)uR.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedTextUnitAlternativesAnnotationPayload",flowId:void 0,alternatives:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=pR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.alternatives.push(uR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:CI.$type,flowId:fR(e.flowId)?pR.fromJSON(e.flowId):void 0,alternatives:globalThis.Array.isArray(null==e?void 0:e.alternatives)?e.alternatives.map((e=>uR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.flowId&&(n.flowId=pR.toJSON(e.flowId)),(null===(t=e.alternatives)||void 0===t?void 0:t.length)&&(n.alternatives=e.alternatives.map((e=>uR.toJSON(e)))),n}};const OI={$type:"deepl.pb.interactive_text_api.translator.SelectTextUnitAlternativeAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.flowId&&pR.encode(e.flowId,t.uint32(10).fork()).join(),""!==e.selection&&t.uint32(18).string(e.selection),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectTextUnitAlternativeAnnotationPayload",flowId:void 0,selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=pR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:OI.$type,flowId:fR(e.flowId)?pR.fromJSON(e.flowId):void 0,selection:fR(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=pR.toJSON(e.flowId)),""!==e.selection&&(t.selection=e.selection),t}};const xI={$type:"deepl.pb.interactive_text_api.translator.RequestAutocompletionAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.flowId&&hR.encode(e.flowId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestAutocompletionAnnotationPayload",flowId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=hR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:xI.$type,flowId:fR(e.flowId)?hR.fromJSON(e.flowId):void 0}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=hR.toJSON(e.flowId)),t}};const LI={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutocompletionAnnotationPayload",encode(e,t=new nI){void 0!==e.flowId&&hR.encode(e.flowId,t.uint32(10).fork()).join();for(const n of e.autocompletions)uR.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutocompletionAnnotationPayload",flowId:void 0,autocompletions:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=hR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.autocompletions.push(uR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:LI.$type,flowId:fR(e.flowId)?hR.fromJSON(e.flowId):void 0,autocompletions:globalThis.Array.isArray(null==e?void 0:e.autocompletions)?e.autocompletions.map((e=>uR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.flowId&&(n.flowId=hR.toJSON(e.flowId)),(null===(t=e.autocompletions)||void 0===t?void 0:t.length)&&(n.autocompletions=e.autocompletions.map((e=>uR.toJSON(e)))),n}};const NI={$type:"deepl.pb.interactive_text_api.translator.SelectAutocompletionAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.flowId&&hR.encode(e.flowId,t.uint32(10).fork()).join(),""!==e.selection&&t.uint32(18).string(e.selection),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectAutocompletionAnnotationPayload",flowId:void 0,selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.flowId=hR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:NI.$type,flowId:fR(e.flowId)?hR.fromJSON(e.flowId):void 0,selection:fR(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return void 0!==e.flowId&&(t.flowId=hR.toJSON(e.flowId)),""!==e.selection&&(t.selection=e.selection),t}};const PI={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutomaticTextUnitAlternativesAnnotationPayload",encode(e,t=new nI){for(const n of e.alternatives)uR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.ProvidedAutomaticTextUnitAlternativesAnnotationPayload",alternatives:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.alternatives.push(uR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:PI.$type,alternatives:globalThis.Array.isArray(null==e?void 0:e.alternatives)?e.alternatives.map((e=>uR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.alternatives)||void 0===t?void 0:t.length)&&(n.alternatives=e.alternatives.map((e=>uR.toJSON(e)))),n}};const DI={$type:"deepl.pb.interactive_text_api.translator.SelectAutomaticTextUnitAlternativeAnnotationPayload",encode:(e,t=new nI)=>(""!==e.selection&&t.uint32(10).string(e.selection),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SelectAutomaticTextUnitAlternativeAnnotationPayload",selection:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.selection=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:DI.$type,selection:fR(e.selection)?globalThis.String(e.selection):""}),toJSON(e){const t={};return""!==e.selection&&(t.selection=e.selection),t}};const MI={$type:"deepl.pb.interactive_text_api.translator.GlossaryReplacementAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.replacement&&rR.encode(e.replacement,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryReplacementAnnotationPayload",replacement:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.replacement=rR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:MI.$type,replacement:fR(e.replacement)?rR.fromJSON(e.replacement):void 0}),toJSON(e){const t={};return void 0!==e.replacement&&(t.replacement=rR.toJSON(e.replacement)),t}};const UI={$type:"deepl.pb.interactive_text_api.translator.SourceLanguagesPropertyValue",encode(e,t=new nI){for(const n of e.sourceLanguages)sR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SourceLanguagesPropertyValue",sourceLanguages:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sourceLanguages.push(sR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:UI.$type,sourceLanguages:globalThis.Array.isArray(null==e?void 0:e.sourceLanguages)?e.sourceLanguages.map((e=>sR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.sourceLanguages)||void 0===t?void 0:t.length)&&(n.sourceLanguages=e.sourceLanguages.map((e=>sR.toJSON(e)))),n}};const $I={$type:"deepl.pb.interactive_text_api.translator.TargetLanguagesPropertyValue",encode(e,t=new nI){for(const n of e.targetLanguages)aR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TargetLanguagesPropertyValue",targetLanguages:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.targetLanguages.push(aR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:$I.$type,targetLanguages:globalThis.Array.isArray(null==e?void 0:e.targetLanguages)?e.targetLanguages.map((e=>aR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.targetLanguages)||void 0===t?void 0:t.length)&&(n.targetLanguages=e.targetLanguages.map((e=>aR.toJSON(e)))),n}};const FI={$type:"deepl.pb.interactive_text_api.translator.RequestedSourceLanguagePropertyValue",encode:(e,t=new nI)=>(void 0!==e.sourceLanguage&&sR.encode(e.sourceLanguage,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestedSourceLanguagePropertyValue",sourceLanguage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sourceLanguage=sR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:FI.$type,sourceLanguage:fR(e.sourceLanguage)?sR.fromJSON(e.sourceLanguage):void 0}),toJSON(e){const t={};return void 0!==e.sourceLanguage&&(t.sourceLanguage=sR.toJSON(e.sourceLanguage)),t}};const GI={$type:"deepl.pb.interactive_text_api.translator.CalculatedSourceLanguagePropertyValue",encode:(e,t=new nI)=>(void 0!==e.sourceLanguage&&sR.encode(e.sourceLanguage,t.uint32(10).fork()).join(),0!==e.origin&&t.uint32(16).int32(e.origin),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.CalculatedSourceLanguagePropertyValue",sourceLanguage:void 0,origin:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sourceLanguage=sR.decode(n,n.uint32());continue;case 2:if(16!==e)break;o.origin=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:GI.$type,sourceLanguage:fR(e.sourceLanguage)?sR.fromJSON(e.sourceLanguage):void 0,origin:fR(e.origin)?SI(e.origin):0}),toJSON(e){const t={};return void 0!==e.sourceLanguage&&(t.sourceLanguage=sR.toJSON(e.sourceLanguage)),0!==e.origin&&(t.origin=bI(e.origin)),t}};const jI={$type:"deepl.pb.interactive_text_api.translator.RequestedTargetLanguagePropertyValue",encode:(e,t=new nI)=>(void 0!==e.targetLanguage&&aR.encode(e.targetLanguage,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.RequestedTargetLanguagePropertyValue",targetLanguage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.targetLanguage=aR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:jI.$type,targetLanguage:fR(e.targetLanguage)?aR.fromJSON(e.targetLanguage):void 0}),toJSON(e){const t={};return void 0!==e.targetLanguage&&(t.targetLanguage=aR.toJSON(e.targetLanguage)),t}};const VI={$type:"deepl.pb.interactive_text_api.translator.CalculatedTargetLanguagePropertyValue",encode:(e,t=new nI)=>(void 0!==e.targetLanguage&&aR.encode(e.targetLanguage,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.CalculatedTargetLanguagePropertyValue",targetLanguage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.targetLanguage=aR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:VI.$type,targetLanguage:fR(e.targetLanguage)?aR.fromJSON(e.targetLanguage):void 0}),toJSON(e){const t={};return void 0!==e.targetLanguage&&(t.targetLanguage=aR.toJSON(e.targetLanguage)),t}};const WI={$type:"deepl.pb.interactive_text_api.translator.TaskMetaInfo",encode:(e,t=new nI)=>(0!==e.progressInPercent&&t.uint32(8).int32(e.progressInPercent),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TaskMetaInfo",progressInPercent:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.progressInPercent=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:WI.$type,progressInPercent:fR(e.progressInPercent)?globalThis.Number(e.progressInPercent):0}),toJSON(e){const t={};return 0!==e.progressInPercent&&(t.progressInPercent=Math.round(e.progressInPercent)),t}};const qI={$type:"deepl.pb.interactive_text_api.translator.FormalityModesPropertyValue",encode(e,t=new nI){for(const n of e.formalityModes)eR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.FormalityModesPropertyValue",formalityModes:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.formalityModes.push(eR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:qI.$type,formalityModes:globalThis.Array.isArray(null==e?void 0:e.formalityModes)?e.formalityModes.map((e=>eR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.formalityModes)||void 0===t?void 0:t.length)&&(n.formalityModes=e.formalityModes.map((e=>eR.toJSON(e)))),n}};const BI={$type:"deepl.pb.interactive_text_api.translator.FormalityModePropertyValue",encode:(e,t=new nI)=>(void 0!==e.formalityMode&&eR.encode(e.formalityMode,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.FormalityModePropertyValue",formalityMode:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.formalityMode=eR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:BI.$type,formalityMode:fR(e.formalityMode)?eR.fromJSON(e.formalityMode):void 0}),toJSON(e){const t={};return void 0!==e.formalityMode&&(t.formalityMode=eR.toJSON(e.formalityMode)),t}};const HI={$type:"deepl.pb.interactive_text_api.translator.LanguageModelsPropertyValue",encode(e,t=new nI){for(const n of e.languageModels)tR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.LanguageModelsPropertyValue",languageModels:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.languageModels.push(tR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:HI.$type,languageModels:globalThis.Array.isArray(null==e?void 0:e.languageModels)?e.languageModels.map((e=>tR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.languageModels)||void 0===t?void 0:t.length)&&(n.languageModels=e.languageModels.map((e=>tR.toJSON(e)))),n}};const JI={$type:"deepl.pb.interactive_text_api.translator.LanguageModelPropertyValue",encode:(e,t=new nI)=>(void 0!==e.languageModel&&tR.encode(e.languageModel,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.LanguageModelPropertyValue",languageModel:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.languageModel=tR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:JI.$type,languageModel:fR(e.languageModel)?tR.fromJSON(e.languageModel):void 0}),toJSON(e){const t={};return void 0!==e.languageModel&&(t.languageModel=tR.toJSON(e.languageModel)),t}};const zI={$type:"deepl.pb.interactive_text_api.translator.GlossarySupportPropertyValue",encode:(e,t=new nI)=>t,decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossarySupportPropertyValue"};for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:zI.$type}),toJSON:e=>({})};const YI={$type:"deepl.pb.interactive_text_api.translator.GlossaryIdPropertyValue",encode:(e,t=new nI)=>(void 0!==e.glossaryId&&nR.encode(e.glossaryId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryIdPropertyValue",glossaryId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.glossaryId=nR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:YI.$type,glossaryId:fR(e.glossaryId)?nR.fromJSON(e.glossaryId):void 0}),toJSON(e){const t={};return void 0!==e.glossaryId&&(t.glossaryId=nR.toJSON(e.glossaryId)),t}};const XI={$type:"deepl.pb.interactive_text_api.translator.TextDirectionPropertyValue",encode:(e,t=new nI)=>(0!==e.textDirection&&t.uint32(8).int32(e.textDirection),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextDirectionPropertyValue",textDirection:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.textDirection=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:XI.$type,textDirection:fR(e.textDirection)?EI(e.textDirection):0}),toJSON(e){const t={};return 0!==e.textDirection&&(t.textDirection=function(e){switch(e){case TI.UNSPECIFIED:return"TEXT_DIRECTION_UNSPECIFIED";case TI.LEFT_TO_RIGHT:return"TEXT_DIRECTION_LEFT_TO_RIGHT";case TI.RIGHT_TO_LEFT:return"TEXT_DIRECTION_RIGHT_TO_LEFT";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum TextDirection")}}(e.textDirection)),t}};const KI={$type:"deepl.pb.interactive_text_api.translator.MaximumTextLengthPropertyValue",encode:(e,t=new nI)=>(0!==e.max&&t.uint32(8).int32(e.max),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.MaximumTextLengthPropertyValue",max:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.max=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:KI.$type,max:fR(e.max)?globalThis.Number(e.max):0}),toJSON(e){const t={};return 0!==e.max&&(t.max=Math.round(e.max)),t}};const QI={$type:"deepl.pb.interactive_text_api.translator.UnsupportedLanguagePropertyValue",encode:(e,t=new nI)=>t,decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.UnsupportedLanguagePropertyValue"};for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:QI.$type}),toJSON:e=>({})};const ZI={$type:"deepl.pb.interactive_text_api.translator.SessionOptions",encode:(e,t=new nI)=>(!1!==e.enableTranscription&&t.uint32(8).bool(e.enableTranscription),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SessionOptions",enableTranscription:!1};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.enableTranscription=n.bool();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:ZI.$type,enableTranscription:!!fR(e.enableTranscription)&&globalThis.Boolean(e.enableTranscription)}),toJSON(e){const t={};return!1!==e.enableTranscription&&(t.enableTranscription=e.enableTranscription),t}};const eR={$type:"deepl.pb.interactive_text_api.translator.FormalityMode",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.FormalityMode",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:eR.$type,value:fR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const tR={$type:"deepl.pb.interactive_text_api.translator.LanguageModel",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.LanguageModel",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:tR.$type,value:fR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const nR={$type:"deepl.pb.interactive_text_api.translator.GlossaryId",encode:(e,t=new nI)=>(""!==e.id&&t.uint32(10).string(e.id),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryId",id:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.id=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:nR.$type,id:fR(e.id)?globalThis.String(e.id):""}),toJSON(e){const t={};return""!==e.id&&(t.id=e.id),t}};const rR={$type:"deepl.pb.interactive_text_api.translator.GlossaryEntry",encode:(e,t=new nI)=>(""!==e.source&&t.uint32(10).string(e.source),""!==e.target&&t.uint32(18).string(e.target),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryEntry",source:"",target:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.source=n.string();continue;case 2:if(18!==e)break;o.target=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:rR.$type,source:fR(e.source)?globalThis.String(e.source):"",target:fR(e.target)?globalThis.String(e.target):""}),toJSON(e){const t={};return""!==e.source&&(t.source=e.source),""!==e.target&&(t.target=e.target),t}};const oR={$type:"deepl.pb.interactive_text_api.translator.GlossaryList",encode(e,t=new nI){for(const n of e.glossaryEntries)rR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryList",glossaryEntries:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.glossaryEntries.push(rR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:oR.$type,glossaryEntries:globalThis.Array.isArray(null==e?void 0:e.glossaryEntries)?e.glossaryEntries.map((e=>rR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.glossaryEntries)||void 0===t?void 0:t.length)&&(n.glossaryEntries=e.glossaryEntries.map((e=>rR.toJSON(e)))),n}};const sR={$type:"deepl.pb.interactive_text_api.translator.SourceLanguage",encode:(e,t=new nI)=>(""!==e.code&&t.uint32(10).string(e.code),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.SourceLanguage",code:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.code=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:sR.$type,code:fR(e.code)?globalThis.String(e.code):""}),toJSON(e){const t={};return""!==e.code&&(t.code=e.code),t}};const aR={$type:"deepl.pb.interactive_text_api.translator.TargetLanguage",encode:(e,t=new nI)=>(""!==e.code&&t.uint32(10).string(e.code),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TargetLanguage",code:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.code=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:aR.$type,code:fR(e.code)?globalThis.String(e.code):""}),toJSON(e){const t={};return""!==e.code&&(t.code=e.code),t}};const iR={$type:"deepl.pb.interactive_text_api.translator.TextUnitId",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:iR.$type,value:fR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const cR={$type:"deepl.pb.interactive_text_api.translator.WordAlternative",encode:(e,t=new nI)=>(""!==e.text&&t.uint32(10).string(e.text),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.WordAlternative",text:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.text=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:cR.$type,text:fR(e.text)?globalThis.String(e.text):""}),toJSON(e){const t={};return""!==e.text&&(t.text=e.text),t}};const lR={$type:"deepl.pb.interactive_text_api.translator.WordAlternativesFlowId",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.WordAlternativesFlowId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:lR.$type,value:fR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const uR={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternative",encode(e,t=new nI){""!==e.text&&t.uint32(10).string(e.text);for(const n of e.glossaryHighlights)dR.encode(n,t.uint32(18).fork()).join();return""!==e.transcription&&t.uint32(26).string(e.transcription),t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternative",text:"",glossaryHighlights:[],transcription:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.text=n.string();continue;case 2:if(18!==e)break;o.glossaryHighlights.push(dR.decode(n,n.uint32()));continue;case 3:if(26!==e)break;o.transcription=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:uR.$type,text:fR(e.text)?globalThis.String(e.text):"",glossaryHighlights:globalThis.Array.isArray(null==e?void 0:e.glossaryHighlights)?e.glossaryHighlights.map((e=>dR.fromJSON(e))):[],transcription:fR(e.transcription)?globalThis.String(e.transcription):""}),toJSON(e){var t;const n={};return""!==e.text&&(n.text=e.text),(null===(t=e.glossaryHighlights)||void 0===t?void 0:t.length)&&(n.glossaryHighlights=e.glossaryHighlights.map((e=>dR.toJSON(e)))),""!==e.transcription&&(n.transcription=e.transcription),n}};const dR={$type:"deepl.pb.interactive_text_api.translator.GlossaryHighlight",encode(e,t=new nI){void 0!==e.entry&&rR.encode(e.entry,t.uint32(10).fork()).join();for(const n of e.ranges)_I.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.GlossaryHighlight",entry:void 0,ranges:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.entry=rR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.ranges.push(_I.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:dR.$type,entry:fR(e.entry)?rR.fromJSON(e.entry):void 0,ranges:globalThis.Array.isArray(null==e?void 0:e.ranges)?e.ranges.map((e=>_I.fromJSON(e))):[]}),toJSON(e){var t;const n={};return void 0!==e.entry&&(n.entry=rR.toJSON(e.entry)),(null===(t=e.ranges)||void 0===t?void 0:t.length)&&(n.ranges=e.ranges.map((e=>_I.toJSON(e)))),n}};const pR={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternativesFlowId",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.TextUnitAlternativesFlowId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:pR.$type,value:fR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const hR={$type:"deepl.pb.interactive_text_api.translator.AutocompletionFlowId",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.translator.AutocompletionFlowId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:hR.$type,value:fR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};function fR(e){return null!=e}const gR={$type:"deepl.pb.interactive_text_api.write.DiffUnitAnnotationPayload",encode:(e,t=new nI)=>(void 0!==e.diffUnitId&&ER.encode(e.diffUnitId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.DiffUnitAnnotationPayload",diffUnitId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.diffUnitId=ER.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:gR.$type,diffUnitId:wR(e.diffUnitId)?ER.fromJSON(e.diffUnitId):void 0}),toJSON(e){const t={};return void 0!==e.diffUnitId&&(t.diffUnitId=ER.toJSON(e.diffUnitId)),t}};const mR={$type:"deepl.pb.interactive_text_api.write.LanguagesPropertyValue",encode(e,t=new nI){for(const n of e.languages)SR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.LanguagesPropertyValue",languages:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.languages.push(SR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:mR.$type,languages:globalThis.Array.isArray(null==e?void 0:e.languages)?e.languages.map((e=>SR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.languages)||void 0===t?void 0:t.length)&&(n.languages=e.languages.map((e=>SR.toJSON(e)))),n}};const _R={$type:"deepl.pb.interactive_text_api.write.RequestedLanguagePropertyValue",encode:(e,t=new nI)=>(void 0!==e.language&&SR.encode(e.language,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.RequestedLanguagePropertyValue",language:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.language=SR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:_R.$type,language:wR(e.language)?SR.fromJSON(e.language):void 0}),toJSON(e){const t={};return void 0!==e.language&&(t.language=SR.toJSON(e.language)),t}};const yR={$type:"deepl.pb.interactive_text_api.write.CalculatedLanguagePropertyValue",encode:(e,t=new nI)=>(void 0!==e.language&&SR.encode(e.language,t.uint32(10).fork()).join(),0!==e.origin&&t.uint32(16).int32(e.origin),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.CalculatedLanguagePropertyValue",language:void 0,origin:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.language=SR.decode(n,n.uint32());continue;case 2:if(16!==e)break;o.origin=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:yR.$type,language:wR(e.language)?SR.fromJSON(e.language):void 0,origin:wR(e.origin)?SI(e.origin):0}),toJSON(e){const t={};return void 0!==e.language&&(t.language=SR.toJSON(e.language)),0!==e.origin&&(t.origin=bI(e.origin)),t}};const vR={$type:"deepl.pb.interactive_text_api.write.StyleVariantsPropertyValue",encode(e,t=new nI){for(const n of e.styleVariants)bR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.StyleVariantsPropertyValue",styleVariants:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.styleVariants.push(bR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:vR.$type,styleVariants:globalThis.Array.isArray(null==e?void 0:e.styleVariants)?e.styleVariants.map((e=>bR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.styleVariants)||void 0===t?void 0:t.length)&&(n.styleVariants=e.styleVariants.map((e=>bR.toJSON(e)))),n}};const TR={$type:"deepl.pb.interactive_text_api.write.StyleVariantPropertyValue",encode:(e,t=new nI)=>(void 0!==e.styleVariant&&bR.encode(e.styleVariant,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.StyleVariantPropertyValue",styleVariant:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.styleVariant=bR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:TR.$type,styleVariant:wR(e.styleVariant)?bR.fromJSON(e.styleVariant):void 0}),toJSON(e){const t={};return void 0!==e.styleVariant&&(t.styleVariant=bR.toJSON(e.styleVariant)),t}};const SR={$type:"deepl.pb.interactive_text_api.write.Language",encode:(e,t=new nI)=>(""!==e.code&&t.uint32(10).string(e.code),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.Language",code:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.code=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:SR.$type,code:wR(e.code)?globalThis.String(e.code):""}),toJSON(e){const t={};return""!==e.code&&(t.code=e.code),t}};const bR={$type:"deepl.pb.interactive_text_api.write.StyleVariant",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.StyleVariant",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:bR.$type,value:wR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const ER={$type:"deepl.pb.interactive_text_api.write.DiffUnitId",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.write.DiffUnitId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:ER.$type,value:wR(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};function wR(e){return null!=e}var AR,IR,RR;function kR(e){switch(e){case 0:case"FIELD_NAME_UNSPECIFIED":return AR.UNSPECIFIED;case 1:case"FIELD_NAME_TRANSLATOR_SOURCE_TEXT":return AR.TRANSLATOR_SOURCE_TEXT;case 2:case"FIELD_NAME_TRANSLATOR_TARGET_TEXT":return AR.TRANSLATOR_TARGET_TEXT;case 4:case"FIELD_NAME_TRANSLATOR_TARGET_TRANSCRIPTION_TEXT":return AR.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT;case 5:case"FIELD_NAME_WRITE_SOURCE_TEXT":return AR.WRITE_SOURCE_TEXT;case 6:case"FIELD_NAME_WRITE_TARGET_TEXT":return AR.WRITE_TARGET_TEXT;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum FieldName")}}function CR(e){switch(e){case AR.UNSPECIFIED:return"FIELD_NAME_UNSPECIFIED";case AR.TRANSLATOR_SOURCE_TEXT:return"FIELD_NAME_TRANSLATOR_SOURCE_TEXT";case AR.TRANSLATOR_TARGET_TEXT:return"FIELD_NAME_TRANSLATOR_TARGET_TEXT";case AR.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT:return"FIELD_NAME_TRANSLATOR_TARGET_TRANSCRIPTION_TEXT";case AR.WRITE_SOURCE_TEXT:return"FIELD_NAME_WRITE_SOURCE_TEXT";case AR.WRITE_TARGET_TEXT:return"FIELD_NAME_WRITE_TARGET_TEXT";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum FieldName")}}function OR(e){switch(e){case 0:case"PROPERTY_NAME_UNSPECIFIED":return IR.UNSPECIFIED;case 1:case"PROPERTY_NAME_TRANSLATOR_SOURCE_LANGUAGES":return IR.TRANSLATOR_SOURCE_LANGUAGES;case 2:case"PROPERTY_NAME_TRANSLATOR_TARGET_LANGUAGES":return IR.TRANSLATOR_TARGET_LANGUAGES;case 3:case"PROPERTY_NAME_TRANSLATOR_REQUESTED_SOURCE_LANGUAGE":return IR.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE;case 4:case"PROPERTY_NAME_TRANSLATOR_CALCULATED_SOURCE_LANGUAGE":return IR.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE;case 5:case"PROPERTY_NAME_TRANSLATOR_REQUESTED_TARGET_LANGUAGE":return IR.TRANSLATOR_REQUESTED_TARGET_LANGUAGE;case 7:case"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODES":return IR.TRANSLATOR_FORMALITY_MODES;case 8:case"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODE":return IR.TRANSLATOR_FORMALITY_MODE;case 9:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUPPORT":return IR.TRANSLATOR_GLOSSARY_SUPPORT;case 10:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_LIST":return IR.TRANSLATOR_GLOSSARY_LIST;case 12:case"PROPERTY_NAME_TRANSLATOR_TEXT_DIRECTION":return IR.TRANSLATOR_TEXT_DIRECTION;case 13:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUGGESTIONS":return IR.TRANSLATOR_GLOSSARY_SUGGESTIONS;case 14:case"PROPERTY_NAME_MAXIMUM_TEXT_LENGTH":return IR.MAXIMUM_TEXT_LENGTH;case 15:case"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODELS":return IR.TRANSLATOR_LANGUAGE_MODELS;case 16:case"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODEL":return IR.TRANSLATOR_LANGUAGE_MODEL;case 17:case"PROPERTY_NAME_TRANSLATOR_GLOSSARY_ID":return IR.TRANSLATOR_GLOSSARY_ID;case 18:case"PROPERTY_NAME_TRANSLATOR_CALCULATED_TARGET_LANGUAGE":return IR.TRANSLATOR_CALCULATED_TARGET_LANGUAGE;case 19:case"PROPERTY_NAME_TRANSLATOR_UNSUPPORTED_LANGUAGE":return IR.TRANSLATOR_UNSUPPORTED_LANGUAGE;case 20:case"PROPERTY_NAME_WRITE_LANGUAGES":return IR.WRITE_LANGUAGES;case 21:case"PROPERTY_NAME_WRITE_REQUESTED_LANGUAGE":return IR.WRITE_REQUESTED_LANGUAGE;case 22:case"PROPERTY_NAME_WRITE_CALCULATED_LANGUAGE":return IR.WRITE_CALCULATED_LANGUAGE;case 23:case"PROPERTY_NAME_WRITE_STYLE_VARIANTS":return IR.WRITE_STYLE_VARIANTS;case 24:case"PROPERTY_NAME_WRITE_STYLE_VARIANT":return IR.WRITE_STYLE_VARIANT;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum PropertyName")}}function xR(e){switch(e){case 0:case"SESSION_MODE_UNSPECIFIED":return RR.UNSPECIFIED;case 1:case"SESSION_MODE_TRANSLATOR":return RR.TRANSLATOR;case 2:case"SESSION_MODE_WRITE":return RR.WRITE;default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum SessionMode")}}!function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRANSLATOR_SOURCE_TEXT=1]="TRANSLATOR_SOURCE_TEXT",e[e.TRANSLATOR_TARGET_TEXT=2]="TRANSLATOR_TARGET_TEXT",e[e.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT=4]="TRANSLATOR_TARGET_TRANSCRIPTION_TEXT",e[e.WRITE_SOURCE_TEXT=5]="WRITE_SOURCE_TEXT",e[e.WRITE_TARGET_TEXT=6]="WRITE_TARGET_TEXT"}(AR||(AR={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRANSLATOR_SOURCE_LANGUAGES=1]="TRANSLATOR_SOURCE_LANGUAGES",e[e.TRANSLATOR_TARGET_LANGUAGES=2]="TRANSLATOR_TARGET_LANGUAGES",e[e.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE=3]="TRANSLATOR_REQUESTED_SOURCE_LANGUAGE",e[e.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE=4]="TRANSLATOR_CALCULATED_SOURCE_LANGUAGE",e[e.TRANSLATOR_REQUESTED_TARGET_LANGUAGE=5]="TRANSLATOR_REQUESTED_TARGET_LANGUAGE",e[e.TRANSLATOR_FORMALITY_MODES=7]="TRANSLATOR_FORMALITY_MODES",e[e.TRANSLATOR_FORMALITY_MODE=8]="TRANSLATOR_FORMALITY_MODE",e[e.TRANSLATOR_GLOSSARY_SUPPORT=9]="TRANSLATOR_GLOSSARY_SUPPORT",e[e.TRANSLATOR_GLOSSARY_LIST=10]="TRANSLATOR_GLOSSARY_LIST",e[e.TRANSLATOR_TEXT_DIRECTION=12]="TRANSLATOR_TEXT_DIRECTION",e[e.TRANSLATOR_GLOSSARY_SUGGESTIONS=13]="TRANSLATOR_GLOSSARY_SUGGESTIONS",e[e.MAXIMUM_TEXT_LENGTH=14]="MAXIMUM_TEXT_LENGTH",e[e.TRANSLATOR_LANGUAGE_MODELS=15]="TRANSLATOR_LANGUAGE_MODELS",e[e.TRANSLATOR_LANGUAGE_MODEL=16]="TRANSLATOR_LANGUAGE_MODEL",e[e.TRANSLATOR_GLOSSARY_ID=17]="TRANSLATOR_GLOSSARY_ID",e[e.TRANSLATOR_CALCULATED_TARGET_LANGUAGE=18]="TRANSLATOR_CALCULATED_TARGET_LANGUAGE",e[e.TRANSLATOR_UNSUPPORTED_LANGUAGE=19]="TRANSLATOR_UNSUPPORTED_LANGUAGE",e[e.WRITE_LANGUAGES=20]="WRITE_LANGUAGES",e[e.WRITE_REQUESTED_LANGUAGE=21]="WRITE_REQUESTED_LANGUAGE",e[e.WRITE_CALCULATED_LANGUAGE=22]="WRITE_CALCULATED_LANGUAGE",e[e.WRITE_STYLE_VARIANTS=23]="WRITE_STYLE_VARIANTS",e[e.WRITE_STYLE_VARIANT=24]="WRITE_STYLE_VARIANT"}(IR||(IR={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRANSLATOR=1]="TRANSLATOR",e[e.WRITE=2]="WRITE"}(RR||(RR={}));const LR={$type:"deepl.pb.interactive_text_api.TextChangeOperation",encode:(e,t=new nI)=>(void 0!==e.range&&_I.encode(e.range,t.uint32(10).fork()).join(),""!==e.text&&t.uint32(18).string(e.text),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.TextChangeOperation",range:void 0,text:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.range=_I.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.text=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:LR.$type,range:nk(e.range)?_I.fromJSON(e.range):void 0,text:nk(e.text)?globalThis.String(e.text):""}),toJSON(e){const t={};return void 0!==e.range&&(t.range=_I.toJSON(e.range)),""!==e.text&&(t.text=e.text),t}};const NR={$type:"deepl.pb.interactive_text_api.CreateAnnotationOperation",encode:(e,t=new nI)=>(void 0!==e.annotationId&&KR.encode(e.annotationId,t.uint32(10).fork()).join(),void 0!==e.range&&_I.encode(e.range,t.uint32(18).fork()).join(),void 0!==e.translatorTextUnitPayload&&wI.encode(e.translatorTextUnitPayload,t.uint32(26).fork()).join(),void 0!==e.translatorRequestWordAlternativesPayload&&AI.encode(e.translatorRequestWordAlternativesPayload,t.uint32(34).fork()).join(),void 0!==e.translatorProvidedWordAlternativesPayload&&II.encode(e.translatorProvidedWordAlternativesPayload,t.uint32(42).fork()).join(),void 0!==e.translatorSelectWordAlternativePayload&&RI.encode(e.translatorSelectWordAlternativePayload,t.uint32(50).fork()).join(),void 0!==e.translatorGlossaryReplacementPayload&&MI.encode(e.translatorGlossaryReplacementPayload,t.uint32(58).fork()).join(),void 0!==e.translatorRequestTextUnitAlternativesPayload&&kI.encode(e.translatorRequestTextUnitAlternativesPayload,t.uint32(66).fork()).join(),void 0!==e.translatorProvidedTextUnitAlternativesPayload&&CI.encode(e.translatorProvidedTextUnitAlternativesPayload,t.uint32(74).fork()).join(),void 0!==e.translatorSelectTextUnitAlternativePayload&&OI.encode(e.translatorSelectTextUnitAlternativePayload,t.uint32(82).fork()).join(),void 0!==e.translatorRequestAutocompletionPayload&&xI.encode(e.translatorRequestAutocompletionPayload,t.uint32(90).fork()).join(),void 0!==e.translatorProvidedAutocompletionPayload&&LI.encode(e.translatorProvidedAutocompletionPayload,t.uint32(98).fork()).join(),void 0!==e.translatorSelectAutocompletionPayload&&NI.encode(e.translatorSelectAutocompletionPayload,t.uint32(106).fork()).join(),void 0!==e.translatorProvidedAutomaticTextUnitAlternativesPayload&&PI.encode(e.translatorProvidedAutomaticTextUnitAlternativesPayload,t.uint32(114).fork()).join(),void 0!==e.translatorSelectAutomaticTextUnitAlternativePayload&&DI.encode(e.translatorSelectAutomaticTextUnitAlternativePayload,t.uint32(122).fork()).join(),void 0!==e.writeDiffUnitPayload&&gR.encode(e.writeDiffUnitPayload,t.uint32(130).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.CreateAnnotationOperation",annotationId:void 0,range:void 0,translatorTextUnitPayload:void 0,translatorRequestWordAlternativesPayload:void 0,translatorProvidedWordAlternativesPayload:void 0,translatorSelectWordAlternativePayload:void 0,translatorGlossaryReplacementPayload:void 0,translatorRequestTextUnitAlternativesPayload:void 0,translatorProvidedTextUnitAlternativesPayload:void 0,translatorSelectTextUnitAlternativePayload:void 0,translatorRequestAutocompletionPayload:void 0,translatorProvidedAutocompletionPayload:void 0,translatorSelectAutocompletionPayload:void 0,translatorProvidedAutomaticTextUnitAlternativesPayload:void 0,translatorSelectAutomaticTextUnitAlternativePayload:void 0,writeDiffUnitPayload:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.annotationId=KR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.range=_I.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.translatorTextUnitPayload=wI.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.translatorRequestWordAlternativesPayload=AI.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.translatorProvidedWordAlternativesPayload=II.decode(n,n.uint32());continue;case 6:if(50!==e)break;o.translatorSelectWordAlternativePayload=RI.decode(n,n.uint32());continue;case 7:if(58!==e)break;o.translatorGlossaryReplacementPayload=MI.decode(n,n.uint32());continue;case 8:if(66!==e)break;o.translatorRequestTextUnitAlternativesPayload=kI.decode(n,n.uint32());continue;case 9:if(74!==e)break;o.translatorProvidedTextUnitAlternativesPayload=CI.decode(n,n.uint32());continue;case 10:if(82!==e)break;o.translatorSelectTextUnitAlternativePayload=OI.decode(n,n.uint32());continue;case 11:if(90!==e)break;o.translatorRequestAutocompletionPayload=xI.decode(n,n.uint32());continue;case 12:if(98!==e)break;o.translatorProvidedAutocompletionPayload=LI.decode(n,n.uint32());continue;case 13:if(106!==e)break;o.translatorSelectAutocompletionPayload=NI.decode(n,n.uint32());continue;case 14:if(114!==e)break;o.translatorProvidedAutomaticTextUnitAlternativesPayload=PI.decode(n,n.uint32());continue;case 15:if(122!==e)break;o.translatorSelectAutomaticTextUnitAlternativePayload=DI.decode(n,n.uint32());continue;case 16:if(130!==e)break;o.writeDiffUnitPayload=gR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:NR.$type,annotationId:nk(e.annotationId)?KR.fromJSON(e.annotationId):void 0,range:nk(e.range)?_I.fromJSON(e.range):void 0,translatorTextUnitPayload:nk(e.translatorTextUnitPayload)?wI.fromJSON(e.translatorTextUnitPayload):void 0,translatorRequestWordAlternativesPayload:nk(e.translatorRequestWordAlternativesPayload)?AI.fromJSON(e.translatorRequestWordAlternativesPayload):void 0,translatorProvidedWordAlternativesPayload:nk(e.translatorProvidedWordAlternativesPayload)?II.fromJSON(e.translatorProvidedWordAlternativesPayload):void 0,translatorSelectWordAlternativePayload:nk(e.translatorSelectWordAlternativePayload)?RI.fromJSON(e.translatorSelectWordAlternativePayload):void 0,translatorGlossaryReplacementPayload:nk(e.translatorGlossaryReplacementPayload)?MI.fromJSON(e.translatorGlossaryReplacementPayload):void 0,translatorRequestTextUnitAlternativesPayload:nk(e.translatorRequestTextUnitAlternativesPayload)?kI.fromJSON(e.translatorRequestTextUnitAlternativesPayload):void 0,translatorProvidedTextUnitAlternativesPayload:nk(e.translatorProvidedTextUnitAlternativesPayload)?CI.fromJSON(e.translatorProvidedTextUnitAlternativesPayload):void 0,translatorSelectTextUnitAlternativePayload:nk(e.translatorSelectTextUnitAlternativePayload)?OI.fromJSON(e.translatorSelectTextUnitAlternativePayload):void 0,translatorRequestAutocompletionPayload:nk(e.translatorRequestAutocompletionPayload)?xI.fromJSON(e.translatorRequestAutocompletionPayload):void 0,translatorProvidedAutocompletionPayload:nk(e.translatorProvidedAutocompletionPayload)?LI.fromJSON(e.translatorProvidedAutocompletionPayload):void 0,translatorSelectAutocompletionPayload:nk(e.translatorSelectAutocompletionPayload)?NI.fromJSON(e.translatorSelectAutocompletionPayload):void 0,translatorProvidedAutomaticTextUnitAlternativesPayload:nk(e.translatorProvidedAutomaticTextUnitAlternativesPayload)?PI.fromJSON(e.translatorProvidedAutomaticTextUnitAlternativesPayload):void 0,translatorSelectAutomaticTextUnitAlternativePayload:nk(e.translatorSelectAutomaticTextUnitAlternativePayload)?DI.fromJSON(e.translatorSelectAutomaticTextUnitAlternativePayload):void 0,writeDiffUnitPayload:nk(e.writeDiffUnitPayload)?gR.fromJSON(e.writeDiffUnitPayload):void 0}),toJSON(e){const t={};return void 0!==e.annotationId&&(t.annotationId=KR.toJSON(e.annotationId)),void 0!==e.range&&(t.range=_I.toJSON(e.range)),void 0!==e.translatorTextUnitPayload&&(t.translatorTextUnitPayload=wI.toJSON(e.translatorTextUnitPayload)),void 0!==e.translatorRequestWordAlternativesPayload&&(t.translatorRequestWordAlternativesPayload=AI.toJSON(e.translatorRequestWordAlternativesPayload)),void 0!==e.translatorProvidedWordAlternativesPayload&&(t.translatorProvidedWordAlternativesPayload=II.toJSON(e.translatorProvidedWordAlternativesPayload)),void 0!==e.translatorSelectWordAlternativePayload&&(t.translatorSelectWordAlternativePayload=RI.toJSON(e.translatorSelectWordAlternativePayload)),void 0!==e.translatorGlossaryReplacementPayload&&(t.translatorGlossaryReplacementPayload=MI.toJSON(e.translatorGlossaryReplacementPayload)),void 0!==e.translatorRequestTextUnitAlternativesPayload&&(t.translatorRequestTextUnitAlternativesPayload=kI.toJSON(e.translatorRequestTextUnitAlternativesPayload)),void 0!==e.translatorProvidedTextUnitAlternativesPayload&&(t.translatorProvidedTextUnitAlternativesPayload=CI.toJSON(e.translatorProvidedTextUnitAlternativesPayload)),void 0!==e.translatorSelectTextUnitAlternativePayload&&(t.translatorSelectTextUnitAlternativePayload=OI.toJSON(e.translatorSelectTextUnitAlternativePayload)),void 0!==e.translatorRequestAutocompletionPayload&&(t.translatorRequestAutocompletionPayload=xI.toJSON(e.translatorRequestAutocompletionPayload)),void 0!==e.translatorProvidedAutocompletionPayload&&(t.translatorProvidedAutocompletionPayload=LI.toJSON(e.translatorProvidedAutocompletionPayload)),void 0!==e.translatorSelectAutocompletionPayload&&(t.translatorSelectAutocompletionPayload=NI.toJSON(e.translatorSelectAutocompletionPayload)),void 0!==e.translatorProvidedAutomaticTextUnitAlternativesPayload&&(t.translatorProvidedAutomaticTextUnitAlternativesPayload=PI.toJSON(e.translatorProvidedAutomaticTextUnitAlternativesPayload)),void 0!==e.translatorSelectAutomaticTextUnitAlternativePayload&&(t.translatorSelectAutomaticTextUnitAlternativePayload=DI.toJSON(e.translatorSelectAutomaticTextUnitAlternativePayload)),void 0!==e.writeDiffUnitPayload&&(t.writeDiffUnitPayload=gR.toJSON(e.writeDiffUnitPayload)),t}};const PR={$type:"deepl.pb.interactive_text_api.RemoveAnnotationOperation",encode:(e,t=new nI)=>(void 0!==e.annotationId&&KR.encode(e.annotationId,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.RemoveAnnotationOperation",annotationId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.annotationId=KR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:PR.$type,annotationId:nk(e.annotationId)?KR.fromJSON(e.annotationId):void 0}),toJSON(e){const t={};return void 0!==e.annotationId&&(t.annotationId=KR.toJSON(e.annotationId)),t}};const DR={$type:"deepl.pb.interactive_text_api.SetPropertyOperation",encode:(e,t=new nI)=>(0!==e.propertyName&&t.uint32(8).int32(e.propertyName),void 0!==e.translatorSourceLanguagesValue&&UI.encode(e.translatorSourceLanguagesValue,t.uint32(18).fork()).join(),void 0!==e.translatorTargetLanguagesValue&&$I.encode(e.translatorTargetLanguagesValue,t.uint32(26).fork()).join(),void 0!==e.translatorRequestedSourceLanguageValue&&FI.encode(e.translatorRequestedSourceLanguageValue,t.uint32(34).fork()).join(),void 0!==e.translatorRequestedTargetLanguageValue&&jI.encode(e.translatorRequestedTargetLanguageValue,t.uint32(42).fork()).join(),void 0!==e.translatorFormalityModesValue&&qI.encode(e.translatorFormalityModesValue,t.uint32(58).fork()).join(),void 0!==e.translatorFormalityModeValue&&BI.encode(e.translatorFormalityModeValue,t.uint32(66).fork()).join(),void 0!==e.translatorGlossarySupportValue&&zI.encode(e.translatorGlossarySupportValue,t.uint32(74).fork()).join(),void 0!==e.translatorGlossaryListValue&&oR.encode(e.translatorGlossaryListValue,t.uint32(82).fork()).join(),void 0!==e.textDirectionValue&&XI.encode(e.textDirectionValue,t.uint32(98).fork()).join(),void 0!==e.translatorCalculatedSourceLanguageValue&&GI.encode(e.translatorCalculatedSourceLanguageValue,t.uint32(106).fork()).join(),void 0!==e.maximumTextLengthValue&&KI.encode(e.maximumTextLengthValue,t.uint32(114).fork()).join(),void 0!==e.translatorLanguageModelsValue&&HI.encode(e.translatorLanguageModelsValue,t.uint32(122).fork()).join(),void 0!==e.translatorLanguageModelValue&&JI.encode(e.translatorLanguageModelValue,t.uint32(130).fork()).join(),void 0!==e.translatorGlossaryIdValue&&YI.encode(e.translatorGlossaryIdValue,t.uint32(138).fork()).join(),void 0!==e.translatorCalculatedTargetLanguageValue&&VI.encode(e.translatorCalculatedTargetLanguageValue,t.uint32(146).fork()).join(),void 0!==e.translatorUnsupportedSourceLanguageValue&&QI.encode(e.translatorUnsupportedSourceLanguageValue,t.uint32(154).fork()).join(),void 0!==e.writeLanguagesValue&&mR.encode(e.writeLanguagesValue,t.uint32(162).fork()).join(),void 0!==e.writeRequestedLanguageValue&&_R.encode(e.writeRequestedLanguageValue,t.uint32(170).fork()).join(),void 0!==e.writeCalculatedLanguageValue&&yR.encode(e.writeCalculatedLanguageValue,t.uint32(178).fork()).join(),void 0!==e.writeStyleVariantsValue&&vR.encode(e.writeStyleVariantsValue,t.uint32(186).fork()).join(),void 0!==e.writeStyleVariantValue&&TR.encode(e.writeStyleVariantValue,t.uint32(194).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.SetPropertyOperation",propertyName:0,translatorSourceLanguagesValue:void 0,translatorTargetLanguagesValue:void 0,translatorRequestedSourceLanguageValue:void 0,translatorRequestedTargetLanguageValue:void 0,translatorFormalityModesValue:void 0,translatorFormalityModeValue:void 0,translatorGlossarySupportValue:void 0,translatorGlossaryListValue:void 0,textDirectionValue:void 0,translatorCalculatedSourceLanguageValue:void 0,maximumTextLengthValue:void 0,translatorLanguageModelsValue:void 0,translatorLanguageModelValue:void 0,translatorGlossaryIdValue:void 0,translatorCalculatedTargetLanguageValue:void 0,translatorUnsupportedSourceLanguageValue:void 0,writeLanguagesValue:void 0,writeRequestedLanguageValue:void 0,writeCalculatedLanguageValue:void 0,writeStyleVariantsValue:void 0,writeStyleVariantValue:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.propertyName=n.int32();continue;case 2:if(18!==e)break;o.translatorSourceLanguagesValue=UI.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.translatorTargetLanguagesValue=$I.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.translatorRequestedSourceLanguageValue=FI.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.translatorRequestedTargetLanguageValue=jI.decode(n,n.uint32());continue;case 7:if(58!==e)break;o.translatorFormalityModesValue=qI.decode(n,n.uint32());continue;case 8:if(66!==e)break;o.translatorFormalityModeValue=BI.decode(n,n.uint32());continue;case 9:if(74!==e)break;o.translatorGlossarySupportValue=zI.decode(n,n.uint32());continue;case 10:if(82!==e)break;o.translatorGlossaryListValue=oR.decode(n,n.uint32());continue;case 12:if(98!==e)break;o.textDirectionValue=XI.decode(n,n.uint32());continue;case 13:if(106!==e)break;o.translatorCalculatedSourceLanguageValue=GI.decode(n,n.uint32());continue;case 14:if(114!==e)break;o.maximumTextLengthValue=KI.decode(n,n.uint32());continue;case 15:if(122!==e)break;o.translatorLanguageModelsValue=HI.decode(n,n.uint32());continue;case 16:if(130!==e)break;o.translatorLanguageModelValue=JI.decode(n,n.uint32());continue;case 17:if(138!==e)break;o.translatorGlossaryIdValue=YI.decode(n,n.uint32());continue;case 18:if(146!==e)break;o.translatorCalculatedTargetLanguageValue=VI.decode(n,n.uint32());continue;case 19:if(154!==e)break;o.translatorUnsupportedSourceLanguageValue=QI.decode(n,n.uint32());continue;case 20:if(162!==e)break;o.writeLanguagesValue=mR.decode(n,n.uint32());continue;case 21:if(170!==e)break;o.writeRequestedLanguageValue=_R.decode(n,n.uint32());continue;case 22:if(178!==e)break;o.writeCalculatedLanguageValue=yR.decode(n,n.uint32());continue;case 23:if(186!==e)break;o.writeStyleVariantsValue=vR.decode(n,n.uint32());continue;case 24:if(194!==e)break;o.writeStyleVariantValue=TR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:DR.$type,propertyName:nk(e.propertyName)?OR(e.propertyName):0,translatorSourceLanguagesValue:nk(e.translatorSourceLanguagesValue)?UI.fromJSON(e.translatorSourceLanguagesValue):void 0,translatorTargetLanguagesValue:nk(e.translatorTargetLanguagesValue)?$I.fromJSON(e.translatorTargetLanguagesValue):void 0,translatorRequestedSourceLanguageValue:nk(e.translatorRequestedSourceLanguageValue)?FI.fromJSON(e.translatorRequestedSourceLanguageValue):void 0,translatorRequestedTargetLanguageValue:nk(e.translatorRequestedTargetLanguageValue)?jI.fromJSON(e.translatorRequestedTargetLanguageValue):void 0,translatorFormalityModesValue:nk(e.translatorFormalityModesValue)?qI.fromJSON(e.translatorFormalityModesValue):void 0,translatorFormalityModeValue:nk(e.translatorFormalityModeValue)?BI.fromJSON(e.translatorFormalityModeValue):void 0,translatorGlossarySupportValue:nk(e.translatorGlossarySupportValue)?zI.fromJSON(e.translatorGlossarySupportValue):void 0,translatorGlossaryListValue:nk(e.translatorGlossaryListValue)?oR.fromJSON(e.translatorGlossaryListValue):void 0,textDirectionValue:nk(e.textDirectionValue)?XI.fromJSON(e.textDirectionValue):void 0,translatorCalculatedSourceLanguageValue:nk(e.translatorCalculatedSourceLanguageValue)?GI.fromJSON(e.translatorCalculatedSourceLanguageValue):void 0,maximumTextLengthValue:nk(e.maximumTextLengthValue)?KI.fromJSON(e.maximumTextLengthValue):void 0,translatorLanguageModelsValue:nk(e.translatorLanguageModelsValue)?HI.fromJSON(e.translatorLanguageModelsValue):void 0,translatorLanguageModelValue:nk(e.translatorLanguageModelValue)?JI.fromJSON(e.translatorLanguageModelValue):void 0,translatorGlossaryIdValue:nk(e.translatorGlossaryIdValue)?YI.fromJSON(e.translatorGlossaryIdValue):void 0,translatorCalculatedTargetLanguageValue:nk(e.translatorCalculatedTargetLanguageValue)?VI.fromJSON(e.translatorCalculatedTargetLanguageValue):void 0,translatorUnsupportedSourceLanguageValue:nk(e.translatorUnsupportedSourceLanguageValue)?QI.fromJSON(e.translatorUnsupportedSourceLanguageValue):void 0,writeLanguagesValue:nk(e.writeLanguagesValue)?mR.fromJSON(e.writeLanguagesValue):void 0,writeRequestedLanguageValue:nk(e.writeRequestedLanguageValue)?_R.fromJSON(e.writeRequestedLanguageValue):void 0,writeCalculatedLanguageValue:nk(e.writeCalculatedLanguageValue)?yR.fromJSON(e.writeCalculatedLanguageValue):void 0,writeStyleVariantsValue:nk(e.writeStyleVariantsValue)?vR.fromJSON(e.writeStyleVariantsValue):void 0,writeStyleVariantValue:nk(e.writeStyleVariantValue)?TR.fromJSON(e.writeStyleVariantValue):void 0}),toJSON(e){const t={};return 0!==e.propertyName&&(t.propertyName=function(e){switch(e){case IR.UNSPECIFIED:return"PROPERTY_NAME_UNSPECIFIED";case IR.TRANSLATOR_SOURCE_LANGUAGES:return"PROPERTY_NAME_TRANSLATOR_SOURCE_LANGUAGES";case IR.TRANSLATOR_TARGET_LANGUAGES:return"PROPERTY_NAME_TRANSLATOR_TARGET_LANGUAGES";case IR.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_REQUESTED_SOURCE_LANGUAGE";case IR.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_CALCULATED_SOURCE_LANGUAGE";case IR.TRANSLATOR_REQUESTED_TARGET_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_REQUESTED_TARGET_LANGUAGE";case IR.TRANSLATOR_FORMALITY_MODES:return"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODES";case IR.TRANSLATOR_FORMALITY_MODE:return"PROPERTY_NAME_TRANSLATOR_FORMALITY_MODE";case IR.TRANSLATOR_GLOSSARY_SUPPORT:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUPPORT";case IR.TRANSLATOR_GLOSSARY_LIST:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_LIST";case IR.TRANSLATOR_TEXT_DIRECTION:return"PROPERTY_NAME_TRANSLATOR_TEXT_DIRECTION";case IR.TRANSLATOR_GLOSSARY_SUGGESTIONS:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_SUGGESTIONS";case IR.MAXIMUM_TEXT_LENGTH:return"PROPERTY_NAME_MAXIMUM_TEXT_LENGTH";case IR.TRANSLATOR_LANGUAGE_MODELS:return"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODELS";case IR.TRANSLATOR_LANGUAGE_MODEL:return"PROPERTY_NAME_TRANSLATOR_LANGUAGE_MODEL";case IR.TRANSLATOR_GLOSSARY_ID:return"PROPERTY_NAME_TRANSLATOR_GLOSSARY_ID";case IR.TRANSLATOR_CALCULATED_TARGET_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_CALCULATED_TARGET_LANGUAGE";case IR.TRANSLATOR_UNSUPPORTED_LANGUAGE:return"PROPERTY_NAME_TRANSLATOR_UNSUPPORTED_LANGUAGE";case IR.WRITE_LANGUAGES:return"PROPERTY_NAME_WRITE_LANGUAGES";case IR.WRITE_REQUESTED_LANGUAGE:return"PROPERTY_NAME_WRITE_REQUESTED_LANGUAGE";case IR.WRITE_CALCULATED_LANGUAGE:return"PROPERTY_NAME_WRITE_CALCULATED_LANGUAGE";case IR.WRITE_STYLE_VARIANTS:return"PROPERTY_NAME_WRITE_STYLE_VARIANTS";case IR.WRITE_STYLE_VARIANT:return"PROPERTY_NAME_WRITE_STYLE_VARIANT";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum PropertyName")}}(e.propertyName)),void 0!==e.translatorSourceLanguagesValue&&(t.translatorSourceLanguagesValue=UI.toJSON(e.translatorSourceLanguagesValue)),void 0!==e.translatorTargetLanguagesValue&&(t.translatorTargetLanguagesValue=$I.toJSON(e.translatorTargetLanguagesValue)),void 0!==e.translatorRequestedSourceLanguageValue&&(t.translatorRequestedSourceLanguageValue=FI.toJSON(e.translatorRequestedSourceLanguageValue)),void 0!==e.translatorRequestedTargetLanguageValue&&(t.translatorRequestedTargetLanguageValue=jI.toJSON(e.translatorRequestedTargetLanguageValue)),void 0!==e.translatorFormalityModesValue&&(t.translatorFormalityModesValue=qI.toJSON(e.translatorFormalityModesValue)),void 0!==e.translatorFormalityModeValue&&(t.translatorFormalityModeValue=BI.toJSON(e.translatorFormalityModeValue)),void 0!==e.translatorGlossarySupportValue&&(t.translatorGlossarySupportValue=zI.toJSON(e.translatorGlossarySupportValue)),void 0!==e.translatorGlossaryListValue&&(t.translatorGlossaryListValue=oR.toJSON(e.translatorGlossaryListValue)),void 0!==e.textDirectionValue&&(t.textDirectionValue=XI.toJSON(e.textDirectionValue)),void 0!==e.translatorCalculatedSourceLanguageValue&&(t.translatorCalculatedSourceLanguageValue=GI.toJSON(e.translatorCalculatedSourceLanguageValue)),void 0!==e.maximumTextLengthValue&&(t.maximumTextLengthValue=KI.toJSON(e.maximumTextLengthValue)),void 0!==e.translatorLanguageModelsValue&&(t.translatorLanguageModelsValue=HI.toJSON(e.translatorLanguageModelsValue)),void 0!==e.translatorLanguageModelValue&&(t.translatorLanguageModelValue=JI.toJSON(e.translatorLanguageModelValue)),void 0!==e.translatorGlossaryIdValue&&(t.translatorGlossaryIdValue=YI.toJSON(e.translatorGlossaryIdValue)),void 0!==e.translatorCalculatedTargetLanguageValue&&(t.translatorCalculatedTargetLanguageValue=VI.toJSON(e.translatorCalculatedTargetLanguageValue)),void 0!==e.translatorUnsupportedSourceLanguageValue&&(t.translatorUnsupportedSourceLanguageValue=QI.toJSON(e.translatorUnsupportedSourceLanguageValue)),void 0!==e.writeLanguagesValue&&(t.writeLanguagesValue=mR.toJSON(e.writeLanguagesValue)),void 0!==e.writeRequestedLanguageValue&&(t.writeRequestedLanguageValue=_R.toJSON(e.writeRequestedLanguageValue)),void 0!==e.writeCalculatedLanguageValue&&(t.writeCalculatedLanguageValue=yR.toJSON(e.writeCalculatedLanguageValue)),void 0!==e.writeStyleVariantsValue&&(t.writeStyleVariantsValue=vR.toJSON(e.writeStyleVariantsValue)),void 0!==e.writeStyleVariantValue&&(t.writeStyleVariantValue=TR.toJSON(e.writeStyleVariantValue)),t}};const MR={$type:"deepl.pb.interactive_text_api.StartSessionRequest",encode:(e,t=new nI)=>(0!==e.sessionMode&&t.uint32(8).int32(e.sessionMode),void 0!==e.baseDocument&&QR.encode(e.baseDocument,t.uint32(18).fork()).join(),void 0!==e.translatorSessionOptions&&ZI.encode(e.translatorSessionOptions,t.uint32(26).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.StartSessionRequest",sessionMode:0,baseDocument:void 0,translatorSessionOptions:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.sessionMode=n.int32();continue;case 2:if(18!==e)break;o.baseDocument=QR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.translatorSessionOptions=ZI.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:MR.$type,sessionMode:nk(e.sessionMode)?xR(e.sessionMode):0,baseDocument:nk(e.baseDocument)?QR.fromJSON(e.baseDocument):void 0,translatorSessionOptions:nk(e.translatorSessionOptions)?ZI.fromJSON(e.translatorSessionOptions):void 0}),toJSON(e){const t={};return 0!==e.sessionMode&&(t.sessionMode=function(e){switch(e){case RR.UNSPECIFIED:return"SESSION_MODE_UNSPECIFIED";case RR.TRANSLATOR:return"SESSION_MODE_TRANSLATOR";case RR.WRITE:return"SESSION_MODE_WRITE";default:throw new globalThis.Error("Unrecognized enum value "+e+" for enum SessionMode")}}(e.sessionMode)),void 0!==e.baseDocument&&(t.baseDocument=QR.toJSON(e.baseDocument)),void 0!==e.translatorSessionOptions&&(t.translatorSessionOptions=ZI.toJSON(e.translatorSessionOptions)),t}};const UR={$type:"deepl.pb.interactive_text_api.StartSessionResponse",encode:(e,t=new nI)=>(void 0!==e.sessionId&&JR.encode(e.sessionId,t.uint32(10).fork()).join(),void 0!==e.participantId&&XR.encode(e.participantId,t.uint32(18).fork()).join(),""!==e.sessionToken&&t.uint32(26).string(e.sessionToken),void 0!==e.versionRemovedAt&&hI.encode(function(e){const t=Math.trunc(e.getTime()/1e3),n=e.getTime()%1e3*1e6;return{$type:"google.protobuf.Timestamp",seconds:t,nanos:n}}(e.versionRemovedAt),t.uint32(34).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.StartSessionResponse",sessionId:void 0,participantId:void 0,sessionToken:"",versionRemovedAt:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.sessionId=JR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.participantId=XR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.sessionToken=n.string();continue;case 4:if(34!==e)break;o.versionRemovedAt=ek(hI.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:UR.$type,sessionId:nk(e.sessionId)?JR.fromJSON(e.sessionId):void 0,participantId:nk(e.participantId)?XR.fromJSON(e.participantId):void 0,sessionToken:nk(e.sessionToken)?globalThis.String(e.sessionToken):"",versionRemovedAt:nk(e.versionRemovedAt)?tk(e.versionRemovedAt):void 0}),toJSON(e){const t={};return void 0!==e.sessionId&&(t.sessionId=JR.toJSON(e.sessionId)),void 0!==e.participantId&&(t.participantId=XR.toJSON(e.participantId)),""!==e.sessionToken&&(t.sessionToken=e.sessionToken),void 0!==e.versionRemovedAt&&(t.versionRemovedAt=e.versionRemovedAt.toISOString()),t}};const $R={$type:"deepl.pb.interactive_text_api.ParticipantRequest",encode:(e,t=new nI)=>(void 0!==e.appendMessage&&BR.encode(e.appendMessage,t.uint32(10).fork()).join(),void 0!==e.updateAuthenticationTokenMessage&&HR.encode(e.updateAuthenticationTokenMessage,t.uint32(18).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ParticipantRequest",appendMessage:void 0,updateAuthenticationTokenMessage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.appendMessage=BR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.updateAuthenticationTokenMessage=HR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:$R.$type,appendMessage:nk(e.appendMessage)?BR.fromJSON(e.appendMessage):void 0,updateAuthenticationTokenMessage:nk(e.updateAuthenticationTokenMessage)?HR.fromJSON(e.updateAuthenticationTokenMessage):void 0}),toJSON(e){const t={};return void 0!==e.appendMessage&&(t.appendMessage=BR.toJSON(e.appendMessage)),void 0!==e.updateAuthenticationTokenMessage&&(t.updateAuthenticationTokenMessage=HR.toJSON(e.updateAuthenticationTokenMessage)),t}};const FR={$type:"deepl.pb.interactive_text_api.ParticipantResponse",encode:(e,t=new nI)=>(void 0!==e.confirmedMessage&&GR.encode(e.confirmedMessage,t.uint32(10).fork()).join(),void 0!==e.initializedMessage&&jR.encode(e.initializedMessage,t.uint32(18).fork()).join(),void 0!==e.publishedMessage&&VR.encode(e.publishedMessage,t.uint32(26).fork()).join(),void 0!==e.metaInfoMessage&&WR.encode(e.metaInfoMessage,t.uint32(34).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ParticipantResponse",confirmedMessage:void 0,initializedMessage:void 0,publishedMessage:void 0,metaInfoMessage:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.confirmedMessage=GR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.initializedMessage=jR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.publishedMessage=VR.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.metaInfoMessage=WR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:FR.$type,confirmedMessage:nk(e.confirmedMessage)?GR.fromJSON(e.confirmedMessage):void 0,initializedMessage:nk(e.initializedMessage)?jR.fromJSON(e.initializedMessage):void 0,publishedMessage:nk(e.publishedMessage)?VR.fromJSON(e.publishedMessage):void 0,metaInfoMessage:nk(e.metaInfoMessage)?WR.fromJSON(e.metaInfoMessage):void 0}),toJSON(e){const t={};return void 0!==e.confirmedMessage&&(t.confirmedMessage=GR.toJSON(e.confirmedMessage)),void 0!==e.initializedMessage&&(t.initializedMessage=jR.toJSON(e.initializedMessage)),void 0!==e.publishedMessage&&(t.publishedMessage=VR.toJSON(e.publishedMessage)),void 0!==e.metaInfoMessage&&(t.metaInfoMessage=WR.toJSON(e.metaInfoMessage)),t}};const GR={$type:"deepl.pb.interactive_text_api.ConfirmedMessage",encode:(e,t=new nI)=>(void 0!==e.currentVersion&&zR.encode(e.currentVersion,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ConfirmedMessage",currentVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.currentVersion=zR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:GR.$type,currentVersion:nk(e.currentVersion)?zR.fromJSON(e.currentVersion):void 0}),toJSON(e){const t={};return void 0!==e.currentVersion&&(t.currentVersion=zR.toJSON(e.currentVersion)),t}};const jR={$type:"deepl.pb.interactive_text_api.InitializedMessage",encode:(e,t=new nI)=>t,decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.InitializedMessage"};for(;n.pos<r;){const e=n.uint32();if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:jR.$type}),toJSON:e=>({})};const VR={$type:"deepl.pb.interactive_text_api.PublishedMessage",encode(e,t=new nI){for(const n of e.events)YR.encode(n,t.uint32(10).fork()).join();return void 0!==e.currentVersion&&zR.encode(e.currentVersion,t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.PublishedMessage",events:[],currentVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.events.push(YR.decode(n,n.uint32()));continue;case 2:if(18!==e)break;o.currentVersion=zR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:VR.$type,events:globalThis.Array.isArray(null==e?void 0:e.events)?e.events.map((e=>YR.fromJSON(e))):[],currentVersion:nk(e.currentVersion)?zR.fromJSON(e.currentVersion):void 0}),toJSON(e){var t;const n={};return(null===(t=e.events)||void 0===t?void 0:t.length)&&(n.events=e.events.map((e=>YR.toJSON(e)))),void 0!==e.currentVersion&&(n.currentVersion=zR.toJSON(e.currentVersion)),n}};const WR={$type:"deepl.pb.interactive_text_api.MetaInfoMessage",encode:(e,t=new nI)=>(void 0!==e.idle&&qR.encode(e.idle,t.uint32(10).fork()).join(),void 0!==e.translatorTaskMetaInfo&&WI.encode(e.translatorTaskMetaInfo,t.uint32(18).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.MetaInfoMessage",idle:void 0,translatorTaskMetaInfo:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.idle=qR.decode(n,n.uint32());continue;case 2:if(18!==e)break;o.translatorTaskMetaInfo=WI.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:WR.$type,idle:nk(e.idle)?qR.fromJSON(e.idle):void 0,translatorTaskMetaInfo:nk(e.translatorTaskMetaInfo)?WI.fromJSON(e.translatorTaskMetaInfo):void 0}),toJSON(e){const t={};return void 0!==e.idle&&(t.idle=qR.toJSON(e.idle)),void 0!==e.translatorTaskMetaInfo&&(t.translatorTaskMetaInfo=WI.toJSON(e.translatorTaskMetaInfo)),t}};const qR={$type:"deepl.pb.interactive_text_api.Idle",encode:(e,t=new nI)=>(void 0!==e.eventVersion&&zR.encode(e.eventVersion,t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.Idle",eventVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.eventVersion=zR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:qR.$type,eventVersion:nk(e.eventVersion)?zR.fromJSON(e.eventVersion):void 0}),toJSON(e){const t={};return void 0!==e.eventVersion&&(t.eventVersion=zR.toJSON(e.eventVersion)),t}};const BR={$type:"deepl.pb.interactive_text_api.AppendMessage",encode(e,t=new nI){for(const n of e.events)YR.encode(n,t.uint32(10).fork()).join();return void 0!==e.baseVersion&&zR.encode(e.baseVersion,t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.AppendMessage",events:[],baseVersion:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.events.push(YR.decode(n,n.uint32()));continue;case 2:if(18!==e)break;o.baseVersion=zR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:BR.$type,events:globalThis.Array.isArray(null==e?void 0:e.events)?e.events.map((e=>YR.fromJSON(e))):[],baseVersion:nk(e.baseVersion)?zR.fromJSON(e.baseVersion):void 0}),toJSON(e){var t;const n={};return(null===(t=e.events)||void 0===t?void 0:t.length)&&(n.events=e.events.map((e=>YR.toJSON(e)))),void 0!==e.baseVersion&&(n.baseVersion=zR.toJSON(e.baseVersion)),n}};const HR={$type:"deepl.pb.interactive_text_api.UpdateAuthenticationTokenMessage",encode:(e,t=new nI)=>(""!==e.token&&t.uint32(10).string(e.token),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.UpdateAuthenticationTokenMessage",token:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.token=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:HR.$type,token:nk(e.token)?globalThis.String(e.token):""}),toJSON(e){const t={};return""!==e.token&&(t.token=e.token),t}};const JR={$type:"deepl.pb.interactive_text_api.SessionId",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.SessionId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:JR.$type,value:nk(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const zR={$type:"deepl.pb.interactive_text_api.EventVersion",encode:(e,t=new nI)=>(void 0!==e.version&&mI.encode({$type:"google.protobuf.Int32Value",value:e.version},t.uint32(10).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.EventVersion",version:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.version=mI.decode(n,n.uint32()).value;continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:zR.$type,version:nk(e.version)?Number(e.version):void 0}),toJSON(e){const t={};return void 0!==e.version&&(t.version=e.version),t}};const YR={$type:"deepl.pb.interactive_text_api.FieldEvent",encode:(e,t=new nI)=>(0!==e.fieldName&&t.uint32(8).int32(e.fieldName),void 0!==e.textChangeOperation&&LR.encode(e.textChangeOperation,t.uint32(18).fork()).join(),void 0!==e.createAnnotationOperation&&NR.encode(e.createAnnotationOperation,t.uint32(26).fork()).join(),void 0!==e.removeAnnotationOperation&&PR.encode(e.removeAnnotationOperation,t.uint32(34).fork()).join(),void 0!==e.setPropertyOperation&&DR.encode(e.setPropertyOperation,t.uint32(42).fork()).join(),void 0!==e.participantId&&XR.encode(e.participantId,t.uint32(50).fork()).join(),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.FieldEvent",fieldName:0,textChangeOperation:void 0,createAnnotationOperation:void 0,removeAnnotationOperation:void 0,setPropertyOperation:void 0,participantId:void 0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.fieldName=n.int32();continue;case 2:if(18!==e)break;o.textChangeOperation=LR.decode(n,n.uint32());continue;case 3:if(26!==e)break;o.createAnnotationOperation=NR.decode(n,n.uint32());continue;case 4:if(34!==e)break;o.removeAnnotationOperation=PR.decode(n,n.uint32());continue;case 5:if(42!==e)break;o.setPropertyOperation=DR.decode(n,n.uint32());continue;case 6:if(50!==e)break;o.participantId=XR.decode(n,n.uint32());continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:YR.$type,fieldName:nk(e.fieldName)?kR(e.fieldName):0,textChangeOperation:nk(e.textChangeOperation)?LR.fromJSON(e.textChangeOperation):void 0,createAnnotationOperation:nk(e.createAnnotationOperation)?NR.fromJSON(e.createAnnotationOperation):void 0,removeAnnotationOperation:nk(e.removeAnnotationOperation)?PR.fromJSON(e.removeAnnotationOperation):void 0,setPropertyOperation:nk(e.setPropertyOperation)?DR.fromJSON(e.setPropertyOperation):void 0,participantId:nk(e.participantId)?XR.fromJSON(e.participantId):void 0}),toJSON(e){const t={};return 0!==e.fieldName&&(t.fieldName=CR(e.fieldName)),void 0!==e.textChangeOperation&&(t.textChangeOperation=LR.toJSON(e.textChangeOperation)),void 0!==e.createAnnotationOperation&&(t.createAnnotationOperation=NR.toJSON(e.createAnnotationOperation)),void 0!==e.removeAnnotationOperation&&(t.removeAnnotationOperation=PR.toJSON(e.removeAnnotationOperation)),void 0!==e.setPropertyOperation&&(t.setPropertyOperation=DR.toJSON(e.setPropertyOperation)),void 0!==e.participantId&&(t.participantId=XR.toJSON(e.participantId)),t}};const XR={$type:"deepl.pb.interactive_text_api.ParticipantId",encode:(e,t=new nI)=>(0!==e.value&&t.uint32(8).int32(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.ParticipantId",value:0};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.value=n.int32();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:XR.$type,value:nk(e.value)?globalThis.Number(e.value):0}),toJSON(e){const t={};return 0!==e.value&&(t.value=Math.round(e.value)),t}};const KR={$type:"deepl.pb.interactive_text_api.AnnotationId",encode:(e,t=new nI)=>(""!==e.value&&t.uint32(10).string(e.value),t),decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.AnnotationId",value:""};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.value=n.string();continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:KR.$type,value:nk(e.value)?globalThis.String(e.value):""}),toJSON(e){const t={};return""!==e.value&&(t.value=e.value),t}};const QR={$type:"deepl.pb.interactive_text_api.BaseDocument",encode(e,t=new nI){for(const n of e.fields)ZR.encode(n,t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.BaseDocument",fields:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(10!==e)break;o.fields.push(ZR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:QR.$type,fields:globalThis.Array.isArray(null==e?void 0:e.fields)?e.fields.map((e=>ZR.fromJSON(e))):[]}),toJSON(e){var t;const n={};return(null===(t=e.fields)||void 0===t?void 0:t.length)&&(n.fields=e.fields.map((e=>ZR.toJSON(e)))),n}};const ZR={$type:"deepl.pb.interactive_text_api.Field",encode(e,t=new nI){0!==e.fieldName&&t.uint32(8).int32(e.fieldName),""!==e.text&&t.uint32(18).string(e.text);for(const n of e.annotations)NR.encode(n,t.uint32(26).fork()).join();for(const n of e.properties)DR.encode(n,t.uint32(34).fork()).join();return t},decode(e,t){const n=e instanceof rI?e:new rI(e);let r=void 0===t?n.len:n.pos+t;const o={$type:"deepl.pb.interactive_text_api.Field",fieldName:0,text:"",annotations:[],properties:[]};for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:if(8!==e)break;o.fieldName=n.int32();continue;case 2:if(18!==e)break;o.text=n.string();continue;case 3:if(26!==e)break;o.annotations.push(NR.decode(n,n.uint32()));continue;case 4:if(34!==e)break;o.properties.push(DR.decode(n,n.uint32()));continue}if(4==(7&e)||0===e)break;n.skip(7&e)}return o},fromJSON:e=>({$type:ZR.$type,fieldName:nk(e.fieldName)?kR(e.fieldName):0,text:nk(e.text)?globalThis.String(e.text):"",annotations:globalThis.Array.isArray(null==e?void 0:e.annotations)?e.annotations.map((e=>NR.fromJSON(e))):[],properties:globalThis.Array.isArray(null==e?void 0:e.properties)?e.properties.map((e=>DR.fromJSON(e))):[]}),toJSON(e){var t,n;const r={};return 0!==e.fieldName&&(r.fieldName=CR(e.fieldName)),""!==e.text&&(r.text=e.text),(null===(t=e.annotations)||void 0===t?void 0:t.length)&&(r.annotations=e.annotations.map((e=>NR.toJSON(e)))),(null===(n=e.properties)||void 0===n?void 0:n.length)&&(r.properties=e.properties.map((e=>DR.toJSON(e)))),r}};function ek(e){let t=1e3*(e.seconds||0);return t+=(e.nanos||0)/1e6,new globalThis.Date(t)}function tk(e){return e instanceof globalThis.Date?e:"string"==typeof e?new globalThis.Date(e):ek(hI.fromJSON(e))}function nk(e){return null!=e}function rk(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function ok(){const e=new bE;return e.register({type:iI.START_SESSION_REQUEST,encode:e=>rk(e)&&"sessionMode"in e?MR.encode(e).finish():null,decode:e=>MR.decode(e)}),e.register({type:iI.START_SESSION_RESPONSE,encode:e=>rk(e)&&"sessionId"in e&&"participantId"in e&&"sessionToken"in e?UR.encode(e).finish():null,decode:e=>UR.decode(e)}),e.register({type:iI.EVENT_VERSION,encode:e=>rk(e)&&"version"in e?zR.encode(e).finish():null,decode:e=>zR.decode(e)}),e.register({type:iI.PARTICIPANT_REQUEST,encode:e=>rk(e)&&("appendMessage"in e||"updateAuthenticationTokenMessage"in e)?$R.encode(e).finish():null,decode:e=>$R.decode(e)}),e.register({type:iI.PARTICIPANT_RESPONSE,encode:e=>rk(e)&&"confirmedMessage"in e&&"initializedMessage"in e&&"publishedMessage"in e?FR.encode(e).finish():null,decode:e=>FR.decode(e)}),e.register({type:iI.CLIENT_ERROR_INFO,encode:e=>rk(e)&&"statusCode"in e&&"detailCode"in e&&"fallbackDetailCodes"in e?dI.encode(e).finish():null,decode:e=>dI.decode(e)}),e}function sk(e){return e.$type===LR.$type}function ak(e){return e.$type===NR.$type}function ik(e){return e.$type===PR.$type}function ck(e){return e.$type===DR.$type}function lk(e){if(e.textChangeOperation)return e.textChangeOperation;if(e.createAnnotationOperation)return e.createAnnotationOperation;if(e.removeAnnotationOperation)return e.removeAnnotationOperation;if(e.setPropertyOperation)return e.setPropertyOperation;throw new Error("FieldEvent does not contain an operation")}function uk(e,t,n){const r={fieldName:t,participantId:n,$type:YR.$type};switch(e.$type){case LR.$type:return Object.assign(Object.assign({},r),{textChangeOperation:e});case NR.$type:return Object.assign(Object.assign({},r),{createAnnotationOperation:e});case PR.$type:return Object.assign(Object.assign({},r),{removeAnnotationOperation:e});case DR.$type:return Object.assign(Object.assign({},r),{setPropertyOperation:e})}}function dk(e,t,n){return{$type:LR.$type,range:{$type:_I.$type,start:e,end:t},text:n}}function pk(e,t,n,r){return function(e,t){switch(t.$type){case wI.$type:return Object.assign(Object.assign({},e),{translatorTextUnitPayload:t});case AI.$type:return Object.assign(Object.assign({},e),{translatorRequestWordAlternativesPayload:t});case II.$type:return Object.assign(Object.assign({},e),{translatorProvidedWordAlternativesPayload:t});case RI.$type:return Object.assign(Object.assign({},e),{translatorSelectWordAlternativePayload:t});case MI.$type:return Object.assign(Object.assign({},e),{translatorGlossaryReplacementPayload:t});case kI.$type:return Object.assign(Object.assign({},e),{translatorRequestTextUnitAlternativesPayload:t});case CI.$type:return Object.assign(Object.assign({},e),{translatorProvidedTextUnitAlternativesPayload:t});case OI.$type:return Object.assign(Object.assign({},e),{translatorSelectTextUnitAlternativePayload:t});case xI.$type:return Object.assign(Object.assign({},e),{translatorRequestAutocompletionPayload:t});case LI.$type:return Object.assign(Object.assign({},e),{translatorProvidedAutocompletionPayload:t});case NI.$type:return Object.assign(Object.assign({},e),{translatorSelectAutocompletionPayload:t});case PI.$type:return Object.assign(Object.assign({},e),{translatorProvidedAutomaticTextUnitAlternativesPayload:t});case DI.$type:return Object.assign(Object.assign({},e),{translatorSelectAutomaticTextUnitAlternativePayload:t});case gR.$type:return Object.assign(Object.assign({},e),{writeDiffUnitPayload:t});default:throw new Error("Could not match annotation payload.")}}({$type:NR.$type,annotationId:e,range:{$type:_I.$type,start:t,end:n}},r)}function hk(e,t){const n={$type:DR.$type,propertyName:e};return void 0===t?n:function(e,t){switch(t.$type){case UI.$type:return Object.assign(Object.assign({},e),{translatorSourceLanguagesValue:t});case FI.$type:return Object.assign(Object.assign({},e),{translatorRequestedSourceLanguageValue:t});case GI.$type:return Object.assign(Object.assign({},e),{translatorCalculatedSourceLanguageValue:t});case $I.$type:return Object.assign(Object.assign({},e),{translatorTargetLanguagesValue:t});case jI.$type:return Object.assign(Object.assign({},e),{translatorRequestedTargetLanguageValue:t});case VI.$type:return Object.assign(Object.assign({},e),{translatorCalculatedTargetLanguageValue:t});case qI.$type:return Object.assign(Object.assign({},e),{translatorFormalityModesValue:t});case BI.$type:return Object.assign(Object.assign({},e),{translatorFormalityModeValue:t});case zI.$type:return Object.assign(Object.assign({},e),{translatorGlossarySupportValue:t});case oR.$type:return Object.assign(Object.assign({},e),{translatorGlossaryListValue:t});case YI.$type:return Object.assign(Object.assign({},e),{translatorGlossaryIdValue:t});case HI.$type:return Object.assign(Object.assign({},e),{translatorLanguageModelsValue:t});case JI.$type:return Object.assign(Object.assign({},e),{translatorLanguageModelValue:t});case XI.$type:return Object.assign(Object.assign({},e),{textDirectionValue:t});case KI.$type:return Object.assign(Object.assign({},e),{maximumTextLengthValue:t});case QI.$type:return Object.assign(Object.assign({},e),{translatorUnsupportedSourceLanguageValue:t});case mR.$type:return Object.assign(Object.assign({},e),{writeLanguagesValue:t});case _R.$type:return Object.assign(Object.assign({},e),{writeRequestedLanguageValue:t});case yR.$type:return Object.assign(Object.assign({},e),{writeCalculatedLanguageValue:t});case vR.$type:return Object.assign(Object.assign({},e),{writeStyleVariantsValue:t});case TR.$type:return Object.assign(Object.assign({},e),{writeStyleVariantValue:t})}}(n,t)}class fk{constructor(e,t,n){this.name=e,this.sessionMode=t,this.document=n,this.bufferedInitialEvents=[]}addChangeHandler(e){this.onChange=e,this.onChange(this.bufferedInitialEvents),this.bufferedInitialEvents=[]}applyFieldEvent(e){this.document.applyItaEvent(e)}publishChange(e,t){const n=t.map((t=>uk(t,e)));this.publishEvents(n)}publishChanges(e){const t=e.flatMap((([e,t])=>t.map((t=>uk(t,e)))));this.publishEvents(t)}publishEvents(e){this.onChange?this.onChange(e):this.bufferedInitialEvents=[...this.bufferedInitialEvents,...e]}}function gk(){}function mk(e,t,n,r,o){for(var s,a=[];t;)a.push(t),s=t.previousComponent,delete t.previousComponent,t=s;a.reverse();for(var i=0,c=a.length,l=0,u=0;i<c;i++){var d=a[i];if(d.removed){if(d.value=e.join(r.slice(u,u+d.count)),u+=d.count,i&&a[i-1].added){var p=a[i-1];a[i-1]=a[i],a[i]=p}}else{if(!d.added&&o){var h=n.slice(l,l+d.count);h=h.map((function(e,t){var n=r[u+t];return n.length>e.length?n:e})),d.value=e.join(h)}else d.value=e.join(n.slice(l,l+d.count));l+=d.count,d.added||(u+=d.count)}}var f=a[c-1];return c>1&&"string"==typeof f.value&&(f.added||f.removed)&&e.equals("",f.value)&&(a[c-2].value+=f.value,a.pop()),a}gk.prototype={diff:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.callback;"function"==typeof r&&(o=r,r={}),this.options=r;var s=this;function a(e){return o?(setTimeout((function(){o(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var i=(t=this.removeEmpty(this.tokenize(t))).length,c=e.length,l=1,u=i+c;r.maxEditLength&&(u=Math.min(u,r.maxEditLength));var d=null!==(n=r.timeout)&&void 0!==n?n:1/0,p=Date.now()+d,h=[{oldPos:-1,lastComponent:void 0}],f=this.extractCommon(h[0],t,e,0);if(h[0].oldPos+1>=c&&f+1>=i)return a([{value:this.join(t),count:t.length}]);var g=-1/0,m=1/0;function _(){for(var n=Math.max(g,-l);n<=Math.min(m,l);n+=2){var r=void 0,o=h[n-1],u=h[n+1];o&&(h[n-1]=void 0);var d=!1;if(u){var p=u.oldPos-n;d=u&&0<=p&&p<i}var _=o&&o.oldPos+1<c;if(d||_){if(r=!_||d&&o.oldPos+1<u.oldPos?s.addToPath(u,!0,void 0,0):s.addToPath(o,void 0,!0,1),f=s.extractCommon(r,t,e,n),r.oldPos+1>=c&&f+1>=i)return a(mk(s,r.lastComponent,t,e,s.useLongestToken));h[n]=r,r.oldPos+1>=c&&(m=Math.min(m,n-1)),f+1>=i&&(g=Math.max(g,n+1))}else h[n]=void 0}l++}if(o)!function e(){setTimeout((function(){if(l>u||Date.now()>p)return o();_()||e()}),0)}();else for(;l<=u&&Date.now()<=p;){var y=_();if(y)return y}},addToPath:function(e,t,n,r){var o=e.lastComponent;return o&&o.added===t&&o.removed===n?{oldPos:e.oldPos+r,lastComponent:{count:o.count+1,added:t,removed:n,previousComponent:o.previousComponent}}:{oldPos:e.oldPos+r,lastComponent:{count:1,added:t,removed:n,previousComponent:o}}},extractCommon:function(e,t,n,r){for(var o=t.length,s=n.length,a=e.oldPos,i=a-r,c=0;i+1<o&&a+1<s&&this.equals(t[i+1],n[a+1]);)i++,a++,c++;return c&&(e.lastComponent={count:c,previousComponent:e.lastComponent}),e.oldPos=a,i},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var _k=new gk;var yk=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,vk=/\S/,Tk=new gk;Tk.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!vk.test(e)&&!vk.test(t)},Tk.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&yk.test(t[n])&&yk.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var Sk=new gk;function bk(e){return bk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bk(e)}Sk.tokenize=function(e){this.options.stripTrailingCr&&(e=e.replace(/\r\n/g,"\n"));var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var o=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=o:(this.options.ignoreWhitespace&&(o=o.trim()),t.push(o))}return t},(new gk).tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)},(new gk).tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var Ek=Object.prototype.toString,wk=new gk;function Ak(e,t,n,r,o){var s,a;for(t=t||[],n=n||[],r&&(e=r(o,e)),s=0;s<t.length;s+=1)if(t[s]===e)return n[s];if("[object Array]"===Ek.call(e)){for(t.push(e),a=new Array(e.length),n.push(a),s=0;s<e.length;s+=1)a[s]=Ak(e[s],t,n,r,o);return t.pop(),n.pop(),a}if(e&&e.toJSON&&(e=e.toJSON()),"object"===bk(e)&&null!==e){t.push(e),a={},n.push(a);var i,c=[];for(i in e)e.hasOwnProperty(i)&&c.push(i);for(c.sort(),s=0;s<c.length;s+=1)a[i=c[s]]=Ak(e[i],t,n,r,i);t.pop(),n.pop()}else a=e;return a}wk.useLongestToken=!0,wk.tokenize=Sk.tokenize,wk.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,o=void 0===r?function(e,t){return void 0===t?n:t}:r;return"string"==typeof e?e:JSON.stringify(Ak(e,null,null,o),o,"  ")},wk.equals=function(e,t){return gk.prototype.equals.call(wk,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var Ik=new gk;function Rk(e,t){const n=(r=e,o=t,s={ignoreCase:!1},_k.diff(r,o,s));var r,o,s;let a=0;const i=[];n.forEach((e=>{e.added?(i.push(dk(a,a,e.value)),a+=e.value.length):e.removed?i.push(dk(a,a+e.value.length,"")):a+=e.value.length}));const c=Math.max(e.length,t.length),l=e=>{var t,n;return"number"==typeof(null===(t=e.range)||void 0===t?void 0:t.start)&&e.range.start===c&&"number"==typeof(null===(n=e.range)||void 0===n?void 0:n.end)&&e.range.end>c&&0===e.text.length},u=i.find((e=>l(e)));if(!u||!u.range)return i;const d=u.range.end-c,p={start:u.range.start-d,end:u.range.end-d};return[Object.assign(Object.assign({},u),{range:Object.assign(Object.assign({},u.range),p)}),...i.filter((e=>!l(e)))]}function kk(e){return e.$type===BR.$type?{$type:$R.$type,appendMessage:e}:{$type:$R.$type,updateAuthenticationTokenMessage:e}}Ik.tokenize=function(e){return e.slice()},Ik.join=Ik.removeEmpty=function(e){return e};const Ck=(e,t)=>e.split("-")[0]===t.split("-")[0];class Ok{constructor(){this.fields=[]}registerField(e){return this.fields.push(e),e}applyItaEvent(e){const t=this.fields.find((t=>t.name===e.fieldName));t&&t.applyOperation(lk(e))}serialize(){return{$type:QR.$type,fields:this.fields.map((e=>e.serialize()))}}prettyPrint(){return{fields:this.fields.map((e=>e.prettyPrint()))}}reset(){this.fields.forEach((e=>e.reset()))}}const xk="autodetect",Lk="en-US",Nk={requiresTransformation:!1};class Pk{constructor(e,t){this.payloadType=e,this.annotations=new xw([]),this.payloads=this.annotations.pipe(SA((e=>e.map((e=>e.specificPayload))))),this.config=Object.assign(Object.assign({},Nk),t)}applyCreateAnnotationOperation(e){if(!e.operation.range||!e.operation.annotationId)return;const t=[...this.annotations.value,e];this.annotations.next(t)}applyRemoveAnnotationOperation(e){const t=this.annotations.value.filter((t=>{var n,r;return(null===(n=t.operation.annotationId)||void 0===n?void 0:n.value)!==(null===(r=e.annotationId)||void 0===r?void 0:r.value)}));this.annotations.next(t)}add(e,t,n){const r=pk({$type:KR.$type,value:crypto.randomUUID()},e,t,n);return this.annotations.next([...this.annotations.value,{operation:r,specificPayload:n}]),[r]}set(e){this.annotations.next(e)}removeAnnotation(e){const t=this.annotations.value.filter((t=>{var n;return(null===(n=t.operation.annotationId)||void 0===n?void 0:n.value)===(null==e?void 0:e.value)})).map((e=>function(e){return{$type:PR.$type,annotationId:e}}(e.operation.annotationId))),n=this.annotations.value.filter((t=>{var n;return(null===(n=t.operation.annotationId)||void 0===n?void 0:n.value)!==(null==e?void 0:e.value)}));return this.annotations.next(n),t}serialize(){return this.annotations.value.map((e=>e.operation))}prettyPrint(){return this.annotations.value.map((e=>{var t;return{id:null===(t=e.operation.annotationId)||void 0===t?void 0:t.value,range:e.operation.range,annotationPayload:e.specificPayload}}))}reset(){this.annotations.next([])}}var Dk;function Mk(e,t){return{$type:_I.$type,start:e,end:t}}!function(e){e[e.BaseThenNew=0]="BaseThenNew",e[e.NewThenBase=1]="NewThenBase"}(Dk||(Dk={}));const Uk=(e,t,n=Dk.BaseThenNew)=>{var r,o;if(ik(t)||ik(e)||ak(e)||sk(e)&&(null===(r=e.range)||void 0===r?void 0:r.start)===(null===(o=e.range)||void 0===o?void 0:o.end)&&0===e.text.length)return t;if(ck(e)&&ck(t))return((e,t,n)=>e.propertyName!==t.propertyName||n===Dk.BaseThenNew?t:e)(e,t,n);if(ck(e)||ck(t))return t;if(sk(e)&&sk(t))return((e,t,n)=>{const r=e.range,o=t.range;if(r.start>o.end)return t;const s=e.text.length+r.start-r.end;if(r.end<o.start)return Object.assign(Object.assign({},t),{range:Mk(o.start+s,o.end+s)});const a=r.start<o.start||r.start===o.start&&n===Dk.BaseThenNew,i=r.end<o.end;if(a){const n=r.start+e.text.length;return i?Object.assign(Object.assign({},t),{range:Mk(n,o.end+s)}):Object.assign(Object.assign({},t),{range:Mk(n,n)})}return i?Object.assign(Object.assign({},t),{range:Mk(o.start,o.end+s),text:t.text+e.text}):Object.assign(Object.assign({},t),{range:Mk(o.start,r.start)})})(e,t,n);if(sk(e)&&ak(t))return((e,t)=>{const n=e.range,r=t.range;if(n.start>r.end)return t;const o=e.text.length+n.start-n.end;if(n.end<r.start)return Object.assign(Object.assign({},t),{range:Mk(r.start+o,r.end+o)});const s=n.start<r.start,a=n.end<r.end,i=n.start+e.text.length;return s?a?Object.assign(Object.assign({},t),{range:Mk(i,r.end+o)}):n.end===r.end?Object.assign(Object.assign({},t),{range:Mk(i,i)}):Object.assign(Object.assign({},t),{range:Mk(n.start,n.start)}):a?n.start===r.start?Object.assign(Object.assign({},t),{range:Mk(i,r.end+o)}):Object.assign(Object.assign({},t),{range:Mk(r.start,r.end+o)}):Object.assign(Object.assign({},t),{range:Mk(r.start,i)})})(e,t);throw new Error(`Operational transform for operations of type [${null==e?void 0:e.$type}, ${null==t?void 0:t.$type}] not implemented.`)},$k=(e,t)=>[Uk(t,e,Dk.NewThenBase),Uk(e,t,Dk.BaseThenNew)],Fk=(e,t)=>{let n=[...e];const r=t.map((e=>{let t=e;return n=n.map((e=>{const[n,r]=$k(t,e);return t=n,r})),t}));return[n,r]},Gk=(e,t)=>{let n=[...t];return{transformedIncomingEvents:e.map((e=>{let t=lk(e);return n=n.map((n=>{if(e.fieldName!==n.fieldName)return n;const[r,o]=$k(t,lk(n));return t=r,"participantId"in n?uk(o,n.fieldName,n.participantId):uk(o,n.fieldName)})),uk(t,e.fieldName,e.participantId)})),transformedExistingEvents:n}};class jk{constructor(e){this.name=e,this.content=new xw(""),this.annotations=[],this.annotationsRequiringTransformation=[],this.changeNotifier=new Cw,this.wasChanged=this.changeNotifier.asObservable(),this.properties=new Map}registerAnnotation(e){return e.config.requiresTransformation&&this.annotationsRequiringTransformation.push(e),this.annotations.push(e),e}registerProperty(e){return this.properties.set(e.propertyName,e),e}applyOperation(e){sk(e)?this.applyTextChangeOperation(e):ak(e)?this.applyCreateAnnotationOperation(e):ik(e)?this.applyRemoveAnnotationOperation(e):ck(e)&&this.applySetPropertyOperation(e)}applyTextChangeOperation(e){const t=((e,t)=>{if(void 0===t.range||t.range.start>e.length||t.range.start<0||t.range.end>e.length||t.range.end<0||t.range.start>t.range.end)throw new Error("Tried to apply out of range operation to string");return e.slice(0,t.range.start)+t.text+e.slice(t.range.end)})(this.content.value,e);this.content.next(t),this.changeNotifier.next();for(const t of this.annotationsRequiringTransformation){const n=t.annotations.value.map((t=>Object.assign(Object.assign({},t),{operation:Uk(e,t.operation)})));t.set(n)}}applyCreateAnnotationOperation(e){const t=function(e){if(e.translatorTextUnitPayload)return e.translatorTextUnitPayload;if(e.translatorRequestWordAlternativesPayload)return e.translatorRequestWordAlternativesPayload;if(e.translatorProvidedWordAlternativesPayload)return e.translatorProvidedWordAlternativesPayload;if(e.translatorSelectWordAlternativePayload)return e.translatorSelectWordAlternativePayload;if(e.translatorGlossaryReplacementPayload)return e.translatorGlossaryReplacementPayload;if(e.translatorRequestTextUnitAlternativesPayload)return e.translatorRequestTextUnitAlternativesPayload;if(e.translatorProvidedTextUnitAlternativesPayload)return e.translatorProvidedTextUnitAlternativesPayload;if(e.translatorSelectTextUnitAlternativePayload)return e.translatorSelectTextUnitAlternativePayload;if(e.translatorRequestAutocompletionPayload)return e.translatorRequestAutocompletionPayload;if(e.translatorProvidedAutocompletionPayload)return e.translatorProvidedAutocompletionPayload;if(e.translatorSelectAutocompletionPayload)return e.translatorSelectAutocompletionPayload;if(e.translatorProvidedAutomaticTextUnitAlternativesPayload)return e.translatorProvidedAutomaticTextUnitAlternativesPayload;if(e.translatorSelectAutomaticTextUnitAlternativePayload)return e.translatorSelectAutomaticTextUnitAlternativePayload;if(e.writeDiffUnitPayload)return e.writeDiffUnitPayload;throw new Error("CreateAnnotationOperation does not contain a known payload")}(e),n=this.annotations.find((e=>e.payloadType===t.$type));n&&(n.applyCreateAnnotationOperation({operation:e,specificPayload:t}),this.changeNotifier.next())}applyRemoveAnnotationOperation(e){this.annotations.forEach((t=>t.applyRemoveAnnotationOperation(e))),this.changeNotifier.next()}applySetPropertyOperation(e){const{propertyName:t}=e,n=this.properties.get(t);n&&(n.applySetPropertyOperation(e),this.changeNotifier.next())}update(e){const t=Rk(this.content.value,e);this.content.next(e),this.changeNotifier.next();for(const e of this.annotationsRequiringTransformation){const n=e.annotations.value,[r,o]=Fk(t,n.map((e=>e.operation)));e.set(o.map(((e,t)=>Object.assign(Object.assign({},n[t]),{operation:e}))))}return t}serialize(){return{$type:ZR.$type,fieldName:this.name,text:this.content.value,annotations:this.annotations.flatMap((e=>e.serialize())),properties:Array.from(this.properties.values()).map((e=>e.serialize()))}}prettyPrint(){return{fieldName:AR[this.name],text:this.content.value,annotations:this.annotations.flatMap((e=>e.prettyPrint())),properties:Array.from(this.properties.values()).map((e=>e.prettyPrint()))}}reset(){this.content.next(""),this.annotations.forEach((e=>e.reset())),this.properties.forEach((e=>e.reset())),this.changeNotifier.next()}}class Vk{constructor(e,t){this.propertyName=e,this.propertyType=t,this.value=new xw(void 0)}applySetPropertyOperation(e){const t=function(e){return e.translatorSourceLanguagesValue?e.translatorSourceLanguagesValue:e.translatorTargetLanguagesValue?e.translatorTargetLanguagesValue:e.translatorRequestedSourceLanguageValue?e.translatorRequestedSourceLanguageValue:e.translatorCalculatedSourceLanguageValue?e.translatorCalculatedSourceLanguageValue:e.translatorRequestedTargetLanguageValue?e.translatorRequestedTargetLanguageValue:e.translatorCalculatedTargetLanguageValue?e.translatorCalculatedTargetLanguageValue:e.translatorFormalityModesValue?e.translatorFormalityModesValue:e.translatorFormalityModeValue?e.translatorFormalityModeValue:e.translatorGlossarySupportValue?e.translatorGlossarySupportValue:e.translatorGlossaryListValue?e.translatorGlossaryListValue:e.translatorGlossaryIdValue?e.translatorGlossaryIdValue:e.translatorLanguageModelsValue?e.translatorLanguageModelsValue:e.translatorLanguageModelValue?e.translatorLanguageModelValue:e.textDirectionValue?e.textDirectionValue:e.maximumTextLengthValue?e.maximumTextLengthValue:e.translatorUnsupportedSourceLanguageValue?e.translatorUnsupportedSourceLanguageValue:e.writeLanguagesValue?e.writeLanguagesValue:e.writeRequestedLanguageValue?e.writeRequestedLanguageValue:e.writeCalculatedLanguageValue?e.writeCalculatedLanguageValue:e.writeStyleVariantsValue?e.writeStyleVariantsValue:e.writeStyleVariantValue?e.writeStyleVariantValue:void 0}(e);if(void 0===t)return this.reset();if(t.$type!==this.propertyType)throw new Error(`PropertyValue has type ${t.$type}, but ${this.propertyType} expected`);this.value.next(t)}set(e){return this.value.next(e),[this.serialize()]}reset(){this.value.next(void 0)}serialize(){return hk(this.propertyName,this.value.value)}prettyPrint(){return{propertyName:IR[this.propertyName],propertyValue:this.value.value}}}class Wk extends Vk{constructor(){super(IR.TRANSLATOR_TEXT_DIRECTION,XI.$type),this.isRightToLeft=this.value.pipe(SA((e=>(null==e?void 0:e.textDirection)===TI.RIGHT_TO_LEFT)))}}const qk=e=>!!e;class Bk extends Vk{constructor(){super(IR.MAXIMUM_TEXT_LENGTH,KI.$type),this.max=this.value.pipe(NA(qk),SA((e=>e.max)))}}class Hk extends Vk{constructor(){super(IR.TRANSLATOR_UNSUPPORTED_LANGUAGE,QI.$type),this.unsupported=this.value.pipe(SA((e=>!!e)))}}class Jk extends Vk{constructor(){super(IR.TRANSLATOR_CALCULATED_SOURCE_LANGUAGE,GI.$type),this.language=this.value.pipe(NA((e=>!!e)),SA((e=>{var t;return null===(t=e.sourceLanguage)||void 0===t?void 0:t.code}))),this.isAutoDetected=this.value.pipe(NA((e=>!!e)),SA((e=>e.origin===vI.LANGUAGE_DETECTION)))}updateLanguage(e){return super.set({$type:GI.$type,sourceLanguage:{$type:sR.$type,code:e},origin:vI.REQUESTED_LANGUAGE})}getCurrent(){var e,t;return null===(t=null===(e=this.value.value)||void 0===e?void 0:e.sourceLanguage)||void 0===t?void 0:t.code}}class zk extends Vk{constructor(){super(IR.TRANSLATOR_REQUESTED_SOURCE_LANGUAGE,FI.$type),this.language=this.value.pipe(NA((e=>!!e)),SA((e=>{var t,n;return null!==(n=null===(t=null==e?void 0:e.sourceLanguage)||void 0===t?void 0:t.code)&&void 0!==n?n:xk})))}updateLanguage(e){if("autodetect"===e){return super.set(void 0)}return super.set({$type:FI.$type,sourceLanguage:{$type:sR.$type,code:e}})}}class Yk extends Vk{constructor(){super(IR.TRANSLATOR_SOURCE_LANGUAGES,UI.$type),this.sourceLanguages=this.value.pipe(SA((e=>{var t;return null!==(t=null==e?void 0:e.sourceLanguages.map((e=>e.code)))&&void 0!==t?t:[]})))}}class Xk extends jk{constructor(){super(...arguments),this.calculatedSourceLanguageProperty=this.registerProperty(new Jk),this.requestedSourceLanguageProperty=this.registerProperty(new zk),this.sourceLanguagesProperty=this.registerProperty(new Yk),this.maximumTextLengthProperty=this.registerProperty(new Bk),this.unsupportedLanguageProperty=this.registerProperty(new Hk),this.sourceTextUnitAnnotations=this.registerAnnotation(new Pk(wI.$type,{requiresTransformation:!0})),this.textDirection=this.registerProperty(new Wk)}}class Kk extends Vk{constructor(){super(IR.TRANSLATOR_TARGET_LANGUAGES,$I.$type),this.targetLanguages=this.value.pipe(SA((e=>{var t;return null!==(t=null==e?void 0:e.targetLanguages.map((e=>e.code)))&&void 0!==t?t:[]})))}}class Qk extends Vk{constructor(){super(IR.TRANSLATOR_CALCULATED_TARGET_LANGUAGE,VI.$type),this.language=this.value.pipe(NA((e=>!!e)),SA((e=>{var t;return null===(t=e.targetLanguage)||void 0===t?void 0:t.code})))}updateLanguage(e){return super.set({$type:VI.$type,targetLanguage:{$type:aR.$type,code:e}})}}class Zk extends Vk{constructor(){super(IR.TRANSLATOR_REQUESTED_TARGET_LANGUAGE,jI.$type)}updateLanguage(e){return super.set({$type:jI.$type,targetLanguage:{$type:aR.$type,code:e}})}getCurrent(){var e,t;return null===(t=null===(e=this.value.value)||void 0===e?void 0:e.targetLanguage)||void 0===t?void 0:t.code}}class eC extends Vk{constructor(){super(IR.TRANSLATOR_GLOSSARY_SUPPORT,zI.$type),this.supported=this.value.pipe(SA((e=>!!e)))}}class tC extends Vk{constructor(){super(IR.TRANSLATOR_GLOSSARY_LIST,oR.$type),this.entries=this.value.pipe(SA((e=>{var t;return null!==(t=null==e?void 0:e.glossaryEntries)&&void 0!==t?t:[]})))}updateGlossaryList(e){return super.set(void 0===e?void 0:{$type:oR.$type,glossaryEntries:e})}}class nC extends Vk{constructor(){super(IR.TRANSLATOR_GLOSSARY_SUGGESTIONS,oR.$type)}}class rC extends Vk{constructor(){super(IR.TRANSLATOR_FORMALITY_MODES,qI.$type)}}class oC extends Vk{constructor(){super(IR.TRANSLATOR_FORMALITY_MODE,BI.$type)}update(e){return super.set(void 0===e?void 0:{$type:BI.$type,formalityMode:e})}}class sC extends Vk{constructor(){super(IR.TRANSLATOR_LANGUAGE_MODELS,HI.$type)}}class aC extends Vk{constructor(){super(IR.TRANSLATOR_LANGUAGE_MODEL,JI.$type)}update(e){return super.set(void 0===e?void 0:{$type:JI.$type,languageModel:e})}}class iC extends Vk{constructor(){super(IR.TRANSLATOR_GLOSSARY_ID,YI.$type)}update(e){return super.set(void 0===e?void 0:{$type:YI.$type,glossaryId:e})}}class cC extends jk{constructor(){super(...arguments),this.requestedTargetLanguageProperty=this.registerProperty(new Zk),this.calculatedTargetLanguageProperty=this.registerProperty(new Qk),this.targetLanguagesProperty=this.registerProperty(new Kk),this.requestWordAlternativesAnnotations=this.registerAnnotation(new Pk(AI.$type)),this.providedWordAlternativesAnnotations=this.registerAnnotation(new Pk(II.$type,{requiresTransformation:!0})),this.selectWordAlternativeAnnotations=this.registerAnnotation(new Pk(RI.$type)),this.requestTextUnitAlternativesAnnotations=this.registerAnnotation(new Pk(kI.$type)),this.providedTextUnitAlternativesAnnotations=this.registerAnnotation(new Pk(CI.$type,{requiresTransformation:!0})),this.selectTextUnitAlternativeAnnotations=this.registerAnnotation(new Pk(OI.$type)),this.requestAutocompletionAnnotations=this.registerAnnotation(new Pk(xI.$type)),this.providedAutocompletionAnnotations=this.registerAnnotation(new Pk(LI.$type,{requiresTransformation:!0})),this.selectAutocompletionAnnotations=this.registerAnnotation(new Pk(NI.$type)),this.providedAutomaticTextUnitAlternativesAnnotations=this.registerAnnotation(new Pk(PI.$type,{requiresTransformation:!0})),this.selectAutomaticTextUnitAlternativeAnnotations=this.registerAnnotation(new Pk(DI.$type)),this.targetTextUnitAnnotations=this.registerAnnotation(new Pk(wI.$type,{requiresTransformation:!0})),this.glossaryReplacementAnnotations=this.registerAnnotation(new Pk(MI.$type,{requiresTransformation:!0})),this.glossarySupport=this.registerProperty(new eC),this.glossaryListProperty=this.registerProperty(new tC),this.glossarySuggestions=this.registerProperty(new nC),this.formalityModes=this.registerProperty(new rC),this.formalityMode=this.registerProperty(new oC),this.languageModels=this.registerProperty(new sC),this.languageModel=this.registerProperty(new aC),this.textDirection=this.registerProperty(new Wk),this.glossaryId=this.registerProperty(new iC),this.maximumTextLengthProperty=this.registerProperty(new Bk)}}class lC extends jk{constructor(){super(...arguments),this.targetTranscriptionTextUnitAnnotations=this.registerAnnotation(new Pk(wI.$type,{requiresTransformation:!0}))}}class uC extends Ok{constructor(){super(...arguments),this.sourceTextField=this.registerField(new Xk(AR.TRANSLATOR_SOURCE_TEXT)),this.targetTextField=this.registerField(new cC(AR.TRANSLATOR_TARGET_TEXT)),this.targetTranscriptionTextField=this.registerField(new lC(AR.TRANSLATOR_TARGET_TRANSCRIPTION_TEXT)),this.textUnitAnnotations=CA([this.sourceTextField.sourceTextUnitAnnotations.annotations,this.targetTextField.targetTextUnitAnnotations.annotations,this.targetTranscriptionTextField.targetTranscriptionTextUnitAnnotations.annotations]).pipe(SA((e=>{const t=e[0],n=e[1],r=e[2];return t.sort(((e,t)=>e.operation.range.start-t.operation.range.start)).map((e=>{var t,o,s,a;const i=e.operation.range,c=null!==(o=null===(t=n.find((t=>{var n,r;return(null===(n=e.specificPayload.textUnitId)||void 0===n?void 0:n.value)===(null===(r=t.specificPayload.textUnitId)||void 0===r?void 0:r.value)})))||void 0===t?void 0:t.operation.range)&&void 0!==o?o:_I.fromJSON({}),l=null!==(a=null===(s=r.find((t=>{var n,r;return(null===(n=e.specificPayload.textUnitId)||void 0===n?void 0:n.value)===(null===(r=t.specificPayload.textUnitId)||void 0===r?void 0:r.value)})))||void 0===s?void 0:s.operation.range)&&void 0!==a?a:_I.fromJSON({});return{sourceStart:i.start,sourceEnd:i.end,sourceLength:i.end-i.start,targetStart:c.start,targetEnd:c.end,targetLength:c.end-c.start,targetTranscriptionStart:l.start,targetTranscriptionEnd:l.end,targetTranscriptionLength:l.end-l.start}}))})))}}class dC extends fk{constructor(e={preventSameLanguages:{enabled:!1}}){super("Translator",RR.TRANSLATOR,new uC),this.config=e,this.targetLanguage=this.document.targetTextField.requestedTargetLanguageProperty.value.pipe(SA((e=>{var t,n;return null!==(n=null===(t=null==e?void 0:e.targetLanguage)||void 0===t?void 0:t.code)&&void 0!==n?n:Lk}))),this.config.preventSameLanguages.enabled&&this.document.sourceTextField.calculatedSourceLanguageProperty.language.pipe(NA((e=>!!e))).subscribe((e=>{const t=this.document.targetTextField.requestedTargetLanguageProperty.getCurrent();t&&this.config.preventSameLanguages.enabled&&Ck(e,t)&&this.updateRequestedTargetLanguage(this.config.preventSameLanguages.getAlternativeTargetLanguage(t))}))}applyFieldEvent(e){if(e.fieldName===AR.TRANSLATOR_TARGET_TEXT&&e.textChangeOperation){const e=[];e.push(...this.cancelTextUnitAlternativesFlows()),e.push(...this.cancelWordAlternativesFlows()),e.push(...this.cancelAutocompletionFlows()),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,e)}this.document.applyItaEvent(e)}updateSourceText(e){const t=this.document.sourceTextField.update(e);this.publishChange(AR.TRANSLATOR_SOURCE_TEXT,t)}updateTargetText(e){const t=[];t.push(...this.cancelTextUnitAlternativesFlows()),t.push(...this.cancelWordAlternativesFlows()),t.push(...this.cancelAutocompletionFlows()),t.push(...this.document.targetTextField.update(e)),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}updateRequestedTargetLanguage(e){var t;if(this.config.preventSameLanguages.enabled&&Ck(e,null!==(t=this.document.sourceTextField.calculatedSourceLanguageProperty.getCurrent())&&void 0!==t?t:""))return;const n=this.document.targetTextField.requestedTargetLanguageProperty.updateLanguage(e);this.publishChange(AR.TRANSLATOR_TARGET_TEXT,n)}updateRequestedSourceLanguage(e){const t=this.document.sourceTextField.requestedSourceLanguageProperty.updateLanguage(e);this.publishChange(AR.TRANSLATOR_SOURCE_TEXT,t)}switchLanguages(e){var t,n,r,o,s,a,i,c,l,u,d;const{sourceTextField:p,targetTextField:h}=this.document,f=null!==(t=p.calculatedSourceLanguageProperty.getCurrent())&&void 0!==t?t:null===(r=null===(n=p.requestedSourceLanguageProperty.value.value)||void 0===n?void 0:n.sourceLanguage)||void 0===r?void 0:r.code,g=null!==(a=null===(s=null===(o=h.calculatedTargetLanguageProperty.value.value)||void 0===o?void 0:o.targetLanguage)||void 0===s?void 0:s.code)&&void 0!==a?a:null===(c=null===(i=h.requestedTargetLanguageProperty.value.value)||void 0===i?void 0:i.targetLanguage)||void 0===c?void 0:c.code,m=h.content.value;if(!f||!g)return;const _=null!==(u=null===(l=p.maximumTextLengthProperty.value.value)||void 0===l?void 0:l.max)&&void 0!==u?u:3e5,y=m.slice(0,_),v=g.split("-")[0],T=null!==(d=e[f])&&void 0!==d?d:f;this.publishChanges([[AR.TRANSLATOR_TARGET_TEXT,[...h.update("")]],[AR.TRANSLATOR_SOURCE_TEXT,[...p.update("")]],[AR.TRANSLATOR_TARGET_TEXT,[...h.requestedTargetLanguageProperty.updateLanguage(T)]],[AR.TRANSLATOR_SOURCE_TEXT,[...p.requestedSourceLanguageProperty.updateLanguage(v),...p.update(y)]]]),p.calculatedSourceLanguageProperty.updateLanguage(v)}cancelWordAlternativesFlows(){return this.document.targetTextField.requestWordAlternativesAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestWordAlternativesAnnotations.removeAnnotation(e.operation.annotationId)))}cancelTextUnitAlternativesFlows(){return this.document.targetTextField.requestTextUnitAlternativesAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestTextUnitAlternativesAnnotations.removeAnnotation(e.operation.annotationId)))}cancelAutocompletionFlows(){return this.document.targetTextField.requestAutocompletionAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestAutocompletionAnnotations.removeAnnotation(e.operation.annotationId)))}requestWordAlternatives(e){const t=[];t.push(...this.cancelWordAlternativesFlows());const n=this.document.targetTextField.requestWordAlternativesAnnotations.add(e,e,{$type:AI.$type,flowId:{$type:lR.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}requestTextUnitAlternatives(e){const t=[];t.push(...this.cancelTextUnitAlternativesFlows());const n=this.document.targetTextField.requestTextUnitAlternativesAnnotations.add(e,e,{$type:kI.$type,flowId:{$type:pR.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}requestAutocompletion(e){const t=[];t.push(...this.cancelAutocompletionFlows());const n=this.document.targetTextField.requestAutocompletionAnnotations.add(e,e,{$type:xI.$type,flowId:{$type:hR.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}selectWordAlternative(e,t,n){const r=[];r.push(...this.cancelTextUnitAlternativesFlows()),r.push(...this.cancelAutocompletionFlows());const o=this.document.targetTextField.selectWordAlternativeAnnotations.add(e,e,{$type:RI.$type,flowId:{$type:lR.$type,value:t},selection:n});r.push(...o),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,r)}selectTextUnitAlternative(e,t,n){const r=[];r.push(...this.cancelWordAlternativesFlows()),r.push(...this.cancelAutocompletionFlows());const o=this.document.targetTextField.selectTextUnitAlternativeAnnotations.add(e,e,{$type:OI.$type,flowId:{$type:pR.$type,value:t},selection:n});r.push(...o),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,r)}selectAutocompletion(e,t,n){const r=[];r.push(...this.cancelWordAlternativesFlows()),r.push(...this.cancelTextUnitAlternativesFlows());const o=this.document.targetTextField.selectAutocompletionAnnotations.add(e,e,{$type:NI.$type,flowId:{$type:hR.$type,value:t},selection:n});r.push(...o),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,r)}selectAutomaticTextUnitAlternative(e,t){const n=[],r=this.document.targetTextField.selectAutomaticTextUnitAlternativeAnnotations.add(e,e,{$type:DI.$type,selection:t});n.push(...r),this.publishChange(AR.TRANSLATOR_TARGET_TEXT,n)}updateGlossaryList(e){const t=this.document.targetTextField.glossaryListProperty.updateGlossaryList(e);this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}updateFormalityMode(e){const t=this.document.targetTextField.formalityMode.update(e);this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}updateLanguageModel(e){const t=this.document.targetTextField.languageModel.update(e);this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}updateGlossaryId(e){const t=this.document.targetTextField.glossaryId.update(e);this.publishChange(AR.TRANSLATOR_TARGET_TEXT,t)}}function pC(e){return e.$type===WR.$type}function hC(e){if(function(e){return e.$type===FR.$type}(e))return function(e){if(null==e?void 0:e.confirmedMessage)return e.confirmedMessage;if(null==e?void 0:e.initializedMessage)return e.initializedMessage;if(null==e?void 0:e.publishedMessage)return e.publishedMessage;if(null==e?void 0:e.metaInfoMessage)return e.metaInfoMessage;throw new Error("ParticipantResponse does not contain a message")}(e);if(function(e){return e.$type===$R.$type}(e))return function(e){if(null==e?void 0:e.appendMessage)return e.appendMessage;if(null==e?void 0:e.updateAuthenticationTokenMessage)return e.updateAuthenticationTokenMessage;throw new Error("ParticipantRequest does not contain a message")}(e);throw new Error("Extracting message failed, you need to pass a ParticipantRequest or ParticipantResponse")}class fC{constructor(e){var t,n,r,o,s,a;this.currentVersion={$type:zR.$type,version:void 0},this.isInitialized=!1,this.pendingEvents=[],this.sentEvents=[],this.confirmedEvents=[],this.incomingEvents=e.pipe(SA((e=>hC(e))),(a=KE(r=e=>{(function(e){return e.$type===GR.$type})(e)&&this.handleConfirmedMessage(e),function(e){return e.$type===jR.$type}(e)&&this.handleInitializedMessage()})||o||s?{next:r,error:o,complete:s}:r)?bw((function(e,t){var n;null===(n=a.subscribe)||void 0===n||n.call(a);var r=!0;e.subscribe(Ew(t,(function(e){var n;null===(n=a.next)||void 0===n||n.call(a,e),t.next(e)}),(function(){var e;r=!1,null===(e=a.complete)||void 0===e||e.call(a),t.complete()}),(function(e){var n;r=!1,null===(n=a.error)||void 0===n||n.call(a,e),t.error(e)}),(function(){var e,t;r&&(null===(e=a.unsubscribe)||void 0===e||e.call(a)),null===(t=a.finalize)||void 0===t||t.call(a)})))})):yw,NA((e=>function(e){return e.$type===VR.$type}(e))),SA((e=>this.handlePublished(e))),(t=e=>TA(e),bw((function(e,r){var o=null,s=0,a=!1,i=function(){return a&&!o&&r.complete()};e.subscribe(Ew(r,(function(e){null==o||o.unsubscribe();var a=0,c=s++;hA(t(e,c)).subscribe(o=Ew(r,(function(t){return r.next(n?n(e,t,c,a++):t)}),(function(){o=null,i()})))}),(function(){a=!0,i()})))}))),DA())}addClientEvents(e){this.pendingEvents.push(...e),this.trySendPendingEvents()}handleConfirmedMessage(e){this.currentVersion=e.currentVersion,this.confirmedEvents.push(...this.sentEvents),this.sentEvents=[],this.trySendPendingEvents()}handlePublished(e){const t=e.events,{transformedIncomingEvents:n,transformedExistingEvents:r}=Gk(t,this.sentEvents);this.sentEvents=r;const{transformedIncomingEvents:o,transformedExistingEvents:s}=Gk(n,this.pendingEvents);return this.pendingEvents=s,this.confirmedEvents.push(...o),this.currentVersion=e.currentVersion,this.trySendPendingEvents(),o}connectToSession(e){this.sendEvents=e,this.trySendPendingEvents()}trySendPendingEvents(){0===this.pendingEvents.length||this.sentEvents.length>0||!this.isInitialized||!this.sendEvents||(this.sentEvents=this.sendEvents(this.pendingEvents.reduce(((e,t)=>{if(function(e){var t,n;return void 0!==e&&(null===(t=e.range)||void 0===t?void 0:t.start)===(null===(n=e.range)||void 0===n?void 0:n.end)&&0===e.text.length}(t.textChangeOperation))return e;if(0===e.length)return[t];const n=e.at(-1);if(n.fieldName!==t.fieldName||!t.textChangeOperation||!n.textChangeOperation)return[...e,t];const r=n.textChangeOperation,o=t.textChangeOperation,s=o.range.start-r.range.start,a=o.range.end-r.range.start,i=Math.max(0,s),c=Math.min(r.text.length,a);if(i>c)return[...e,t];const l=Math.min(0,s),u=a-s-(c-i),d=uk(dk(r.range.start+l,r.range.end+l+u,r.text.slice(0,i)+o.text+r.text.slice(c)),t.fieldName);return[...e.slice(0,-1),d]}),new Array),this.currentVersion),this.pendingEvents=[])}handleInitializedMessage(){this.sentEvents.length>0&&this.sendEvents(this.sentEvents,this.currentVersion),this.isInitialized=!0,this.trySendPendingEvents()}}var gC,mC=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(e){s(e)}}function i(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.Connecting=0]="Connecting",e[e.Reconnecting=1]="Reconnecting",e[e.Restoring=2]="Restoring",e[e.Connected=3]="Connected",e[e.Disconnected=4]="Disconnected"}(gC||(gC={}));class _C extends Error{constructor(){super(...arguments),this.name="ConnectionError"}}class yC extends Error{constructor(e){super("There was an error with the session on the server. See the info property for details."),this.info=e,this.name="SessionError"}}class vC{constructor(e,t,n,r){this.connection=e,this.config=t,this.client=n,this.metaInfo=r,this.participantResponses=new Cw,this.participantRequests=new Cw,this.errorInfoSubject=new Cw,this.error=this.errorInfoSubject.asObservable(),this.statusSubject=new xw(gC.Disconnected),this.status=this.statusSubject.asObservable(),this.messages=LA(this.participantResponses,this.participantRequests).pipe(PA(((e,t)=>[...e,t]),[]),function(e,t,n){var r,o,s,a,i=!1;return e&&"object"==typeof e?(r=e.bufferSize,a=void 0===r?1/0:r,o=e.windowTime,t=void 0===o?1/0:o,i=void 0!==(s=e.refCount)&&s,n=e.scheduler):a=null!=e?e:1/0,DA({connector:function(){return new Nw(a,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}()),this.eventHandler=new fC(this.participantResponses),this.client.addChangeHandler((e=>this.eventHandler.addClientEvents(e))),this.eventHandler.incomingEvents.subscribe((e=>this.client.applyFieldEvent(e))),this.participantResponses.pipe(SA(hC),NA(pC)).subscribe((e=>{var t;return null===(t=this.metaInfo)||void 0===t?void 0:t.addMetaInfoMessage(e)})),this.connection.onclose((e=>{this.statusSubject.next(gC.Disconnected),this.errorInfoSubject.next(new _C(`The connection was closed with error: ${e}`))}))}connect(e){return mC(this,void 0,void 0,(function*(){if(this.statusSubject.value!==gC.Disconnected)return;if(this.connection.on("OnError",(e=>{this.connection.off("OnError"),this.statusSubject.next(gC.Disconnected),this.errorInfoSubject.next(new yC(e))})),this.startSessionResponse&&!e?this.statusSubject.next(gC.Reconnecting):this.statusSubject.next(gC.Connecting),this.connection.state!==$b.Connected)try{yield this.connection.start()}catch(e){throw this.statusSubject.next(gC.Disconnected),new _C(`Error starting connection: ${e}`)}this.startSessionResponse&&!e||(this.startSessionResponse=yield this.startSession(e));const t=this.connection.stream("GetMessages",this.startSessionResponse.sessionToken,this.eventHandler.currentVersion).subscribe({next:e=>{this.statusSubject.value!==gC.Connected&&this.statusSubject.next(gC.Connected),this.participantResponses.next(e)},error:()=>{},complete:()=>{}});this.connection.on("OnError",(()=>t.dispose()));try{yield this.connection.send("AppendMessages",this.startSessionResponse.sessionToken,this.participantRequests)}catch(e){throw this.statusSubject.next(gC.Disconnected),new _C(`Error starting 'AppendMessages': ${e}`)}var n;this.eventHandler.connectToSession(((e,t)=>{const n=e.map((e=>Object.assign(Object.assign({},e),{participantId:this.startSessionResponse.participantId})));if(this.statusSubject.value!==gC.Connected)return n;const r=kk(function(e,t){return{$type:BR.$type,events:e,baseVersion:t}}(n,t));return this.participantRequests.next(r),n})),this.config.accessToken.pipe((n=this.status.pipe(NA((e=>e===gC.Connected))),bw((function(e,t){var r=!1,o=Ew(t,(function(){null==o||o.unsubscribe(),r=!0}),cw);hA(n).subscribe(o),e.subscribe(Ew(t,(function(e){return r&&t.next(e)})))})))).subscribe((e=>this.updateAuthenticationToken(e)))}))}startSession(e){return mC(this,void 0,void 0,(function*(){const t={$type:MR.$type,sessionMode:this.client.sessionMode,baseDocument:e,translatorSessionOptions:{$type:ZI.$type,enableTranscription:this.config.enableTranscription}};let n;try{n=yield this.connection.invoke("StartSession",t)}catch(e){throw this.statusSubject.next(gC.Disconnected),new _C(`Error starting session: ${e}`)}if(!n)throw this.statusSubject.next(gC.Disconnected),new _C("No StartSessionResponse returned from StartSession");return n}))}restore(){return mC(this,void 0,void 0,(function*(){this.statusSubject.next(gC.Restoring),this.connection.off("OnError");const e=this.client.document.serialize();this.client.document.reset();const t=new vC(this.connection,this.config,this.client,this.metaInfo);try{yield t.connect(e)}catch(e){throw this.statusSubject.next(gC.Disconnected),e}return t}))}updateAuthenticationToken(e){this.participantRequests.next(kk({$type:HR.$type,token:e}))}}class TC extends Vk{constructor(){super(IR.WRITE_LANGUAGES,mR.$type),this.languageCodes=this.value.pipe(SA((e=>{var t;return null!==(t=null==e?void 0:e.languages.map((e=>e.code)))&&void 0!==t?t:[]})))}}class SC extends Vk{constructor(){super(IR.WRITE_REQUESTED_LANGUAGE,_R.$type)}updateLanguage(e){if("autodetect"===e){return super.set(void 0)}return super.set({$type:_R.$type,language:{$type:SR.$type,code:e}})}}class bC extends Vk{constructor(){super(IR.WRITE_CALCULATED_LANGUAGE,yR.$type),this.language=this.value.pipe(NA((e=>!!e)),SA((e=>{var t;return null===(t=e.language)||void 0===t?void 0:t.code}))),this.isAutoDetected=this.value.pipe(NA((e=>!!e)),SA((e=>e.origin===vI.LANGUAGE_DETECTION)))}updateLanguage(e){return super.set({$type:yR.$type,language:{$type:SR.$type,code:e},origin:vI.REQUESTED_LANGUAGE})}}class EC extends jk{constructor(){super(...arguments),this.sourceTextUnitAnnotations=this.registerAnnotation(new Pk(wI.$type,{requiresTransformation:!0})),this.diffUnitAnnotations=this.registerAnnotation(new Pk(gR.$type,{requiresTransformation:!0})),this.languages=this.registerProperty(new TC),this.requestedLanguage=this.registerProperty(new SC),this.calculatedLanguage=this.registerProperty(new bC),this.maximumTextLengthProperty=this.registerProperty(new Bk),this.unsupportedLanguageProperty=this.registerProperty(new Hk)}}class wC extends Vk{constructor(){super(IR.WRITE_STYLE_VARIANTS,vR.$type),this.styleVariants=this.value.pipe(SA((e=>null==e?void 0:e.styleVariants.map((e=>e.value)))))}}class AC extends Vk{constructor(){super(IR.WRITE_STYLE_VARIANT,TR.$type),this.styleVariant=this.value.pipe(SA((e=>null==e?void 0:e.styleVariant)))}updateStyleVariant(e){return super.set({$type:TR.$type,styleVariant:e?{$type:bR.$type,value:e}:void 0})}}class IC extends Vk{constructor(){super(IR.TRANSLATOR_GLOSSARY_SUPPORT,zI.$type),this.supported=this.value.pipe(SA((e=>!!e)))}}class RC extends Vk{constructor(){super(IR.TRANSLATOR_GLOSSARY_LIST,oR.$type),this.entries=this.value.pipe(SA((e=>{var t;return null!==(t=null==e?void 0:e.glossaryEntries)&&void 0!==t?t:[]})))}updateNeverEditList(e){return super.set(void 0===e?void 0:{$type:oR.$type,glossaryEntries:e})}}class kC extends Vk{constructor(){super(IR.TRANSLATOR_GLOSSARY_ID,YI.$type)}update(e){return super.set(void 0===e?void 0:{$type:YI.$type,glossaryId:e})}}class CC extends jk{constructor(){super(...arguments),this.targetTextUnitAnnotations=this.registerAnnotation(new Pk(wI.$type,{requiresTransformation:!0})),this.diffUnitAnnotations=this.registerAnnotation(new Pk(gR.$type,{requiresTransformation:!0})),this.styleVariantsProperty=this.registerProperty(new wC),this.styleVariantProperty=this.registerProperty(new AC),this.maximumTextLengthProperty=this.registerProperty(new Bk),this.neverEditSupport=this.registerProperty(new IC),this.neverEditListProperty=this.registerProperty(new RC),this.glossaryId=this.registerProperty(new kC),this.requestWordAlternativesAnnotations=this.registerAnnotation(new Pk(AI.$type)),this.providedWordAlternativesAnnotations=this.registerAnnotation(new Pk(II.$type,{requiresTransformation:!0})),this.selectWordAlternativeAnnotations=this.registerAnnotation(new Pk(RI.$type)),this.requestTextUnitAlternativesAnnotations=this.registerAnnotation(new Pk(kI.$type)),this.providedTextUnitAlternativesAnnotations=this.registerAnnotation(new Pk(CI.$type,{requiresTransformation:!0})),this.selectTextUnitAlternativeAnnotations=this.registerAnnotation(new Pk(OI.$type)),this.providedAutomaticTextUnitAlternativesAnnotations=this.registerAnnotation(new Pk(PI.$type,{requiresTransformation:!0})),this.selectAutomaticTextUnitAlternativeAnnotations=this.registerAnnotation(new Pk(DI.$type))}}class OC extends Ok{constructor(){super(...arguments),this.sourceTextField=this.registerField(new EC(AR.WRITE_SOURCE_TEXT)),this.targetTextField=this.registerField(new CC(AR.WRITE_TARGET_TEXT)),this.textUnitAnnotations=CA([this.sourceTextField.sourceTextUnitAnnotations.annotations,this.targetTextField.targetTextUnitAnnotations.annotations]).pipe(SA((e=>{const t=e[0],n=e[1];return t.sort(((e,t)=>e.operation.range.start-t.operation.range.start)).map((e=>{var t,r;const o=e.operation.range,s=null!==(r=null===(t=n.find((t=>{var n,r;return(null===(n=e.specificPayload.textUnitId)||void 0===n?void 0:n.value)===(null===(r=t.specificPayload.textUnitId)||void 0===r?void 0:r.value)})))||void 0===t?void 0:t.operation.range)&&void 0!==r?r:_I.fromJSON({});return{sourceStart:o.start,sourceEnd:o.end,sourceLength:o.end-o.start,targetStart:s.start,targetEnd:s.end,targetLength:s.end-s.start}}))})))}}class xC extends fk{constructor(){super("Write",RR.WRITE,new OC)}applyFieldEvent(e){if(e.fieldName===AR.WRITE_TARGET_TEXT&&e.textChangeOperation){const e=[];e.push(...this.cancelTextUnitAlternativesFlows()),e.push(...this.cancelWordAlternativesFlows()),this.publishChange(AR.WRITE_TARGET_TEXT,e)}this.document.applyItaEvent(e)}updateSourceText(e){const t=this.document.sourceTextField.update(e);this.publishChange(AR.WRITE_SOURCE_TEXT,t)}updateTargetText(e){const t=[];t.push(...this.cancelTextUnitAlternativesFlows()),t.push(...this.cancelWordAlternativesFlows()),t.push(...this.document.targetTextField.update(e)),this.publishChange(AR.WRITE_TARGET_TEXT,t)}updateRequestedLanguage(e){const t=this.document.sourceTextField.requestedLanguage.updateLanguage(e);this.publishChange(AR.WRITE_TARGET_TEXT,t)}updateStyleVariant(e){const t=this.document.targetTextField.styleVariantProperty.updateStyleVariant(e);this.publishChange(AR.WRITE_TARGET_TEXT,t)}updateNeverEditList(e){const t=this.document.targetTextField.neverEditListProperty.updateNeverEditList(e);this.publishChange(AR.WRITE_TARGET_TEXT,t)}cancelWordAlternativesFlows(){return this.document.targetTextField.requestWordAlternativesAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestWordAlternativesAnnotations.removeAnnotation(e.operation.annotationId)))}updateNeverEditGlossaryId(e){const t=this.document.targetTextField.glossaryId.update(e);this.publishChange(AR.WRITE_TARGET_TEXT,t)}cancelTextUnitAlternativesFlows(){return this.document.targetTextField.requestTextUnitAlternativesAnnotations.annotations.value.flatMap((e=>this.document.targetTextField.requestTextUnitAlternativesAnnotations.removeAnnotation(e.operation.annotationId)))}requestWordAlternatives(e){const t=[];t.push(...this.cancelWordAlternativesFlows());const n=this.document.targetTextField.requestWordAlternativesAnnotations.add(e,e,{$type:AI.$type,flowId:{$type:lR.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(AR.WRITE_TARGET_TEXT,t)}requestTextUnitAlternatives(e){const t=[];t.push(...this.cancelTextUnitAlternativesFlows());const n=this.document.targetTextField.requestTextUnitAlternativesAnnotations.add(e,e,{$type:kI.$type,flowId:{$type:pR.$type,value:crypto.randomUUID()}})[0];t.push(n),this.publishChange(AR.WRITE_TARGET_TEXT,t)}selectWordAlternative(e,t,n){const r=[];r.push(...this.cancelTextUnitAlternativesFlows());const o=this.document.targetTextField.selectWordAlternativeAnnotations.add(e,e,{$type:RI.$type,flowId:{$type:lR.$type,value:t},selection:n});r.push(...o),this.publishChange(AR.WRITE_TARGET_TEXT,r)}selectTextUnitAlternative(e,t,n){const r=[];r.push(...this.cancelWordAlternativesFlows());const o=this.document.targetTextField.selectTextUnitAlternativeAnnotations.add(e,e,{$type:OI.$type,flowId:{$type:pR.$type,value:t},selection:n});r.push(...o),this.publishChange(AR.WRITE_TARGET_TEXT,r)}selectAutomaticTextUnitAlternative(e,t){const n=[],r=this.document.targetTextField.selectAutomaticTextUnitAlternativeAnnotations.add(e,e,{$type:DI.$type,selection:t});n.push(...r),this.publishChange(AR.WRITE_TARGET_TEXT,n)}}class LC{constructor(e,t){this.serverUrl=e;const n=new URL(e);n.pathname+="/sessions",this.accessTokenSubject=new xw(t);const r=(new tE).withHubProtocol(new GE({extensionCodec:ok()})).configureLogging(pb.Critical);t?r.withUrl(n.toString(),{accessTokenFactory:()=>this.accessTokenSubject.value}):r.withUrl(n.toString()),this.connection=r.build()}createSession(e,t,n){const r=Object.assign(Object.assign({},{enableTranscription:!1}),n);return new vC(this.connection,Object.assign({accessToken:this.accessTokenSubject.pipe(NA((e=>"string"==typeof e)))},r),e,t)}updateAccessToken(e){this.accessTokenSubject.next(e)}}const NC="ITA_RATE_LIMITED",PC="ITA_RATE_LIMITED_RESTRICTED",DC="800_rate_limited",MC="801_rate_limited_restricted",UC="1600_session_ended_authentication_token_expired",$C=e=>{if(e instanceof _C)return!0;const t=e.info;return t.statusCode===cI.UNAUTHENTICATED&&t.detailCode.value===UC},FC=e=>{if(e instanceof _C)return!1;const t=e.info;if(t.statusCode===cI.RESOURCE_EXHAUSTED)switch(t.detailCode.value){case DC:case MC:return!0;default:return!1}return!1},GC=e=>{switch(e.info.detailCode.value){case DC:return NC;case MC:return PC;default:return}},jC=e=>{if(1!==e.length)for(let t=e.length-2;t>=0;--t){const n=e[t];if("metaInfoMessage"in n&&n?.metaInfoMessage?.idle)return;if("appendMessage"in n)return n}},VC={TEXT_CHANGE:"textChange",TARGET_LANGUAGE_CHANGE:"targetLanguageChange",FORMALITY_CHANGE:"formalityChange",WRITE_STYLE_CHANGE:"writeStyleChange"},WC="translatorRequestedTargetLanguageValue",qC="translatorFormalityModeValue",BC="writeStyleVariantValue",HC=e=>{if(e.textChangeOperation)return VC.TEXT_CHANGE;if(e.setPropertyOperation){if(WC in e.setPropertyOperation)return VC.TARGET_LANGUAGE_CHANGE;if(qC in e.setPropertyOperation)return VC.FORMALITY_CHANGE;if(BC in e.setPropertyOperation)return VC.WRITE_STYLE_CHANGE}},JC={},zC=(e,t)=>{JC[e]||(JC[e]={}),JC[e]={...JC[e],...t},kg()&&console.log("Updated translate port settings",JC)},YC=e=>JC[e]??{};function XC(e){e.name in JC&&delete JC[e.name]}const KC={},QC=(e,t)=>{KC[e]||(KC[e]={}),KC[e]={...KC[e],...t},kg()&&console.log("Updated write port settings",KC)},ZC=e=>KC[e]??{};function eO(e){e.name in KC&&delete KC[e.name]}const tO={ITA_REQUEST_TRANSLATION:"ITA_REQUEST_TRANSLATION",ITA_CLOSE_TRANSLATION_SESSION:"ITA_CLOSE_TRANSLATION_SESSION",ITA_REQUEST_WRITE:"ITA_REQUEST_WRITE",ITA_WRITE_UPDATE_SOURCE_TEXT:"ITA_WRITE_UPDATE_SOURCE_TEXT",ITA_RESTORE_TRANSLATE_SESSION:"ITA_RESTORE_TRANSLATE_SESSION",ITA_TRANSLATE_SOURCE_LANGUAGE:"ITA_TRANSLATE_SOURCE_LANGUAGE",ITA_TRANSLATE_SOURCE_LANGUAGE_IS_AUTO_DETECTED:"ITA_TRANSLATE_SOURCE_LANGUAGE_IS_AUTO_DETECTED",ITA_TARGET_TEXT_FIELD:"ITA_TARGET_TEXT_FIELD",ITA_WRITE_TARGET_TEXT_FIELD:"ITA_WRITE_TARGET_TEXT_FIELD",ITA_UPDATE_FORMALITY:"ITA_UPDATE_FORMALITY",ERROR:"ERROR",ITA_DOCUMENT_STATE:"ITA_DOCUMENT_STATE",ITA_WRITE_DOCUMENT_STATE:"ITA_WRITE_DOCUMENT_STATE",ITA_WRITE_UPDATE_REQUESTED_LANGUAGE:"ITA_WRITE_UPDATE_REQUESTED_LANGUAGE",ITA_WRITE_UPDATE_STYLE_VARIANT:"ITA_WRITE_UPDATE_STYLE_VARIANT",ITA_RESTORE_WRITE_SESSION:"ITA_RESTORE_WRITE_SESSION",ITA_RATE_LIMITED:"ITA_RATE_LIMITED",ITA_WRITE_SOURCE_LANGUAGE:"ITA_WRITE_SOURCE_LANGUAGE",ITA_WRITE_SOURCE_LANGUAGE_IS_AUTO_DETECTED:"ITA_WRITE_SOURCE_LANGUAGE_IS_AUTO_DETECTED",ITA_CLOSE_WRITE_SESSION:"ITA_CLOSE_WRITE_SESSION",ITA_TRANSLATE_SOURCE_LANGUAGE_IS_UNSUPPORTED:"ITA_TRANSLATE_SOURCE_LANGUAGE_IS_UNSUPPORTED",ITA_WRITE_SOURCE_LANGUAGE_IS_UNSUPPORTED:"ITA_WRITE_SOURCE_LANGUAGE_IS_UNSUPPORTED",ITA_TRANSLATE_GENERIC_ERROR:"ITA_TRANSLATE_GENERIC_ERROR",ITA_WRITE_GENERIC_ERROR:"ITA_WRITE_GENERIC_ERROR",WRITE:{REQUEST:{ITA_SELECT_ALTERNATIVE:"ITA_SELECT_WRITE_ALTERNATIVE"},REPLY:{ITA_BACKEND_IDLE:"ITA_BACKEND_IDLE",ITA_TARGET_TEXT_FIELD_PROVIDED_AUTOMATIC_TEXT_UNIT_ALTERNATIVES_ANNOTATIONS:"ITA_TRANSLATE_TARGET_TEXT_FIELD_PROVIDED_AUTOMATIC_TEXT_UNIT_ALTERNATIVES_ANNOTATIONS"}},TRANSLATE:{REQUEST:{ITA_UPDATE_TARGET_LANGUAGE:"ITA_UPDATE_TARGET_LANGUAGE",ITA_SELECT_ALTERNATIVE:"ITA_SELECT_TRANSLATE_ALTERNATIVE"},REPLY:{ITA_BACKEND_IDLE:"ITA_BACKEND_IDLE",ITA_TARGET_TEXT_FIELD_PROVIDED_AUTOMATIC_TEXT_UNIT_ALTERNATIVES_ANNOTATIONS:"ITA_WRITE_TARGET_TEXT_FIELD_PROVIDED_AUTOMATIC_TEXT_UNIT_ALTERNATIVES_ANNOTATIONS"}}},nO={};async function rO({sourceText:e,targetLanguage:t,port:n,itaDocumentState:r,domainName:o,isRetryAttempt:s=!1}){delete nO[n.name];const a=await hv(),i=await Xy(),c=Mg(i,D.TRANSLATOR)?"https://ita-pro.www.deepl.com/v1":"https://ita-free.www.deepl.com/v1",u=new LC(new URL(c),a),d=new dC,p=u.createSession(d);try{await p.connect(r)}catch(e){return Gg(e,yg),void n.postMessage({type:tO.ITA_TRANSLATE_GENERIC_ERROR,payload:{error:e}})}zC(n.name,{session:p,updateAccessToken:e=>{u.updateAccessToken(e)},isRetryAttempt:s}),kg()&&console.log("ITA session ID:",p.startSessionResponse?.sessionId?.value);const h=p.client;return zC(n.name,{domainName:o}),t&&h.updateRequestedTargetLanguage(wg(t)),e&&h.updateSourceText(e),function(e,t){const n=e.client,r=[];e.connection.onclose((()=>{for(const e of r)e.unsubscribe()})),r.push(e.error.subscribe((e=>{!function(e,t){nO[t.name]=e,Gg(e,yg),e instanceof yC&&(kg()&&console.error(`ITA session error, Type ${typeof e},\n        Code: ${e.info?.statusCode}; Detail Code: ${e.info?.detailCode?.value}; Fallback Codes: ${e.info?.fallbackDetailCodes.map((e=>e.value)).join(", ")}`),FC(e)&&function(e,t){const n=GC(e);if(!n)return void(kg()&&console.error(`Received a rate limiting error, but couldn't determine the corresponding internal error: ${e}`));t.postMessage({type:tO.ITA_RATE_LIMITED,payload:{warning:n}})}(e,t),zm({errorCode:e.name,errorMessage:e.message,domainName:YC(t.name).domainName,targetLang:YC(t.name).targetLanguage,websiteLanguage:YC(t.name).translateSourceLanguage,trigger:l.input,characterCount:YC(t.name)?.sourceText?.length}))}(e,t)}))),r.push(e.messages.subscribe((async e=>{const n=e[e.length-1];kg()&&console.log("ITA_TRANSLATE_IDLE_MESSAGE",n),"metaInfoMessage"in n&&n.metaInfoMessage?.idle&&(t.postMessage({type:tO.TRANSLATE.REPLY.ITA_BACKEND_IDLE}),function(e,t){const n=jC(t);if(!n?.appendMessage)return;const r=n.appendMessage.events[n.appendMessage.events.length-1],o=HC(r);if(!o)return;if(o===VC.TEXT_CHANGE)return;if(o===VC.TARGET_LANGUAGE_CHANGE||o===VC.FORMALITY_CHANGE){if(!YC(e.name).translateSourceLanguage)return;uO(e)}}(t,e))}))),r.push(n.document.targetTextField.content.subscribe((e=>{cO(n,t),t.postMessage({type:tO.ITA_TARGET_TEXT_FIELD,payload:{targetText:e}}),zC(t.name,{translatedText:e})}))),r.push(n.document.sourceTextField.content.subscribe((e=>{zC(t.name,{sourceText:e})}))),r.push(n.document.targetTextField.requestedTargetLanguageProperty.value.subscribe((e=>{zC(t.name,{targetLanguage:e?.targetLanguage?.code})}))),r.push(n.document.sourceTextField.calculatedSourceLanguageProperty.language.subscribe((e=>{const r=YC(t.name).translateSourceLanguage;cO(n,t),zC(t.name,{translateSourceLanguage:e}),t.postMessage({type:tO.ITA_TRANSLATE_SOURCE_LANGUAGE,payload:{language:e}}),r!==e&&uO(t)}))),r.push(n.document.sourceTextField.calculatedSourceLanguageProperty.isAutoDetected.subscribe((e=>{cO(n,t),zC(t.name,{isTranslateSourceLanguageAutoDetected:e}),t.postMessage({type:tO.ITA_TRANSLATE_SOURCE_LANGUAGE_IS_AUTO_DETECTED,payload:{isAutoDetected:e}})}))),r.push(n.document.sourceTextField.unsupportedLanguageProperty.unsupported.subscribe((e=>{cO(n,t),zC(t.name,{isTranslateSourceLanguageUnsupported:e}),t.postMessage({type:tO.ITA_TRANSLATE_SOURCE_LANGUAGE_IS_UNSUPPORTED,payload:{isUnsupported:e}})}))),r.push(n.document.targetTextField.providedAutomaticTextUnitAlternativesAnnotations.annotations.subscribe((e=>{const n=e.flatMap((e=>e.specificPayload.alternatives.map((t=>({text:t.text,flowId:"",index:e.operation.range?.start??0})))));t.postMessage({type:tO.TRANSLATE.REPLY.ITA_TARGET_TEXT_FIELD_PROVIDED_AUTOMATIC_TEXT_UNIT_ALTERNATIVES_ANNOTATIONS,payload:{providedAlternatives:n}})}))),kg()&&r.push(n.document.sourceTextField.maximumTextLengthProperty.value.subscribe((e=>{console.log("ITA_SOURCE_TEXT_FIELD_MAX_LENGTH",e?.max)})))}(p,n),p}async function oO(e){if(e.name in nO){const t=nO[e.name];kg()&&console.error("Detected error for session so will attempt to restore",t);const n={...YC(e.name)};delete nO[e.name];const r=async()=>{try{const t=await sO(n,e);return t?.client??null}catch(e){return console.error(`Unable to recreate ITA session, Error: ${e}`),null}};if($C(t))return await r();try{const t=await sO(n.session,e);return t?.client??null}catch(e){return console.error(`Unable to restore ITA session, Error: ${e}. Attempting to recreate session instead`),await r()}}const t=await hv();return YC(e.name).updateAccessToken?.(t),YC(e.name).session?.client??null}async function sO(e,t){return kg()&&console.log(`Attempting to recreate an ITA session for port ${t.name}`),YC(t.name).isRetryAttempt?(kg()&&console.error(`Skipping restore of ITA session for port ${t.name} as this was already attempted`),Gg(new Error("ITA session restore failed"),yg),void t.postMessage({type:tO.ITA_TRANSLATE_GENERIC_ERROR,payload:{error:new Error("ITA session restore already attempted")}})):(await(e.session?.connection.stop()),rO({...e,itaDocumentState:e.session?.client.document.serialize(),port:t,sourceText:void 0,domainName:e.domainName??"",isRetryAttempt:!0}))}async function aO({port:e,language:t}){const n=await oO(e);n&&(n.updateRequestedTargetLanguage(wg(t)),zC(e.name,{targetLanguage:t}))}async function iO(e,t){const n=await oO(e);if(!n)return;const r={value:t,$type:"deepl.pb.interactive_text_api.translator.FormalityMode"};n.updateFormalityMode(r)}function cO(e,t){t.postMessage({type:tO.ITA_DOCUMENT_STATE,payload:{itaDocumentState:e.document.serialize()}})}async function lO(e){const t=YC(e.name).session;await(t?.connection.stop()),delete nO[e.name],XC(e),kg()&&console.log(`Disposed translate session for port ${e.name}`)}const uO=async e=>{const t=YC(e.name);t.translateSourceLanguage&&await Promise.allSettled([Hm({installationId:(await ky(["installationId"])).installationId,trigger:l.input,websiteLanguage:t.translateSourceLanguage,targetLanguage:t.targetLanguage,characterCount:t.sourceText?.length,domainName:t.domainName,isIta:!0}),aS(t.translateSourceLanguage,t.targetLanguage)])};function dO(e,t){const n=YC(e.name).session?.client;n?.selectAutomaticTextUnitAlternative(t.index,t.text)}const pO=e=>{eO(e),XC(e)},hO={};async function fO({sourceText:e,requestedLanguage:t,port:n,itaDocumentState:r,domainName:o}){delete hO[n.name];const s=await hv(),a=await Xy(),i=Mg(a,D.WRITE)?"https://ita-pro.www.deepl.com/v1":"https://ita-free.www.deepl.com/v1",c=new LC(new URL(i),s),l=new xC,u=c.createSession(l);try{await u.connect(r)}catch(e){return n.postMessage({type:tO.ITA_WRITE_GENERIC_ERROR,payload:{error:e}}),void Gg(e,yg)}QC(n.name,{session:u,updateAccessToken:e=>{c.updateAccessToken(e)}}),kg()&&console.log("ITA session ID:",u.startSessionResponse?.sessionId?.value);const d=u.client;QC(n.name,{domainName:o}),t&&d.updateRequestedLanguage(wg(t)),e&&d.updateSourceText(e),function(e,t){const n=e.client,r=[];e.connection.onclose((()=>{for(const e of r)e.unsubscribe()})),r.push(n.document.targetTextField.content.subscribe((async e=>{yO(n,t),t.postMessage({type:tO.ITA_WRITE_TARGET_TEXT_FIELD,payload:{targetText:e}}),QC(t.name,{translatedText:e})}))),r.push(e.messages.subscribe((async e=>{const n=e[e.length-1];kg()&&console.log(n),"metaInfoMessage"in n&&n.metaInfoMessage?.idle&&(t.postMessage({type:tO.WRITE.REPLY.ITA_BACKEND_IDLE}),function(e,t){const n=jC(t);if(!n?.appendMessage)return;const r=n.appendMessage.events[n.appendMessage.events.length-1],o=HC(r);if(!o)return;if(o===VC.TEXT_CHANGE)return;if(o===VC.WRITE_STYLE_CHANGE){if(!ZC(e.name).translateSourceLanguage)return;bO(e)}}(t,e))}))),r.push(e.error.subscribe((e=>{!function(e,t){hO[t.name]=e,e instanceof yC&&kg()&&console.log(`ITA session error, Type ${typeof e},\n        Code: ${e.info?.statusCode}; Detail Code: ${e.info?.detailCode?.value}; Fallback Codes: ${e.info?.fallbackDetailCodes.map((e=>e.value)).join(", ")}`)}(e,t)}))),r.push(n.document.sourceTextField.content.subscribe((e=>{QC(t.name,{sourceText:e})}))),r.push(n.document.sourceTextField.calculatedLanguage.language.subscribe((e=>{yO(n,t);const r=ZC(t.name).writeSourceLanguage;QC(t.name,{writeSourceLanguage:e}),t.postMessage({type:tO.ITA_WRITE_SOURCE_LANGUAGE,payload:{language:e}}),r!==e&&bO(t)}))),r.push(n.document.sourceTextField.calculatedLanguage.isAutoDetected.subscribe((e=>{yO(n,t),QC(t.name,{isWriteSourceLanguageAutoDetected:e}),t.postMessage({type:tO.ITA_WRITE_SOURCE_LANGUAGE_IS_AUTO_DETECTED,payload:{isAutoDetected:e}})}))),r.push(n.document.sourceTextField.unsupportedLanguageProperty.unsupported.subscribe((e=>{yO(n,t),QC(t.name,{isWriteSourceLanguageUnsupported:e}),t.postMessage({type:tO.ITA_WRITE_SOURCE_LANGUAGE_IS_UNSUPPORTED,payload:{isUnsupported:e}})}))),r.push(n.document.targetTextField.providedAutomaticTextUnitAlternativesAnnotations.annotations.subscribe((e=>{const n=e.flatMap((e=>e.specificPayload.alternatives.map((t=>({text:t.text,flowId:"",index:e.operation.range?.start??0})))));t.postMessage({type:tO.WRITE.REPLY.ITA_TARGET_TEXT_FIELD_PROVIDED_AUTOMATIC_TEXT_UNIT_ALTERNATIVES_ANNOTATIONS,payload:{providedAlternatives:n}})})))}(u,n)}async function gO(e){if(e.name in hO){kg()&&console.error("Detected error for session so will attempt to restore",hO[e.name]),delete hO[e.name];try{await async function(e,t){try{kg()&&console.log(`Attempting to restore ITA session for port ${t.name}`);const n=await(e?.restore());await(n?.connect()),QC(t.name,{session:n})}catch(e){console.error(`Unable to restore ITA session, Error: ${e}`)}}(ZC(e.name).session,e)}catch(e){console.error(`Unable to restore ITA session, Error: ${e}`)}}const t=await hv();return ZC(e.name).updateAccessToken?.(t),ZC(e.name).session?.client??null}async function mO({port:e,language:t}){(await gO(e)).updateRequestedLanguage(wg(t)),QC(e.name,{targetLanguage:t})}async function _O(e,t){(await gO(e)).updateStyleVariant(t)}function yO(e,t){t.postMessage({type:tO.ITA_WRITE_DOCUMENT_STATE,payload:{itaDocumentState:e.document.serialize()}})}async function vO(e,t){(await gO(e)).updateSourceText(t)}async function TO(e){const t=ZC(e.name).session;await(t?.connection.stop()),delete hO[e.name],eO(e),kg()&&console.log(`Disposed write session for port ${e.name}`)}function SO(e,t){const n=ZC(e.name).session?.client;n?.selectAutomaticTextUnitAlternative(t.index,t.text)}const bO=async e=>{const t=ZC(e.name);t.translateSourceLanguage&&await Promise.allSettled([Hm({installationId:(await ky(["installationId"])).installationId,trigger:l.input,websiteLanguage:t.translateSourceLanguage,targetLanguage:t.targetLanguage,characterCount:t.sourceText?.length,domainName:t.domainName,isIta:!0}),aS(t.translateSourceLanguage,t.targetLanguage)])},EO={syncExperiments:"sync_experiments",syncClientState:"sync_client_state",trackClientStateWeb:"track_client_state_web"};function wO(e){let t;try{t=new URL(e)}catch(e){return!1}return"http:"===t.protocol||"https:"===t.protocol}const AO={developer_tools:"DEVELOPER_TOOLS",settings_page:"SETTINGS_PAGE",settings_writing:"SETTINGS_WRITING",settings_reading:"SETTINGS_READING",settings_customizations:"SETTINGS_CUSTOMIZATIONS",settings_glossary:"SETTINGS_GLOSSARY",onboarding:"ONBOARDING",onboarding_after_successful_login:"ONBOARDING_AFTER_SUCCESSFUL_LOGIN",firefox_first_run:"FIREFOX_FIRST_RUN",privacy_policy:"PRIVACY_POLICY",create_account:"CREATE_ACCOUNT"},IO={DEVELOPER_TOOLS:"dev-page.html",SETTINGS_PAGE:"settings.html",SETTINGS_READING:"settings.html#translator",SETTINGS_WRITING:"settings.html#write",SETTINGS_CUSTOMIZATIONS:"settings.html#customizations",SETTINGS_GLOSSARY:"settings.html#glossary",ONBOARDING:"onboarding.html",ONBOARDING_FIREFOX:"onboarding-firefox.html",ONBOARDING_AFTER_SUCCESSFUL_LOGIN:"onboarding.html#successful_login",FIREFOX_FIRST_RUN:"firefox-first-run.html",PRIVACY_POLICY:"privacy-policy.html",CREATE_ACCOUNT:"create-account.html"};function RO({payload:e}){const{destination:t,openInSameTab:n}=e;if(void 0===t)return;let r="";switch(t){case AO.developer_tools:r=kO(IO.DEVELOPER_TOOLS);break;case AO.settings_page:r=kO(IO.SETTINGS_PAGE);break;case AO.settings_writing:r=kO(IO.SETTINGS_WRITING);break;case AO.settings_reading:r=kO(IO.SETTINGS_READING);break;case AO.settings_customizations:r=kO(IO.SETTINGS_CUSTOMIZATIONS);break;case AO.settings_glossary:r=kO(IO.SETTINGS_GLOSSARY);break;case AO.onboarding:r=K()?kO(IO.ONBOARDING_FIREFOX):kO(IO.ONBOARDING);break;case AO.onboarding_after_successful_login:r=kO(IO.ONBOARDING_AFTER_SUCCESSFUL_LOGIN);break;case AO.firefox_first_run:r=kO(IO.FIREFOX_FIRST_RUN);break;case AO.privacy_policy:r=kO(IO.PRIVACY_POLICY);break;case AO.create_account:r=kO(IO.CREATE_ACCOUNT)}r&&(n?chrome.tabs.query({active:!0,currentWindow:!0},(function(e){const t=e[0];chrome.tabs.update(t.id,{url:r})})):chrome.tabs.create({url:r,active:!0}))}function kO(e){const t=new URL(chrome.runtime.getURL(e));return t.searchParams.append("dl_brex_internal_page","true"),t.toString()}async function CO({request:e,port:t}){try{const n={nicheIntegration:e.nicheIntegration||k.default,sourceTexts:[e.sourceText],isWriteRequest:!1};await Kv(n),await rO({sourceText:e.sourceText,targetLanguage:e.targetLanguage,domainName:e.domainName,port:t}),kg()&&console.log(`ITA Translator session created for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`)}catch(n){throw kg()&&console.error(`Error creating ITA Translator session for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`,n),Gg(n,yg),zm({errorCode:n.name,errorMessage:n.message,domainName:e.domainName,targetLang:e.targetLanguage,websiteLanguage:e.websiteLanguage,trigger:e.trigger,characterCount:e.sourceText.length}),n}}async function OO({request:e,port:t}){try{const n={nicheIntegration:e.nicheIntegration||k.default,sourceTexts:[e.sourceText],isWriteRequest:!0};await Kv(n),await fO({sourceText:e.sourceText,requestedLanguage:e.requestedLanguage,domainName:e.domainName,port:t}),kg()&&console.log(`ITA Write session created for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`)}catch(e){throw kg()&&console.error(`Error creating ITA Write session for sender: ${t.sender?.tab?.url}, tab ID: ${t.sender?.tab?.id}}`,e),e}}function xO(e,t,n){switch(kg()&&!{IS_PROD:!0,BASE_URLS:{dapApi:"https://s.deepl.com/chrome/statistics",toolingApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApiPro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",toolingWriteApi:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApi:"https://www2.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiPro:"https://api.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWrite:"https://write-free.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiWritePro:"https://write-pro.www.deepl.com/jsonrpc?client=chrome-extension,1.30.0",classicApiGlossary:"https://api.deepl.com/termbases/jsonrpc?client=chrome-extension,1.30.0",interactiveTextApiFree:"https://ita-free.www.deepl.com/v1",interactiveTextApiPro:"https://ita-pro.www.deepl.com/v1",login:"https://www.deepl.com/auth/login",token:"https://w.deepl.com/oidc/token",logout:"https://www.deepl.com/auth/logout",feedbackSurvey:"https://deepl.typeform.com/to/MkMfP2Y6",newFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_cMvbeX0WZGvkKGi",firefoxFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eyfDZqQmXuNTFOK",uninstallSurvey:"https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU",gslidesFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_9XBLSAbDmLq5emO",deeplDomain:"https://www.deepl.com",deeplPro:"https://www.deepl.com/pro",deeplProWrite:"https://www.deepl.com/pro-write",deeplTranslator:"https://www.deepl.com/translator",deeplDoctrans:"https://www.deepl.com/translator/files",deeplTermsOfServiceFree:"https://www.deepl.com/en/pro-license?tab=free",deeplCreateAccount:"https://www.deepl.com/signup",extensionStorePage:"https://bit.ly/DeepL-Chrome",supportArticle:"https://support.deepl.com/hc/articles/4407580229522",deeplSupport:"https://support.deepl.com/hc",chromeWebstore:"https://chrome.google.com/webstore/detail/deepl-translate-reading-w/cofdbpoegempjloogbagkncekinflcnj",edgeWebstore:"https://microsoftedge.microsoft.com/addons/detail/deepl-translate-reading-/fancfknaplihpclbhbpclnmmjcjanbaf",firefoxWebstore:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate",firefoxShortcutDocs:"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox",firefoxPrivacyPolicy:"https://addons.mozilla.org/en-US/firefox/addon/deepl-translate/privacy/",clientStateApi:"https://w.deepl.com/web",experimentsEndpoint:"https://experimentation.deepl.com/experiments",gmailFeedbackSurvey:"https://deepl.qualtrics.com/jfe/form/SV_db8ItFTmYBcZjYW",customerSegmentationSurveyFree:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2071",customerSegmentationSurveyPro:"https://deepl.qualtrics.com/jfe/form/SV_3LbBcdg4mjQuCCq?desc=TG-2070",arabicSurvey:"https://deepl.qualtrics.com/jfe/form/SV_ekTrC2ePp0wn7xQ",msAddinsDeepLAds:"https://www.deepl.com/en/microsoft-365"},APP_VERSION:"1.30.0",FEATURE_FLAGS:{TRANSLATE_INPUT:!0,PAGE_TRANSLATION:!0,IMPROVE_WRITING:!0,DOCUMENT_TRANSLATION:!0,RECOMMEND_TO_A_FRIEND:!0,PRO_LOGIN:!0,WEBPAGE_CUSTOMIZER:!0,GDOCS_INTEGRATION:!0,ZENDESK_INTEGRATION:!0,GMAIL_INTEGRATION:!0,GSLIDES_INTEGRATION:!0,ON_INSTALL_ONBOARDING:!0,WHATSAPP_TRANSLATE_ALL_CHAT:!1,DEEPL_WRITE_GENERAL:!1,DEEPL_WRITE_GDOCS:!0,SHOW_CUSTOMER_SEGMENTATION_SURVEY:!1,ARABIC_SURVEY:!0,REVIEW_UI_WITH_ITA:!1,BATCH_TRANSLATE_HTML_REQUEST:!0}}.DISABLE_DEBUG_LOGS&&console.log(t.tab?`message from a content script: ${t.tab.url} with tab id: ${t.tab.id}. action: ${e.action}`:`message from the extension with action: ${e.action}`),e.action){case"dlRequestHtmlTranslation":pT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestInlineTranslation":hT(e).then((e=>{n(e)})).catch((e=>{n(sm(e,yg))}));break;case"dlTriggerTranslateInline":uT(t.tab.id),n();break;case"dlTriggerTranslateInput":dT(t.tab.id),n();break;case"dlRequestInputTranslation":fT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestZendeskInputTranslation":gT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestGmailReceivedEmailTranslation":mT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestWhatsAppMessageTranslation":TT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestTwitterTweetTranslation":_T(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestYouTubeTranslation":yT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestLinkedInPostTranslation":vT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestZendeskMessageTranslation":RT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestWhatsAppMessagesTranslation":ST(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestGDocsSplitText":bT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestGDocsProcessContent":ET(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestGDocsSentenceAlternatives":wT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestGDocsWordAlternatives":AT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestGDocsSentenceFromPartialTranslation":IT(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestTermbases":kT().then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlTrackDetectLanguage":CT(e),n();break;case"dlRequestLogin":XT().then((()=>n(!0))).catch((e=>{n(sm(e,yg))}));break;case"dlRequestLogout":KT().then((()=>n(!0))).catch((e=>{n(sm(e,yg))}));break;case"dlGetAppSettings":chrome.storage.sync.get(null,(function(e){n(e)}));break;case"dlUpdateAppSettings":chrome.storage.sync.set(e.payload,(function(){n(e.payload)}));break;case"dlTranslatedInputTextNotSet":Ym({errorCode:qg,errorMessage:"The translated text could not be set",domainName:e.payload}),n();break;case"dlGetUserState":QT().then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlExternalURLRedirect":te(e.payload),n();break;case"dlOpenInternalPage":RO(e),n();break;case"dlTrackInputTranslationInjection":OT(e.payload),n();break;case"dlTrackExtensionOpenedEvent":xT(e.payload),n();break;case"dlTrackLogoClickedEvent":LT(e.payload),n();break;case"dlTrackDocTransClick":NT(),n();break;case"dlTrackRecommendToAFriendClick":PT(),n();break;case"dlSendNotification":ZT(e.payload),n();break;case"dlCheckCommandShortcuts":eS().then((e=>n(e)));break;case"dlTrackUseOfShortcut":tS(e.payload),n();break;case"dlTrackUiAction":nS(e.payload),n();break;case"dlTrackInlineSettingOpened":DT(e.payload),n();break;case"dlTrackSettingChanged":MT(e.payload),n();break;case"dlTrackUILocationClicked":ES(e.payload),n();break;case"dlTrackRightClick":UT(e.payload),n();break;case"dlTrackInlinePositionChange":$T(e.payload),n();break;case"dlTrackInlineDragStart":FT(),n();break;case"dlTrackFptHide":GT(e.payload);break;case"dlTrackInlineCopy":VT(e.payload),n();break;case"dlTrackInlineListen":qT(e.payload),n();break;case"dlTrackIconHover":jT(e.payload),n();break;case"dlTrackVoiceOverStops":BT(e.payload),n();break;case"dlTrackOnboardingStepChange":WT(e.payload),n();break;case"dlTrackOnboardingOpenExternalLink":HT(e.payload),n();break;case"dlTrackReadMore":JT(e.payload),n();break;case"dlTrackLandingOnWebsite":oS(e.payload),n();break;case"dlTrackGDocsReplaceText":zT(e.payload),n();break;case"dlGetExperiments":YT(e.payload?.forceFetch).then((e=>n(e))).catch((e=>n(e)));break;case"dlGetClientState":LS(e.payload?.forceFetch).then((e=>n(e))).catch((e=>n(e)));break;case"dlTextToSpeech":iS(e.payload,t.tab.id).then((()=>n())).catch((e=>{n(sm(e,yg))}));break;case"dlGetDictionary":fS(e.payload).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlGetSupportedVoices":cS(e.payload).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlStopSpeech":lS(e.payload).then((()=>n())).catch((e=>{n(sm(e,yg))}));break;case"dlTrackOpenInputHighlighter":uS(e.payload),n();break;case"dlTrackOpenInlineHighlighter":dS(e.payload),n();break;case"dlTrackCloseInputHighlighter":pS(e.payload),n();break;case"dlTrackCloseInlineHighlighter":hS(e.payload),n();break;case"dlTrackDictionaryStatus":gS(e.payload),n();break;case"dlTrackOpenDictionarySection":mS(e.payload),n();break;case"dlTrackDisabledDictionaryHover":_S(e.payload),n();break;case"dlTrackZendeskCustomizationEvent":yS(e.payload),n();break;case"dlTrackZendeskGlossaryOpened":US(e.payload).then((()=>n())).catch((e=>{n(sm(e,yg))}));break;case"dlTrackGlossaryEnabled":$S(e.payload).then((()=>n())).catch((e=>{n(sm(e,yg))}));break;case"dlTrackGlossaryDisabled":FS(e.payload).then((()=>n())).catch((e=>{n(sm(e,yg))}));break;case"dlTrackDeeplWriteEvent":wS(e.payload),n();break;case"dlTrackLingueeErrorData":vS(e.payload),n();break;case"dlTrackGdocsMaxCharExceededShown":TS(e.payload),n();break;case"dlTrackGDocsMaxCharExceededTryProClicked":SS(e.payload),n();break;case"dlTrackOnboardingModalShown":bS(e.payload),n();break;case"dlRequestImproveWriting":AS(e).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlSplitTextRequest":BS(e).then((e=>n(e))).catch((e=>{n(sm(e))}));break;case"dlRequestAlternatives":HS(e).then((e=>n(e))).catch((e=>{n(sm(e))}));break;case"dlTrackTranslateAcceptOrRevertEvent":IS(e.payload),n();break;case"dlTrackCustomizationEnabledEvent":RS(e.payload),n();break;case"dlTrackGmailCharLimitReached":CS(e.payload),n();break;case"dlGetUsersCharacterLimit":PS().then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlTrackAlternativesEvent":xS(e.payload),n();break;case"dlTestClassicAPI":jS(e.payload).then((e=>n(e))).catch((e=>{n(sm(e,yg))}));break;case"dlOnSuccessfulZendeskTranslation":sS();break;case"dlTrackUpgradeNotificationIsDisplayed":DS(e.payload.type);break;case"dlTrackUpgradeNotificationClosed":MS(e.payload.type);break;case"dlTrackUpgradeNotificationAction":GS(e.payload.type,e.payload.cta);break;case"dlTrackLanguageDetectionForTextProcessing":VS(e.payload).finally(n());break;case"dlTrackSeeAlternativesClicked":WS(),n();break;case"dlTrackAlternativeSelected":qS(e.payload),n();break;case"dlTrackIframeTranslationSuccessful":zS(),n();break;case"dlTrackIframeTranslationFailed":YS(e.payload),n();break;case"dlTrackClicksOnAdsButton":XS(),n();break;case"dlTrackAdsShown":KS(e.payload),n();break;case"dlTrackWriteTextStylesChanged":QS(e.payload),n();break;case"dlTrackWriteTextStylesApplied":ZS(e.payload),n();break;case"dlTrackWriteTextTonesChanged":eb(e.payload),n();break;case"dlTrackFormalitySelected":gy(e.payload),n()}return!0}function LO(e){switch(console.log(`Command "${e}" triggered`),e){case y.triggerTranslation:chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"dlTriggerTranslationShortcut"})}));break;case y.changeLanguage:chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{action:"dlChangeLanguageShortcut"})}))}}function NO(e){(async function(){let e=!1;const t=await chrome.storage.sync.get(null),n=Ag();if(!t||!t.settingSchemeVersion||t.settingSchemeVersion<n.settingSchemeVersion){let r={};for(const[o,s]of Object.entries(n))o in t&&"settingSchemeVersion"!==o?r[o]=t[o]:("installationId"===o&&(e=!0),r[o]=s);await chrome.storage.sync.clear(),await chrome.storage.sync.set(r),console.log("settings set: ",r)}return{installationIdWasSet:e}})().then((t=>{!async function(e,t){const n=await qy();if(n||e!==chrome.runtime.OnInstalledReason.INSTALL)n||await Wy();else{await Wy(),I_(),W_();try{py(await NS())}catch(e){fy(),console.error(e)}}t&&V_()}(e.reason,t.installationIdWasSet)})).catch((e=>Jm({errorCode:Wg,errorMessage:`setSettingsAfterInstall failed: ${e.message}`}))).finally((()=>{try{YT(),LS(!0),async function(){await chrome.alarms.clearAll(),await chrome.alarms.create(EO.syncExperiments,{delayInMinutes:10,periodInMinutes:10}),await chrome.alarms.create(EO.syncClientState,{delayInMinutes:30,periodInMinutes:30}),await chrome.alarms.create(EO.trackClientStateWeb,{delayInMinutes:1440,periodInMinutes:1440})}()}catch(e){console.error(e),Jm({errorCode:Wg,errorMessage:e.message})}try{chrome.runtime.setUninstallURL("https://deepl.qualtrics.com/jfe/form/SV_eJxAD8c7J5hqSRU"),e.reason===chrome.runtime.OnInstalledReason.UPDATE&&console.log(`Update from version ${e.previousVersion} to ${chrome.runtime.getManifest().version} was completed`),e.reason===chrome.runtime.OnInstalledReason.INSTALL&&Rg()!==Ig.test&&(K()?RO({payload:{destination:AO.firefox_first_run}}):RO({payload:{destination:AO.create_account}})),chrome.contextMenus.removeAll((function(){chrome.contextMenus.create({id:"dlTranslateWithDeepL",title:chrome.i18n.getMessage("right_click_menu_translate_with_deepl"),contexts:["all"]})})),chrome.tabs.query({},(function(e){for(const t of e)wO(t)&&chrome.scripting.executeScript({target:{tabId:t},files:["build/content.js"]})}))}catch(e){Jm({errorCode:Wg,errorMessage:e.message})}}))}function PO(e){switch(e.name){case EO.syncExperiments:YT();break;case EO.syncClientState:LS();break;case EO.trackClientStateWeb:NS().then((e=>hy(e))).catch((()=>fy()))}}function DO(e){"dlTranslateWithDeepL"===e.menuItemId&&rS(!1)}function MO(){}function UO(e,t){switch(kg()&&console.log(`Port message received, port name: ${t.name}, sender: ${t.sender.tab.url}, tab ID: ${t.sender.tab.id}, message type ${e.type}`),e.type){case tO.ITA_REQUEST_TRANSLATION:CO({request:e.payload,port:t}).then().catch((e=>{FO(e,t)}));break;case tO.TRANSLATE.REQUEST.ITA_UPDATE_TARGET_LANGUAGE:aO({port:t,language:e.payload.language});break;case tO.ITA_UPDATE_FORMALITY:iO(t,e.payload.formality);break;case tO.ITA_RESTORE_TRANSLATE_SESSION:rO({itaDocumentState:e.payload.itaDocumentState,domainName:e.payload.domainName,port:t});break;case tO.ITA_REQUEST_WRITE:OO({request:e.payload,port:t}).then().catch((e=>{FO(e,t)}));break;case tO.ITA_WRITE_UPDATE_REQUESTED_LANGUAGE:mO({port:t,language:e.payload.language});break;case tO.ITA_WRITE_UPDATE_STYLE_VARIANT:_O(t,e.payload.styleVariant);break;case tO.ITA_RESTORE_WRITE_SESSION:fO({itaDocumentState:e.payload.itaDocumentState,domainName:e.payload.domainName,port:t});break;case tO.ITA_WRITE_UPDATE_SOURCE_TEXT:vO(t,e.payload.sourceText);break;case tO.ITA_CLOSE_TRANSLATION_SESSION:lO(t);break;case tO.ITA_CLOSE_WRITE_SESSION:TO(t);break;case tO.WRITE.REQUEST.ITA_SELECT_ALTERNATIVE:SO(t,e.payload.alternative);break;case tO.TRANSLATE.REQUEST.ITA_SELECT_ALTERNATIVE:dO(t,e.payload.alternative);break;default:kg()&&console.log(`Unrecognised message type: ${e.type}`)}}function $O(e){kg()&&console.log(`Port name: ${e.name} disconnected`),pO(e)}function FO(e,t){t.postMessage({type:tO.ERROR,payload:sm(e,yg)})}const GO={setBrowserExtensionUserAgent:{type:"modifyHeaders",requestHeaders:[{header:"user-agent",operation:"set",value:`DeepLBrowserExtension/1.30.0 ${navigator.userAgent} `}]}},jO={lingueeDomainFilter:{excludedDomains:["linguee.com"],urlFilter:"*://www-app.linguee.com*",resourceTypes:["xmlhttprequest"]},deeplToolingApiDomainFilter:{excludedDomains:["deepl.com"],urlFilter:"*://*.deepl.com/jsonrpc?client=chrome-extension,*",resourceTypes:["xmlhttprequest"]},deeplStatisticsDomainFilter:{excludedDomains:["deepl.com"],urlFilter:"*://s.deepl.*/chrome/statistics*",resourceTypes:["xmlhttprequest"]}};function VO(){if(chrome.declarativeNetRequest)chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:[2,3,4],addRules:[{id:2,priority:1,action:GO.setBrowserExtensionUserAgent,condition:jO.lingueeDomainFilter},{id:3,priority:1,action:GO.setBrowserExtensionUserAgent,condition:jO.deeplToolingApiDomainFilter},{id:4,priority:1,action:GO.setBrowserExtensionUserAgent,condition:jO.deeplStatisticsDomainFilter}]},(async e=>{kg()&&await console.log("created",e)}));else if(chrome.webRequest?.onBeforeSendHeaders){const e=kg()?"https://test.deepl.com/":"https://www.deepl.com/";browser.webRequest.onBeforeSendHeaders.addListener((t=>{const n=t.requestHeaders;return n.push({name:"Referer",value:e}),{requestHeaders:n}}),{urls:["*://*.deepl.com/jsonrpc?client=chrome-extension,*"]},["requestHeaders","blocking"]),browser.webRequest.onBeforeSendHeaders.addListener((function(e){for(const t of e.requestHeaders)if("User-Agent"===t.name){t.value=`DeepLBrowserExtension/1.30.0 ${navigator.userAgent}`;break}return{requestHeaders:e.requestHeaders}}),{urls:["*://www-app.linguee.com/*","*://*.deepl.com/jsonrpc?client=chrome-extension,*","https://s.deepl.com/chrome/statistics"]},["blocking","requestHeaders"])}}var WO;return self.addEventListener("error",(function(e){const t=e.message||"";$g(t)&&e.preventDefault()})),self.addEventListener("unhandledrejection",(function(e){const t=e.reason&&e.reason.message||"";$g(t)&&e.preventDefault()})),Yc({...Fg}),kr("appContext",{location:"background"}),WO=yg,chrome.storage.sync.get(["installationId","session","isLoggedIn","translatorServiceType","writeServiceType"],(function(e){WO.setTag("internal_session_id",e?.session?.id),WO.setTag("is_translator_pro",Mg(e,D.TRANSLATOR)),WO.setTag("is_write_pro",Mg(e,D.WRITE)),WO.setTag("is_logged_in",e.isLoggedIn)})),chrome.storage.local.get("browserInstanceId",(function(e){WO.setTag("browser_instance_id",e.browserInstanceId)})),chrome.storage.onChanged.addListener((e=>(e?.session?.newValue&&WO.setTag("internal_session_id",e.session.newValue.id),e?.installationId&&WO.setUser({id:e.installationId}),e?.browser_instance_id&&WO.setTag("browser_instance_id",Pg.browserInstanceId.newValue),!0!==e.isLoggedIn?.newValue&&!1!==e.isLoggedIn?.newValue||WO.setTag("is_logged_in",e.isLoggedIn.newValue),e.translatorServiceType&&chrome.storage.sync.get(["isLoggedIn"],WO.setTag("is_translator_pro",Mg({...Pg,translatorServiceType:e.translatorServiceType.newValue},D.TRANSLATOR))),e.writeServiceType&&chrome.storage.sync.get(["isLoggedIn"],WO.setTag("is_write_pro",Mg({...Pg,writeServiceType:e.writeServiceType.newValue},D.WRITE))),!0))),console.info("Sentry initialised"),VO(),chrome.runtime.onInstalled.addListener(NO),chrome.contextMenus.onClicked.addListener(DO),chrome.tabs.onActivated.addListener((async function(e){wO((await chrome.tabs.get(e.tabId)).url)&&chrome.tabs.sendMessage(e.tabId,{action:"dlTabChanged"}),chrome.tabs.query({},(function(t){for(const n of t)chrome.tabs.sendMessage(n.id,{action:"dlChangeActiveTabStatus",payload:{isActive:n.id===e.tabId}})})),LS()})),chrome.runtime.onConnect.addListener((function(e){kg()&&console.log(`PORT connected to tab with id: ${e.sender.tab.id}, port name: ${e.name}`),e.onMessage.addListener(UO),e.onDisconnect.addListener($O)})),chrome.runtime.onMessage.addListener(xO),chrome.storage.onChanged.addListener(MO),chrome.commands.onCommand.addListener(LO),chrome.alarms.onAlarm.addListener(PO),chrome.runtime.onMessage.addListener((e=>("reload"===e&&chrome.tabs.query({active:!0}).then((()=>{chrome.runtime.reload(),chrome.tabs.reload()})),!0))),K()||chrome.webRequest.onBeforeSendHeaders.addListener((()=>{}),{urls:["<all_urls>"]},["requestHeaders","extraHeaders"]),e.CONTENT_PROCESS_MODE=qv,e.EVENT_TYPES=VC,e.INTERNAL_PAGE_KEYS=AO,e.MAX_TRANSLATION_BATCH_SIZE=nT,e.PERODIC_CODE_EXECUTION_NAMES=EO,e.URL_ACTIONS=Q,e.URL_LIST=Z,e.cacheClientState=wy,e.cacheExperiments=Iy,e.checkCommandShortcuts=eS,e.checkLimits=Kv,e.clearLoginTimestamp=Fy,e.commandListener=LO,e.connectDatabase=Sy,e.createBatches=eT,e.createITATranslatorSession=rO,e.createITAWriteSession=fO,e.createInteractiveTranslation=CO,e.createInteractiveWrite=OO,e.deleteAuthTokens=Ly,e.deletePortSettings=pO,e.deleteTranslationPortSettings=XC,e.deleteWritePortSettings=eO,e.determineEventType=HC,e.disposeTranslateSession=lO,e.disposeWriteSession=TO,e.doesErrorIndicateBrokenSession=$C,e.extractMostRecentNonIdleRequestFromMessages=jC,e.fetchClientState=uv,e.fetchClientStateWeb=Sv,e.fetchExperiments=Qy,e.fetchGDocsSentenceAlternatives=wT,e.fetchGDocsWordAlternatives=AT,e.fetchTermbases=kT,e.getAccessToken=hv,e.getAccountID=By,e.getActiveTermbase=JS,e.getActiveTranslator=oO,e.getActiveWriter=gO,e.getAllServiceLevels=Xy,e.getAuthTokens=Py,e.getBrowserInstanceId=qy,e.getCachedClientState=Ay,e.getCachedExperiments=Ry,e.getCharacterLimit=zy,e.getClientState=LS,e.getClientStateWeb=NS,e.getCurrentExperiments=async function(){try{const e=await Ey(Ty,yy);return e&&e.meta&&e.data?e.data:[]}catch(e){return[]}},e.getDapAlternativesSegmentationType=Mm,e.getDapApiConfig=am,e.getDapApiExtensionOpenedFromId=lm,e.getDapApiInlinePositionType=_m,e.getDapApiLingueeError=cm,e.getDapApiLogoClickedFromId=um,e.getDapApiNotificationType=dm,e.getDapApiSettingType=mm,e.getDapApiShortcutTypes=hm,e.getDapApiTranslationTriggerId=im,e.getDapApiUiActionEventId=fm,e.getDapApiUiFunctionality=gm,e.getDapApiUiLocation=pm,e.getDapContentProcessingModeType=Pm,e.getDapGmailActionType=Lm,e.getDapLogoutTrigger=km,e.getDapNicheIntegration=bm,e.getDapOnboardingExternalLink=ym,e.getDapOnboardingStepChangeTrigger=vm,e.getDapOriginStore=Tm,e.getDapServiceLevel=xm,e.getDapSessionType=Um,e.getDapSessionTypeTrigger=Cm,e.getDapUidCookieValue=Ky,e.getDapUpgradeNotificationAction=Dm,e.getDapUpgradeNotificationType=Nm,e.getDapWhatsAppTranslator=Om,e.getDictionary=fS,e.getExperiments=YT,e.getExperimentsData=Hy,e.getExternalUrl=ee,e.getInlineListenContext=wm,e.getInlineListenTextKind=Em,e.getInstallationId=Uy,e.getRateLimitingErrorType=GC,e.getRequestSize=tT,e.getSecondsSinceLastLogin=Gy,e.getSessionType=My,e.getSettings=ky,e.getSupportedVoices=cS,e.getTermbases=zv,e.getTranslateFormality=Im,e.getTranslationSessionSettings=YC,e.getUserInfo=Vy,e.getUserState=QT,e.getUserType=Jy,e.getUsersCharacterLimit=PS,e.getWebUserInfoData=qm,e.getWebsiteIdFromWebsite=Sm,e.getWriteSessionSettings=ZC,e.getWriteStyle=Am,e.handleJobs=Jv,e.handleSuccessfulGmailTranslationsCount=kS,e.handleSuccessfulGslidesTranslationsCount=OS,e.handleSuccessfulTranslationsCount=aS,e.handleSuccessfulZendeskTranslationsCount=sS,e.improveWriting=AS,e.isPayloadNecessaryForUIEvent=Rm,e.isProServiceLevel=Yy,e.isRateLimitingError=FC,e.isUserLoggedIn=Dy,e.jsonrpc_callFunction=gv,e.jsonrpc_composeMethodCallDict=Wm,e.listenToPerodicCodeExecution=PO,e.login=dv,e.loginRequest=XT,e.logout=pv,e.logoutRequest=KT,e.markLoginTimestamp=$y,e.messageListener=xO,e.onContextMenuClicked=DO,e.onInstalled=NO,e.onPortDisconnect=$O,e.onStorageChanged=MO,e.openInternalPage=RO,e.performGDocsProcessContent=ET,e.performGDocsSplitText=bT,e.portListener=UO,e.processContent=Bv,e.readData=Ey,e.rebuildGDocsSentenceFromPartialTranslation=IT,e.redirectToExternalURL=te,e.requestAlternatives=HS,e.requestDictionary=yv,e.resetGlossary=Ny,e.selectTranslateAlternative=dO,e.selectWriteAlternative=SO,e.sendDAPAlternativeSelected=oy,e.sendDAPAlternativesEvent=ey,e.sendDAPBrowserInstanceIdCreated=W_,e.sendDAPCloseInlineHighlighter=k_,e.sendDAPCloseInputHighlighter=w_,e.sendDAPContentScriptErrorData=Ym,e.sendDAPCustomizationEnabled=Y_,e.sendDAPDeeplWriteEvent=q_,e.sendDAPDetectLanguage=a_,e.sendDAPDictionaryStatus=C_,e.sendDAPDisabledDictionaryHover=x_,e.sendDAPDocTransClick=n_,e.sendDAPErrorData=Jm,e.sendDAPExtensionOpened=Km,e.sendDAPFPTHide=f_,e.sendDAPFTPBlockSizeExceeded=async function(e){return Bm((t=>({...t,eventId:60006,fptBlockSizeExceededData:{translationData:{sourceLang:e.websiteLanguage,targetLang:e.targetLanguage,sourceLength:e.characterCount},domainName:e.domainName}})))},e.sendDAPGDocsMaxCharExceededShown=U_,e.sendDAPGDocsMaxCharExceededTryProClicked=$_,e.sendDAPGDocsReplaceText=A_,e.sendDAPGlossaryEnabledOrDisabled=ty,e.sendDAPGmailCharLimitReached=X_,e.sendDAPIconHover=__,e.sendDAPInlineCopy=g_,e.sendDAPInlineDragStart=l_,e.sendDAPInlineListen=m_,e.sendDAPInlinePositionChange=c_,e.sendDAPInlineSettingOpened=o_,e.sendDAPInputTranslationInjection=Xm,e.sendDAPInstallSuccess=I_,e.sendDAPInstallationIdCreated=V_,e.sendDAPLandingOnSpecificWebsite=S_,e.sendDAPLingueeErrorData=L_,e.sendDAPLoggedIn=H_,e.sendDAPLoggedOut=J_,e.sendDAPLogin=D_,e.sendDAPLogoClicked=Qm,e.sendDAPLogout=M_,e.sendDAPNotificationViewed=Zm,e.sendDAPOnboardingModalShown=G_,e.sendDAPOnboardingOpenExternalPage=v_,e.sendDAPOnboardingStepChange=y_,e.sendDAPOpenDictionarySection=O_,e.sendDAPOpenInlineHighlighter=R_,e.sendDAPOpenInputHighlighter=E_,e.sendDAPReadMoreClicked=T_,e.sendDAPRecommendToAFriendClick=r_,e.sendDAPRightClick=i_,e.sendDAPSeeAlternativesClicked=ry,e.sendDAPSessionStarted=B_,e.sendDAPSettingsChanged=s_,e.sendDAPShortcutUsed=e_,e.sendDAPTrackAdsButtonClicked=iy,e.sendDAPTrackAdsShown=cy,e.sendDAPTrackDailyWebsiteUserLoginCheck=hy,e.sendDAPTrackExtensionInstallWithWebsiteUserLoginCheck=py,e.sendDAPTrackIframeTranslationFailed=ay,e.sendDAPTrackIframeTranslationSuccessful=sy,e.sendDAPTrackLanguageDetectionForTextProcessing=ny,e.sendDAPTrackUpgradeNotificationAction=Z_,e.sendDAPTrackUpgradeNotificationClosed=Q_,e.sendDAPTrackUpgradeNotificationDisplayed=K_,e.sendDAPTrackWriteTextStylesApplied=uy,e.sendDAPTrackWriteTextStylesChanged=ly,e.sendDAPTrackWriteTextTonesChanged=dy,e.sendDAPTranslateAcceptOrUndoEvent=z_,e.sendDAPTranslationErrorData=zm,e.sendDAPTranslationRequest=Hm,e.sendDAPTwitterTweetTranslationFailed=p_,e.sendDAPUILocationClicked=j_,e.sendDAPUiAction=t_,e.sendDAPVoiceOverStops=b_,e.sendDAPWhatsAppMessageTranslated=u_,e.sendDAPWhatsAppMessageTranslationFailed=d_,e.sendDAPYoutubeCommentTranslationFailed=h_,e.sendDAPZendeskCustomizationEvent=N_,e.sendDAPZendeskGlossaryConfigOpened=P_,e.sendDAPtrackSessionType=F_,e.sendDapFormalitySelected=gy,e.sendDapTrackGetWebsiteUserDataFailed=fy,e.sendNotification=ZT,e.setAuthTokens=xy,e.setBrowserInstanceId=Wy,e.setUserInfoFromClientState=jy,e.simpleTextProcessor=rT,e.splitText=Hv,e.splitTextRequest=BS,e.stopSpeech=lS,e.testClassicApi=jS,e.textToSpeech=iS,e.trackAdsShown=KS,e.trackAlternativeSelected=qS,e.trackAlternativesEvent=xS,e.trackClickOnAdsButton=XS,e.trackCloseInlineHighlighter=hS,e.trackCloseInputHighlighter=pS,e.trackCustomizationEnabled=RS,e.trackDeeplWriteEvent=wS,e.trackDetectLanguage=CT,e.trackDictionaryStatus=gS,e.trackDisabledDictionaryHover=_S,e.trackDocTransClick=NT,e.trackExtensionOpenedEvent=xT,e.trackFptHide=GT,e.trackGDocsMaxCharExceededTryProClicked=SS,e.trackGDocsReplaceText=zT,e.trackGdocsMaxCharExceededShown=TS,e.trackGlossaryDisabled=FS,e.trackGlossaryEnabled=$S,e.trackGmailCharLimitReached=CS,e.trackIconHover=jT,e.trackIframeTranslationFailed=YS,e.trackIframeTranslationSuccessful=zS,e.trackInlineCopy=VT,e.trackInlineDragStart=FT,e.trackInlineListen=qT,e.trackInlinePositionChange=$T,e.trackInlineSettingsOpened=DT,e.trackInputTranslationInjection=OT,e.trackLandingOnWebsite=oS,e.trackLanguageDetectionForTextProcessing=VS,e.trackLingueeErrorData=vS,e.trackLogoClickedEvent=LT,e.trackOnboardingModalShown=bS,e.trackOnboardingOpenExternalLink=HT,e.trackOnboardingStepChange=WT,e.trackOpenDictionarySection=mS,e.trackOpenInlineHighlighter=dS,e.trackOpenInputHighlighter=uS,e.trackReadMoreClick=JT,e.trackRecommendToAFriendClick=PT,e.trackRightClick=UT,e.trackSeeAlternativesClicked=WS,e.trackSettingChanged=MT,e.trackTranslateAcceptOrUndoEvent=IS,e.trackUILocationClicked=ES,e.trackUiAction=nS,e.trackUpgradeNotificationAction=GS,e.trackUpgradeNotificationClosed=MS,e.trackUpgradeNotificationDisplayed=DS,e.trackUseOfShortcut=tS,e.trackVoiceOverStops=BT,e.trackWriteTextStylesApplied=ZS,e.trackWriteTextStylesChanged=QS,e.trackWriteTextTonesChanged=eb,e.trackZendeskCustomizationEvent=yS,e.trackZendeskGlossaryOpened=US,e.translate=mv,e.translateGmailReceivedEmail=mT,e.translateHtmlRequest=pT,e.translateInlineRequest=hT,e.translateInputRequest=fT,e.translateLargeTextBatched=oT,e.translateLinkedInPostRequest=vT,e.translateSelection=rS,e.translateTwitterTweetRequest=_T,e.translateWhatsAppMessageRequest=TT,e.translateWhatsAppMessagesRequest=ST,e.translateYouTubeCommentRequest=yT,e.translateZendeskInputRequest=gT,e.translateZendeskMessageRequest=RT,e.triggerTranslateInline=uT,e.triggerTranslateInput=dT,e.updateDynamicRules=VO,e.updateITAFormality=iO,e.updateITATargetLanguage=aO,e.updateRequestedLanguage=mO,e.updateSession=Oy,e.updateSourceText=vO,e.updateStyleVariant=_O,e.updateTranslationSessionSettings=zC,e.updateWriteSessionSettings=QC,e.writeData=by,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=background.js.map
